{"version":3,"file":"EnhancedStudentMap-Dhu-IsN7.js","sources":["../../../src/services/busService.ts","../../../src/components/EnhancedStudentMap.tsx"],"sourcesContent":["import { BusLocation, BusInfo, Bus } from '../types';\nimport { IBusService } from './interfaces/IBusService';\nimport { apiService } from './api';\n\ninterface BusData {\n  [busId: string]: BusInfo;\n}\n\ninterface PreviousLocation {\n  latitude: number;\n  longitude: number;\n  timestamp: string;\n}\n\nclass BusService implements IBusService {\n  private buses: BusData = {};\n  private previousLocations: { [busId: string]: PreviousLocation } = {};\n\n  // Calculate speed between two points using Haversine formula\n  private calculateSpeed(\n    lat1: number,\n    lon1: number,\n    lat2: number,\n    lon2: number,\n    timeDiffMs: number\n  ): number {\n    const R = 6371; // Earth's radius in kilometers\n    const dLat = this.toRadians(lat2 - lat1);\n    const dLon = this.toRadians(lon2 - lon1);\n\n    const a =\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n      Math.cos(this.toRadians(lat1)) *\n        Math.cos(this.toRadians(lat2)) *\n        Math.sin(dLon / 2) *\n        Math.sin(dLon / 2);\n\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    const distance = R * c; // Distance in kilometers\n\n    const timeDiffHours = timeDiffMs / (1000 * 60 * 60); // Convert to hours\n    const speed = distance / timeDiffHours; // Speed in km/h\n\n    return Math.round(speed * 10) / 10; // Round to 1 decimal place\n  }\n\n  private toRadians(degrees: number): number {\n    return degrees * (Math.PI / 180);\n  }\n\n  // Update bus location and calculate speed\n  updateBusLocation(location: BusLocation): void {\n    const { busId, latitude, longitude, timestamp } = location;\n\n    // Get previous location for speed calculation\n    const previousLocation = this.previousLocations[busId];\n\n    let speed: number | undefined;\n    if (previousLocation) {\n      const timeDiff =\n        new Date(timestamp).getTime() -\n        new Date(previousLocation.timestamp).getTime();\n      if (timeDiff > 0) {\n        speed = this.calculateSpeed(\n          previousLocation.latitude,\n          previousLocation.longitude,\n          latitude,\n          longitude,\n          timeDiff\n        );\n      }\n    }\n\n    // Update or create bus info\n    if (!this.buses[busId]) {\n      this.buses[busId] = {\n        busId,\n        busNumber: `Bus ${busId}`, // Default name, will be updated from API\n        routeName: 'Route TBD', // Default route, will be updated from API\n        driverName: 'Driver TBD', // Default name, will be updated from API\n        currentLocation: {\n          ...location,\n          speed: speed || location.speed,\n        },\n        eta: location.eta?.estimated_arrival_minutes,\n      };\n    } else {\n      this.buses[busId].currentLocation = {\n        ...location,\n        speed: speed || location.speed,\n      };\n      // Update ETA from location data\n      this.buses[busId].eta = location.eta?.estimated_arrival_minutes;\n    }\n\n    // Store current location as previous for next calculation\n    this.previousLocations[busId] = {\n      latitude,\n      longitude,\n      timestamp,\n    };\n  }\n\n  // Get bus information by ID\n  getBus(busId: string): BusInfo | null {\n    return this.buses[busId] || null;\n  }\n\n  // Get all buses\n  getAllBuses(): BusInfo[] {\n    return Object.values(this.buses);\n  }\n\n  // Get buses by route name\n  getBusesByRoute(routeName: string): BusInfo[] {\n    return Object.values(this.buses).filter(\n      (bus) => bus.routeName === routeName\n    );\n  }\n\n  // Sync bus data from API\n  async syncBusFromAPI(busId: string, apiData?: Bus): Promise<void> {\n    try {\n      // If no API data provided, fetch it from the backend\n      if (!apiData) {\n        const response = await apiService.getBusInfo(busId);\n        if (response.success && response.data) {\n          apiData = response.data;\n        } else {\n          console.error('❌ Failed to fetch bus data from API for bus:', busId);\n          return;\n        }\n      }\n\n      if (this.buses[busId]) {\n        // Update existing bus with API data\n        this.buses[busId] = {\n          ...this.buses[busId],\n          busNumber: apiData.number_plate || apiData.code || `Bus ${busId}`,\n          routeName: apiData.route_name || 'Route TBD',\n          driverName: apiData.driver_full_name || 'Driver TBD',\n        };\n      } else {\n        // Create new bus from API data\n        this.buses[busId] = {\n          busId,\n          busNumber: apiData.number_plate || apiData.code || `Bus ${busId}`,\n          routeName: apiData.route_name || 'Route TBD',\n          driverName: apiData.driver_full_name || 'Driver TBD',\n          currentLocation: {\n            busId,\n            driverId: apiData.assigned_driver_id || '',\n            latitude: 0,\n            longitude: 0,\n            timestamp: new Date().toISOString(),\n          },\n        };\n      }\n    } catch (error) {\n      console.error('❌ Error syncing bus data from API:', error);\n    }\n  }\n\n  // Sync all buses from API\n  async syncAllBusesFromAPI(): Promise<void> {\n    try {\n      const response = await apiService.getAllBuses();\n      if (response.success && response.data) {\n        response.data.forEach((bus: Bus) => {\n          this.syncBusFromAPI(bus.id, bus);\n        });\n      }\n    } catch (error) {\n      console.error('❌ Error syncing all buses from API:', error);\n    }\n  }\n\n  // Clear all buses\n  clearBuses(): void {\n    this.buses = {};\n    this.previousLocations = {};\n  }\n\n  // Get bus statistics\n  getBusStats(): {\n    totalBuses: number;\n    activeBuses: number;\n    busesByRoute: { [routeName: string]: number };\n  } {\n    const buses = Object.values(this.buses);\n    const busesByRoute: { [routeName: string]: number } = {};\n\n    buses.forEach((bus) => {\n      const routeName = bus.routeName;\n      busesByRoute[routeName] = (busesByRoute[routeName] || 0) + 1;\n    });\n\n    return {\n      totalBuses: buses.length,\n      activeBuses: buses.filter((bus) => bus.currentLocation).length,\n      busesByRoute,\n    };\n  }\n\n  // Get buses with recent activity (within last 5 minutes)\n  getActiveBuses(): BusInfo[] {\n    const fiveMinutesAgo = new Date(Date.now() - 5 * 60 * 1000);\n    return Object.values(this.buses).filter((bus) => {\n      const lastUpdate = new Date(bus.currentLocation.timestamp);\n      return lastUpdate > fiveMinutesAgo;\n    });\n  }\n\n  // Get bus location history (simplified - in real app, this would come from API)\n  getBusLocationHistory(busId: string): BusLocation[] {\n    // This is a simplified implementation\n    // In a real application, this would fetch from the backend API\n    const bus = this.buses[busId];\n    if (!bus) return [];\n\n    return [bus.currentLocation];\n  }\n\n  // Update bus ETA\n  updateBusETA(busId: string, eta: number): void {\n    if (this.buses[busId]) {\n      this.buses[busId].eta = eta;\n    }\n  }\n\n  // Get buses near a specific location\n  getBusesNearLocation(\n    latitude: number,\n    longitude: number,\n    radiusKm: number = 5\n  ): BusInfo[] {\n    return Object.values(this.buses).filter((bus) => {\n      const busLat = bus.currentLocation.latitude;\n      const busLng = bus.currentLocation.longitude;\n\n      // Calculate distance using Haversine formula\n      const R = 6371; // Earth's radius in kilometers\n      const dLat = this.toRadians(busLat - latitude);\n      const dLon = this.toRadians(busLng - longitude);\n\n      const a =\n        Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n        Math.cos(this.toRadians(latitude)) *\n          Math.cos(this.toRadians(busLat)) *\n          Math.sin(dLon / 2) *\n          Math.sin(dLon / 2);\n\n      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n      const distance = R * c;\n\n      return distance <= radiusKm;\n    });\n  }\n}\n\n// Export singleton instance\nexport const busService = new BusService();\nexport default busService;\nexport type { BusInfo } from '../types';\n","import React, {\n  useEffect,\n  useRef,\n  useState,\n  useCallback,\n  useMemo,\n} from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport maplibregl from 'maplibre-gl';\nimport { websocketService, BusLocation } from '../services/websocket';\nimport { busService, BusInfo } from '../services/busService';\nimport { apiService } from '../services/api';\nimport { authService } from '../services/authService';\nimport GlassyCard from './ui/GlassyCard';\nimport './StudentMap.css';\nimport { Route } from '../types';\n\ninterface EnhancedStudentMapProps {\n  className?: string;\n}\n\nconst EnhancedStudentMap: React.FC<EnhancedStudentMapProps> = ({\n  className = '',\n}) => {\n  // Map references\n  const mapContainer = useRef<HTMLDivElement>(null);\n  const map = useRef<maplibregl.Map | null>(null);\n  const markers = useRef<{ [busId: string]: maplibregl.Marker }>({});\n  const isMapInitialized = useRef(false);\n  const addedRoutes = useRef<Set<string>>(new Set());\n\n  // State management\n  const [isConnected, setIsConnected] = useState(false);\n  const [connectionError, setConnectionError] = useState<string | null>(null);\n  const [connectionStatus, setConnectionStatus] = useState<\n    'connected' | 'connecting' | 'disconnected' | 'reconnecting'\n  >('disconnected');\n  const [buses, setBuses] = useState<BusInfo[]>([]);\n  const [routes, setRoutes] = useState<Route[]>([]);\n  const [selectedRoute, setSelectedRoute] = useState<string>('all');\n  const [isLoading, setIsLoading] = useState(true);\n  const [lastBusLocations, setLastBusLocations] = useState<{\n    [busId: string]: BusLocation;\n  }>({});\n\n  // Navbar state\n  const [isNavbarCollapsed, setIsNavbarCollapsed] = useState(false);\n  const [isRouteFilterOpen, setIsRouteFilterOpen] = useState(true);\n  const [isActiveBusesOpen, setIsActiveBusesOpen] = useState(true);\n\n  // Load routes from API\n  const loadRoutes = useCallback(async () => {\n    try {\n      console.log('🔄 Loading routes from backend API...');\n      const response = await apiService.getRoutes();\n      if (response.success && response.data) {\n        console.log(\n          '✅ Routes loaded from backend:',\n          response.data.length,\n          'routes'\n        );\n        setRoutes(response.data as unknown as Route[]);\n\n        // Log route details for debugging\n        response.data.forEach((route: Route) => {\n          console.log(\n            `📍 Route: ${route.name} (ID: ${route.id}) - Active: ${route.is_active}`\n          );\n        });\n      } else {\n        console.error('❌ Failed to load routes:', response);\n      }\n    } catch (error) {\n      console.error('❌ Error loading routes:', error);\n    }\n  }, []);\n\n  // Remove routes from map\n  const removeRoutesFromMap = useCallback(() => {\n    if (!map.current) return;\n\n    routes.forEach((route) => {\n      const routeId = `route-${route.id}`;\n\n      try {\n        if (map.current!.getLayer(routeId)) {\n          map.current!.removeLayer(routeId);\n        }\n        if (map.current!.getSource(routeId)) {\n          map.current!.removeSource(routeId);\n        }\n        addedRoutes.current.delete(routeId);\n      } catch (error) {\n        console.warn(`⚠️ Error removing route ${route.name}:`, error);\n      }\n    });\n  }, [routes]);\n\n  // Add routes to map\n  const addRoutesToMap = useCallback(() => {\n    if (!map.current || routes.length === 0) return;\n\n    console.log('🗺️ Adding routes to map:', routes.length, 'routes');\n\n    routes.forEach((route, index) => {\n      const routeId = `route-${route.id}`;\n\n      if (addedRoutes.current.has(routeId) || map.current!.getSource(routeId)) {\n        console.log(`🗺️ Route ${routeId} already exists, skipping...`);\n        return;\n      }\n\n      try {\n        map.current!.addSource(routeId, {\n          type: 'geojson',\n          data: {\n            type: 'Feature',\n            properties: {\n              name: route.name,\n              description: route.description,\n              distance: route.distance_km,\n              duration: route.estimated_duration_minutes,\n            },\n            geometry: route.stops,\n          },\n        });\n\n        map.current!.addLayer({\n          id: routeId,\n          type: 'line',\n          source: routeId,\n          layout: {\n            'line-join': 'round',\n            'line-cap': 'round',\n          },\n          paint: {\n            'line-color': `hsl(${(index * 137.5) % 360}, 70%, 50%)`,\n            'line-width': 4,\n            'line-opacity': 0.8,\n          },\n        });\n\n        console.log(`🗺️ Added route ${route.name} to map`);\n        addedRoutes.current.add(routeId);\n      } catch (error) {\n        console.warn(`⚠️ Error adding route ${route.name}:`, error);\n      }\n    });\n  }, [routes]);\n\n  // Update bus marker on map\n  const updateBusMarker = useCallback(\n    (location: BusLocation) => {\n      if (!map.current) return;\n\n      const { busId, latitude, longitude, speed } = location;\n      const bus = busService.getBus(busId);\n\n      if (!bus) return;\n\n      if (!markers.current[busId]) {\n        const el = document.createElement('div');\n        el.className = 'bus-marker';\n        el.innerHTML = `\n        <div class=\"bus-marker-pin\">\n          <div class=\"bus-marker-icon\">🚌</div>\n          <div class=\"bus-marker-pulse\"></div>\n        </div>\n        <div class=\"bus-marker-content\">\n          <div class=\"bus-number\">${bus.busNumber}</div>\n          <div class=\"bus-speed\">${speed ? `${speed} km/h` : 'N/A'}</div>\n          <div class=\"bus-eta\">${location.eta ? `ETA: ${location.eta.estimated_arrival_minutes} min` : 'ETA: N/A'}</div>\n        </div>\n      `;\n\n        const marker = new maplibregl.Marker({\n          element: el,\n          anchor: 'center',\n        })\n          .setLngLat([longitude, latitude])\n          .addTo(map.current);\n\n        const popup = new maplibregl.Popup({\n          offset: 25,\n          className: 'bus-popup-container',\n        }).setHTML(`\n        <div class=\"bus-popup\">\n          <div class=\"bus-popup-header\">\n            <h3>🚌 Bus ${bus.busNumber}</h3>\n            <div class=\"bus-status ${isConnected ? 'online' : 'offline'}\">\n              ${isConnected ? '🟢 Online' : '🔴 Offline'}\n            </div>\n          </div>\n          <div class=\"bus-popup-content\">\n            <div class=\"bus-info\">\n              <p><strong>Driver:</strong> ${bus.driverName || 'N/A'}</p>\n              <p><strong>Route:</strong> ${bus.routeName || 'N/A'}</p>\n              <p><strong>Speed:</strong> ${speed ? `${speed} km/h` : 'N/A'}</p>\n              <p><strong>Last Update:</strong> ${new Date(location.timestamp).toLocaleTimeString()}</p>\n            </div>\n          </div>\n        </div>\n      `);\n\n        marker.setPopup(popup);\n        markers.current[busId] = marker;\n      } else {\n        markers.current[busId].setLngLat([longitude, latitude]);\n\n        const popup = markers.current[busId].getPopup();\n        popup.setHTML(`\n        <div class=\"bus-popup\">\n          <div class=\"bus-popup-header\">\n            <h3>🚌 Bus ${bus.busNumber}</h3>\n            <div class=\"bus-status ${isConnected ? 'online' : 'offline'}\">\n              ${isConnected ? '🟢 Online' : '🔴 Offline'}\n            </div>\n          </div>\n          <div class=\"bus-popup-content\">\n            <div class=\"bus-info\">\n              <p><strong>Driver:</strong> ${bus.driverName || 'N/A'}</p>\n              <p><strong>Route:</strong> ${bus.routeName || 'N/A'}</p>\n              <p><strong>Speed:</strong> ${speed ? `${speed} km/h` : 'N/A'}</p>\n              <p><strong>Last Update:</strong> ${new Date(location.timestamp).toLocaleTimeString()}</p>\n            </div>\n          </div>\n        </div>\n      `);\n      }\n    },\n    [isConnected]\n  );\n\n  // Remove bus marker from map\n  const removeBusMarker = useCallback((busId: string) => {\n    if (markers.current[busId]) {\n      markers.current[busId].remove();\n      delete markers.current[busId];\n    }\n  }, []);\n\n  // Center map on all buses\n  const centerMapOnBuses = useCallback(() => {\n    if (!map.current || Object.keys(lastBusLocations).length === 0) return;\n\n    const coordinates = Object.values(lastBusLocations).map(\n      (location) => [location.longitude, location.latitude] as [number, number]\n    );\n\n    if (coordinates.length === 1) {\n      map.current.flyTo({\n        center: coordinates[0],\n        zoom: 16,\n        duration: 2000,\n      });\n    } else if (coordinates.length > 1) {\n      const bounds = new maplibregl.LngLatBounds();\n      coordinates.forEach((coord) => bounds.extend(coord));\n\n      map.current.fitBounds(bounds, {\n        padding: 50,\n        duration: 2000,\n      });\n    }\n  }, [lastBusLocations]);\n\n  // Handle bus location updates\n  const handleBusLocationUpdate = useCallback(\n    (location: BusLocation) => {\n      console.log('📍 Bus location update:', location);\n\n      setLastBusLocations((prev) => ({\n        ...prev,\n        [location.busId]: location,\n      }));\n\n      updateBusMarker(location);\n    },\n    [updateBusMarker]\n  );\n\n  const handleDriverConnected = useCallback(\n    (data: { driverId: string; busId: string; timestamp: string }) => {\n      console.log('🚌 Driver connected:', data);\n    },\n    []\n  );\n\n  const handleDriverDisconnected = useCallback(\n    (data: { driverId: string; busId: string; timestamp: string }) => {\n      console.log('🚌 Driver disconnected:', data);\n      removeBusMarker(data.busId);\n    },\n    [removeBusMarker]\n  );\n\n  const handleBusArriving = useCallback(\n    (data: {\n      busId: string;\n      routeId: string;\n      location: [number, number];\n      timestamp: string;\n    }) => {\n      console.log('🚌 Bus arriving:', data);\n    },\n    []\n  );\n\n  // Initialize map\n  useEffect(() => {\n    if (isMapInitialized.current || !mapContainer.current) {\n      return;\n    }\n\n    console.log('🗺️ Initializing map...');\n    isMapInitialized.current = true;\n\n    map.current = new maplibregl.Map({\n      container: mapContainer.current,\n      style: {\n        version: 8,\n        sources: {\n          osm: {\n            type: 'raster',\n            tiles: [\n              'https://tile.openstreetmap.org/{z}/{x}/{y}.png',\n              'https://a.tile.openstreetmap.org/{z}/{x}/{y}.png',\n              'https://b.tile.openstreetmap.org/{z}/{x}/{y}.png',\n              'https://c.tile.openstreetmap.org/{z}/{x}/{y}.png',\n            ],\n            tileSize: 256,\n            attribution: '© OpenStreetMap contributors',\n            maxzoom: 19,\n          },\n        },\n        layers: [\n          {\n            id: 'osm-tiles',\n            type: 'raster',\n            source: 'osm',\n            minzoom: 0,\n            maxzoom: 19,\n          },\n        ],\n      },\n      center: [72.571, 23.025],\n      zoom: 12,\n      bearing: 0,\n      pitch: 0,\n      attributionControl: true,\n      maxZoom: 19,\n      minZoom: 1,\n      preserveDrawingBuffer: false,\n      antialias: true,\n      dragRotate: false,\n    });\n\n    map.current.addControl(new maplibregl.NavigationControl(), 'top-right');\n\n    map.current.once('load', () => {\n      console.log('🗺️ Map loaded successfully');\n      setIsLoading(false);\n      loadRoutes();\n    });\n\n    map.current.on('error', (e) => {\n      console.error('❌ Map error:', e);\n    });\n\n    return () => {\n      if (map.current) {\n        map.current.remove();\n        map.current = null;\n        isMapInitialized.current = false;\n        addedRoutes.current.clear();\n        markers.current = {};\n      }\n    };\n  }, [loadRoutes]);\n\n  // Connect to WebSocket\n  useEffect(() => {\n    let reconnectTimeout: NodeJS.Timeout;\n    let statusInterval: NodeJS.Timeout;\n    let reconnectAttempts = 0;\n\n    const connectWebSocket = async () => {\n      try {\n        setConnectionError(null);\n        setConnectionStatus('connecting');\n        \n        // Set client type for student map\n        websocketService.setClientType('student');\n        \n        // Reset WebSocket service state before connecting\n        websocketService.resetState();\n        \n        await websocketService.connect();\n        setIsConnected(true);\n        setConnectionStatus('connected');\n\n        websocketService.onBusLocationUpdate(handleBusLocationUpdate);\n        websocketService.onDriverConnected(handleDriverConnected);\n        websocketService.onDriverDisconnected(handleDriverDisconnected);\n        // Emit student connection event\n        websocketService.socket?.emit('student:connect');\n        \n        // Set client type for student connection\n        websocketService.setClientType('student');\n        \n        websocketService.onStudentConnected(() => {\n          console.log('✅ Student connected to WebSocket');\n        });\n        websocketService.onBusArriving(handleBusArriving);\n\n        const checkConnectionStatus = () => {\n          const status = websocketService.getConnectionStatus();\n          if (!status && connectionStatus === 'connected') {\n            setConnectionStatus('disconnected');\n            setIsConnected(false);\n          }\n        };\n\n        statusInterval = setInterval(checkConnectionStatus, 10000);\n\n        const loadBuses = async () => {\n          try {\n            while (!authService.isInitialized()) {\n              await new Promise((resolve) => setTimeout(resolve, 100));\n            }\n\n            const response = await apiService.getAllBuses();\n            if (response.success && response.data) {\n              console.log(\n                '📊 Initial bus data from API:',\n                response.data.length,\n                'buses'\n              );\n\n              response.data.forEach((apiBus: any) => {\n                const busId = apiBus.bus_id || apiBus.id;\n                if (busId) {\n                  busService.syncBusFromAPI(busId, apiBus);\n                }\n              });\n\n              const updatedBuses = busService.getAllBuses();\n              setBuses(updatedBuses);\n              console.log(\n                '✅ Initial buses loaded and synced:',\n                response.data.length\n              );\n            }\n          } catch (error) {\n            console.error('❌ Error loading initial buses:', error);\n          }\n        };\n\n        loadBuses();\n      } catch (error) {\n        console.error('❌ WebSocket connection failed:', error);\n        setConnectionError('Failed to connect to real-time updates');\n        setIsConnected(false);\n        setConnectionStatus('disconnected');\n\n        // Retry connection with exponential backoff\n        const retryDelay = Math.min(5000 * Math.pow(2, Math.min(reconnectAttempts, 3)), 30000);\n        console.log(`🔄 Retrying WebSocket connection in ${retryDelay}ms...`);\n        \n        reconnectAttempts++;\n        reconnectTimeout = setTimeout(() => {\n          console.log('🔄 Retrying WebSocket connection...');\n          setConnectionStatus('reconnecting');\n          connectWebSocket();\n        }, retryDelay);\n      }\n    };\n\n    connectWebSocket();\n\n    return () => {\n      if (reconnectTimeout) {\n        clearTimeout(reconnectTimeout);\n      }\n      if (statusInterval) {\n        clearInterval(statusInterval);\n      }\n      websocketService.softDisconnect();\n    };\n  }, [\n    handleBusArriving,\n    handleBusLocationUpdate,\n    handleDriverConnected,\n    handleDriverDisconnected,\n  ]);\n\n  // Get filtered buses based on selected route\n  const filteredBuses = useMemo(() => {\n    if (selectedRoute === 'all') {\n      return buses;\n    }\n\n    return buses.filter((bus) => {\n      const busRoute = routes.find((route) => route.name === bus.routeName);\n      return busRoute && busRoute.id === selectedRoute;\n    });\n  }, [buses, selectedRoute, routes]);\n\n  // Get unique routes for filter\n  const availableRoutes = useMemo(() => {\n    return routes.map((route: Route) => ({\n      id: route.id,\n      name: route.name,\n      description: route.description,\n    }));\n  }, [routes]);\n\n  // Add routes to map when routes are loaded\n  useEffect(() => {\n    if (routes.length > 0 && map.current && map.current.isStyleLoaded()) {\n      removeRoutesFromMap();\n      addRoutesToMap();\n    }\n\n    return () => {\n      if (map.current) {\n        removeRoutesFromMap();\n      }\n    };\n  }, [routes, addRoutesToMap, removeRoutesFromMap]);\n\n  return (\n    <div className={`relative h-screen ${className}`}>\n      {/* Loading overlay */}\n      {isLoading && (\n        <div className=\"loading-overlay\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n            <p className=\"mt-4 text-gray-600\">Loading map...</p>\n          </div>\n        </div>\n      )}\n\n      {/* Error overlay */}\n      {connectionError && (\n        <div className=\"error-overlay\">\n          <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n            <div className=\"flex\">\n              <div className=\"flex-shrink-0\">\n                <svg\n                  className=\"h-5 w-5 text-red-400\"\n                  viewBox=\"0 0 20 20\"\n                  fill=\"currentColor\"\n                >\n                  <path\n                    fillRule=\"evenodd\"\n                    d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\"\n                    clipRule=\"evenodd\"\n                  />\n                </svg>\n              </div>\n              <div className=\"ml-3\">\n                <h3 className=\"text-sm font-medium text-red-800\">\n                  Connection Error\n                </h3>\n                <p className=\"text-sm text-red-700 mt-1\">{connectionError}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Map container */}\n      <div ref={mapContainer} className=\"map-container rounded-lg\" />\n\n      {/* Collapsible Glassmorphic Navbar */}\n      <motion.div\n        initial={{ x: -400 }}\n        animate={{ x: isNavbarCollapsed ? -350 : 0 }}\n        transition={{ duration: 0.3, ease: 'easeInOut' }}\n        className=\"absolute top-4 left-4 z-30\"\n      >\n        {/* Collapse/Expand Button (always visible) */}\n        <button\n          onClick={() => setIsNavbarCollapsed(!isNavbarCollapsed)}\n          className=\"absolute -right-12 top-0 p-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg hover:bg-white/20 transition-all duration-200 z-40\"\n        >\n          <svg\n            className={`w-5 h-5 text-white transition-transform duration-200 ${\n              isNavbarCollapsed ? 'rotate-180' : ''\n            }`}\n            fill=\"none\"\n            stroke=\"currentColor\"\n            viewBox=\"0 0 24 24\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M15 19l-7-7 7-7\"\n            />\n          </svg>\n        </button>\n        <GlassyCard\n          variant=\"premium\"\n          glow={true}\n          className=\"w-80 max-h-[calc(100vh-2rem)] overflow-hidden\"\n        >\n          {/* Navbar Header */}\n          <div className=\"flex items-center justify-between p-4 border-b border-white/20\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-3 h-3 bg-green-500 rounded-full animate-pulse\"></div>\n              <h2 className=\"text-lg font-bold text-gray-900\">\n                Student Live Tracking\n              </h2>\n            </div>\n            <div className=\"text-xs text-gray-600 bg-white/50 px-2 py-1 rounded\">\n              Live Map\n            </div>\n          </div>\n\n          {/* Navbar Content */}\n          <div className=\"p-4 space-y-4 max-h-[calc(100vh-8rem)] overflow-y-auto\">\n            {/* Connection Status */}\n            <div className=\"flex items-center justify-between p-3 bg-blue-50/80 rounded-lg border border-blue-200/50\">\n              <div className=\"flex items-center space-x-2\">\n                <div\n                  className={`w-2 h-2 rounded-full ${\n                    isConnected ? 'bg-green-500 animate-pulse' : 'bg-red-500'\n                  }`}\n                ></div>\n                <span className=\"text-sm text-gray-800 font-medium\">\n                  {isConnected ? 'Live Connected' : 'Offline'}\n                </span>\n              </div>\n              <span className=\"text-xs text-gray-600 bg-white/70 px-2 py-1 rounded\">\n                {filteredBuses.length} buses\n              </span>\n            </div>\n\n            {/* Route Filter Section */}\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-sm font-semibold text-gray-800\">\n                  Route Filter\n                </h3>\n                <button\n                  onClick={() => setIsRouteFilterOpen(!isRouteFilterOpen)}\n                  className=\"p-1 hover:bg-gray-100 rounded transition-colors duration-200\"\n                >\n                  <svg\n                    className={`w-4 h-4 text-gray-600 transition-transform duration-200 ${\n                      isRouteFilterOpen ? 'rotate-180' : ''\n                    }`}\n                    fill=\"none\"\n                    stroke=\"currentColor\"\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth={2}\n                      d=\"M19 9l-7 7-7-7\"\n                    />\n                  </svg>\n                </button>\n              </div>\n\n              <AnimatePresence>\n                {isRouteFilterOpen && (\n                  <motion.div\n                    initial={{ height: 0, opacity: 0 }}\n                    animate={{ height: 'auto', opacity: 1 }}\n                    exit={{ height: 0, opacity: 0 }}\n                    transition={{ duration: 0.2 }}\n                    className=\"space-y-3\"\n                  >\n                    <select\n                      value={selectedRoute}\n                      onChange={(e) => setSelectedRoute(e.target.value)}\n                      className=\"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all duration-200\"\n                    >\n                      <option value=\"all\">All Routes ({routes.length})</option>\n                      {availableRoutes.map((route) => (\n                        <option key={route.id} value={route.id}>\n                          {route.name}\n                        </option>\n                      ))}\n                    </select>\n\n                    <button\n                      onClick={centerMapOnBuses}\n                      disabled={filteredBuses.length === 0}\n                      className=\"w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 border border-blue-600 rounded-lg text-white font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      📍 Center on Buses ({filteredBuses.length})\n                    </button>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </div>\n\n            {/* Active Buses Section */}\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-sm font-semibold text-gray-800\">\n                  Active Buses\n                </h3>\n                <button\n                  onClick={() => setIsActiveBusesOpen(!isActiveBusesOpen)}\n                  className=\"p-1 hover:bg-gray-100 rounded transition-colors duration-200\"\n                >\n                  <svg\n                    className={`w-4 h-4 text-gray-600 transition-transform duration-200 ${\n                      isActiveBusesOpen ? 'rotate-180' : ''\n                    }`}\n                    fill=\"none\"\n                    stroke=\"currentColor\"\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth={2}\n                      d=\"M19 9l-7 7-7-7\"\n                    />\n                  </svg>\n                </button>\n              </div>\n\n              <AnimatePresence>\n                {isActiveBusesOpen && (\n                  <motion.div\n                    initial={{ height: 0, opacity: 0 }}\n                    animate={{ height: 'auto', opacity: 1 }}\n                    exit={{ height: 0, opacity: 0 }}\n                    transition={{ duration: 0.2 }}\n                    className=\"space-y-2 max-h-64 overflow-y-auto\"\n                  >\n                    {filteredBuses.length === 0 ? (\n                      <div className=\"text-center py-4\">\n                        <div className=\"text-gray-400 text-2xl mb-2\">🚌</div>\n                        <p className=\"text-gray-600 text-sm\">\n                          No buses tracking\n                        </p>\n                        <p className=\"text-gray-500 text-xs mt-1\">\n                          Check connection status\n                        </p>\n                      </div>\n                    ) : (\n                      filteredBuses.map((bus) => {\n                        const location = lastBusLocations[bus.busId];\n                        return (\n                          <motion.div\n                            key={bus.busId}\n                            initial={{ opacity: 0, y: 10 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            className=\"p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 cursor-pointer transition-all duration-200 shadow-sm\"\n                            onClick={() => {\n                              const location = lastBusLocations[bus.busId];\n                              if (location && map.current) {\n                                map.current.flyTo({\n                                  center: [\n                                    location.longitude,\n                                    location.latitude,\n                                  ],\n                                  zoom: 16,\n                                  duration: 1000,\n                                });\n                                const marker = markers.current[bus.busId];\n                                if (marker) {\n                                  marker.getPopup().addTo(map.current);\n                                }\n                              }\n                            }}\n                          >\n                            {/* Bus Header */}\n                            <div className=\"flex items-center justify-between mb-2\">\n                              <div className=\"flex items-center space-x-2\">\n                                <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n                                <span className=\"font-medium text-sm text-gray-800\">\n                                  {bus.busNumber}\n                                </span>\n                                <span className=\"text-xs text-blue-600 opacity-75\">\n                                  👆\n                                </span>\n                              </div>\n                              <div className=\"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded\">\n                                {bus.eta ? `${bus.eta} min` : 'ETA: --'}\n                              </div>\n                            </div>\n\n                            {/* Bus Details */}\n                            <div className=\"space-y-1\">\n                              <div className=\"text-xs text-gray-600\">\n                                📍 Route: {bus.routeName}\n                              </div>\n                              <div className=\"text-xs text-gray-600\">\n                                👨‍💼 Driver: {bus.driverName}\n                              </div>\n                              {location && (\n                                <div className=\"flex items-center justify-between text-xs\">\n                                  <span className=\"text-green-600\">\n                                    🕐{' '}\n                                    {new Date(\n                                      location.timestamp\n                                    ).toLocaleTimeString([], {\n                                      hour: '2-digit',\n                                      minute: '2-digit',\n                                    })}\n                                  </span>\n                                  <span className=\"text-blue-600\">\n                                    {location.speed\n                                      ? `${location.speed} km/h`\n                                      : 'Speed: --'}\n                                  </span>\n                                </div>\n                              )}\n                            </div>\n                          </motion.div>\n                        );\n                      })\n                    )}\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </div>\n          </div>\n        </GlassyCard>\n      </motion.div>\n    </div>\n  );\n};\n\nexport default EnhancedStudentMap;\n"],"names":["BusService","__publicField","lat1","lon1","lat2","lon2","timeDiffMs","dLat","dLon","a","distance","timeDiffHours","speed","degrees","location","busId","latitude","longitude","timestamp","previousLocation","timeDiff","_b","_a","routeName","bus","apiData","response","apiService","error","buses","busesByRoute","fiveMinutesAgo","eta","radiusKm","busLat","busLng","R","c","busService","EnhancedStudentMap","className","mapContainer","useRef","map","markers","isMapInitialized","addedRoutes","isConnected","setIsConnected","useState","connectionError","setConnectionError","connectionStatus","setConnectionStatus","setBuses","routes","setRoutes","selectedRoute","setSelectedRoute","isLoading","setIsLoading","lastBusLocations","setLastBusLocations","isNavbarCollapsed","setIsNavbarCollapsed","isRouteFilterOpen","setIsRouteFilterOpen","isActiveBusesOpen","setIsActiveBusesOpen","loadRoutes","useCallback","route","removeRoutesFromMap","routeId","addRoutesToMap","index","updateBusMarker","el","marker","maplibregl","popup","removeBusMarker","centerMapOnBuses","coordinates","bounds","coord","handleBusLocationUpdate","prev","handleDriverConnected","data","handleDriverDisconnected","handleBusArriving","useEffect","reconnectTimeout","statusInterval","reconnectAttempts","connectWebSocket","websocketService","authService","resolve","apiBus","updatedBuses","retryDelay","filteredBuses","useMemo","busRoute","availableRoutes","jsxDEV","this","motion","GlassyCard","AnimatePresence"],"mappings":"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"}