var ae=Object.defineProperty;var ie=(C,o,n)=>o in C?ae(C,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):C[o]=n;var I=(C,o,n)=>ie(C,typeof o!="symbol"?o+"":o,n);import{a as L,w as f,j as t,G as ce,b as le}from"./index-BK47aaFD.js";import{r}from"./vendor-react-CyT1AhbS.js";import{m as P}from"./vendor-maps-C78ko_py.js";import{m as V,A as J}from"./vendor-animations-jk_Di6sJ.js";import"./vendor-ui-D_U17TOn.js";import"./vendor-router-BXLLWNa2.js";import"./vendor-state-B-5mdhwp.js";import"./vendor-websocket-TjCxX7sJ.js";class de{constructor(){I(this,"buses",{});I(this,"previousLocations",{})}calculateSpeed(o,n,a,l,u){const m=this.toRadians(a-o),p=this.toRadians(l-n),b=Math.sin(m/2)*Math.sin(m/2)+Math.cos(this.toRadians(o))*Math.cos(this.toRadians(a))*Math.sin(p/2)*Math.sin(p/2),v=6371*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b))),S=u/(1e3*60*60),k=v/S;return Math.round(k*10)/10}toRadians(o){return o*(Math.PI/180)}updateBusLocation(o){var p,b;const{busId:n,latitude:a,longitude:l,timestamp:u}=o,c=this.previousLocations[n];let m;if(c){const E=new Date(u).getTime()-new Date(c.timestamp).getTime();E>0&&(m=this.calculateSpeed(c.latitude,c.longitude,a,l,E))}this.buses[n]?(this.buses[n].currentLocation={...o,speed:m||o.speed},this.buses[n].eta=(b=o.eta)==null?void 0:b.estimated_arrival_minutes):this.buses[n]={busId:n,busNumber:`Bus ${n}`,routeName:"Route TBD",driverName:"Driver TBD",currentLocation:{...o,speed:m||o.speed},eta:(p=o.eta)==null?void 0:p.estimated_arrival_minutes},this.previousLocations[n]={latitude:a,longitude:l,timestamp:u}}getBus(o){return this.buses[o]||null}getAllBuses(){return Object.values(this.buses)}getBusesByRoute(o){return Object.values(this.buses).filter(n=>n.routeName===o)}async syncBusFromAPI(o,n){try{if(!n){const a=await L.getBusInfo(o);if(a.success&&a.data)n=a.data;else{console.error("❌ Failed to fetch bus data from API for bus:",o);return}}this.buses[o]?this.buses[o]={...this.buses[o],busNumber:n.number_plate||n.code||`Bus ${o}`,routeName:n.route_name||"Route TBD",driverName:n.driver_full_name||"Driver TBD"}:this.buses[o]={busId:o,busNumber:n.number_plate||n.code||`Bus ${o}`,routeName:n.route_name||"Route TBD",driverName:n.driver_full_name||"Driver TBD",currentLocation:{busId:o,driverId:n.assigned_driver_id||"",latitude:0,longitude:0,timestamp:new Date().toISOString()}}}catch(a){console.error("❌ Error syncing bus data from API:",a)}}async syncAllBusesFromAPI(){try{const o=await L.getAllBuses();o.success&&o.data&&o.data.forEach(n=>{this.syncBusFromAPI(n.id,n)})}catch(o){console.error("❌ Error syncing all buses from API:",o)}}clearBuses(){this.buses={},this.previousLocations={}}getBusStats(){const o=Object.values(this.buses),n={};return o.forEach(a=>{const l=a.routeName;n[l]=(n[l]||0)+1}),{totalBuses:o.length,activeBuses:o.filter(a=>a.currentLocation).length,busesByRoute:n}}getActiveBuses(){const o=new Date(Date.now()-3e5);return Object.values(this.buses).filter(n=>new Date(n.currentLocation.timestamp)>o)}getBusLocationHistory(o){const n=this.buses[o];return n?[n.currentLocation]:[]}updateBusETA(o,n){this.buses[o]&&(this.buses[o].eta=n)}getBusesNearLocation(o,n,a=5){return Object.values(this.buses).filter(l=>{const u=l.currentLocation.latitude,c=l.currentLocation.longitude,m=6371,p=this.toRadians(u-o),b=this.toRadians(c-n),E=Math.sin(p/2)*Math.sin(p/2)+Math.cos(this.toRadians(o))*Math.cos(this.toRadians(u))*Math.sin(b/2)*Math.sin(b/2),v=2*Math.atan2(Math.sqrt(E),Math.sqrt(1-E));return m*v<=a})}}const _=new de,xe=({className:C=""})=>{const o=r.useRef(null),n=r.useRef(null),a=r.useRef({}),l=r.useRef(!1),u=r.useRef(new Set),[c,m]=r.useState(!1),[p,b]=r.useState(null),[E,v]=r.useState("disconnected"),[S,k]=r.useState([]),[d,K]=r.useState([]),[w,Q]=r.useState("all"),[X,Y]=r.useState(!0),[M,ee]=r.useState({}),[B,ne]=r.useState(!1),[R,te]=r.useState(!0),[$,oe]=r.useState(!0),O=r.useCallback(async()=>{try{console.log("🔄 Loading routes from backend API...");const e=await L.getRoutes();e.success&&e.data?(console.log("✅ Routes loaded from backend:",e.data.length,"routes"),K(e.data),e.data.forEach(s=>{console.log(`📍 Route: ${s.name} (ID: ${s.id}) - Active: ${s.is_active}`)})):console.error("❌ Failed to load routes:",e)}catch(e){console.error("❌ Error loading routes:",e)}},[]),A=r.useCallback(()=>{n.current&&d.forEach(e=>{const s=`route-${e.id}`;try{n.current.getLayer(s)&&n.current.removeLayer(s),n.current.getSource(s)&&n.current.removeSource(s),u.current.delete(s)}catch(i){console.warn(`⚠️ Error removing route ${e.name}:`,i)}})},[d]),z=r.useCallback(()=>{!n.current||d.length===0||(console.log("🗺️ Adding routes to map:",d.length,"routes"),d.forEach((e,s)=>{const i=`route-${e.id}`;if(u.current.has(i)||n.current.getSource(i)){console.log(`🗺️ Route ${i} already exists, skipping...`);return}try{n.current.addSource(i,{type:"geojson",data:{type:"Feature",properties:{name:e.name,description:e.description,distance:e.distance_km,duration:e.estimated_duration_minutes},geometry:e.stops}}),n.current.addLayer({id:i,type:"line",source:i,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":`hsl(${s*137.5%360}, 70%, 50%)`,"line-width":4,"line-opacity":.8}}),console.log(`🗺️ Added route ${e.name} to map`),u.current.add(i)}catch(g){console.warn(`⚠️ Error adding route ${e.name}:`,g)}}))},[d]),F=r.useCallback(e=>{if(!n.current)return;const{busId:s,latitude:i,longitude:g,speed:x}=e,N=_.getBus(s);if(N)if(a.current[s])a.current[s].setLngLat([g,i]),a.current[s].getPopup().setHTML(`
        <div class="bus-popup">
          <div class="bus-popup-header">
            <h3>🚌 Bus ${N.busNumber}</h3>
            <div class="bus-status ${c?"online":"offline"}">
              ${c?"🟢 Online":"🔴 Offline"}
            </div>
          </div>
          <div class="bus-popup-content">
            <div class="bus-info">
              <p><strong>Driver:</strong> ${N.driverName||"N/A"}</p>
              <p><strong>Route:</strong> ${N.routeName||"N/A"}</p>
              <p><strong>Speed:</strong> ${x?`${x} km/h`:"N/A"}</p>
              <p><strong>Last Update:</strong> ${new Date(e.timestamp).toLocaleTimeString()}</p>
            </div>
          </div>
        </div>
      `);else{const j=document.createElement("div");j.className="bus-marker",j.innerHTML=`
        <div class="bus-marker-pin">
          <div class="bus-marker-icon">🚌</div>
          <div class="bus-marker-pulse"></div>
        </div>
        <div class="bus-marker-content">
          <div class="bus-number">${N.busNumber}</div>
          <div class="bus-speed">${x?`${x} km/h`:"N/A"}</div>
          <div class="bus-eta">${e.eta?`ETA: ${e.eta.estimated_arrival_minutes} min`:"ETA: N/A"}</div>
        </div>
      `;const h=new P.Marker({element:j,anchor:"center"}).setLngLat([g,i]).addTo(n.current),D=new P.Popup({offset:25,className:"bus-popup-container"}).setHTML(`
        <div class="bus-popup">
          <div class="bus-popup-header">
            <h3>🚌 Bus ${N.busNumber}</h3>
            <div class="bus-status ${c?"online":"offline"}">
              ${c?"🟢 Online":"🔴 Offline"}
            </div>
          </div>
          <div class="bus-popup-content">
            <div class="bus-info">
              <p><strong>Driver:</strong> ${N.driverName||"N/A"}</p>
              <p><strong>Route:</strong> ${N.routeName||"N/A"}</p>
              <p><strong>Speed:</strong> ${x?`${x} km/h`:"N/A"}</p>
              <p><strong>Last Update:</strong> ${new Date(e.timestamp).toLocaleTimeString()}</p>
            </div>
          </div>
        </div>
      `);h.setPopup(D),a.current[s]=h}},[c]),W=r.useCallback(e=>{a.current[e]&&(a.current[e].remove(),delete a.current[e])},[]),se=r.useCallback(()=>{if(!n.current||Object.keys(M).length===0)return;const e=Object.values(M).map(s=>[s.longitude,s.latitude]);if(e.length===1)n.current.flyTo({center:e[0],zoom:16,duration:2e3});else if(e.length>1){const s=new P.LngLatBounds;e.forEach(i=>s.extend(i)),n.current.fitBounds(s,{padding:50,duration:2e3})}},[M]),U=r.useCallback(e=>{console.log("📍 Bus location update:",e),ee(s=>({...s,[e.busId]:e})),F(e)},[F]),H=r.useCallback(e=>{console.log("🚌 Driver connected:",e)},[]),q=r.useCallback(e=>{console.log("🚌 Driver disconnected:",e),W(e.busId)},[W]),G=r.useCallback(e=>{console.log("🚌 Bus arriving:",e)},[]);r.useEffect(()=>{if(!(l.current||!o.current))return console.log("🗺️ Initializing map..."),l.current=!0,n.current=new P.Map({container:o.current,style:{version:8,sources:{osm:{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png","https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png","https://c.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"© OpenStreetMap contributors",maxzoom:19}},layers:[{id:"osm-tiles",type:"raster",source:"osm",minzoom:0,maxzoom:19}]},center:[72.571,23.025],zoom:12,bearing:0,pitch:0,attributionControl:!0,maxZoom:19,minZoom:1,preserveDrawingBuffer:!1,antialias:!0,dragRotate:!1}),n.current.addControl(new P.NavigationControl,"top-right"),n.current.once("load",()=>{console.log("🗺️ Map loaded successfully"),Y(!1),O()}),n.current.on("error",e=>{console.error("❌ Map error:",e)}),()=>{n.current&&(n.current.remove(),n.current=null,l.current=!1,u.current.clear(),a.current={})}},[O]),r.useEffect(()=>{let e,s,i=0;const g=async()=>{var x;try{b(null),v("connecting"),f.setClientType("student"),f.resetState(),await f.connect(),m(!0),v("connected"),f.onBusLocationUpdate(U),f.onDriverConnected(H),f.onDriverDisconnected(q),(x=f.socket)==null||x.emit("student:connect"),f.setClientType("student"),f.onStudentConnected(()=>{console.log("✅ Student connected to WebSocket")}),f.onBusArriving(G),s=setInterval(()=>{!f.getConnectionStatus()&&E==="connected"&&(v("disconnected"),m(!1))},1e4),(async()=>{try{for(;!le.isInitialized();)await new Promise(D=>setTimeout(D,100));const h=await L.getAllBuses();if(h.success&&h.data){console.log("📊 Initial bus data from API:",h.data.length,"buses"),h.data.forEach(T=>{const Z=T.bus_id||T.id;Z&&_.syncBusFromAPI(Z,T)});const D=_.getAllBuses();k(D),console.log("✅ Initial buses loaded and synced:",h.data.length)}}catch(h){console.error("❌ Error loading initial buses:",h)}})()}catch(N){console.error("❌ WebSocket connection failed:",N),b("Failed to connect to real-time updates"),m(!1),v("disconnected");const j=Math.min(5e3*Math.pow(2,Math.min(i,3)),3e4);console.log(`🔄 Retrying WebSocket connection in ${j}ms...`),i++,e=setTimeout(()=>{console.log("🔄 Retrying WebSocket connection..."),v("reconnecting"),g()},j)}};return g(),()=>{e&&clearTimeout(e),s&&clearInterval(s),f.softDisconnect()}},[G,U,H,q]);const y=r.useMemo(()=>w==="all"?S:S.filter(e=>{const s=d.find(i=>i.name===e.routeName);return s&&s.id===w}),[S,w,d]),re=r.useMemo(()=>d.map(e=>({id:e.id,name:e.name,description:e.description})),[d]);return r.useEffect(()=>(d.length>0&&n.current&&n.current.isStyleLoaded()&&(A(),z()),()=>{n.current&&A()}),[d,z,A]),t.jsxDEV("div",{className:`relative h-screen ${C}`,children:[X&&t.jsxDEV("div",{className:"loading-overlay",children:t.jsxDEV("div",{className:"text-center",children:[t.jsxDEV("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:538,columnNumber:13},void 0),t.jsxDEV("p",{className:"mt-4 text-gray-600",children:"Loading map..."},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:539,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:537,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:536,columnNumber:9},void 0),p&&t.jsxDEV("div",{className:"error-overlay",children:t.jsxDEV("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:t.jsxDEV("div",{className:"flex",children:[t.jsxDEV("div",{className:"flex-shrink-0",children:t.jsxDEV("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:t.jsxDEV("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:555,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:550,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:549,columnNumber:15},void 0),t.jsxDEV("div",{className:"ml-3",children:[t.jsxDEV("h3",{className:"text-sm font-medium text-red-800",children:"Connection Error"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:563,columnNumber:17},void 0),t.jsxDEV("p",{className:"text-sm text-red-700 mt-1",children:p},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:566,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:562,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:548,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:547,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:546,columnNumber:9},void 0),t.jsxDEV("div",{ref:o,className:"map-container rounded-lg"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:574,columnNumber:7},void 0),t.jsxDEV(V.div,{initial:{x:-400},animate:{x:B?-350:0},transition:{duration:.3,ease:"easeInOut"},className:"absolute top-4 left-4 z-30",children:[t.jsxDEV("button",{onClick:()=>ne(!B),className:"absolute -right-12 top-0 p-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg hover:bg-white/20 transition-all duration-200 z-40",children:t.jsxDEV("svg",{className:`w-5 h-5 text-white transition-transform duration-200 ${B?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:596,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:588,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:584,columnNumber:9},void 0),t.jsxDEV(ce,{variant:"premium",glow:!0,className:"w-80 max-h-[calc(100vh-2rem)] overflow-hidden",children:[t.jsxDEV("div",{className:"flex items-center justify-between p-4 border-b border-white/20",children:[t.jsxDEV("div",{className:"flex items-center space-x-3",children:[t.jsxDEV("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:612,columnNumber:15},void 0),t.jsxDEV("h2",{className:"text-lg font-bold text-gray-900",children:"Student Live Tracking"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:613,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:611,columnNumber:13},void 0),t.jsxDEV("div",{className:"text-xs text-gray-600 bg-white/50 px-2 py-1 rounded",children:"Live Map"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:617,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:610,columnNumber:11},void 0),t.jsxDEV("div",{className:"p-4 space-y-4 max-h-[calc(100vh-8rem)] overflow-y-auto",children:[t.jsxDEV("div",{className:"flex items-center justify-between p-3 bg-blue-50/80 rounded-lg border border-blue-200/50",children:[t.jsxDEV("div",{className:"flex items-center space-x-2",children:[t.jsxDEV("div",{className:`w-2 h-2 rounded-full ${c?"bg-green-500 animate-pulse":"bg-red-500"}`},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:627,columnNumber:17},void 0),t.jsxDEV("span",{className:"text-sm text-gray-800 font-medium",children:c?"Live Connected":"Offline"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:632,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:626,columnNumber:15},void 0),t.jsxDEV("span",{className:"text-xs text-gray-600 bg-white/70 px-2 py-1 rounded",children:[y.length," buses"]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:636,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:625,columnNumber:13},void 0),t.jsxDEV("div",{className:"space-y-3",children:[t.jsxDEV("div",{className:"flex items-center justify-between",children:[t.jsxDEV("h3",{className:"text-sm font-semibold text-gray-800",children:"Route Filter"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:644,columnNumber:17},void 0),t.jsxDEV("button",{onClick:()=>te(!R),className:"p-1 hover:bg-gray-100 rounded transition-colors duration-200",children:t.jsxDEV("svg",{className:`w-4 h-4 text-gray-600 transition-transform duration-200 ${R?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:659,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:651,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:647,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:643,columnNumber:15},void 0),t.jsxDEV(J,{children:R&&t.jsxDEV(V.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"space-y-3",children:[t.jsxDEV("select",{value:w,onChange:e=>Q(e.target.value),className:"w-full px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-all duration-200",children:[t.jsxDEV("option",{value:"all",children:["All Routes (",d.length,")"]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:683,columnNumber:23},void 0),re.map(e=>t.jsxDEV("option",{value:e.id,children:e.name},e.id,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:685,columnNumber:25},void 0))]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:678,columnNumber:21},void 0),t.jsxDEV("button",{onClick:se,disabled:y.length===0,className:"w-full px-3 py-2 bg-blue-600 hover:bg-blue-700 border border-blue-600 rounded-lg text-white font-medium transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:["📍 Center on Buses (",y.length,")"]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:691,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:671,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:669,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:642,columnNumber:13},void 0),t.jsxDEV("div",{className:"space-y-3",children:[t.jsxDEV("div",{className:"flex items-center justify-between",children:[t.jsxDEV("h3",{className:"text-sm font-semibold text-gray-800",children:"Active Buses"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:706,columnNumber:17},void 0),t.jsxDEV("button",{onClick:()=>oe(!$),className:"p-1 hover:bg-gray-100 rounded transition-colors duration-200",children:t.jsxDEV("svg",{className:`w-4 h-4 text-gray-600 transition-transform duration-200 ${$?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsxDEV("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:721,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:713,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:709,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:705,columnNumber:15},void 0),t.jsxDEV(J,{children:$&&t.jsxDEV(V.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"space-y-2 max-h-64 overflow-y-auto",children:y.length===0?t.jsxDEV("div",{className:"text-center py-4",children:[t.jsxDEV("div",{className:"text-gray-400 text-2xl mb-2",children:"🚌"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:742,columnNumber:25},void 0),t.jsxDEV("p",{className:"text-gray-600 text-sm",children:"No buses tracking"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:743,columnNumber:25},void 0),t.jsxDEV("p",{className:"text-gray-500 text-xs mt-1",children:"Check connection status"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:746,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:741,columnNumber:23},void 0):y.map(e=>{const s=M[e.busId];return t.jsxDEV(V.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 cursor-pointer transition-all duration-200 shadow-sm",onClick:()=>{const i=M[e.busId];if(i&&n.current){n.current.flyTo({center:[i.longitude,i.latitude],zoom:16,duration:1e3});const g=a.current[e.busId];g&&g.getPopup().addTo(n.current)}},children:[t.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[t.jsxDEV("div",{className:"flex items-center space-x-2",children:[t.jsxDEV("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:780,columnNumber:33},void 0),t.jsxDEV("span",{className:"font-medium text-sm text-gray-800",children:e.busNumber},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:781,columnNumber:33},void 0),t.jsxDEV("span",{className:"text-xs text-blue-600 opacity-75",children:"👆"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:784,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:779,columnNumber:31},void 0),t.jsxDEV("div",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:e.eta?`${e.eta} min`:"ETA: --"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:788,columnNumber:31},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:778,columnNumber:29},void 0),t.jsxDEV("div",{className:"space-y-1",children:[t.jsxDEV("div",{className:"text-xs text-gray-600",children:["📍 Route: ",e.routeName]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:795,columnNumber:31},void 0),t.jsxDEV("div",{className:"text-xs text-gray-600",children:["👨‍💼 Driver: ",e.driverName]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:798,columnNumber:31},void 0),s&&t.jsxDEV("div",{className:"flex items-center justify-between text-xs",children:[t.jsxDEV("span",{className:"text-green-600",children:["🕐"," ",new Date(s.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:803,columnNumber:35},void 0),t.jsxDEV("span",{className:"text-blue-600",children:s.speed?`${s.speed} km/h`:"Speed: --"},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:812,columnNumber:35},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:802,columnNumber:33},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:794,columnNumber:29},void 0)]},e.busId,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:754,columnNumber:27},void 0)})},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:733,columnNumber:19},void 0)},void 0,!1,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:731,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:704,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:623,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:604,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:577,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/College Project/frontend/src/components/EnhancedStudentMap.tsx",lineNumber:533,columnNumber:5},void 0)};export{xe as default};
//# sourceMappingURL=EnhancedStudentMap-Dhu-IsN7.js.map
