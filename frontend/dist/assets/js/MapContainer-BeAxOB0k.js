import{j as b}from"./index-B1j8FRVx.js";import{r as s}from"./vendor-react-CyT1AhbS.js";import{m as h}from"./vendor-maps-C78ko_py.js";import"./vendor-ui-D_U17TOn.js";import"./vendor-router-BXLLWNa2.js";import"./vendor-state-B-5mdhwp.js";import"./vendor-websocket-TjCxX7sJ.js";import"./vendor-animations-jk_Di6sJ.js";const N=({onMapLoad:a,onMapError:c,onViewportChange:o,center:u=[72.8777,23.0225],zoom:m=12,enableClustering:f=!0,enableHeatmap:p=!1})=>{const i=s.useRef(null),e=s.useRef(null),l=s.useRef(null),d=s.useCallback(()=>{if(!(!i.current||e.current))try{e.current=new h.Map({container:i.current,style:{version:8,sources:{osm:{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"© OpenStreetMap contributors",maxzoom:18,bounds:[-180,-85.051129,180,85.051129],scheme:"xyz"}},layers:[{id:"osm-tiles",type:"raster",source:"osm",minzoom:0,maxzoom:18,paint:{"raster-opacity":1,"raster-fade-duration":300}}]},center:u,zoom:m,attributionControl:!0,preserveDrawingBuffer:!1,antialias:!1,failIfMajorPerformanceCaveat:!1,maxZoom:18,minZoom:0,maxBounds:[[72,22],[74,24]],pitchWithRotate:!1,dragRotate:!1}),e.current.on("load",()=>{console.log("🗺️ Map loaded successfully"),a(e.current)}),e.current.on("error",t=>{console.error("❌ Map error:",t),c(t)});const r=()=>{!e.current||!o||(l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{const t=e.current.getBounds(),x=e.current.getZoom(),g=e.current.getCenter();o({bounds:[[t.getWest(),t.getSouth()],[t.getEast(),t.getNorth()]],zoom:x,center:[g.lng,g.lat]})},100))};e.current.on("moveend",r),e.current.on("zoomend",r),e.current.on("resize",r);let n=!1;e.current.on("webglcontextlost",()=>{console.warn("⚠️ WebGL context lost, attempting to restore..."),!n&&(n=!0,setTimeout(()=>{if(e.current)try{e.current.resize(),e.current.triggerRepaint(),n=!1,console.log("✅ WebGL context restored successfully")}catch(t){console.error("❌ Failed to restore WebGL context:",t),c(new Error("Map rendering failed, please refresh the page"))}},2e3))}),e.current.on("webglcontextrestored",()=>{console.log("✅ WebGL context restored"),e.current&&(n=!1,e.current.triggerRepaint())}),e.current.on("error",t=>{console.error("❌ Map error:",t),t.type!=="TileLoadError"&&c(t)}),e.current.on("idle",()=>{console.log("🗺️ Map is idle - all tiles loaded")}),f&&console.log("🗺️ Clustering enabled"),p&&console.log("🗺️ Heatmap enabled")}catch(r){console.error("❌ Error initializing map:",r),c(r)}},[u,m,a,c,o,f,p]);return s.useEffect(()=>{if(e.current){console.log("🗺️ Map already initialized, skipping...");return}return d(),()=>{l.current&&clearTimeout(l.current),e.current&&(console.log("🗺️ Cleaning up map..."),e.current.remove(),e.current=null)}},[]),s.useEffect(()=>{if(e.current&&o){const r=e.current.getBounds(),n=e.current.getZoom(),t=e.current.getCenter();o({bounds:[[r.getWest(),r.getSouth()],[r.getEast(),r.getNorth()]],zoom:n,center:[t.lng,t.lat]})}},[e.current,o]),b.jsxDEV("div",{ref:i,className:"map-container",style:{height:"100vh",width:"100%"}},void 0,!1,{fileName:"C:/College Project/frontend/src/components/map/MapContainer.tsx",lineNumber:228,columnNumber:5},void 0)};export{N as default};
//# sourceMappingURL=MapContainer-BeAxOB0k.js.map
