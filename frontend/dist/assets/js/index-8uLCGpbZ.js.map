{"version":3,"mappings":"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","names":["React","require$$0","REACT_ELEMENT_TYPE","REACT_PORTAL_TYPE","REACT_FRAGMENT_TYPE","REACT_STRICT_MODE_TYPE","REACT_PROFILER_TYPE","REACT_PROVIDER_TYPE","REACT_CONTEXT_TYPE","REACT_FORWARD_REF_TYPE","REACT_SUSPENSE_TYPE","REACT_SUSPENSE_LIST_TYPE","REACT_MEMO_TYPE","REACT_LAZY_TYPE","REACT_OFFSCREEN_TYPE","MAYBE_ITERATOR_SYMBOL","FAUX_ITERATOR_SYMBOL","getIteratorFn","maybeIterable","maybeIterator","ReactSharedInternals","error","format","_len2","args","_key2","printWarning","level","ReactDebugCurrentFrame","stack","argsWithFormat","item","enableScopeAPI","enableCacheElement","enableTransitionTracing","enableLegacyHidden","enableDebugTracing","REACT_MODULE_REFERENCE","isValidElementType","type","getWrappedName","outerType","innerType","wrapperName","displayName","functionName","getContextName","getComponentNameFromType","context","provider","outerName","lazyComponent","payload","init","assign","disabledDepth","prevLog","prevInfo","prevWarn","prevError","prevGroup","prevGroupCollapsed","prevGroupEnd","disabledLog","disableLogs","props","reenableLogs","ReactCurrentDispatcher","prefix","describeBuiltInComponentFrame","name","source","ownerFn","x","match","reentry","componentFrameCache","PossiblyWeakMap","describeNativeComponentFrame","fn","construct","frame","control","previousPrepareStackTrace","previousDispatcher","Fake","sample","sampleLines","controlLines","s","c","_frame","syntheticFrame","describeFunctionComponentFrame","shouldConstruct","Component","prototype","describeUnknownElementTypeFrameInDEV","hasOwnProperty","loggedTypeFailures","setCurrentlyValidatingElement","element","owner","checkPropTypes","typeSpecs","values","location","componentName","has","typeSpecName","error$1","err","ex","isArrayImpl","isArray","a","typeName","value","hasToStringTag","willCoercionThrow","testStringCoercion","checkKeyStringCoercion","ReactCurrentOwner","RESERVED_PROPS","specialPropKeyWarningShown","specialPropRefWarningShown","didWarnAboutStringRefs","hasValidRef","config","getter","hasValidKey","warnIfStringRefCannotBeAutoConverted","self","defineKeyPropWarningGetter","warnAboutAccessingKey","defineRefPropWarningGetter","warnAboutAccessingRef","ReactElement","key","ref","jsxDEV","maybeKey","propName","defaultProps","ReactCurrentOwner$1","ReactDebugCurrentFrame$1","setCurrentlyValidatingElement$1","propTypesMisspellWarningShown","isValidElement","object","getDeclarationErrorAddendum","getSourceInfoErrorAddendum","fileName","lineNumber","ownerHasKeyUseWarning","getCurrentComponentErrorInfo","parentType","info","parentName","validateExplicitKey","currentComponentErrorInfo","childOwner","validateChildKeys","node","i","child","iteratorFn","iterator","step","validatePropTypes","propTypes","_name","validateFragmentProps","fragment","keys","didWarnAboutKeySpread","jsxWithValidation","isStaticChildren","validType","sourceInfo","typeString","children","k","beforeExample","afterExample","jsxDEV$1","reactJsxDevRuntime_development","jsxDevRuntimeModule","m","o","client","h","trackedConnections","getTrackedConnectionState","api","api2","extractConnectionInformation","store","extensionConnector","options","existingConnection","newConnection","removeStoreFromTrackedConnections","connectionInfo","findCallerName","_a","_b","traceLines","apiSetStateLineIndex","traceLine","callerLine","devtoolsImpl","devtoolsOptions","set","get","enabled","anonymousActionType","__vite_import_meta_env__","connection","connectionInformation","isRecording","state","replace","nameOrAction","r","action","setStateFromDevtools","originalIsRecording","initialState","store2","didWarnAboutReservedActionType","originalDispatch","message","parseJsonThen","stateFromDevtools","nextLiftedState","lastComputedState","devtools","stringified","parsed","e","useAuthStore","create","prev","user","loading","getApiUrl","getWebSocketUrl","environment","validateSupabaseConfig","url","anonKey","createSupabaseClient","createClient","fallbackClient","supabase","AuthService","__publicField","session","subscription","event","userId","authRoles","currentPath","role","_d","_c","profile","_e","isAdmin","_i","_h","_j","_k","_l","_m","_f","_g","email","password","authPromise","timeoutPromise","_","reject","data","profilePromise","profileTimeout","profileError","token","possibleKeys","storedSession","parsedSession","refreshed","refreshResult","validatedUser","validationError","updates","listener","keysToRemove","usedKey","stored","parseError","accessToken","driverId","busData","busError","routeName","routeData","routeError","driverName","profileData","userData","userError","assignment","expiresAt","now","refreshedSession","refreshError","authService","CircuitBreaker","operation","fallback","result","errorMessage","pattern","metrics","CircuitBreakerRegistry","breaker","circuitBreakerRegistry","apiCircuitBreaker","ExponentialBackoff","onRetry","delay","baseDelay","jitterRange","jitter","ms","resolve","standardBackoff","OfflineStorage","request","db","dataStore","queueStore","id","offlineData","freshData","endpoint","queueItem","retryCount","getRequest","putRequest","queueItems","response","newRetryCount","transaction","dataRequest","queueRequest","dataItems","dataByType","offlineStorage","ErrorHandler","severity","networkInfo","conn","errorReport","_context","suggestions","retryable","color","retryableText","suggestion","byService","bySeverity","errorHandler","logError","ResilientApiService","baseUrl","method","headers","timeout","useOfflineStorage","retryOnFailure","requestId","cachedData","fallbackData","controller","timeoutId","dataType","resilientApiService","API_BASE_URL","ApiService","body","busId","routeId","bounds","minLng","minLat","maxLng","maxLat","zoom","apiService","queryKeys","useHealthCheck","useQuery","WebSocketService","wsUrl","io","attemptNumber","reason","isConnected","timeSinceLastHeartbeat","callbacks","locationData","callback","stats","clientType","websocketService","DriverInterface","isAuthenticated","setIsAuthenticated","useState","isTracking","setIsTracking","busInfo","setBusInfo","currentLocation","setCurrentLocation","locationError","setLocationError","socketError","setSocketError","lastUpdateTime","setLastUpdateTime","updateCount","setUpdateCount","loginForm","setLoginForm","loginError","setLoginError","isLoading","setIsLoading","socketRef","useRef","locationIntervalRef","watchIdRef","mapRef","mapContainerRef","markerRef","useEffect","authenticateWithSocket","disconnectSocket","cleanupMap","permission","initializeMap","latitude","longitude","maplibregl","markerElement","popup","updateMapLocation","newLocation","handleLogin","startLocationTracking","isMobile","isFirefox","isChrome","isSafari","position","sendLocationUpdate","stopLocationTracking","handleSignOut","this","Fragment","successMsg","errorMsg","TransitionContext","createContext","useTransition","useContext","TransitionProvider","currentTransition","setCurrentTransition","pathname","useLocation","setTransition","transition","HomepageToLoginTransition","isVisible","motion","HomepageToMapTransition","LoginToDashboardTransition","GlobalTransitionWrapper","renderTransition","DriverLogin","navigate","useNavigate","setIsMobile","checkMobile","connectionAttempts","maxAttempts","handleAuthenticationSuccess","handleAuthenticationFailed","authTimeout","AnimatePresence","DriverDashboard","connectionStatus","setConnectionStatus","initializationRef","fallbackTimerRef","eventListenersRef","updateConnectionStatus","statusInterval","existingAssignment","isValid","currentAssignment","fallbackAttempt","maxFallbackAttempts","fallbackInterval","fetchBusInfoFromAPI","success","handleContextLost","handleContextRestored","currentLngLat","handleMapError","handleMapLoad","fallbackError","errorText","AdminApiService","driverData","adminApiService","StorageService","defaultHeaders","file","formData","errorData","fileUrl","folder","allowedTypes","maxSize","MediaManagement","activeTab","setActiveTab","buses","setBuses","drivers","setDrivers","routes","setRoutes","setLoading","uploading","setUploading","selectedFile","setSelectedFile","selectedItem","setSelectedItem","setError","setSuccess","loadData","busesResult","driversResult","routesResult","uniqueDriversMap","driver","idKey","existing","uniqueDrivers","handleFileSelect","handleUpload","handleDelete","itemId","getCurrentItems","getDisplayName","getFileUrl","getTabTitle","tab","GANPAT_UNIVERSITY","MapSelector","onLocationSelect","onClose","title","defaultCenter","searchPlaceholder","instanceId","mapContainer","map","marker","searchQuery","setSearchQuery","selectedLocation","setSelectedLocation","isMapLoading","setIsMapLoading","mapError","setMapError","coordinates","reverseGeocode","searchLocation","firstResult","handleConfirm","handleKeyPress","container","StreamlinedManagement","successMessage","setSuccessMessage","assignedDrivers","setAssignedDrivers","showBusForm","setShowBusForm","showDriverForm","setShowDriverForm","showCreateDriverForm","setShowCreateDriverForm","showRouteForm","setShowRouteForm","showBusDetails","setShowBusDetails","showRouteDetails","setShowRouteDetails","selectedBus","setSelectedBus","selectedRoute","setSelectedRoute","editingBus","setEditingBus","editingRoute","setEditingRoute","busForm","setBusForm","driverForm","setDriverForm","createDriverForm","setCreateDriverForm","showPassword","setShowPassword","showConfirmPassword","setShowConfirmPassword","selectedSupabaseDriver","setSelectedSupabaseDriver","routeForm","setRouteForm","showMapSelector","setShowMapSelector","mapSelectorType","setMapSelectorType","selectedDestination","setSelectedDestination","selectedOrigin","setSelectedOrigin","loadAllData","useCallback","loadAssignedDrivers","uniqueAssignedDriversMap","uniqueAssignedDrivers","handleCreateBus","bus","handleDeleteBus","handleAssignRouteToBus","handleCreateDriver","handleAssignBusToDriver","handleUnassignDriver","handleDeleteDriver","firstName","lastName","confirmMessage","assigned","handleCreateRoute","handleDeleteRoute","route","getRouteName","city","destination","handleMapSelectorOpen","handleLocationSelect","getDriverName","d","getDriverNameFromBus","getBusPlate","b","handleViewBusDetails","handleEditBus","handleViewRouteDetails","handleEditRoute","handleUpdateBus","handleUpdateRoute","assignedDriver","AdminDashboard","analytics","setAnalytics","systemHealth","setSystemHealth","loadDashboardData","analyticsResult","healthResult","currentUser","GlassyCard","className","variant","hover","glow","onClick","baseClasses","variantClasses","hoverClasses","glowClasses","clickableClasses","PremiumButton","size","disabled","icon","iconPosition","sizeClasses","AdminLogin","onLoginSuccess","setEmail","setPassword","twoFactorCode","setTwoFactorCode","handleLoginSuccess","handleSubmit","loginPromise","handleRecoverSession","handleForceFreshLogin","StaggerContainer","StaggerItem","BusIcon","MapIcon","AdminIcon","PremiumHomepage","handleNavigation","path","particleCount","ErrorBoundary","errorInfo","errorId","prevProps","showDetails","NetworkStatus","showOfflineMessage","onNetworkChange","setNetworkInfo","showBanner","setShowBanner","lastOnlineTime","setLastOnlineTime","updateNetworkInfo","isOnline","newNetworkInfo","timer","offlineDuration","EnhancedStudentMap","__vitePreload","App","authLoading","authError","setUser","health","healthLoading","healthError","updateAuthState","LegacyHomePage","Link","Router","Routes","Route","Suspense","setupConsoleFilter","originalWarn","originalFetch","input","sharedConfig","getContextId","count","num","len","setHydrateContext","IS_DEV","equalFn","$PROXY","SUPPORTS_PROXY","$TRACK","signalOptions","runEffects","runQueue","STALE","PENDING","UNOWNED","NO_INIT","Owner","Transition","ExternalSourceConfig","Listener","Updates","Effects","ExecCount","createRoot","detachedOwner","unowned","current","root","updateFn","untrack","cleanNode","runUpdates","createSignal","setter","value2","writeSignal","readSignal","createComputed","createComputation","updateComputation","createRenderEffect","createEffect","runUserEffects","createMemo","isPromise","v","createResource","pSource","pFetcher","pOptions","fetcher","pr","initP","scheduled","resolved","dynamic","contexts","setValue","track","trigger","setState","loadEnd","p","error2","completeLoad","read","SuspenseContext","load","refetching","lookup","fetcherError","castError","runWithOwner","batch","on","deps","isArray3","prevInput","defer","prevValue","onMount","onCleanup","getOwner","prevListener","handleError","startTransition","l","t","transPending","setTransPending","defaultValue","createProvider","children2","memo2","resolveChildren","lookUpstream","sSlot","isComp","TransitionRunning","markDownstream","time","runComputation","nextValue","pure","runTop","ancestors","wait","res","completeUpdates","queue","userLength","ignore","index","obs","n","results","FALLBACK","dispose","mapArray","list","mapFn","items","mapped","disposers","indexes","newItems","newLen","j","newIndices","newIndicesNext","temp","tempdisposers","tempIndexes","start","end","newEnd","disposer","mapper","indexArray","signals","createComponent","Comp","trueFn","propTraps","property","receiver","resolveSource","resolveSources","length","mergeProps","sources","proxy","sourcesMap","defined","sourceKeys","i2","desc","sources2","target","definedKeys","splitProps","blocked","otherObject","objects","isDefaultDesc","objectIndex","lazy","comp","wrap","ctx","mod","counter","createUniqueId","narrowedError","For","Index","Show","keyed","conditionValue","condition","Switch","chs","switchFunc","ch","mps","func","mp","prevFunc","sel","Match","booleans","Properties","ChildProperties","Aliases","PropAliases","getPropAlias","prop","tagName","DelegatedEvents","SVGElements","SVGNamespace","memo","reconcileArrays","parentNode","bLength","aEnd","bEnd","aStart","bStart","after","sequence","$$EVENTS","render","code","dispose2","insert","template","html","isImportNode","isSVG","isMathML","delegateEvents","eventNames","document2","eventHandler","clearDelegatedEvents","setAttribute","isHydrating","setAttributeNS","namespace","setBoolAttribute","addEventListener","handler","delegate","handlerFn","classList","classKeys","prevKeys","toggleClassKey","classValue","style","nodeStyle","spread","skipChildren","insertExpression","use","arg","parent","accessor","initial","skipRef","assignProp","getNextElement","template2","getHydrationKey","toPropertyName","w","classNames","nameLen","isCE","isProp","isChildProp","propAlias","forceProp","ns","el","ev","oriTarget","oriCurrentTarget","retarget","handleNode","walkUpTree","unwrapArray","hydrating","cleaned","multi","cleanChildren","array","currentArray","normalizeIncomingArray","nodes","appendNodes","normalized","unwrap","replacement","inserted","isParent","SVG_NAMESPACE","createElement","Portal","useShadow","mount","content","clean","setClean","cleanup","renderRoot","createDynamic","component","cached","component2","isSvg","Dynamic","others","DoubleIndexedKV","Registry","generateIdentifier","identifier","ClassRegistry","valuesOfObj","record","find","predicate","valuesNotNever","forEach","run","includes","arr","findArr","CustomTransformerRegistry","transformer","getType","isUndefined","isNull","isPlainObject","isEmptyObject","isString","isNumber","isBoolean","isRegExp","isMap","isSet","isSymbol","isDate","isError","isNaNValue","isPrimitive","isBigint","isInfinite","isTypedArray","isURL","escapeKey","stringifyPath","parsePath","string","segment","char","lastSegment","simpleTransformation","isApplicable","annotation","transform","untransform","simpleRules","superJson","baseError","regex","flags","compositeTransformation","symbolRule","constructorToName","obj","ctor","typedArrayRule","isInstanceOfRegisteredClass","potentialClass","classRule","clazz","allowedProps","customRule","compositeRules","transformValue","applicableCompositeRule","rule","applicableSimpleRule","simpleRulesByAnnotation","untransformValue","json","transformation","getNthKey","validatePath","getDeep","row","keyOfRow","setDeep","lastKey","oldValue","newValue","keyToRow","newKey","traverse","tree","walker2","origin","subtree","nodeValue","applyValueAnnotations","plain","annotations","applyReferentialEqualityAnnotations","apply","identicalPaths","identicalObjectPath","other","identicalPath","isDeep","addIdentity","identities","existingSet","generateReferentialEqualityAnnotations","identitites","dedupe","rootEqualityPaths","paths","representativePath","walker","objectsInThisPath","seenObjects","primitive","seen","transformed2","result2","transformationResult","transformed","transformedValue","innerAnnotations","recursiveResult","getType2","isArray2","isPlainObject2","assignProp2","carry","newVal","originalObject","includeNonenumerable","propType","copy","symbols","val","SuperJSON","output","equalityAnnotations","meta","serialize","stringify","getQueryStatusLabel","query","getSidedProp","side","getQueryStatusColor","queryState","observerCount","isStale","getMutationStatusColor","status","isPaused","getQueryStatusColorByLabel","label","displayValue","beautify","getStatusRank","q","queryHashSort","dateSort","statusAndDateSort","sortFns","getMutationStatusRank","mutationDateSort","mutationStatusSort","mutationSortFns","convertRemToPixels","rem","getPreferredColorScheme","colorScheme","setColorScheme","updateNestedDataByPath","oldData","updatePath","newData","head","tail","setAsArray","deleteNestedDataByPath","deletePath","idx","setupStyleSheet","nonce","styleTag","textNode","TanstackQueryDevtools","__privateAdd","_client","_onlineManager","_queryFlavor","_version","_isMounted","_styleNonce","_shadowDOMTarget","_buttonPosition","_position","_initialIsOpen","_errorTypes","_hideDisabledQueries","_Component","_dispose","queryFlavor","version","onlineManager","buttonPosition","initialIsOpen","errorTypes","styleNonce","shadowDOMTarget","hideDisabledQueries","__privateSet","__privateGet","isOpen","_self$","btnPosition","pos","errors","queryClient","Devtools","ReactQueryDevtools","useQueryClient","React.useRef","React.useState","React.useEffect","jsx","ReactQueryDevtools2","Devtools.ReactQueryDevtools","QueryClient","failureCount","QueryProvider","QueryClientProvider","detectBrowserCompatibility","userAgent","isHTTPS","isLocalhost","browserName","unregisterAllServiceWorkers","registrations","registration","script","browserCompatibility","preconnectLink","fontLink","ReactDOM"],"ignoreList":[0,1,2,3,41,42,43,44],"sources":["../../../../node_modules/react/cjs/react-jsx-dev-runtime.development.js","../../../../node_modules/react/jsx-dev-runtime.js","../../../../node_modules/react-dom/client.js","../../../../node_modules/zustand/esm/middleware.mjs","../../../src/stores/useAuthStore.ts","../../../src/config/environment.ts","../../../src/config/supabase.ts","../../../src/services/authService.ts","../../../src/services/resilience/CircuitBreaker.ts","../../../src/services/resilience/ExponentialBackoff.ts","../../../src/services/offline/OfflineStorage.ts","../../../src/utils/errorHandler.ts","../../../src/services/resilience/ResilientApiService.ts","../../../src/services/api.ts","../../../src/hooks/useApiQueries.ts","../../../src/services/websocket.ts","../../../src/components/DriverInterface.tsx","../../../src/components/transitions/TransitionContext.tsx","../../../src/components/transitions/HomepageToLoginTransition.tsx","../../../src/components/transitions/HomepageToMapTransition.tsx","../../../src/components/transitions/LoginToDashboardTransition.tsx","../../../src/components/transitions/GlobalTransitionWrapper.tsx","../../../src/components/DriverLogin.tsx","../../../src/components/DriverDashboard.tsx","../../../src/services/adminApiService.ts","../../../src/services/storageService.ts","../../../src/components/MediaManagement.tsx","../../../src/utils/coordinates.ts","../../../src/components/MapSelector.tsx","../../../src/components/StreamlinedManagement.tsx","../../../src/components/AdminDashboard.tsx","../../../src/components/ui/GlassyCard.tsx","../../../src/components/ui/PremiumButton.tsx","../../../src/components/AdminLogin.tsx","../../../src/components/PageTransition.tsx","../../../src/components/PremiumHomepage.tsx","../../../src/components/error/ErrorBoundary.tsx","../../../src/components/error/NetworkStatus.tsx","../../../src/App.tsx","../../../src/utils/consoleFilter.ts","../../../src/utils/apiInterceptor.ts","../../../../node_modules/@tanstack/query-devtools/build/chunk/CXOMC62J.js","../../../../node_modules/@tanstack/query-devtools/build/dev.js","../../../../node_modules/@tanstack/react-query-devtools/build/modern/ReactQueryDevtools.js","../../../../node_modules/@tanstack/react-query-devtools/build/modern/index.js","../../../src/providers/QueryProvider.tsx","../../../src/utils/serviceWorkerUtils.ts","../../../src/main.tsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-dev-runtime.development.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nif (process.env.NODE_ENV !== \"production\") {\n  (function() {\n'use strict';\n\nvar React = require('react');\n\n// ATTENTION\n// When adding new symbols to this file,\n// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'\n// The Symbol used to tag the ReactElement-like types.\nvar REACT_ELEMENT_TYPE = Symbol.for('react.element');\nvar REACT_PORTAL_TYPE = Symbol.for('react.portal');\nvar REACT_FRAGMENT_TYPE = Symbol.for('react.fragment');\nvar REACT_STRICT_MODE_TYPE = Symbol.for('react.strict_mode');\nvar REACT_PROFILER_TYPE = Symbol.for('react.profiler');\nvar REACT_PROVIDER_TYPE = Symbol.for('react.provider');\nvar REACT_CONTEXT_TYPE = Symbol.for('react.context');\nvar REACT_FORWARD_REF_TYPE = Symbol.for('react.forward_ref');\nvar REACT_SUSPENSE_TYPE = Symbol.for('react.suspense');\nvar REACT_SUSPENSE_LIST_TYPE = Symbol.for('react.suspense_list');\nvar REACT_MEMO_TYPE = Symbol.for('react.memo');\nvar REACT_LAZY_TYPE = Symbol.for('react.lazy');\nvar REACT_OFFSCREEN_TYPE = Symbol.for('react.offscreen');\nvar MAYBE_ITERATOR_SYMBOL = Symbol.iterator;\nvar FAUX_ITERATOR_SYMBOL = '@@iterator';\nfunction getIteratorFn(maybeIterable) {\n  if (maybeIterable === null || typeof maybeIterable !== 'object') {\n    return null;\n  }\n\n  var maybeIterator = MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL] || maybeIterable[FAUX_ITERATOR_SYMBOL];\n\n  if (typeof maybeIterator === 'function') {\n    return maybeIterator;\n  }\n\n  return null;\n}\n\nvar ReactSharedInternals = React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\nfunction error(format) {\n  {\n    {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      printWarning('error', format, args);\n    }\n  }\n}\n\nfunction printWarning(level, format, args) {\n  // When changing this logic, you might want to also\n  // update consoleWithStackDev.www.js as well.\n  {\n    var ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\n    var stack = ReactDebugCurrentFrame.getStackAddendum();\n\n    if (stack !== '') {\n      format += '%s';\n      args = args.concat([stack]);\n    } // eslint-disable-next-line react-internal/safe-string-coercion\n\n\n    var argsWithFormat = args.map(function (item) {\n      return String(item);\n    }); // Careful: RN currently depends on this prefix\n\n    argsWithFormat.unshift('Warning: ' + format); // We intentionally don't use spread (or .apply) directly because it\n    // breaks IE9: https://github.com/facebook/react/issues/13610\n    // eslint-disable-next-line react-internal/no-production-logging\n\n    Function.prototype.apply.call(console[level], console, argsWithFormat);\n  }\n}\n\n// -----------------------------------------------------------------------------\n\nvar enableScopeAPI = false; // Experimental Create Event Handle API.\nvar enableCacheElement = false;\nvar enableTransitionTracing = false; // No known bugs, but needs performance testing\n\nvar enableLegacyHidden = false; // Enables unstable_avoidThisFallback feature in Fiber\n// stuff. Intended to enable React core members to more easily debug scheduling\n// issues in DEV builds.\n\nvar enableDebugTracing = false; // Track which Fiber(s) schedule render work.\n\nvar REACT_MODULE_REFERENCE;\n\n{\n  REACT_MODULE_REFERENCE = Symbol.for('react.module.reference');\n}\n\nfunction isValidElementType(type) {\n  if (typeof type === 'string' || typeof type === 'function') {\n    return true;\n  } // Note: typeof might be other than 'symbol' or 'number' (e.g. if it's a polyfill).\n\n\n  if (type === REACT_FRAGMENT_TYPE || type === REACT_PROFILER_TYPE || enableDebugTracing  || type === REACT_STRICT_MODE_TYPE || type === REACT_SUSPENSE_TYPE || type === REACT_SUSPENSE_LIST_TYPE || enableLegacyHidden  || type === REACT_OFFSCREEN_TYPE || enableScopeAPI  || enableCacheElement  || enableTransitionTracing ) {\n    return true;\n  }\n\n  if (typeof type === 'object' && type !== null) {\n    if (type.$$typeof === REACT_LAZY_TYPE || type.$$typeof === REACT_MEMO_TYPE || type.$$typeof === REACT_PROVIDER_TYPE || type.$$typeof === REACT_CONTEXT_TYPE || type.$$typeof === REACT_FORWARD_REF_TYPE || // This needs to include all possible module reference object\n    // types supported by any Flight configuration anywhere since\n    // we don't know which Flight build this will end up being used\n    // with.\n    type.$$typeof === REACT_MODULE_REFERENCE || type.getModuleId !== undefined) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction getWrappedName(outerType, innerType, wrapperName) {\n  var displayName = outerType.displayName;\n\n  if (displayName) {\n    return displayName;\n  }\n\n  var functionName = innerType.displayName || innerType.name || '';\n  return functionName !== '' ? wrapperName + \"(\" + functionName + \")\" : wrapperName;\n} // Keep in sync with react-reconciler/getComponentNameFromFiber\n\n\nfunction getContextName(type) {\n  return type.displayName || 'Context';\n} // Note that the reconciler package should generally prefer to use getComponentNameFromFiber() instead.\n\n\nfunction getComponentNameFromType(type) {\n  if (type == null) {\n    // Host root, text node or just invalid type.\n    return null;\n  }\n\n  {\n    if (typeof type.tag === 'number') {\n      error('Received an unexpected object in getComponentNameFromType(). ' + 'This is likely a bug in React. Please file an issue.');\n    }\n  }\n\n  if (typeof type === 'function') {\n    return type.displayName || type.name || null;\n  }\n\n  if (typeof type === 'string') {\n    return type;\n  }\n\n  switch (type) {\n    case REACT_FRAGMENT_TYPE:\n      return 'Fragment';\n\n    case REACT_PORTAL_TYPE:\n      return 'Portal';\n\n    case REACT_PROFILER_TYPE:\n      return 'Profiler';\n\n    case REACT_STRICT_MODE_TYPE:\n      return 'StrictMode';\n\n    case REACT_SUSPENSE_TYPE:\n      return 'Suspense';\n\n    case REACT_SUSPENSE_LIST_TYPE:\n      return 'SuspenseList';\n\n  }\n\n  if (typeof type === 'object') {\n    switch (type.$$typeof) {\n      case REACT_CONTEXT_TYPE:\n        var context = type;\n        return getContextName(context) + '.Consumer';\n\n      case REACT_PROVIDER_TYPE:\n        var provider = type;\n        return getContextName(provider._context) + '.Provider';\n\n      case REACT_FORWARD_REF_TYPE:\n        return getWrappedName(type, type.render, 'ForwardRef');\n\n      case REACT_MEMO_TYPE:\n        var outerName = type.displayName || null;\n\n        if (outerName !== null) {\n          return outerName;\n        }\n\n        return getComponentNameFromType(type.type) || 'Memo';\n\n      case REACT_LAZY_TYPE:\n        {\n          var lazyComponent = type;\n          var payload = lazyComponent._payload;\n          var init = lazyComponent._init;\n\n          try {\n            return getComponentNameFromType(init(payload));\n          } catch (x) {\n            return null;\n          }\n        }\n\n      // eslint-disable-next-line no-fallthrough\n    }\n  }\n\n  return null;\n}\n\nvar assign = Object.assign;\n\n// Helpers to patch console.logs to avoid logging during side-effect free\n// replaying on render function. This currently only patches the object\n// lazily which won't cover if the log function was extracted eagerly.\n// We could also eagerly patch the method.\nvar disabledDepth = 0;\nvar prevLog;\nvar prevInfo;\nvar prevWarn;\nvar prevError;\nvar prevGroup;\nvar prevGroupCollapsed;\nvar prevGroupEnd;\n\nfunction disabledLog() {}\n\ndisabledLog.__reactDisabledLog = true;\nfunction disableLogs() {\n  {\n    if (disabledDepth === 0) {\n      /* eslint-disable react-internal/no-production-logging */\n      prevLog = console.log;\n      prevInfo = console.info;\n      prevWarn = console.warn;\n      prevError = console.error;\n      prevGroup = console.group;\n      prevGroupCollapsed = console.groupCollapsed;\n      prevGroupEnd = console.groupEnd; // https://github.com/facebook/react/issues/19099\n\n      var props = {\n        configurable: true,\n        enumerable: true,\n        value: disabledLog,\n        writable: true\n      }; // $FlowFixMe Flow thinks console is immutable.\n\n      Object.defineProperties(console, {\n        info: props,\n        log: props,\n        warn: props,\n        error: props,\n        group: props,\n        groupCollapsed: props,\n        groupEnd: props\n      });\n      /* eslint-enable react-internal/no-production-logging */\n    }\n\n    disabledDepth++;\n  }\n}\nfunction reenableLogs() {\n  {\n    disabledDepth--;\n\n    if (disabledDepth === 0) {\n      /* eslint-disable react-internal/no-production-logging */\n      var props = {\n        configurable: true,\n        enumerable: true,\n        writable: true\n      }; // $FlowFixMe Flow thinks console is immutable.\n\n      Object.defineProperties(console, {\n        log: assign({}, props, {\n          value: prevLog\n        }),\n        info: assign({}, props, {\n          value: prevInfo\n        }),\n        warn: assign({}, props, {\n          value: prevWarn\n        }),\n        error: assign({}, props, {\n          value: prevError\n        }),\n        group: assign({}, props, {\n          value: prevGroup\n        }),\n        groupCollapsed: assign({}, props, {\n          value: prevGroupCollapsed\n        }),\n        groupEnd: assign({}, props, {\n          value: prevGroupEnd\n        })\n      });\n      /* eslint-enable react-internal/no-production-logging */\n    }\n\n    if (disabledDepth < 0) {\n      error('disabledDepth fell below zero. ' + 'This is a bug in React. Please file an issue.');\n    }\n  }\n}\n\nvar ReactCurrentDispatcher = ReactSharedInternals.ReactCurrentDispatcher;\nvar prefix;\nfunction describeBuiltInComponentFrame(name, source, ownerFn) {\n  {\n    if (prefix === undefined) {\n      // Extract the VM specific prefix used by each line.\n      try {\n        throw Error();\n      } catch (x) {\n        var match = x.stack.trim().match(/\\n( *(at )?)/);\n        prefix = match && match[1] || '';\n      }\n    } // We use the prefix to ensure our stacks line up with native stack frames.\n\n\n    return '\\n' + prefix + name;\n  }\n}\nvar reentry = false;\nvar componentFrameCache;\n\n{\n  var PossiblyWeakMap = typeof WeakMap === 'function' ? WeakMap : Map;\n  componentFrameCache = new PossiblyWeakMap();\n}\n\nfunction describeNativeComponentFrame(fn, construct) {\n  // If something asked for a stack inside a fake render, it should get ignored.\n  if ( !fn || reentry) {\n    return '';\n  }\n\n  {\n    var frame = componentFrameCache.get(fn);\n\n    if (frame !== undefined) {\n      return frame;\n    }\n  }\n\n  var control;\n  reentry = true;\n  var previousPrepareStackTrace = Error.prepareStackTrace; // $FlowFixMe It does accept undefined.\n\n  Error.prepareStackTrace = undefined;\n  var previousDispatcher;\n\n  {\n    previousDispatcher = ReactCurrentDispatcher.current; // Set the dispatcher in DEV because this might be call in the render function\n    // for warnings.\n\n    ReactCurrentDispatcher.current = null;\n    disableLogs();\n  }\n\n  try {\n    // This should throw.\n    if (construct) {\n      // Something should be setting the props in the constructor.\n      var Fake = function () {\n        throw Error();\n      }; // $FlowFixMe\n\n\n      Object.defineProperty(Fake.prototype, 'props', {\n        set: function () {\n          // We use a throwing setter instead of frozen or non-writable props\n          // because that won't throw in a non-strict mode function.\n          throw Error();\n        }\n      });\n\n      if (typeof Reflect === 'object' && Reflect.construct) {\n        // We construct a different control for this case to include any extra\n        // frames added by the construct call.\n        try {\n          Reflect.construct(Fake, []);\n        } catch (x) {\n          control = x;\n        }\n\n        Reflect.construct(fn, [], Fake);\n      } else {\n        try {\n          Fake.call();\n        } catch (x) {\n          control = x;\n        }\n\n        fn.call(Fake.prototype);\n      }\n    } else {\n      try {\n        throw Error();\n      } catch (x) {\n        control = x;\n      }\n\n      fn();\n    }\n  } catch (sample) {\n    // This is inlined manually because closure doesn't do it for us.\n    if (sample && control && typeof sample.stack === 'string') {\n      // This extracts the first frame from the sample that isn't also in the control.\n      // Skipping one frame that we assume is the frame that calls the two.\n      var sampleLines = sample.stack.split('\\n');\n      var controlLines = control.stack.split('\\n');\n      var s = sampleLines.length - 1;\n      var c = controlLines.length - 1;\n\n      while (s >= 1 && c >= 0 && sampleLines[s] !== controlLines[c]) {\n        // We expect at least one stack frame to be shared.\n        // Typically this will be the root most one. However, stack frames may be\n        // cut off due to maximum stack limits. In this case, one maybe cut off\n        // earlier than the other. We assume that the sample is longer or the same\n        // and there for cut off earlier. So we should find the root most frame in\n        // the sample somewhere in the control.\n        c--;\n      }\n\n      for (; s >= 1 && c >= 0; s--, c--) {\n        // Next we find the first one that isn't the same which should be the\n        // frame that called our sample function and the control.\n        if (sampleLines[s] !== controlLines[c]) {\n          // In V8, the first line is describing the message but other VMs don't.\n          // If we're about to return the first line, and the control is also on the same\n          // line, that's a pretty good indicator that our sample threw at same line as\n          // the control. I.e. before we entered the sample frame. So we ignore this result.\n          // This can happen if you passed a class to function component, or non-function.\n          if (s !== 1 || c !== 1) {\n            do {\n              s--;\n              c--; // We may still have similar intermediate frames from the construct call.\n              // The next one that isn't the same should be our match though.\n\n              if (c < 0 || sampleLines[s] !== controlLines[c]) {\n                // V8 adds a \"new\" prefix for native classes. Let's remove it to make it prettier.\n                var _frame = '\\n' + sampleLines[s].replace(' at new ', ' at '); // If our component frame is labeled \"<anonymous>\"\n                // but we have a user-provided \"displayName\"\n                // splice it in to make the stack more readable.\n\n\n                if (fn.displayName && _frame.includes('<anonymous>')) {\n                  _frame = _frame.replace('<anonymous>', fn.displayName);\n                }\n\n                {\n                  if (typeof fn === 'function') {\n                    componentFrameCache.set(fn, _frame);\n                  }\n                } // Return the line we found.\n\n\n                return _frame;\n              }\n            } while (s >= 1 && c >= 0);\n          }\n\n          break;\n        }\n      }\n    }\n  } finally {\n    reentry = false;\n\n    {\n      ReactCurrentDispatcher.current = previousDispatcher;\n      reenableLogs();\n    }\n\n    Error.prepareStackTrace = previousPrepareStackTrace;\n  } // Fallback to just using the name if we couldn't make it throw.\n\n\n  var name = fn ? fn.displayName || fn.name : '';\n  var syntheticFrame = name ? describeBuiltInComponentFrame(name) : '';\n\n  {\n    if (typeof fn === 'function') {\n      componentFrameCache.set(fn, syntheticFrame);\n    }\n  }\n\n  return syntheticFrame;\n}\nfunction describeFunctionComponentFrame(fn, source, ownerFn) {\n  {\n    return describeNativeComponentFrame(fn, false);\n  }\n}\n\nfunction shouldConstruct(Component) {\n  var prototype = Component.prototype;\n  return !!(prototype && prototype.isReactComponent);\n}\n\nfunction describeUnknownElementTypeFrameInDEV(type, source, ownerFn) {\n\n  if (type == null) {\n    return '';\n  }\n\n  if (typeof type === 'function') {\n    {\n      return describeNativeComponentFrame(type, shouldConstruct(type));\n    }\n  }\n\n  if (typeof type === 'string') {\n    return describeBuiltInComponentFrame(type);\n  }\n\n  switch (type) {\n    case REACT_SUSPENSE_TYPE:\n      return describeBuiltInComponentFrame('Suspense');\n\n    case REACT_SUSPENSE_LIST_TYPE:\n      return describeBuiltInComponentFrame('SuspenseList');\n  }\n\n  if (typeof type === 'object') {\n    switch (type.$$typeof) {\n      case REACT_FORWARD_REF_TYPE:\n        return describeFunctionComponentFrame(type.render);\n\n      case REACT_MEMO_TYPE:\n        // Memo may contain any component type so we recursively resolve it.\n        return describeUnknownElementTypeFrameInDEV(type.type, source, ownerFn);\n\n      case REACT_LAZY_TYPE:\n        {\n          var lazyComponent = type;\n          var payload = lazyComponent._payload;\n          var init = lazyComponent._init;\n\n          try {\n            // Lazy may contain any component type so we recursively resolve it.\n            return describeUnknownElementTypeFrameInDEV(init(payload), source, ownerFn);\n          } catch (x) {}\n        }\n    }\n  }\n\n  return '';\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar loggedTypeFailures = {};\nvar ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\n\nfunction setCurrentlyValidatingElement(element) {\n  {\n    if (element) {\n      var owner = element._owner;\n      var stack = describeUnknownElementTypeFrameInDEV(element.type, element._source, owner ? owner.type : null);\n      ReactDebugCurrentFrame.setExtraStackFrame(stack);\n    } else {\n      ReactDebugCurrentFrame.setExtraStackFrame(null);\n    }\n  }\n}\n\nfunction checkPropTypes(typeSpecs, values, location, componentName, element) {\n  {\n    // $FlowFixMe This is okay but Flow doesn't know it.\n    var has = Function.call.bind(hasOwnProperty);\n\n    for (var typeSpecName in typeSpecs) {\n      if (has(typeSpecs, typeSpecName)) {\n        var error$1 = void 0; // Prop type validation may throw. In case they do, we don't want to\n        // fail the render phase where it didn't fail before. So we log it.\n        // After these have been cleaned up, we'll let them throw.\n\n        try {\n          // This is intentionally an invariant that gets caught. It's the same\n          // behavior as without this statement except with a better message.\n          if (typeof typeSpecs[typeSpecName] !== 'function') {\n            // eslint-disable-next-line react-internal/prod-error-codes\n            var err = Error((componentName || 'React class') + ': ' + location + ' type `' + typeSpecName + '` is invalid; ' + 'it must be a function, usually from the `prop-types` package, but received `' + typeof typeSpecs[typeSpecName] + '`.' + 'This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.');\n            err.name = 'Invariant Violation';\n            throw err;\n          }\n\n          error$1 = typeSpecs[typeSpecName](values, typeSpecName, componentName, location, null, 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED');\n        } catch (ex) {\n          error$1 = ex;\n        }\n\n        if (error$1 && !(error$1 instanceof Error)) {\n          setCurrentlyValidatingElement(element);\n\n          error('%s: type specification of %s' + ' `%s` is invalid; the type checker ' + 'function must return `null` or an `Error` but returned a %s. ' + 'You may have forgotten to pass an argument to the type checker ' + 'creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and ' + 'shape all require an argument).', componentName || 'React class', location, typeSpecName, typeof error$1);\n\n          setCurrentlyValidatingElement(null);\n        }\n\n        if (error$1 instanceof Error && !(error$1.message in loggedTypeFailures)) {\n          // Only monitor this failure once because there tends to be a lot of the\n          // same error.\n          loggedTypeFailures[error$1.message] = true;\n          setCurrentlyValidatingElement(element);\n\n          error('Failed %s type: %s', location, error$1.message);\n\n          setCurrentlyValidatingElement(null);\n        }\n      }\n    }\n  }\n}\n\nvar isArrayImpl = Array.isArray; // eslint-disable-next-line no-redeclare\n\nfunction isArray(a) {\n  return isArrayImpl(a);\n}\n\n/*\n * The `'' + value` pattern (used in in perf-sensitive code) throws for Symbol\n * and Temporal.* types. See https://github.com/facebook/react/pull/22064.\n *\n * The functions in this module will throw an easier-to-understand,\n * easier-to-debug exception with a clear errors message message explaining the\n * problem. (Instead of a confusing exception thrown inside the implementation\n * of the `value` object).\n */\n// $FlowFixMe only called in DEV, so void return is not possible.\nfunction typeName(value) {\n  {\n    // toStringTag is needed for namespaced types like Temporal.Instant\n    var hasToStringTag = typeof Symbol === 'function' && Symbol.toStringTag;\n    var type = hasToStringTag && value[Symbol.toStringTag] || value.constructor.name || 'Object';\n    return type;\n  }\n} // $FlowFixMe only called in DEV, so void return is not possible.\n\n\nfunction willCoercionThrow(value) {\n  {\n    try {\n      testStringCoercion(value);\n      return false;\n    } catch (e) {\n      return true;\n    }\n  }\n}\n\nfunction testStringCoercion(value) {\n  // If you ended up here by following an exception call stack, here's what's\n  // happened: you supplied an object or symbol value to React (as a prop, key,\n  // DOM attribute, CSS property, string ref, etc.) and when React tried to\n  // coerce it to a string using `'' + value`, an exception was thrown.\n  //\n  // The most common types that will cause this exception are `Symbol` instances\n  // and Temporal objects like `Temporal.Instant`. But any object that has a\n  // `valueOf` or `[Symbol.toPrimitive]` method that throws will also cause this\n  // exception. (Library authors do this to prevent users from using built-in\n  // numeric operators like `+` or comparison operators like `>=` because custom\n  // methods are needed to perform accurate arithmetic or comparison.)\n  //\n  // To fix the problem, coerce this object or symbol value to a string before\n  // passing it to React. The most reliable way is usually `String(value)`.\n  //\n  // To find which value is throwing, check the browser or debugger console.\n  // Before this exception was thrown, there should be `console.error` output\n  // that shows the type (Symbol, Temporal.PlainDate, etc.) that caused the\n  // problem and how that type was used: key, atrribute, input value prop, etc.\n  // In most cases, this console output also shows the component and its\n  // ancestor components where the exception happened.\n  //\n  // eslint-disable-next-line react-internal/safe-string-coercion\n  return '' + value;\n}\nfunction checkKeyStringCoercion(value) {\n  {\n    if (willCoercionThrow(value)) {\n      error('The provided key is an unsupported type %s.' + ' This value must be coerced to a string before before using it here.', typeName(value));\n\n      return testStringCoercion(value); // throw (to help callers find troubleshooting comments)\n    }\n  }\n}\n\nvar ReactCurrentOwner = ReactSharedInternals.ReactCurrentOwner;\nvar RESERVED_PROPS = {\n  key: true,\n  ref: true,\n  __self: true,\n  __source: true\n};\nvar specialPropKeyWarningShown;\nvar specialPropRefWarningShown;\nvar didWarnAboutStringRefs;\n\n{\n  didWarnAboutStringRefs = {};\n}\n\nfunction hasValidRef(config) {\n  {\n    if (hasOwnProperty.call(config, 'ref')) {\n      var getter = Object.getOwnPropertyDescriptor(config, 'ref').get;\n\n      if (getter && getter.isReactWarning) {\n        return false;\n      }\n    }\n  }\n\n  return config.ref !== undefined;\n}\n\nfunction hasValidKey(config) {\n  {\n    if (hasOwnProperty.call(config, 'key')) {\n      var getter = Object.getOwnPropertyDescriptor(config, 'key').get;\n\n      if (getter && getter.isReactWarning) {\n        return false;\n      }\n    }\n  }\n\n  return config.key !== undefined;\n}\n\nfunction warnIfStringRefCannotBeAutoConverted(config, self) {\n  {\n    if (typeof config.ref === 'string' && ReactCurrentOwner.current && self && ReactCurrentOwner.current.stateNode !== self) {\n      var componentName = getComponentNameFromType(ReactCurrentOwner.current.type);\n\n      if (!didWarnAboutStringRefs[componentName]) {\n        error('Component \"%s\" contains the string ref \"%s\". ' + 'Support for string refs will be removed in a future major release. ' + 'This case cannot be automatically converted to an arrow function. ' + 'We ask you to manually fix this case by using useRef() or createRef() instead. ' + 'Learn more about using refs safely here: ' + 'https://reactjs.org/link/strict-mode-string-ref', getComponentNameFromType(ReactCurrentOwner.current.type), config.ref);\n\n        didWarnAboutStringRefs[componentName] = true;\n      }\n    }\n  }\n}\n\nfunction defineKeyPropWarningGetter(props, displayName) {\n  {\n    var warnAboutAccessingKey = function () {\n      if (!specialPropKeyWarningShown) {\n        specialPropKeyWarningShown = true;\n\n        error('%s: `key` is not a prop. Trying to access it will result ' + 'in `undefined` being returned. If you need to access the same ' + 'value within the child component, you should pass it as a different ' + 'prop. (https://reactjs.org/link/special-props)', displayName);\n      }\n    };\n\n    warnAboutAccessingKey.isReactWarning = true;\n    Object.defineProperty(props, 'key', {\n      get: warnAboutAccessingKey,\n      configurable: true\n    });\n  }\n}\n\nfunction defineRefPropWarningGetter(props, displayName) {\n  {\n    var warnAboutAccessingRef = function () {\n      if (!specialPropRefWarningShown) {\n        specialPropRefWarningShown = true;\n\n        error('%s: `ref` is not a prop. Trying to access it will result ' + 'in `undefined` being returned. If you need to access the same ' + 'value within the child component, you should pass it as a different ' + 'prop. (https://reactjs.org/link/special-props)', displayName);\n      }\n    };\n\n    warnAboutAccessingRef.isReactWarning = true;\n    Object.defineProperty(props, 'ref', {\n      get: warnAboutAccessingRef,\n      configurable: true\n    });\n  }\n}\n/**\n * Factory method to create a new React element. This no longer adheres to\n * the class pattern, so do not use new to call it. Also, instanceof check\n * will not work. Instead test $$typeof field against Symbol.for('react.element') to check\n * if something is a React Element.\n *\n * @param {*} type\n * @param {*} props\n * @param {*} key\n * @param {string|object} ref\n * @param {*} owner\n * @param {*} self A *temporary* helper to detect places where `this` is\n * different from the `owner` when React.createElement is called, so that we\n * can warn. We want to get rid of owner and replace string `ref`s with arrow\n * functions, and as long as `this` and owner are the same, there will be no\n * change in behavior.\n * @param {*} source An annotation object (added by a transpiler or otherwise)\n * indicating filename, line number, and/or other information.\n * @internal\n */\n\n\nvar ReactElement = function (type, key, ref, self, source, owner, props) {\n  var element = {\n    // This tag allows us to uniquely identify this as a React Element\n    $$typeof: REACT_ELEMENT_TYPE,\n    // Built-in properties that belong on the element\n    type: type,\n    key: key,\n    ref: ref,\n    props: props,\n    // Record the component responsible for creating this element.\n    _owner: owner\n  };\n\n  {\n    // The validation flag is currently mutative. We put it on\n    // an external backing store so that we can freeze the whole object.\n    // This can be replaced with a WeakMap once they are implemented in\n    // commonly used development environments.\n    element._store = {}; // To make comparing ReactElements easier for testing purposes, we make\n    // the validation flag non-enumerable (where possible, which should\n    // include every environment we run tests in), so the test framework\n    // ignores it.\n\n    Object.defineProperty(element._store, 'validated', {\n      configurable: false,\n      enumerable: false,\n      writable: true,\n      value: false\n    }); // self and source are DEV only properties.\n\n    Object.defineProperty(element, '_self', {\n      configurable: false,\n      enumerable: false,\n      writable: false,\n      value: self\n    }); // Two elements created in two different places should be considered\n    // equal for testing purposes and therefore we hide it from enumeration.\n\n    Object.defineProperty(element, '_source', {\n      configurable: false,\n      enumerable: false,\n      writable: false,\n      value: source\n    });\n\n    if (Object.freeze) {\n      Object.freeze(element.props);\n      Object.freeze(element);\n    }\n  }\n\n  return element;\n};\n/**\n * https://github.com/reactjs/rfcs/pull/107\n * @param {*} type\n * @param {object} props\n * @param {string} key\n */\n\nfunction jsxDEV(type, config, maybeKey, source, self) {\n  {\n    var propName; // Reserved names are extracted\n\n    var props = {};\n    var key = null;\n    var ref = null; // Currently, key can be spread in as a prop. This causes a potential\n    // issue if key is also explicitly declared (ie. <div {...props} key=\"Hi\" />\n    // or <div key=\"Hi\" {...props} /> ). We want to deprecate key spread,\n    // but as an intermediary step, we will use jsxDEV for everything except\n    // <div {...props} key=\"Hi\" />, because we aren't currently able to tell if\n    // key is explicitly declared to be undefined or not.\n\n    if (maybeKey !== undefined) {\n      {\n        checkKeyStringCoercion(maybeKey);\n      }\n\n      key = '' + maybeKey;\n    }\n\n    if (hasValidKey(config)) {\n      {\n        checkKeyStringCoercion(config.key);\n      }\n\n      key = '' + config.key;\n    }\n\n    if (hasValidRef(config)) {\n      ref = config.ref;\n      warnIfStringRefCannotBeAutoConverted(config, self);\n    } // Remaining properties are added to a new props object\n\n\n    for (propName in config) {\n      if (hasOwnProperty.call(config, propName) && !RESERVED_PROPS.hasOwnProperty(propName)) {\n        props[propName] = config[propName];\n      }\n    } // Resolve default props\n\n\n    if (type && type.defaultProps) {\n      var defaultProps = type.defaultProps;\n\n      for (propName in defaultProps) {\n        if (props[propName] === undefined) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    }\n\n    if (key || ref) {\n      var displayName = typeof type === 'function' ? type.displayName || type.name || 'Unknown' : type;\n\n      if (key) {\n        defineKeyPropWarningGetter(props, displayName);\n      }\n\n      if (ref) {\n        defineRefPropWarningGetter(props, displayName);\n      }\n    }\n\n    return ReactElement(type, key, ref, self, source, ReactCurrentOwner.current, props);\n  }\n}\n\nvar ReactCurrentOwner$1 = ReactSharedInternals.ReactCurrentOwner;\nvar ReactDebugCurrentFrame$1 = ReactSharedInternals.ReactDebugCurrentFrame;\n\nfunction setCurrentlyValidatingElement$1(element) {\n  {\n    if (element) {\n      var owner = element._owner;\n      var stack = describeUnknownElementTypeFrameInDEV(element.type, element._source, owner ? owner.type : null);\n      ReactDebugCurrentFrame$1.setExtraStackFrame(stack);\n    } else {\n      ReactDebugCurrentFrame$1.setExtraStackFrame(null);\n    }\n  }\n}\n\nvar propTypesMisspellWarningShown;\n\n{\n  propTypesMisspellWarningShown = false;\n}\n/**\n * Verifies the object is a ReactElement.\n * See https://reactjs.org/docs/react-api.html#isvalidelement\n * @param {?object} object\n * @return {boolean} True if `object` is a ReactElement.\n * @final\n */\n\n\nfunction isValidElement(object) {\n  {\n    return typeof object === 'object' && object !== null && object.$$typeof === REACT_ELEMENT_TYPE;\n  }\n}\n\nfunction getDeclarationErrorAddendum() {\n  {\n    if (ReactCurrentOwner$1.current) {\n      var name = getComponentNameFromType(ReactCurrentOwner$1.current.type);\n\n      if (name) {\n        return '\\n\\nCheck the render method of `' + name + '`.';\n      }\n    }\n\n    return '';\n  }\n}\n\nfunction getSourceInfoErrorAddendum(source) {\n  {\n    if (source !== undefined) {\n      var fileName = source.fileName.replace(/^.*[\\\\\\/]/, '');\n      var lineNumber = source.lineNumber;\n      return '\\n\\nCheck your code at ' + fileName + ':' + lineNumber + '.';\n    }\n\n    return '';\n  }\n}\n/**\n * Warn if there's no key explicitly set on dynamic arrays of children or\n * object keys are not valid. This allows us to keep track of children between\n * updates.\n */\n\n\nvar ownerHasKeyUseWarning = {};\n\nfunction getCurrentComponentErrorInfo(parentType) {\n  {\n    var info = getDeclarationErrorAddendum();\n\n    if (!info) {\n      var parentName = typeof parentType === 'string' ? parentType : parentType.displayName || parentType.name;\n\n      if (parentName) {\n        info = \"\\n\\nCheck the top-level render call using <\" + parentName + \">.\";\n      }\n    }\n\n    return info;\n  }\n}\n/**\n * Warn if the element doesn't have an explicit key assigned to it.\n * This element is in an array. The array could grow and shrink or be\n * reordered. All children that haven't already been validated are required to\n * have a \"key\" property assigned to it. Error statuses are cached so a warning\n * will only be shown once.\n *\n * @internal\n * @param {ReactElement} element Element that requires a key.\n * @param {*} parentType element's parent's type.\n */\n\n\nfunction validateExplicitKey(element, parentType) {\n  {\n    if (!element._store || element._store.validated || element.key != null) {\n      return;\n    }\n\n    element._store.validated = true;\n    var currentComponentErrorInfo = getCurrentComponentErrorInfo(parentType);\n\n    if (ownerHasKeyUseWarning[currentComponentErrorInfo]) {\n      return;\n    }\n\n    ownerHasKeyUseWarning[currentComponentErrorInfo] = true; // Usually the current owner is the offender, but if it accepts children as a\n    // property, it may be the creator of the child that's responsible for\n    // assigning it a key.\n\n    var childOwner = '';\n\n    if (element && element._owner && element._owner !== ReactCurrentOwner$1.current) {\n      // Give the component that originally created this child.\n      childOwner = \" It was passed a child from \" + getComponentNameFromType(element._owner.type) + \".\";\n    }\n\n    setCurrentlyValidatingElement$1(element);\n\n    error('Each child in a list should have a unique \"key\" prop.' + '%s%s See https://reactjs.org/link/warning-keys for more information.', currentComponentErrorInfo, childOwner);\n\n    setCurrentlyValidatingElement$1(null);\n  }\n}\n/**\n * Ensure that every element either is passed in a static location, in an\n * array with an explicit keys property defined, or in an object literal\n * with valid key property.\n *\n * @internal\n * @param {ReactNode} node Statically passed child of any type.\n * @param {*} parentType node's parent's type.\n */\n\n\nfunction validateChildKeys(node, parentType) {\n  {\n    if (typeof node !== 'object') {\n      return;\n    }\n\n    if (isArray(node)) {\n      for (var i = 0; i < node.length; i++) {\n        var child = node[i];\n\n        if (isValidElement(child)) {\n          validateExplicitKey(child, parentType);\n        }\n      }\n    } else if (isValidElement(node)) {\n      // This element was passed in a valid location.\n      if (node._store) {\n        node._store.validated = true;\n      }\n    } else if (node) {\n      var iteratorFn = getIteratorFn(node);\n\n      if (typeof iteratorFn === 'function') {\n        // Entry iterators used to provide implicit keys,\n        // but now we print a separate warning for them later.\n        if (iteratorFn !== node.entries) {\n          var iterator = iteratorFn.call(node);\n          var step;\n\n          while (!(step = iterator.next()).done) {\n            if (isValidElement(step.value)) {\n              validateExplicitKey(step.value, parentType);\n            }\n          }\n        }\n      }\n    }\n  }\n}\n/**\n * Given an element, validate that its props follow the propTypes definition,\n * provided by the type.\n *\n * @param {ReactElement} element\n */\n\n\nfunction validatePropTypes(element) {\n  {\n    var type = element.type;\n\n    if (type === null || type === undefined || typeof type === 'string') {\n      return;\n    }\n\n    var propTypes;\n\n    if (typeof type === 'function') {\n      propTypes = type.propTypes;\n    } else if (typeof type === 'object' && (type.$$typeof === REACT_FORWARD_REF_TYPE || // Note: Memo only checks outer props here.\n    // Inner props are checked in the reconciler.\n    type.$$typeof === REACT_MEMO_TYPE)) {\n      propTypes = type.propTypes;\n    } else {\n      return;\n    }\n\n    if (propTypes) {\n      // Intentionally inside to avoid triggering lazy initializers:\n      var name = getComponentNameFromType(type);\n      checkPropTypes(propTypes, element.props, 'prop', name, element);\n    } else if (type.PropTypes !== undefined && !propTypesMisspellWarningShown) {\n      propTypesMisspellWarningShown = true; // Intentionally inside to avoid triggering lazy initializers:\n\n      var _name = getComponentNameFromType(type);\n\n      error('Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?', _name || 'Unknown');\n    }\n\n    if (typeof type.getDefaultProps === 'function' && !type.getDefaultProps.isReactClassApproved) {\n      error('getDefaultProps is only used on classic React.createClass ' + 'definitions. Use a static property named `defaultProps` instead.');\n    }\n  }\n}\n/**\n * Given a fragment, validate that it can only be provided with fragment props\n * @param {ReactElement} fragment\n */\n\n\nfunction validateFragmentProps(fragment) {\n  {\n    var keys = Object.keys(fragment.props);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n\n      if (key !== 'children' && key !== 'key') {\n        setCurrentlyValidatingElement$1(fragment);\n\n        error('Invalid prop `%s` supplied to `React.Fragment`. ' + 'React.Fragment can only have `key` and `children` props.', key);\n\n        setCurrentlyValidatingElement$1(null);\n        break;\n      }\n    }\n\n    if (fragment.ref !== null) {\n      setCurrentlyValidatingElement$1(fragment);\n\n      error('Invalid attribute `ref` supplied to `React.Fragment`.');\n\n      setCurrentlyValidatingElement$1(null);\n    }\n  }\n}\n\nvar didWarnAboutKeySpread = {};\nfunction jsxWithValidation(type, props, key, isStaticChildren, source, self) {\n  {\n    var validType = isValidElementType(type); // We warn in this case but don't throw. We expect the element creation to\n    // succeed and there will likely be errors in render.\n\n    if (!validType) {\n      var info = '';\n\n      if (type === undefined || typeof type === 'object' && type !== null && Object.keys(type).length === 0) {\n        info += ' You likely forgot to export your component from the file ' + \"it's defined in, or you might have mixed up default and named imports.\";\n      }\n\n      var sourceInfo = getSourceInfoErrorAddendum(source);\n\n      if (sourceInfo) {\n        info += sourceInfo;\n      } else {\n        info += getDeclarationErrorAddendum();\n      }\n\n      var typeString;\n\n      if (type === null) {\n        typeString = 'null';\n      } else if (isArray(type)) {\n        typeString = 'array';\n      } else if (type !== undefined && type.$$typeof === REACT_ELEMENT_TYPE) {\n        typeString = \"<\" + (getComponentNameFromType(type.type) || 'Unknown') + \" />\";\n        info = ' Did you accidentally export a JSX literal instead of a component?';\n      } else {\n        typeString = typeof type;\n      }\n\n      error('React.jsx: type is invalid -- expected a string (for ' + 'built-in components) or a class/function (for composite ' + 'components) but got: %s.%s', typeString, info);\n    }\n\n    var element = jsxDEV(type, props, key, source, self); // The result can be nullish if a mock or a custom function is used.\n    // TODO: Drop this when these are no longer allowed as the type argument.\n\n    if (element == null) {\n      return element;\n    } // Skip key warning if the type isn't valid since our key validation logic\n    // doesn't expect a non-string/function type and can throw confusing errors.\n    // We don't want exception behavior to differ between dev and prod.\n    // (Rendering will throw with a helpful message and as soon as the type is\n    // fixed, the key warnings will appear.)\n\n\n    if (validType) {\n      var children = props.children;\n\n      if (children !== undefined) {\n        if (isStaticChildren) {\n          if (isArray(children)) {\n            for (var i = 0; i < children.length; i++) {\n              validateChildKeys(children[i], type);\n            }\n\n            if (Object.freeze) {\n              Object.freeze(children);\n            }\n          } else {\n            error('React.jsx: Static children should always be an array. ' + 'You are likely explicitly calling React.jsxs or React.jsxDEV. ' + 'Use the Babel transform instead.');\n          }\n        } else {\n          validateChildKeys(children, type);\n        }\n      }\n    }\n\n    {\n      if (hasOwnProperty.call(props, 'key')) {\n        var componentName = getComponentNameFromType(type);\n        var keys = Object.keys(props).filter(function (k) {\n          return k !== 'key';\n        });\n        var beforeExample = keys.length > 0 ? '{key: someKey, ' + keys.join(': ..., ') + ': ...}' : '{key: someKey}';\n\n        if (!didWarnAboutKeySpread[componentName + beforeExample]) {\n          var afterExample = keys.length > 0 ? '{' + keys.join(': ..., ') + ': ...}' : '{}';\n\n          error('A props object containing a \"key\" prop is being spread into JSX:\\n' + '  let props = %s;\\n' + '  <%s {...props} />\\n' + 'React keys must be passed directly to JSX without using spread:\\n' + '  let props = %s;\\n' + '  <%s key={someKey} {...props} />', beforeExample, componentName, afterExample, componentName);\n\n          didWarnAboutKeySpread[componentName + beforeExample] = true;\n        }\n      }\n    }\n\n    if (type === REACT_FRAGMENT_TYPE) {\n      validateFragmentProps(element);\n    } else {\n      validatePropTypes(element);\n    }\n\n    return element;\n  }\n} // These two functions exist to still get child warnings in dev\n\nvar jsxDEV$1 =  jsxWithValidation ;\n\nexports.Fragment = REACT_FRAGMENT_TYPE;\nexports.jsxDEV = jsxDEV$1;\n  })();\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-dev-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-dev-runtime.development.js');\n}\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...args) => api.dispatch(...args), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst removeStoreFromTrackedConnections = (name, store) => {\n  if (store === void 0) return;\n  const connectionInfo = trackedConnections.get(name);\n  if (!connectionInfo) return;\n  delete connectionInfo.stores[store];\n  if (Object.keys(connectionInfo.stores).length === 0) {\n    trackedConnections.delete(name);\n  }\n};\nconst findCallerName = (stack) => {\n  var _a, _b;\n  if (!stack) return void 0;\n  const traceLines = stack.split(\"\\n\");\n  const apiSetStateLineIndex = traceLines.findIndex(\n    (traceLine) => traceLine.includes(\"api.setState\")\n  );\n  if (apiSetStateLineIndex < 0) return void 0;\n  const callerLine = ((_a = traceLines[apiSetStateLineIndex + 1]) == null ? void 0 : _a.trim()) || \"\";\n  return (_b = /.+ (.+) .+/.exec(callerLine)) == null ? void 0 : _b[1];\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (e) {\n  }\n  if (!extensionConnector) {\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = ((state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? {\n      type: anonymousActionType || findCallerName(new Error().stack) || \"anonymous\"\n    } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  });\n  api.devtools = {\n    cleanup: () => {\n      if (connection && typeof connection.unsubscribe === \"function\") {\n        connection.unsubscribe();\n      }\n      removeStoreFromTrackedConnections(options.name, store);\n    }\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...args) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && args[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...args);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format.\n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, fn) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) fn(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = ((selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  });\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nfunction combine(initialState, create) {\n  return (...args) => Object.assign({}, initialState, create(...args));\n}\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(name, JSON.stringify(newValue, options == null ? void 0 : options.replacer)),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst persistImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    return setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      return setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            const migration = options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n            if (migration instanceof Promise) {\n              return migration.then((result) => [true, result]);\n            }\n            return [true, migration];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persist = persistImpl;\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector };\n","import { create } from 'zustand';\r\nimport { devtools } from 'zustand/middleware';\r\nimport { User } from '../types';\r\n\r\ninterface AuthState {\r\n  // Auth state\r\n  isAuthenticated: boolean;\r\n  user: User | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n  \r\n  // Actions\r\n  setAuthState: (state: {\r\n    isAuthenticated?: boolean;\r\n    user?: User | null;\r\n    loading?: boolean;\r\n    error?: string | null;\r\n  }) => void;\r\n  \r\n  setUser: (user: User | null) => void;\r\n  setLoading: (loading: boolean) => void;\r\n  setError: (error: string | null) => void;\r\n  clearError: () => void;\r\n  \r\n  // Computed values\r\n  isAdmin: () => boolean;\r\n  isDriver: () => boolean;\r\n  isStudent: () => boolean;\r\n}\r\n\r\nexport const useAuthStore = create<AuthState>()(\r\n  devtools(\r\n    (set, get) => ({\r\n      // Initial state\r\n      isAuthenticated: false,\r\n      user: null,\r\n      loading: true,\r\n      error: null,\r\n      \r\n      // Actions\r\n      setAuthState: (state) =>\r\n        set((prev) => ({\r\n          ...prev,\r\n          ...state,\r\n        })),\r\n      \r\n      setUser: (user) =>\r\n        set(() => ({\r\n          user,\r\n          isAuthenticated: !!user,\r\n        })),\r\n      \r\n      setLoading: (loading) =>\r\n        set({ loading }),\r\n      \r\n      setError: (error) =>\r\n        set({ error }),\r\n      \r\n      clearError: () =>\r\n        set({ error: null }),\r\n      \r\n      // Computed values\r\n      isAdmin: () => {\r\n        const state = get();\r\n        return state.user?.role === 'admin';\r\n      },\r\n      \r\n      isDriver: () => {\r\n        const state = get();\r\n        return state.user?.role === 'driver';\r\n      },\r\n      \r\n      isStudent: () => {\r\n        const state = get();\r\n        return state.user?.role === 'student';\r\n      },\r\n    }),\r\n    {\r\n      name: 'auth-store',\r\n    }\r\n  )\r\n);\r\n","// Smart API URL detection for cross-laptop testing and VS Code tunnels - OPTIMIZED\r\nconst getApiUrl = () => {\r\n  // PRIORITY 1: Environment variable override (for deployment) - FAST PATH\r\n  if (import.meta.env.VITE_API_URL) {\r\n    return import.meta.env.VITE_API_URL;\r\n  }\r\n\r\n  // PRIORITY 2: Production domains - FAST PATH\r\n  const currentHost = window.location.hostname;\r\n  const currentProtocol = window.location.protocol;\r\n\r\n  // Fast check for production domains\r\n  if (\r\n    currentHost.includes('render.com') ||\r\n    currentHost.includes('vercel.app') ||\r\n    currentHost.includes('vercel.com')\r\n  ) {\r\n    return 'https://bus-tracking-backend-sxh8.onrender.com';\r\n  }\r\n\r\n  // PRIORITY 3: VS Code tunnels - OPTIMIZED\r\n  if (currentHost.includes('devtunnels.ms')) {\r\n    const tunnelId = currentHost.split('.')[0];\r\n    return `${currentProtocol}//${tunnelId}-3000.inc1.devtunnels.ms`;\r\n  }\r\n\r\n  // PRIORITY 4: Network IP (cross-laptop) - OPTIMIZED\r\n  if (currentHost !== 'localhost' && currentHost !== '127.0.0.1' && currentHost !== '0.0.0.0') {\r\n    return `http://${currentHost}:3000`;\r\n  }\r\n\r\n  // PRIORITY 5: Development - only for actual development\r\n  if (import.meta.env.DEV) {\r\n    return 'http://localhost:3000';\r\n  }\r\n\r\n  // FALLBACK: Production backend for any other case\r\n  return 'https://bus-tracking-backend-sxh8.onrender.com';\r\n};\r\n\r\nconst getWebSocketUrl = () => {\r\n  // PRIORITY 1: Environment variable override (for deployment) - FAST PATH\r\n  if (import.meta.env.VITE_WEBSOCKET_URL) {\r\n    return import.meta.env.VITE_WEBSOCKET_URL;\r\n  }\r\n\r\n  // PRIORITY 2: Production domains - FAST PATH\r\n  const currentHost = window.location.hostname;\r\n  const currentProtocol = window.location.protocol;\r\n\r\n  // Fast check for production domains\r\n  if (\r\n    currentHost.includes('render.com') ||\r\n    currentHost.includes('vercel.app') ||\r\n    currentHost.includes('vercel.com')\r\n  ) {\r\n    return 'wss://bus-tracking-backend-sxh8.onrender.com';\r\n  }\r\n\r\n  // PRIORITY 3: VS Code tunnels - OPTIMIZED\r\n  if (currentHost.includes('devtunnels.ms')) {\r\n    const tunnelId = currentHost.split('.')[0];\r\n    const wsUrl = `${currentProtocol === 'https:' ? 'wss:' : 'ws:'}//${tunnelId}-3000.inc1.devtunnels.ms`;\r\n    return wsUrl;\r\n  }\r\n\r\n  // PRIORITY 4: Network IP (cross-laptop) - OPTIMIZED\r\n  if (currentHost !== 'localhost' && currentHost !== '127.0.0.1' && currentHost !== '0.0.0.0') {\r\n    return `ws://${currentHost}:3000`;\r\n  }\r\n\r\n  // PRIORITY 5: Development - only for actual development\r\n  if (import.meta.env.DEV) {\r\n    return 'ws://localhost:3000';\r\n  }\r\n\r\n  // FALLBACK: Production backend for any other case\r\n  return 'wss://bus-tracking-backend-sxh8.onrender.com';\r\n};\r\n\r\n// Create a dynamic environment object that evaluates URLs at runtime\r\nexport const environment = {\r\n  // Supabase Configuration\r\n  supabase: {\r\n    url: (() => {\r\n      const envUrl = import.meta.env.VITE_SUPABASE_URL;\r\n\r\n      if (envUrl && envUrl !== 'your_supabase_project_url' && envUrl !== '') {\r\n        return envUrl;\r\n      }\r\n\r\n      if (import.meta.env.DEV) {\r\n        console.warn(\r\n          '⚠️ VITE_SUPABASE_URL not set. Please set it in your environment variables.'\r\n        );\r\n        return null;\r\n      }\r\n\r\n      throw new Error(\r\n        'VITE_SUPABASE_URL is required in production. Please set it in your environment variables.'\r\n      );\r\n    })(),\r\n    anonKey: (() => {\r\n      const envKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\r\n\r\n      if (envKey && envKey !== 'your_supabase_anon_key_here' && envKey !== '') {\r\n        return envKey;\r\n      }\r\n\r\n      if (import.meta.env.DEV) {\r\n        console.warn(\r\n          '⚠️ VITE_SUPABASE_ANON_KEY not set. Please set it in your environment variables.'\r\n        );\r\n        return null;\r\n      }\r\n\r\n      throw new Error(\r\n        'VITE_SUPABASE_ANON_KEY is required in production. Please set it in your environment variables.'\r\n      );\r\n    })(),\r\n  },\r\n\r\n  // API Configuration - Use getters to ensure dynamic evaluation\r\n  get api() {\r\n    return {\r\n      url: getApiUrl(),\r\n      websocketUrl: getWebSocketUrl(),\r\n    };\r\n  },\r\n\r\n  // Environment\r\n  isDevelopment: import.meta.env.DEV,\r\n  isProduction: import.meta.env.PROD,\r\n};\r\n\r\n// Log environment status (only in development)\r\nif (environment.isDevelopment) {\r\n  console.log('🔧 Environment Configuration:', {\r\n    supabaseUrl: environment.supabase.url ? '✅ Set' : '❌ Missing',\r\n    supabaseKey: environment.supabase.anonKey ? '✅ Set' : '❌ Missing',\r\n    apiUrl: environment.api.url,\r\n    websocketUrl: environment.api.websocketUrl,\r\n    currentHost: window.location.hostname,\r\n    currentProtocol: window.location.protocol,\r\n    envVar: import.meta.env.VITE_API_URL || 'NOT SET',\r\n  });\r\n}\r\n\r\nexport default environment;\r\n","import { createClient } from '@supabase/supabase-js';\nimport { environment } from './environment';\n\n// Validate Supabase configuration with better error handling\nconst validateSupabaseConfig = () => {\n  const { url, anonKey } = environment.supabase;\n\n  console.log('🔧 Validating Supabase configuration:', {\n    url: url ? '✅ Set' : '❌ Missing',\n    anonKey: anonKey ? '✅ Set' : '❌ Missing',\n    envVars: {\n      VITE_SUPABASE_URL: import.meta.env.VITE_SUPABASE_URL\n        ? '✅ Set'\n        : '❌ Missing',\n      VITE_SUPABASE_ANON_KEY: import.meta.env.VITE_SUPABASE_ANON_KEY\n        ? '✅ Set'\n        : '❌ Missing',\n    },\n  });\n\n  // Check if URL is missing or contains placeholder\n  if (!url || url === 'your_supabase_project_url' || url === '') {\n    console.error('❌ Supabase URL validation failed:', {\n      url,\n      envVar: import.meta.env.VITE_SUPABASE_URL,\n    });\n    throw new Error(\n      'Invalid Supabase URL. Please check your environment variables.'\n    );\n  }\n\n  // Check if anon key is missing or contains placeholder\n  if (!anonKey || anonKey === 'your_supabase_anon_key_here' || anonKey === '') {\n    console.error('❌ Supabase anon key validation failed:', {\n      anonKey: anonKey ? 'SET' : 'MISSING',\n      envVar: import.meta.env.VITE_SUPABASE_ANON_KEY ? 'SET' : 'MISSING',\n    });\n    throw new Error(\n      'Invalid Supabase anon key. Please check your environment variables.'\n    );\n  }\n\n  // Validate URL format\n  try {\n    new URL(url);\n  } catch (error) {\n    console.error('❌ Supabase URL format validation failed:', { url, error });\n    throw new Error(`Invalid Supabase URL format: ${url}`);\n  }\n\n  console.log('✅ Supabase configuration validated successfully');\n  return { url, anonKey };\n};\n\n// Create Supabase client with error handling\nconst createSupabaseClient = () => {\n  try {\n    const config = validateSupabaseConfig();\n\n    const client = createClient(config.url, config.anonKey, {\n      auth: {\n        autoRefreshToken: true,\n        persistSession: true,\n        detectSessionInUrl: true,\n      },\n      global: {\n        headers: {\n          'X-Client-Info': 'bus-tracking-admin',\n        },\n      },\n      realtime: {\n        params: {\n          eventsPerSecond: 10,\n        },\n      },\n    });\n\n    console.log('✅ Supabase client created successfully');\n    return client;\n  } catch (error) {\n    console.error('❌ Failed to create Supabase client:', error);\n\n    // Create a fallback client with default values for development\n    if (import.meta.env.DEV) {\n      console.log('🔄 Creating fallback Supabase client for development...');\n      const fallbackClient = createClient(\n        'https://gthwmwfwvhyriygpcdlr.supabase.co',\n        '',\n        {\n          auth: {\n            autoRefreshToken: true,\n            persistSession: true,\n            detectSessionInUrl: true,\n          },\n          global: {\n            headers: {\n              'X-Client-Info': 'bus-tracking-admin',\n            },\n          },\n          realtime: {\n            params: {\n              eventsPerSecond: 10,\n            },\n          },\n        }\n      );\n      console.log('✅ Fallback Supabase client created');\n      return fallbackClient;\n    } else {\n      throw error;\n    }\n  }\n};\n\n// Create and export the Supabase client\nexport const supabase = createSupabaseClient();\n\n// Test Supabase connection\nexport const testSupabaseConnection = async () => {\n  try {\n    // Skip test for mock client\n    if (!supabase.from || typeof supabase.from !== 'function') {\n      console.log('🔄 Skipping Supabase connection test (mock client)');\n      return true;\n    }\n\n    // Testing Supabase connection...\n    const { error } = await supabase.from('profiles').select('count').limit(1);\n\n    if (error) {\n      console.error('❌ Supabase connection test failed:', error);\n      return false;\n    }\n\n    // Supabase connection test successful\n    return true;\n  } catch (error) {\n    console.error('❌ Supabase connection test error:', error);\n    return false;\n  }\n};\n\nexport default supabase;\n","import { User, Session } from '@supabase/supabase-js';\r\nimport { UserProfile } from '../types';\r\nimport { supabase } from '../config/supabase';\r\n\r\nexport interface AuthState {\r\n  user: User | null;\r\n  session: Session | null;\r\n  profile: UserProfile | null;\r\n  loading: boolean;\r\n}\r\n\r\nexport interface DriverBusAssignment {\r\n  driver_id: string;\r\n  bus_id: string;\r\n  bus_number: string;\r\n  route_id: string;\r\n  route_name: string;\r\n  driver_name: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n}\r\n\r\nclass AuthService {\r\n  private currentUser: User | null = null;\r\n  private currentSession: Session | null = null;\r\n  private currentProfile: UserProfile | null = null;\r\n  private currentDriverAssignment: DriverBusAssignment | null = null;\r\n  private authStateChangeListener: (() => void) | null = null;\r\n  private _isInitialized: boolean = false;\r\n\r\n  constructor() {\r\n    this.initializeAuth();\r\n  }\r\n\r\n  private async initializeAuth() {\r\n    try {\r\n      // Get initial session\r\n      const {\r\n        data: { session },\r\n        error,\r\n      } = await supabase.auth.getSession();\r\n\r\n      if (error) {\r\n        console.error('❌ Error getting session:', error);\r\n        this._isInitialized = true;\r\n        return;\r\n      }\r\n\r\n      if (session) {\r\n        console.log('🔑 Setting initial session for user:', session.user.email);\r\n        this.currentSession = session;\r\n        this.currentUser = session.user;\r\n        console.log(\r\n          '🔑 Session access token:',\r\n          session.access_token ? 'Exists' : 'Missing'\r\n        );\r\n        await this.loadUserProfile(session.user.id);\r\n      }\r\n\r\n      // Listen for auth state changes\r\n      const {\r\n        data: { subscription },\r\n      } = supabase.auth.onAuthStateChange(async (event, session) => {\r\n        console.log('🔄 Auth state changed:', event, session?.user?.email);\r\n\r\n        this.currentSession = session;\r\n        this.currentUser = session?.user || null;\r\n\r\n        if (session) {\r\n          console.log(\r\n            '🔑 Auth state change - Session access token:',\r\n            session.access_token ? 'Exists' : 'Missing'\r\n          );\r\n        }\r\n\r\n        if (session?.user) {\r\n          await this.loadUserProfile(session.user.id);\r\n        } else {\r\n          this.currentProfile = null;\r\n        }\r\n\r\n        // Notify listeners\r\n        if (this.authStateChangeListener) {\r\n          this.authStateChangeListener();\r\n        }\r\n      });\r\n\r\n      this._isInitialized = true;\r\n      console.log('✅ Auth service initialized');\r\n\r\n      // Cleanup subscription on unmount\r\n      return () => subscription.unsubscribe();\r\n    } catch (error) {\r\n      console.error('❌ Error initializing auth:', error);\r\n      this._isInitialized = true;\r\n    }\r\n  }\r\n\r\n  private async loadUserProfile(userId: string): Promise<void> {\r\n    try {\r\n      // Check if user has dual roles in auth metadata\r\n      const authRoles = this.currentUser?.user_metadata?.roles;\r\n      const isDualRoleUser =\r\n        authRoles && Array.isArray(authRoles) && authRoles.length > 1;\r\n\r\n      if (isDualRoleUser) {\r\n        // For dual-role users, determine role based on current interface\r\n        const currentPath = window.location.pathname;\r\n        let role: 'admin' | 'driver' | 'student' = 'admin'; // Default to admin\r\n\r\n        if (currentPath.includes('/driver')) {\r\n          role = 'driver';\r\n        } else if (currentPath.includes('/admin')) {\r\n          role = 'admin';\r\n        } else {\r\n          // If not on a specific interface, check if admin email\r\n          const adminEmails = import.meta.env.VITE_ADMIN_EMAILS?.split(',').map(\r\n            (email: string) => email.trim().toLowerCase()\r\n          ) || ['siddharthmali.211@gmail.com'];\r\n          role = adminEmails.includes(\r\n            this.currentUser?.email?.toLowerCase() || ''\r\n          )\r\n            ? 'admin'\r\n            : 'driver';\r\n        }\r\n\r\n        // Load profile from database but override role\r\n        const { data: profile, error } = await supabase\r\n          .from('profiles')\r\n          .select('*')\r\n          .eq('id', userId)\r\n          .single();\r\n\r\n        if (error) {\r\n          console.error('❌ Error loading user profile:', error);\r\n          this.setTemporaryProfileWithRoleCheck(userId, this.currentUser);\r\n          return;\r\n        }\r\n\r\n        this.currentProfile = {\r\n          id: profile.id,\r\n          email: this.currentUser?.email || '',\r\n          role: role, // Use determined role instead of database role\r\n          full_name: profile.full_name,\r\n          first_name: profile.full_name?.split(' ')[0] || '',\r\n          last_name: profile.full_name?.split(' ').slice(1).join(' ') || '',\r\n          created_at: profile.created_at,\r\n          updated_at: profile.updated_at,\r\n        };\r\n        return;\r\n      }\r\n\r\n      // Regular single-role user handling\r\n      const { data: profile, error } = await supabase\r\n        .from('profiles')\r\n        .select('*')\r\n        .eq('id', userId)\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error('❌ Error loading user profile:', error);\r\n        // Set temporary profile with role check\r\n        this.setTemporaryProfileWithRoleCheck(userId, this.currentUser);\r\n        return;\r\n      }\r\n\r\n      // Check if this is a known admin user - prioritize admin email over database role\r\n      const adminEmails = import.meta.env.VITE_ADMIN_EMAILS?.split(',').map(\r\n        (email: string) => email.trim().toLowerCase()\r\n      ) || [\r\n        'siddharthmali.211@gmail.com', // Keep this as fallback for development\r\n      ];\r\n\r\n      const isAdmin = adminEmails.includes(\r\n        this.currentUser?.email?.toLowerCase() || ''\r\n      );\r\n      const role = isAdmin ? 'admin' : profile.role;\r\n\r\n      console.log(\r\n        `🔍 User ${this.currentUser?.email} - Database role: ${profile.role}, Admin check: ${isAdmin}, Final role: ${role}`\r\n      );\r\n\r\n      this.currentProfile = {\r\n        id: profile.id,\r\n        email: this.currentUser?.email || '',\r\n        role: role,\r\n        full_name: profile.full_name,\r\n        first_name: profile.full_name?.split(' ')[0] || '',\r\n        last_name: profile.full_name?.split(' ').slice(1).join(' ') || '',\r\n        created_at: profile.created_at,\r\n        updated_at: profile.updated_at,\r\n      };\r\n    } catch (error) {\r\n      console.error('❌ Error in loadUserProfile:', error);\r\n      // Set temporary profile with role check on any error\r\n      this.setTemporaryProfileWithRoleCheck(userId, this.currentUser);\r\n    }\r\n  }\r\n\r\n  // Removed unused setTemporaryProfile function\r\n\r\n  private setTemporaryProfileWithRoleCheck(userId: string, user: any): void {\r\n    console.log('🔄 Setting temporary profile with role check for user login');\r\n\r\n    // Check if this is a known admin user - use environment variable\r\n    const adminEmails = import.meta.env.VITE_ADMIN_EMAILS?.split(',').map(\r\n      (email: string) => email.trim().toLowerCase()\r\n    ) || [\r\n      'siddharthmali.211@gmail.com', // Keep this as fallback for development\r\n    ];\r\n\r\n    const isAdmin = adminEmails.includes(user.email?.toLowerCase() || '');\r\n    const role = isAdmin ? 'admin' : 'student';\r\n\r\n    console.log(`🔍 User ${user.email} assigned role: ${role}`);\r\n\r\n    this.currentProfile = {\r\n      id: userId,\r\n      email: user.email || '',\r\n      role: role,\r\n      full_name:\r\n        user.user_metadata?.full_name || user.email?.split('@')[0] || 'User',\r\n      first_name:\r\n        user.user_metadata?.full_name?.split(' ')[0] ||\r\n        user.email?.split('@')[0] ||\r\n        'User',\r\n      last_name:\r\n        user.user_metadata?.full_name?.split(' ').slice(1).join(' ') || '',\r\n      created_at: new Date().toISOString(),\r\n      updated_at: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // private async createDefaultProfile(userId: string): Promise<void> {\r\n  //   try {\r\n  //     const { data: profile, error } = await supabase\r\n  //       .from('profiles')\r\n  //       .insert({\r\n  //         id: userId,\r\n  //         full_name:\r\n  //           this.currentUser?.user_metadata?.full_name || 'Unknown User',\r\n  //         role: 'admin', // Changed to admin for admin login\r\n  //       })\r\n  //       .select()\r\n  //       .single();\r\n\r\n  //     if (error) {\r\n  //       console.error('❌ Error creating default profile:', error);\r\n  //       return;\r\n  //     }\r\n\r\n  //     this.currentProfile = {\r\n  //       id: profile.id,\r\n  //       email: this.currentUser?.email || '',\r\n  //       role: profile.role,\r\n  //       full_name: profile.full_name,\r\n  //       first_name: profile.full_name?.split(' ')[0] || '',\r\n  //       last_name: profile.full_name?.split(' ').slice(1).join(' ') || '',\r\n  //       created_at: profile.created_at,\r\n  //       updated_at: profile.updated_at,\r\n  //     };\r\n  //   } catch (error) {\r\n  //     console.error('❌ Error in createDefaultProfile:', error);\r\n  //   }\r\n  // }\r\n\r\n  // Sign in with email and password - OPTIMIZED VERSION\r\n  async signIn(\r\n    email: string,\r\n    password: string\r\n  ): Promise<{ success: boolean; error?: string; user?: UserProfile }> {\r\n    try {\r\n      console.log('🔐 Starting sign in process for:', email);\r\n\r\n      // Direct authentication with timeout\r\n      const authPromise = supabase.auth.signInWithPassword({\r\n        email,\r\n        password,\r\n      });\r\n\r\n      const timeoutPromise = new Promise((_, reject) => {\r\n        setTimeout(() => reject(new Error('Authentication timeout')), 5000); // 5s timeout\r\n      });\r\n\r\n      const { data, error } = (await Promise.race([\r\n        authPromise,\r\n        timeoutPromise,\r\n      ])) as any;\r\n\r\n      if (error) {\r\n        console.error('❌ Sign in error:', error);\r\n        return { success: false, error: error.message };\r\n      }\r\n\r\n      console.log('✅ Supabase authentication successful');\r\n\r\n      if (data.user && data.session) {\r\n        console.log('👤 User data received:', data.user.email);\r\n        this.currentUser = data.user;\r\n        this.currentSession = data.session;\r\n\r\n        console.log('📋 Loading user profile...');\r\n        try {\r\n          // Load profile with timeout\r\n          const profilePromise = this.loadUserProfile(data.user.id);\r\n          const profileTimeout = new Promise((_, reject) => {\r\n            setTimeout(\r\n              () => reject(new Error('Profile loading timeout')),\r\n              3000 // Reduced from 5s to 3s for better UX\r\n            );\r\n          });\r\n\r\n          await Promise.race([profilePromise, profileTimeout]);\r\n          console.log('✅ Profile loaded:', this.currentProfile?.role);\r\n        } catch (profileError) {\r\n          console.warn(\r\n            '⚠️ Profile loading failed, using temporary profile:',\r\n            profileError\r\n          );\r\n\r\n          // Set temporary profile immediately for faster response\r\n          this.setTemporaryProfileWithRoleCheck(data.user.id, data.user);\r\n        }\r\n\r\n        // Notify listeners immediately after successful sign in\r\n        if (this.authStateChangeListener) {\r\n          this.authStateChangeListener();\r\n        }\r\n\r\n        return {\r\n          success: true,\r\n          user: this.currentProfile || undefined,\r\n        };\r\n      }\r\n\r\n      console.error('❌ No user or session data received');\r\n      return { success: false, error: 'Authentication failed' };\r\n    } catch (error) {\r\n      console.error('❌ Sign in error:', error);\r\n      if (error instanceof Error && error.message.includes('NetworkError')) {\r\n        return {\r\n          success: false,\r\n          error:\r\n            'Network connection error. Please check your internet connection and try again.',\r\n        };\r\n      }\r\n      if (error instanceof Error && error.message.includes('timeout')) {\r\n        return {\r\n          success: false,\r\n          error: 'Login timed out. Please try again.',\r\n        };\r\n      }\r\n      return { success: false, error: 'Network error during sign in' };\r\n    }\r\n  }\r\n\r\n  // Sign up with email and password\r\n  async signUp(\r\n    email: string,\r\n    password: string,\r\n    profile: Partial<UserProfile>\r\n  ): Promise<{ success: boolean; error?: string }> {\r\n    try {\r\n      const { data, error } = await supabase.auth.signUp({\r\n        email,\r\n        password,\r\n        options: {\r\n          data: {\r\n            full_name: profile.full_name,\r\n            role: profile.role || 'student',\r\n          },\r\n        },\r\n      });\r\n\r\n      if (error) {\r\n        console.error('❌ Sign up error:', error);\r\n        return { success: false, error: error.message };\r\n      }\r\n\r\n      if (data.user) {\r\n        // Create profile in profiles table\r\n        const { error: profileError } = await supabase.from('profiles').insert({\r\n          id: data.user.id,\r\n          full_name: profile.full_name || 'Unknown User',\r\n          role: profile.role || 'student',\r\n        });\r\n\r\n        if (profileError) {\r\n          console.error('❌ Error creating profile:', profileError);\r\n          return { success: false, error: 'Profile creation failed' };\r\n        }\r\n\r\n        return { success: true };\r\n      }\r\n\r\n      return { success: false, error: 'Registration failed' };\r\n    } catch (error) {\r\n      console.error('❌ Sign up error:', error);\r\n      return { success: false, error: 'Network error during sign up' };\r\n    }\r\n  }\r\n\r\n  // Sign out\r\n  async signOut(): Promise<{ success: boolean; error?: string }> {\r\n    try {\r\n      console.log('🔐 Starting sign out process...');\r\n\r\n      const { error } = await supabase.auth.signOut();\r\n\r\n      if (error) {\r\n        console.error('❌ Sign out error:', error);\r\n        return { success: false, error: error.message };\r\n      }\r\n\r\n      console.log('✅ Sign out successful');\r\n\r\n      // Clear all auth state\r\n      this.currentUser = null;\r\n      this.currentSession = null;\r\n      this.currentProfile = null;\r\n\r\n      // Notify listeners immediately after sign out\r\n      if (this.authStateChangeListener) {\r\n        this.authStateChangeListener();\r\n      }\r\n\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('❌ Sign out error:', error);\r\n      return { success: false, error: 'Network error during sign out' };\r\n    }\r\n  }\r\n\r\n  // Get current user\r\n  getCurrentUser(): User | null {\r\n    return this.currentUser;\r\n  }\r\n\r\n  // Get current session\r\n  getCurrentSession(): Session | null {\r\n    return this.currentSession;\r\n  }\r\n\r\n  // Get current user profile\r\n  getCurrentProfile(): UserProfile | null {\r\n    return this.currentProfile;\r\n  }\r\n\r\n  // Check if auth service is initialized\r\n  isInitialized(): boolean {\r\n    return this._isInitialized;\r\n  }\r\n\r\n  // Check if user is authenticated\r\n  isAuthenticated(): boolean {\r\n    return !!this.currentUser && !!this.currentSession;\r\n  }\r\n\r\n  // Check if user has specific role\r\n  hasRole(role: string): boolean {\r\n    return this.currentProfile?.role === role;\r\n  }\r\n\r\n  // Check if user is admin\r\n  isAdmin(): boolean {\r\n    return this.hasRole('admin');\r\n  }\r\n\r\n  // Check if user is driver\r\n  isDriver(): boolean {\r\n    return this.hasRole('driver');\r\n  }\r\n\r\n  // Check if user is student\r\n  isStudent(): boolean {\r\n    return this.hasRole('student');\r\n  }\r\n\r\n  // Get access token for API calls\r\n  getAccessToken(): string | null {\r\n    // First try to get from current session\r\n    let token = this.currentSession?.access_token || null;\r\n\r\n    // If no token in current session, try to get from localStorage as fallback\r\n    if (!token) {\r\n      try {\r\n        // Try multiple localStorage keys that Supabase might use\r\n        const possibleKeys = [\r\n          'supabase.auth.token',\r\n          'sb-gthwmwfwvhyriygpcdlr-auth-token', // Supabase project-specific key\r\n          'supabase.auth.session',\r\n        ];\r\n\r\n        for (const key of possibleKeys) {\r\n          const storedSession = localStorage.getItem(key);\r\n          if (storedSession) {\r\n            const parsedSession = JSON.parse(storedSession);\r\n            token =\r\n              parsedSession?.currentSession?.access_token ||\r\n              parsedSession?.access_token ||\r\n              parsedSession?.session?.access_token ||\r\n              null;\r\n\r\n            if (token) {\r\n              console.log(\r\n                `🔑 Retrieved token from localStorage fallback (${key})`\r\n              );\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.warn('⚠️ Error reading token from localStorage:', error);\r\n      }\r\n    }\r\n\r\n    console.log(\r\n      '🔑 getAccessToken called:',\r\n      token ? 'Token exists' : 'No token',\r\n      'Session:',\r\n      !!this.currentSession\r\n    );\r\n    return token;\r\n  }\r\n\r\n  // Enhanced token validation for API calls with automatic refresh\r\n  async validateTokenForAPI(): Promise<{\r\n    valid: boolean;\r\n    token: string | null;\r\n    refreshed: boolean;\r\n  }> {\r\n    let token = this.getAccessToken();\r\n    let refreshed = false;\r\n\r\n    if (!token) {\r\n      return { valid: false, token: null, refreshed: false };\r\n    }\r\n\r\n    try {\r\n      // First, try to validate the current token\r\n      const {\r\n        data: { user },\r\n        error,\r\n      } = await supabase.auth.getUser(token);\r\n\r\n      if (error || !user) {\r\n        console.log(\r\n          '🔄 Token validation failed, attempting refresh:',\r\n          error?.message\r\n        );\r\n\r\n        // Try to refresh the session\r\n        const refreshResult = await this.refreshSession();\r\n        if (refreshResult.success) {\r\n          token = this.getAccessToken();\r\n          refreshed = true;\r\n          console.log('✅ Token refreshed successfully');\r\n        } else {\r\n          console.log('❌ Token refresh failed:', refreshResult.error);\r\n          return { valid: false, token: null, refreshed: false };\r\n        }\r\n      }\r\n\r\n      // Validate the token again (either original or refreshed)\r\n      if (token) {\r\n        const {\r\n          data: { user: validatedUser },\r\n          error: validationError,\r\n        } = await supabase.auth.getUser(token);\r\n\r\n        if (validationError || !validatedUser) {\r\n          console.log(\r\n            '❌ Final token validation failed:',\r\n            validationError?.message\r\n          );\r\n          return { valid: false, token: null, refreshed };\r\n        }\r\n\r\n        return { valid: true, token, refreshed };\r\n      }\r\n\r\n      return { valid: false, token: null, refreshed };\r\n    } catch (error) {\r\n      console.error('❌ Token validation error:', error);\r\n      return { valid: false, token: null, refreshed: false };\r\n    }\r\n  }\r\n\r\n  // Refresh session\r\n  async refreshSession(): Promise<{ success: boolean; error?: string }> {\r\n    try {\r\n      // Check if we have a current session before attempting refresh\r\n      if (!this.currentSession) {\r\n        console.log('🔄 No current session to refresh');\r\n        return { success: false, error: 'No session to refresh' };\r\n      }\r\n\r\n      const { data, error } = await supabase.auth.refreshSession();\r\n\r\n      if (error) {\r\n        // Don't log AuthSessionMissingError as an error since it's expected when no session exists\r\n        if (error.message.includes('Auth session missing')) {\r\n          console.log(\r\n            '🔄 No session to refresh (expected for unauthenticated users)'\r\n          );\r\n          return { success: false, error: 'No session to refresh' };\r\n        }\r\n        console.error('❌ Session refresh error:', error);\r\n        return { success: false, error: error.message };\r\n      }\r\n\r\n      if (data.session) {\r\n        this.currentSession = data.session;\r\n        this.currentUser = data.user;\r\n        return { success: true };\r\n      }\r\n\r\n      return { success: false, error: 'Session refresh failed' };\r\n    } catch (error) {\r\n      console.error('❌ Session refresh error:', error);\r\n      return { success: false, error: 'Network error during session refresh' };\r\n    }\r\n  }\r\n\r\n  // Update user profile\r\n  async updateProfile(\r\n    updates: Partial<UserProfile>\r\n  ): Promise<{ success: boolean; error?: string }> {\r\n    if (!this.currentUser) {\r\n      return { success: false, error: 'No authenticated user' };\r\n    }\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from('profiles')\r\n        .update(updates)\r\n        .eq('id', this.currentUser.id);\r\n\r\n      if (error) {\r\n        console.error('❌ Profile update error:', error);\r\n        return { success: false, error: error.message };\r\n      }\r\n\r\n      // Reload profile\r\n      await this.loadUserProfile(this.currentUser.id);\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('❌ Profile update error:', error);\r\n      return { success: false, error: 'Network error during profile update' };\r\n    }\r\n  }\r\n\r\n  // Set auth state change listener\r\n  onAuthStateChange(listener: () => void): void {\r\n    this.authStateChangeListener = listener;\r\n  }\r\n\r\n  // Remove auth state change listener\r\n  removeAuthStateChangeListener(): void {\r\n    this.authStateChangeListener = null;\r\n  }\r\n\r\n  // Debug method to get current auth state\r\n  getAuthState() {\r\n    return {\r\n      initialized: this._isInitialized,\r\n      user: this.currentUser,\r\n      session: this.currentSession,\r\n      profile: this.currentProfile,\r\n      isAuthenticated: this.isAuthenticated(),\r\n      isAdmin: this.isAdmin(),\r\n    };\r\n  }\r\n\r\n  // Method to force a fresh login and clear any stale sessions\r\n  async forceFreshLogin(): Promise<{ success: boolean; error?: string }> {\r\n    try {\r\n      console.log('🔄 Forcing fresh login...');\r\n\r\n      // Clear all localStorage auth data\r\n      const keysToRemove = [];\r\n      for (let i = 0; i < localStorage.length; i++) {\r\n        const key = localStorage.key(i);\r\n        if (\r\n          key &&\r\n          (key.includes('supabase') ||\r\n            key.includes('auth') ||\r\n            key.includes('sb-'))\r\n        ) {\r\n          keysToRemove.push(key);\r\n        }\r\n      }\r\n\r\n      keysToRemove.forEach((key) => {\r\n        localStorage.removeItem(key);\r\n        console.log(`🗑️ Removed localStorage key: ${key}`);\r\n      });\r\n\r\n      // Clear current session\r\n      this.currentSession = null;\r\n      this.currentUser = null;\r\n      this.currentProfile = null;\r\n\r\n      console.log('✅ Fresh login state prepared');\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('❌ Error forcing fresh login:', error);\r\n      return { success: false, error: 'Failed to force fresh login' };\r\n    }\r\n  }\r\n\r\n  // Method to recover session from localStorage for cross-device scenarios\r\n  async recoverSession(): Promise<{ success: boolean; error?: string }> {\r\n    try {\r\n      console.log('🔄 Attempting to recover session from localStorage...');\r\n\r\n      // Try multiple localStorage keys that Supabase might use\r\n      const possibleKeys = [\r\n        'supabase.auth.token',\r\n        'sb-gthwmwfwvhyriygpcdlr-auth-token', // Supabase project-specific key\r\n        'supabase.auth.session',\r\n      ];\r\n\r\n      let storedSession = null;\r\n      let usedKey = null;\r\n\r\n      for (const key of possibleKeys) {\r\n        const stored = localStorage.getItem(key);\r\n        if (stored) {\r\n          storedSession = stored;\r\n          usedKey = key;\r\n          console.log(`📝 Found session in localStorage key: ${key}`);\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (!storedSession) {\r\n        console.log('📝 No stored session found in any localStorage key');\r\n        return { success: false, error: 'No stored session' };\r\n      }\r\n\r\n      let parsedSession;\r\n      try {\r\n        parsedSession = JSON.parse(storedSession);\r\n      } catch (parseError) {\r\n        console.log('❌ Failed to parse stored session:', parseError);\r\n        return { success: false, error: 'Invalid session format' };\r\n      }\r\n\r\n      // Try different session structures\r\n      const accessToken =\r\n        parsedSession?.currentSession?.access_token ||\r\n        parsedSession?.access_token ||\r\n        parsedSession?.session?.access_token;\r\n\r\n      if (!accessToken) {\r\n        console.log(\r\n          '🔑 No access token found in stored session structure:',\r\n          parsedSession\r\n        );\r\n        return { success: false, error: 'No access token in stored session' };\r\n      }\r\n\r\n      console.log('🔑 Found access token, validating...');\r\n\r\n      // Verify the token is still valid\r\n      const {\r\n        data: { user },\r\n        error,\r\n      } = await supabase.auth.getUser(accessToken);\r\n\r\n      if (error || !user) {\r\n        console.log('❌ Stored token is invalid:', error?.message);\r\n        if (usedKey) {\r\n          localStorage.removeItem(usedKey);\r\n        }\r\n        return { success: false, error: 'Stored token is invalid' };\r\n      }\r\n\r\n      // Set the recovered session\r\n      this.currentSession = {\r\n        access_token: accessToken,\r\n        refresh_token:\r\n          parsedSession?.currentSession?.refresh_token ||\r\n          parsedSession?.refresh_token,\r\n        expires_in:\r\n          parsedSession?.currentSession?.expires_in ||\r\n          parsedSession?.expires_in,\r\n        token_type: 'bearer',\r\n        user: user,\r\n      } as Session;\r\n\r\n      this.currentUser = user;\r\n\r\n      // Load user profile\r\n      await this.loadUserProfile(user.id);\r\n\r\n      console.log('✅ Session recovered successfully for user:', user.email);\r\n      return { success: true };\r\n    } catch (error) {\r\n      console.error('❌ Error recovering session:', error);\r\n      return { success: false, error: 'Failed to recover session' };\r\n    }\r\n  }\r\n\r\n  // New methods for proper authentication state management\r\n\r\n  /**\r\n   * Get driver-bus assignment from database\r\n   */\r\n  async getDriverBusAssignment(\r\n    driverId: string\r\n  ): Promise<DriverBusAssignment | null> {\r\n    try {\r\n      // Get bus assignment directly from buses table (matching backend logic)\r\n      const { data: busData, error: busError } = await supabase\r\n        .from('buses')\r\n        .select('id, number_plate, route_id')\r\n        .eq('assigned_driver_id', driverId)\r\n        .eq('is_active', true)\r\n        .single();\r\n\r\n      if (busError || !busData) {\r\n        console.error('❌ Error fetching bus assignment:', busError);\r\n        return null;\r\n      }\r\n\r\n      // Get route information\r\n      let routeName = '';\r\n      if (busData.route_id) {\r\n        const { data: routeData, error: routeError } = await supabase\r\n          .from('routes')\r\n          .select('name')\r\n          .eq('id', busData.route_id)\r\n          .single();\r\n\r\n        if (!routeError && routeData) {\r\n          routeName = routeData.name;\r\n        }\r\n      }\r\n\r\n      // Get driver name from profiles\r\n      let driverName = 'Unknown Driver';\r\n      const { data: profileData, error: profileError } = await supabase\r\n        .from('profiles')\r\n        .select('full_name')\r\n        .eq('id', driverId)\r\n        .single();\r\n\r\n      if (!profileError && profileData?.full_name) {\r\n        driverName = profileData.full_name;\r\n      } else {\r\n        // Fallback to users table\r\n        const { data: userData, error: userError } = await supabase\r\n          .from('users')\r\n          .select('first_name, last_name')\r\n          .eq('id', driverId)\r\n          .single();\r\n\r\n        if (!userError && userData) {\r\n          driverName =\r\n            `${userData.first_name || ''} ${userData.last_name || ''}`.trim() ||\r\n            'Unknown Driver';\r\n        }\r\n      }\r\n\r\n      return {\r\n        driver_id: driverId,\r\n        bus_id: busData.id,\r\n        bus_number: busData.number_plate,\r\n        route_id: busData.route_id || '',\r\n        route_name: routeName,\r\n        driver_name: driverName,\r\n        created_at: new Date().toISOString(),\r\n        updated_at: new Date().toISOString(),\r\n      };\r\n    } catch (error) {\r\n      console.error('❌ Error in getDriverBusAssignment:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Store driver-bus assignment in database\r\n   */\r\n  async storeDriverBusAssignment(\r\n    assignment: Omit<DriverBusAssignment, 'created_at' | 'updated_at'>\r\n  ): Promise<boolean> {\r\n    try {\r\n      // Since the backend already has the assignment in the buses table,\r\n      // we just need to store the assignment in memory for the frontend\r\n      this.currentDriverAssignment = {\r\n        ...assignment,\r\n        created_at: new Date().toISOString(),\r\n        updated_at: new Date().toISOString(),\r\n      };\r\n\r\n      console.log('✅ Driver bus assignment stored in memory successfully');\r\n      return true;\r\n    } catch (error) {\r\n      console.error('❌ Error in storeDriverBusAssignment:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear driver-bus assignment from database\r\n   */\r\n  async clearDriverBusAssignment(): Promise<boolean> {\r\n    try {\r\n      // Just clear from memory since the backend handles the actual assignment\r\n      this.currentDriverAssignment = null;\r\n      console.log('✅ Driver bus assignment cleared from memory');\r\n      return true;\r\n    } catch (error) {\r\n      console.error('❌ Error in clearDriverBusAssignment:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current driver assignment from memory (cached)\r\n   */\r\n  getCurrentDriverAssignment(): DriverBusAssignment | null {\r\n    return this.currentDriverAssignment;\r\n  }\r\n\r\n  /**\r\n   * Validate session and refresh if needed\r\n   */\r\n  async validateSession(): Promise<boolean> {\r\n    try {\r\n      const {\r\n        data: { session },\r\n        error,\r\n      } = await supabase.auth.getSession();\r\n\r\n      if (error) {\r\n        console.error('❌ Session validation error:', error);\r\n        return false;\r\n      }\r\n\r\n      if (!session) {\r\n        console.log('❌ No active session found');\r\n        return false;\r\n      }\r\n\r\n      // Check if session is expired or about to expire\r\n      const expiresAt = new Date(session.expires_at! * 1000);\r\n      const now = new Date();\r\n      const timeUntilExpiry = expiresAt.getTime() - now.getTime();\r\n\r\n      // If session expires in less than 5 minutes, refresh it\r\n      if (timeUntilExpiry < 5 * 60 * 1000) {\r\n        console.log('🔄 Session expiring soon, refreshing...');\r\n        const {\r\n          data: { session: refreshedSession },\r\n          error: refreshError,\r\n        } = await supabase.auth.refreshSession();\r\n\r\n        if (refreshError) {\r\n          console.error('❌ Session refresh error:', refreshError);\r\n          return false;\r\n        }\r\n\r\n        if (refreshedSession) {\r\n          this.currentSession = refreshedSession;\r\n          this.currentUser = refreshedSession.user;\r\n          console.log('✅ Session refreshed successfully');\r\n        }\r\n      }\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('❌ Error validating session:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if user has valid driver session\r\n   */\r\n  async validateDriverSession(): Promise<{\r\n    isValid: boolean;\r\n    assignment: DriverBusAssignment | null;\r\n  }> {\r\n    try {\r\n      // First validate the session\r\n      const isSessionValid = await this.validateSession();\r\n      if (!isSessionValid) {\r\n        return { isValid: false, assignment: null };\r\n      }\r\n\r\n      // Check if user is a driver\r\n      if (this.currentProfile?.role !== 'driver') {\r\n        console.log('❌ User is not a driver');\r\n        return { isValid: false, assignment: null };\r\n      }\r\n\r\n      // Get driver assignment from database\r\n      const assignment = await this.getDriverBusAssignment(\r\n        this.currentUser!.id\r\n      );\r\n      if (!assignment) {\r\n        console.log('❌ No active bus assignment found for driver');\r\n        return { isValid: false, assignment: null };\r\n      }\r\n\r\n      this.currentDriverAssignment = assignment;\r\n      return { isValid: true, assignment };\r\n    } catch (error) {\r\n      console.error('❌ Error validating driver session:', error);\r\n      return { isValid: false, assignment: null };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logout and clear all session data\r\n   */\r\n  async logout(): Promise<void> {\r\n    try {\r\n      // Clear driver assignment if exists\r\n      if (this.currentUser && this.currentProfile?.role === 'driver') {\r\n        await this.clearDriverBusAssignment();\r\n      }\r\n\r\n      // Clear current state\r\n      this.currentUser = null;\r\n      this.currentSession = null;\r\n      this.currentProfile = null;\r\n      this.currentDriverAssignment = null;\r\n\r\n      // Sign out from Supabase\r\n      const { error } = await supabase.auth.signOut();\r\n      if (error) {\r\n        console.error('❌ Error signing out:', error);\r\n      } else {\r\n        console.log('✅ Logged out successfully');\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in logout:', error);\r\n    }\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const authService = new AuthService();\r\nexport default authService;\r\n","// Circuit Breaker Pattern Implementation\r\nexport interface CircuitBreakerConfig {\r\n  failureThreshold: number; // Number of failures before opening circuit\r\n  recoveryTimeout: number; // Time in ms to wait before attempting recovery\r\n  expectedErrors: string[]; // Error patterns that should not count as failures\r\n  monitorInterval: number; // Interval to check circuit state\r\n}\r\n\r\nexport type CircuitState = 'CLOSED' | 'OPEN' | 'HALF_OPEN';\r\n\r\nexport interface CircuitMetrics {\r\n  totalRequests: number;\r\n  successfulRequests: number;\r\n  failedRequests: number;\r\n  lastFailureTime?: number;\r\n  lastSuccessTime?: number;\r\n  currentState: CircuitState;\r\n  failureCount: number;\r\n}\r\n\r\nclass CircuitBreaker {\r\n  private state: CircuitState = 'CLOSED';\r\n  private failureCount: number = 0;\r\n  private lastFailureTime?: number;\r\n  private lastSuccessTime?: number;\r\n  private nextAttemptTime?: number;\r\n  private totalRequests: number = 0;\r\n  private successfulRequests: number = 0;\r\n  private failedRequests: number = 0;\r\n  private monitorTimer?: NodeJS.Timeout;\r\n\r\n  constructor(\r\n    private name: string,\r\n    private config: CircuitBreakerConfig = {\r\n      failureThreshold: 5,\r\n      recoveryTimeout: 60000, // 1 minute\r\n      expectedErrors: [],\r\n      monitorInterval: 30000, // 30 seconds\r\n    }\r\n  ) {\r\n    this.startMonitoring();\r\n  }\r\n\r\n  // Execute a function with circuit breaker protection\r\n  async execute<T>(\r\n    operation: () => Promise<T>,\r\n    fallback?: () => Promise<T>\r\n  ): Promise<T> {\r\n    this.totalRequests++;\r\n\r\n    // Check if circuit is open\r\n    if (this.state === 'OPEN') {\r\n      if (this.shouldAttemptReset()) {\r\n        this.transitionToHalfOpen();\r\n      } else {\r\n        console.warn(`🚨 Circuit breaker '${this.name}' is OPEN, using fallback`);\r\n        if (fallback) {\r\n          return fallback();\r\n        }\r\n        throw new Error(`Circuit breaker '${this.name}' is OPEN`);\r\n      }\r\n    }\r\n\r\n    try {\r\n      const result = await operation();\r\n      this.onSuccess();\r\n      return result;\r\n    } catch (error) {\r\n      this.onFailure(error);\r\n      \r\n      // If we have a fallback, use it\r\n      if (fallback) {\r\n        console.log(`🔄 Using fallback for '${this.name}' due to error:`, error);\r\n        return fallback();\r\n      }\r\n      \r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private onSuccess(): void {\r\n    this.successfulRequests++;\r\n    this.lastSuccessTime = Date.now();\r\n    this.failureCount = 0;\r\n    \r\n    if (this.state === 'HALF_OPEN') {\r\n      this.transitionToClosed();\r\n    }\r\n  }\r\n\r\n  private onFailure(error: any): void {\r\n    this.failedRequests++;\r\n    this.lastFailureTime = Date.now();\r\n\r\n    // Check if this is an expected error\r\n    const errorMessage = error?.message || error?.toString() || '';\r\n    const isExpectedError = this.config.expectedErrors.some(pattern =>\r\n      errorMessage.includes(pattern)\r\n    );\r\n\r\n    if (!isExpectedError) {\r\n      this.failureCount++;\r\n      \r\n      if (this.failureCount >= this.config.failureThreshold) {\r\n        this.transitionToOpen();\r\n      }\r\n    }\r\n  }\r\n\r\n  private transitionToOpen(): void {\r\n    if (this.state !== 'OPEN') {\r\n      console.warn(`🚨 Circuit breaker '${this.name}' transitioning to OPEN`);\r\n      this.state = 'OPEN';\r\n      this.nextAttemptTime = Date.now() + this.config.recoveryTimeout;\r\n    }\r\n  }\r\n\r\n  private transitionToHalfOpen(): void {\r\n    console.log(`🔄 Circuit breaker '${this.name}' transitioning to HALF_OPEN`);\r\n    this.state = 'HALF_OPEN';\r\n  }\r\n\r\n  private transitionToClosed(): void {\r\n    console.log(`✅ Circuit breaker '${this.name}' transitioning to CLOSED`);\r\n    this.state = 'CLOSED';\r\n    this.failureCount = 0;\r\n    this.nextAttemptTime = undefined;\r\n  }\r\n\r\n  private shouldAttemptReset(): boolean {\r\n    return this.nextAttemptTime !== undefined && Date.now() >= this.nextAttemptTime;\r\n  }\r\n\r\n  private startMonitoring(): void {\r\n    this.monitorTimer = setInterval(() => {\r\n      this.logMetrics();\r\n    }, this.config.monitorInterval);\r\n  }\r\n\r\n  private logMetrics(): void {\r\n    const metrics = this.getMetrics();\r\n    console.log(`📊 Circuit Breaker '${this.name}' Metrics:`, {\r\n      state: metrics.currentState,\r\n      successRate: metrics.totalRequests > 0 \r\n        ? ((metrics.successfulRequests / metrics.totalRequests) * 100).toFixed(2) + '%'\r\n        : '0%',\r\n      failureCount: metrics.failureCount,\r\n      totalRequests: metrics.totalRequests,\r\n    });\r\n  }\r\n\r\n  // Get current circuit metrics\r\n  getMetrics(): CircuitMetrics {\r\n    return {\r\n      totalRequests: this.totalRequests,\r\n      successfulRequests: this.successfulRequests,\r\n      failedRequests: this.failedRequests,\r\n      lastFailureTime: this.lastFailureTime,\r\n      lastSuccessTime: this.lastSuccessTime,\r\n      currentState: this.state,\r\n      failureCount: this.failureCount,\r\n    };\r\n  }\r\n\r\n  // Reset circuit to closed state\r\n  reset(): void {\r\n    console.log(`🔄 Resetting circuit breaker '${this.name}'`);\r\n    this.transitionToClosed();\r\n  }\r\n\r\n  // Clean up resources\r\n  destroy(): void {\r\n    if (this.monitorTimer) {\r\n      clearInterval(this.monitorTimer);\r\n    }\r\n  }\r\n}\r\n\r\n// Circuit Breaker Registry\r\nclass CircuitBreakerRegistry {\r\n  private breakers: Map<string, CircuitBreaker> = new Map();\r\n\r\n  create(\r\n    name: string,\r\n    config?: CircuitBreakerConfig\r\n  ): CircuitBreaker {\r\n    if (this.breakers.has(name)) {\r\n      return this.breakers.get(name)!;\r\n    }\r\n\r\n    const breaker = new CircuitBreaker(name, config);\r\n    this.breakers.set(name, breaker);\r\n    return breaker;\r\n  }\r\n\r\n  get(name: string): CircuitBreaker | undefined {\r\n    return this.breakers.get(name);\r\n  }\r\n\r\n  getAll(): Map<string, CircuitBreaker> {\r\n    return new Map(this.breakers);\r\n  }\r\n\r\n  reset(name: string): void {\r\n    const breaker = this.breakers.get(name);\r\n    if (breaker) {\r\n      breaker.reset();\r\n    }\r\n  }\r\n\r\n  resetAll(): void {\r\n    this.breakers.forEach(breaker => breaker.reset());\r\n  }\r\n\r\n  destroy(): void {\r\n    this.breakers.forEach(breaker => breaker.destroy());\r\n    this.breakers.clear();\r\n  }\r\n}\r\n\r\n// Global registry instance\r\nexport const circuitBreakerRegistry = new CircuitBreakerRegistry();\r\n\r\n// Pre-configured circuit breakers\r\nexport const apiCircuitBreaker = circuitBreakerRegistry.create('api', {\r\n  failureThreshold: 3,\r\n  recoveryTimeout: 30000, // 30 seconds\r\n  expectedErrors: ['401', '403', '404'], // Don't count auth/not found as failures\r\n  monitorInterval: 15000, // 15 seconds\r\n});\r\n\r\nexport const websocketCircuitBreaker = circuitBreakerRegistry.create('websocket', {\r\n  failureThreshold: 5,\r\n  recoveryTimeout: 60000, // 1 minute\r\n  expectedErrors: [],\r\n  monitorInterval: 30000, // 30 seconds\r\n});\r\n\r\nexport const supabaseCircuitBreaker = circuitBreakerRegistry.create('supabase', {\r\n  failureThreshold: 3,\r\n  recoveryTimeout: 45000, // 45 seconds\r\n  expectedErrors: ['401', '403'],\r\n  monitorInterval: 20000, // 20 seconds\r\n});\r\n\r\nexport default CircuitBreaker;\r\n","// Exponential Backoff Implementation\r\nexport interface BackoffConfig {\r\n  initialDelay: number; // Initial delay in ms\r\n  maxDelay: number; // Maximum delay in ms\r\n  multiplier: number; // Multiplier for each retry\r\n  maxAttempts: number; // Maximum number of attempts\r\n  jitter: boolean; // Whether to add random jitter\r\n  jitterFactor: number; // Jitter factor (0-1)\r\n}\r\n\r\nexport interface BackoffResult<T> {\r\n  success: boolean;\r\n  result?: T;\r\n  error?: Error;\r\n  attempts: number;\r\n  totalTime: number;\r\n}\r\n\r\nclass ExponentialBackoff {\r\n  private attemptCount: number = 0;\r\n  private startTime: number = 0;\r\n\r\n  constructor(\r\n    private config: BackoffConfig = {\r\n      initialDelay: 1000, // 1 second\r\n      maxDelay: 30000, // 30 seconds\r\n      multiplier: 2,\r\n      maxAttempts: 5,\r\n      jitter: true,\r\n      jitterFactor: 0.1,\r\n    }\r\n  ) {}\r\n\r\n  // Execute a function with exponential backoff\r\n  async execute<T>(\r\n    operation: () => Promise<T>,\r\n    onRetry?: (attempt: number, delay: number, error: Error) => void\r\n  ): Promise<BackoffResult<T>> {\r\n    this.attemptCount = 0;\r\n    this.startTime = Date.now();\r\n\r\n    while (this.attemptCount < this.config.maxAttempts) {\r\n      try {\r\n        const result = await operation();\r\n        return {\r\n          success: true,\r\n          result,\r\n          attempts: this.attemptCount + 1,\r\n          totalTime: Date.now() - this.startTime,\r\n        };\r\n      } catch (error) {\r\n        this.attemptCount++;\r\n        \r\n        if (this.attemptCount >= this.config.maxAttempts) {\r\n          return {\r\n            success: false,\r\n            error: error instanceof Error ? error : new Error(String(error)),\r\n            attempts: this.attemptCount,\r\n            totalTime: Date.now() - this.startTime,\r\n          };\r\n        }\r\n\r\n        const delay = this.calculateDelay();\r\n        \r\n        if (onRetry) {\r\n          onRetry(this.attemptCount, delay, error instanceof Error ? error : new Error(String(error)));\r\n        }\r\n\r\n        console.log(`🔄 Retry attempt ${this.attemptCount}/${this.config.maxAttempts} in ${delay}ms`);\r\n        \r\n        await this.sleep(delay);\r\n      }\r\n    }\r\n\r\n    return {\r\n      success: false,\r\n      error: new Error('Max retry attempts exceeded'),\r\n      attempts: this.attemptCount,\r\n      totalTime: Date.now() - this.startTime,\r\n    };\r\n  }\r\n\r\n  // Calculate delay for current attempt\r\n  private calculateDelay(): number {\r\n    const baseDelay = Math.min(\r\n      this.config.initialDelay * Math.pow(this.config.multiplier, this.attemptCount - 1),\r\n      this.config.maxDelay\r\n    );\r\n\r\n    if (!this.config.jitter) {\r\n      return baseDelay;\r\n    }\r\n\r\n    // Add jitter to prevent thundering herd\r\n    const jitterRange = baseDelay * this.config.jitterFactor;\r\n    const jitter = (Math.random() - 0.5) * jitterRange;\r\n    \r\n    return Math.max(0, baseDelay + jitter);\r\n  }\r\n\r\n  // Sleep for specified duration\r\n  private sleep(ms: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n  // Reset backoff state\r\n  reset(): void {\r\n    this.attemptCount = 0;\r\n    this.startTime = 0;\r\n  }\r\n\r\n  // Get current attempt count\r\n  getAttemptCount(): number {\r\n    return this.attemptCount;\r\n  }\r\n\r\n  // Get remaining attempts\r\n  getRemainingAttempts(): number {\r\n    return Math.max(0, this.config.maxAttempts - this.attemptCount);\r\n  }\r\n}\r\n\r\n// Pre-configured backoff strategies\r\nexport const quickBackoff = new ExponentialBackoff({\r\n  initialDelay: 500,\r\n  maxDelay: 5000,\r\n  multiplier: 1.5,\r\n  maxAttempts: 3,\r\n  jitter: true,\r\n  jitterFactor: 0.1,\r\n});\r\n\r\nexport const standardBackoff = new ExponentialBackoff({\r\n  initialDelay: 1000,\r\n  maxDelay: 30000,\r\n  multiplier: 2,\r\n  maxAttempts: 5,\r\n  jitter: true,\r\n  jitterFactor: 0.15,\r\n});\r\n\r\nexport const aggressiveBackoff = new ExponentialBackoff({\r\n  initialDelay: 2000,\r\n  maxDelay: 60000,\r\n  multiplier: 2.5,\r\n  maxAttempts: 7,\r\n  jitter: true,\r\n  jitterFactor: 0.2,\r\n});\r\n\r\nexport const websocketBackoff = new ExponentialBackoff({\r\n  initialDelay: 1000,\r\n  maxDelay: 30000,\r\n  multiplier: 2,\r\n  maxAttempts: 10,\r\n  jitter: true,\r\n  jitterFactor: 0.1,\r\n});\r\n\r\nexport default ExponentialBackoff;\r\n","// Offline-First Architecture with IndexedDB\r\nexport interface OfflineData {\r\n  id: string;\r\n  type: 'bus' | 'route' | 'location' | 'driver' | 'user';\r\n  data: any;\r\n  timestamp: number;\r\n  version: number;\r\n  syncStatus: 'synced' | 'pending' | 'failed';\r\n}\r\n\r\nexport interface SyncQueueItem {\r\n  id: string;\r\n  operation: 'create' | 'update' | 'delete';\r\n  endpoint: string;\r\n  data: any;\r\n  timestamp: number;\r\n  retryCount: number;\r\n}\r\n\r\nexport interface OfflineConfig {\r\n  dbName: string;\r\n  dbVersion: number;\r\n  maxAge: number; // Max age of cached data in ms\r\n  maxSize: number; // Max number of items to store\r\n  syncInterval: number; // Sync interval in ms\r\n}\r\n\r\nclass OfflineStorage {\r\n  private db: IDBDatabase | null = null;\r\n  private syncTimer: NodeJS.Timeout | null = null;\r\n  private isOnline: boolean = navigator.onLine;\r\n\r\n  constructor(\r\n    private config: OfflineConfig = {\r\n      dbName: 'BusTrackingOffline',\r\n      dbVersion: 1,\r\n      maxAge: 24 * 60 * 60 * 1000, // 24 hours\r\n      maxSize: 1000,\r\n      syncInterval: 30000, // 30 seconds\r\n    }\r\n  ) {\r\n    this.initializeDB();\r\n    this.setupNetworkListeners();\r\n    this.startSyncTimer();\r\n  }\r\n\r\n  // Initialize IndexedDB\r\n  private async initializeDB(): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n      const request = indexedDB.open(this.config.dbName, this.config.dbVersion);\r\n\r\n      request.onerror = () => {\r\n        console.error('❌ Failed to open IndexedDB:', request.error);\r\n        reject(request.error);\r\n      };\r\n\r\n      request.onsuccess = () => {\r\n        this.db = request.result;\r\n        console.log('✅ IndexedDB initialized successfully');\r\n        resolve();\r\n      };\r\n\r\n      request.onupgradeneeded = (event) => {\r\n        const db = (event.target as IDBOpenDBRequest).result;\r\n\r\n        // Create object stores\r\n        if (!db.objectStoreNames.contains('offlineData')) {\r\n          const dataStore = db.createObjectStore('offlineData', { keyPath: 'id' });\r\n          dataStore.createIndex('type', 'type', { unique: false });\r\n          dataStore.createIndex('timestamp', 'timestamp', { unique: false });\r\n          dataStore.createIndex('syncStatus', 'syncStatus', { unique: false });\r\n        }\r\n\r\n        if (!db.objectStoreNames.contains('syncQueue')) {\r\n          const queueStore = db.createObjectStore('syncQueue', { keyPath: 'id' });\r\n          queueStore.createIndex('timestamp', 'timestamp', { unique: false });\r\n          queueStore.createIndex('retryCount', 'retryCount', { unique: false });\r\n        }\r\n\r\n        console.log('✅ IndexedDB schema upgraded');\r\n      };\r\n    });\r\n  }\r\n\r\n  // Setup network status listeners\r\n  private setupNetworkListeners(): void {\r\n    window.addEventListener('online', () => {\r\n      this.isOnline = true;\r\n      console.log('🌐 Network connection restored');\r\n      this.syncPendingData();\r\n    });\r\n\r\n    window.addEventListener('offline', () => {\r\n      this.isOnline = false;\r\n      console.log('📴 Network connection lost');\r\n    });\r\n  }\r\n\r\n  // Start sync timer\r\n  private startSyncTimer(): void {\r\n    if (this.syncTimer) {\r\n      clearInterval(this.syncTimer);\r\n    }\r\n\r\n    this.syncTimer = setInterval(() => {\r\n      if (this.isOnline) {\r\n        this.syncPendingData();\r\n      }\r\n    }, this.config.syncInterval);\r\n  }\r\n\r\n  // Store data offline\r\n  async storeData(type: OfflineData['type'], id: string, data: any): Promise<void> {\r\n    if (!this.db) {\r\n      throw new Error('IndexedDB not initialized');\r\n    }\r\n\r\n    const offlineData: OfflineData = {\r\n      id,\r\n      type,\r\n      data,\r\n      timestamp: Date.now(),\r\n      version: 1,\r\n      syncStatus: 'synced',\r\n    };\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = this.db!.transaction(['offlineData'], 'readwrite');\r\n      const store = transaction.objectStore('offlineData');\r\n      const request = store.put(offlineData);\r\n\r\n      request.onsuccess = () => {\r\n        console.log(`💾 Stored ${type} data offline:`, id);\r\n        resolve();\r\n      };\r\n\r\n      request.onerror = () => {\r\n        console.error('❌ Failed to store data offline:', request.error);\r\n        reject(request.error);\r\n      };\r\n    });\r\n  }\r\n\r\n  // Get data from offline storage\r\n  async getData(type: OfflineData['type'], id: string): Promise<any | null> {\r\n    if (!this.db) {\r\n      return null;\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = this.db!.transaction(['offlineData'], 'readonly');\r\n      const store = transaction.objectStore('offlineData');\r\n      const request = store.get(id);\r\n\r\n      request.onsuccess = () => {\r\n        const result = request.result;\r\n        if (result && result.type === type) {\r\n          // Check if data is still fresh\r\n          if (Date.now() - result.timestamp < this.config.maxAge) {\r\n            resolve(result.data);\r\n          } else {\r\n            // Data is stale, remove it\r\n            this.removeData(type, id);\r\n            resolve(null);\r\n          }\r\n        } else {\r\n          resolve(null);\r\n        }\r\n      };\r\n\r\n      request.onerror = () => {\r\n        console.error('❌ Failed to get data from offline storage:', request.error);\r\n        reject(request.error);\r\n      };\r\n    });\r\n  }\r\n\r\n  // Get all data of a specific type\r\n  async getAllData(type: OfflineData['type']): Promise<any[]> {\r\n    if (!this.db) {\r\n      return [];\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = this.db!.transaction(['offlineData'], 'readonly');\r\n      const store = transaction.objectStore('offlineData');\r\n      const index = store.index('type');\r\n      const request = index.getAll(type);\r\n\r\n      request.onsuccess = () => {\r\n        const results = request.result;\r\n        const freshData = results\r\n          .filter(item => Date.now() - item.timestamp < this.config.maxAge)\r\n          .map(item => item.data);\r\n        resolve(freshData);\r\n      };\r\n\r\n      request.onerror = () => {\r\n        console.error('❌ Failed to get all data from offline storage:', request.error);\r\n        reject(request.error);\r\n      };\r\n    });\r\n  }\r\n\r\n  // Remove data from offline storage\r\n  async removeData(type: OfflineData['type'], id: string): Promise<void> {\r\n    if (!this.db) {\r\n      return;\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = this.db!.transaction(['offlineData'], 'readwrite');\r\n      const store = transaction.objectStore('offlineData');\r\n      const request = store.delete(id);\r\n\r\n      request.onsuccess = () => {\r\n        console.log(`🗑️ Removed ${type} data from offline storage:`, id);\r\n        resolve();\r\n      };\r\n\r\n      request.onerror = () => {\r\n        console.error('❌ Failed to remove data from offline storage:', request.error);\r\n        reject(request.error);\r\n      };\r\n    });\r\n  }\r\n\r\n  // Add item to sync queue\r\n  async addToSyncQueue(operation: SyncQueueItem['operation'], endpoint: string, data: any): Promise<void> {\r\n    if (!this.db) {\r\n      throw new Error('IndexedDB not initialized');\r\n    }\r\n\r\n    const queueItem: SyncQueueItem = {\r\n      id: `${operation}_${Date.now()}_${Math.random()}`,\r\n      operation,\r\n      endpoint,\r\n      data,\r\n      timestamp: Date.now(),\r\n      retryCount: 0,\r\n    };\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = this.db!.transaction(['syncQueue'], 'readwrite');\r\n      const store = transaction.objectStore('syncQueue');\r\n      const request = store.put(queueItem);\r\n\r\n      request.onsuccess = () => {\r\n        console.log(`📋 Added to sync queue:`, queueItem.id);\r\n        resolve();\r\n      };\r\n\r\n      request.onerror = () => {\r\n        console.error('❌ Failed to add to sync queue:', request.error);\r\n        reject(request.error);\r\n      };\r\n    });\r\n  }\r\n\r\n  // Get sync queue items\r\n  async getSyncQueue(): Promise<SyncQueueItem[]> {\r\n    if (!this.db) {\r\n      return [];\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = this.db!.transaction(['syncQueue'], 'readonly');\r\n      const store = transaction.objectStore('syncQueue');\r\n      const request = store.getAll();\r\n\r\n      request.onsuccess = () => {\r\n        resolve(request.result);\r\n      };\r\n\r\n      request.onerror = () => {\r\n        console.error('❌ Failed to get sync queue:', request.error);\r\n        reject(request.error);\r\n      };\r\n    });\r\n  }\r\n\r\n  // Remove item from sync queue\r\n  async removeFromSyncQueue(id: string): Promise<void> {\r\n    if (!this.db) {\r\n      return;\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = this.db!.transaction(['syncQueue'], 'readwrite');\r\n      const store = transaction.objectStore('syncQueue');\r\n      const request = store.delete(id);\r\n\r\n      request.onsuccess = () => {\r\n        console.log(`✅ Removed from sync queue:`, id);\r\n        resolve();\r\n      };\r\n\r\n      request.onerror = () => {\r\n        console.error('❌ Failed to remove from sync queue:', request.error);\r\n        reject(request.error);\r\n      };\r\n    });\r\n  }\r\n\r\n  // Update retry count for sync queue item\r\n  async updateRetryCount(id: string, retryCount: number): Promise<void> {\r\n    if (!this.db) {\r\n      return;\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = this.db!.transaction(['syncQueue'], 'readwrite');\r\n      const store = transaction.objectStore('syncQueue');\r\n      const getRequest = store.get(id);\r\n\r\n      getRequest.onsuccess = () => {\r\n        const item = getRequest.result;\r\n        if (item) {\r\n          item.retryCount = retryCount;\r\n          const putRequest = store.put(item);\r\n          putRequest.onsuccess = () => resolve();\r\n          putRequest.onerror = () => reject(putRequest.error);\r\n        } else {\r\n          resolve();\r\n        }\r\n      };\r\n\r\n      getRequest.onerror = () => reject(getRequest.error);\r\n    });\r\n  }\r\n\r\n  // Sync pending data\r\n  async syncPendingData(): Promise<void> {\r\n    if (!this.isOnline) {\r\n      console.log('📴 Skipping sync - offline');\r\n      return;\r\n    }\r\n\r\n    const queueItems = await this.getSyncQueue();\r\n    if (queueItems.length === 0) {\r\n      return;\r\n    }\r\n\r\n    console.log(`🔄 Syncing ${queueItems.length} pending items...`);\r\n\r\n    for (const item of queueItems) {\r\n      try {\r\n        // Attempt to sync the item\r\n        const response = await fetch(item.endpoint, {\r\n          method: item.operation === 'delete' ? 'DELETE' : 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: item.operation !== 'delete' ? JSON.stringify(item.data) : undefined,\r\n        });\r\n\r\n        if (response.ok) {\r\n          await this.removeFromSyncQueue(item.id);\r\n          console.log(`✅ Synced item:`, item.id);\r\n        } else {\r\n          throw new Error(`HTTP ${response.status}`);\r\n        }\r\n      } catch (error) {\r\n        console.error(`❌ Failed to sync item ${item.id}:`, error);\r\n        \r\n        // Increment retry count\r\n        const newRetryCount = item.retryCount + 1;\r\n        await this.updateRetryCount(item.id, newRetryCount);\r\n\r\n        // Remove item if max retries exceeded\r\n        if (newRetryCount >= 5) {\r\n          await this.removeFromSyncQueue(item.id);\r\n          console.log(`🗑️ Removed item ${item.id} after max retries`);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Clear all offline data\r\n  async clearAll(): Promise<void> {\r\n    if (!this.db) {\r\n      return;\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = this.db!.transaction(['offlineData', 'syncQueue'], 'readwrite');\r\n      const dataStore = transaction.objectStore('offlineData');\r\n      const queueStore = transaction.objectStore('syncQueue');\r\n\r\n      const dataRequest = dataStore.clear();\r\n      const queueRequest = queueStore.clear();\r\n\r\n      dataRequest.onsuccess = () => {\r\n        queueRequest.onsuccess = () => {\r\n          console.log('🗑️ Cleared all offline data');\r\n          resolve();\r\n        };\r\n        queueRequest.onerror = () => reject(queueRequest.error);\r\n      };\r\n      dataRequest.onerror = () => reject(dataRequest.error);\r\n    });\r\n  }\r\n\r\n  // Get storage statistics\r\n  async getStats(): Promise<{\r\n    totalItems: number;\r\n    dataByType: Record<string, number>;\r\n    queueItems: number;\r\n    totalSize: number;\r\n  }> {\r\n    if (!this.db) {\r\n      return { totalItems: 0, dataByType: {}, queueItems: 0, totalSize: 0 };\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const transaction = this.db!.transaction(['offlineData', 'syncQueue'], 'readonly');\r\n      const dataStore = transaction.objectStore('offlineData');\r\n      const queueStore = transaction.objectStore('syncQueue');\r\n\r\n      const dataRequest = dataStore.getAll();\r\n      const queueRequest = queueStore.getAll();\r\n\r\n      dataRequest.onsuccess = () => {\r\n        queueRequest.onsuccess = () => {\r\n          const dataItems = dataRequest.result;\r\n          const queueItems = queueRequest.result;\r\n\r\n          const dataByType: Record<string, number> = {};\r\n          dataItems.forEach(item => {\r\n            dataByType[item.type] = (dataByType[item.type] || 0) + 1;\r\n          });\r\n\r\n          resolve({\r\n            totalItems: dataItems.length,\r\n            dataByType,\r\n            queueItems: queueItems.length,\r\n            totalSize: JSON.stringify(dataItems).length + JSON.stringify(queueItems).length,\r\n          });\r\n        };\r\n        queueRequest.onerror = () => reject(queueRequest.error);\r\n      };\r\n      dataRequest.onerror = () => reject(dataRequest.error);\r\n    });\r\n  }\r\n\r\n  // Cleanup resources\r\n  destroy(): void {\r\n    if (this.syncTimer) {\r\n      clearInterval(this.syncTimer);\r\n    }\r\n  }\r\n}\r\n\r\n// Global offline storage instance\r\nexport const offlineStorage = new OfflineStorage();\r\n\r\nexport default OfflineStorage;\r\n","// Comprehensive Error Handler for Real-time Services\r\nexport interface ErrorContext {\r\n  service: 'websocket' | 'supabase' | 'sse' | 'api' | 'ui' | 'map' | 'network';\r\n  operation: string;\r\n  timestamp: string;\r\n  userAgent: string;\r\n  url: string;\r\n  networkInfo?: {\r\n    effectiveType?: string;\r\n    downlink?: number;\r\n    rtt?: number;\r\n    saveData?: boolean;\r\n  };\r\n}\r\n\r\nexport interface ErrorReport {\r\n  message: string;\r\n  context: ErrorContext;\r\n  severity: 'low' | 'medium' | 'high' | 'critical';\r\n  retryable: boolean;\r\n  suggestions: string[];\r\n}\r\n\r\nclass ErrorHandler {\r\n  private errorLog: ErrorReport[] = [];\r\n  private maxLogSize = 100;\r\n\r\n  // Log an error with context\r\n  logError(\r\n    error: Error | string | Event | unknown,\r\n    context: Partial<ErrorContext>,\r\n    severity: 'low' | 'medium' | 'high' | 'critical' = 'medium'\r\n  ): ErrorReport {\r\n    // Handle different error types\r\n    let errorMessage: string;\r\n    \r\n    if (error instanceof Error) {\r\n      errorMessage = error.message;\r\n    } else if (typeof error === 'string') {\r\n      errorMessage = error;\r\n    } else if (error instanceof Event) {\r\n      errorMessage = `Event error: ${error.type}`;\r\n    } else {\r\n      errorMessage = 'Unknown error';\r\n    }\r\n    \r\n    // Add network information if available\r\n    let networkInfo = {};\r\n    if (typeof navigator !== 'undefined' && 'connection' in navigator) {\r\n      const conn = (navigator as any).connection;\r\n      if (conn) {\r\n        networkInfo = {\r\n          effectiveType: conn.effectiveType,\r\n          downlink: conn.downlink,\r\n          rtt: conn.rtt,\r\n          saveData: conn.saveData,\r\n        };\r\n      }\r\n    }\r\n    \r\n    const errorReport: ErrorReport = {\r\n      message: errorMessage,\r\n      context: {\r\n        service: context.service || 'api',\r\n        operation: context.operation || 'unknown',\r\n        timestamp: new Date().toISOString(),\r\n        userAgent: navigator.userAgent,\r\n        url: window.location.href,\r\n        networkInfo: networkInfo as any,\r\n        ...context,\r\n      },\r\n      severity,\r\n      retryable: this.isRetryableError(error),\r\n      suggestions: this.getSuggestions(error, context),\r\n    };\r\n\r\n    this.errorLog.push(errorReport);\r\n    \r\n    // Keep log size manageable\r\n    if (this.errorLog.length > this.maxLogSize) {\r\n      this.errorLog.shift();\r\n    }\r\n\r\n    // Log to console with appropriate level\r\n    this.logToConsole(errorReport);\r\n\r\n    return errorReport;\r\n  }\r\n\r\n  // Check if an error is retryable\r\n  private isRetryableError(error: Error | string | Event | unknown): boolean {\r\n    let message: string;\r\n    \r\n    if (error instanceof Error) {\r\n      message = error.message;\r\n    } else if (typeof error === 'string') {\r\n      message = error;\r\n    } else if (error instanceof Event) {\r\n      message = error.type;\r\n    } else {\r\n      message = 'Unknown error';\r\n    }\r\n    \r\n    // Network-related errors are usually retryable\r\n    const retryablePatterns = [\r\n      /network/i,\r\n      /timeout/i,\r\n      /connection/i,\r\n      /cors/i,\r\n      /fetch/i,\r\n      /websocket/i,\r\n      /sse/i,\r\n      /socket\\.io/i,\r\n      /error/i,\r\n      /failed/i,\r\n      /disconnect/i,\r\n    ];\r\n\r\n    return retryablePatterns.some(pattern => pattern.test(message));\r\n  }\r\n\r\n  // Get suggestions for fixing the error\r\n  private getSuggestions(error: Error | string | Event | unknown, _context: Partial<ErrorContext>): string[] {\r\n    let message: string;\r\n    \r\n    if (error instanceof Error) {\r\n      message = error.message;\r\n    } else if (typeof error === 'string') {\r\n      message = error;\r\n    } else if (error instanceof Event) {\r\n      message = error.type;\r\n    } else {\r\n      message = 'Unknown error';\r\n    }\r\n    const suggestions: string[] = [];\r\n\r\n    if (message.includes('CORS')) {\r\n      suggestions.push('Check CORS configuration on the server');\r\n      suggestions.push('Verify the API endpoint is accessible');\r\n    }\r\n\r\n    if (message.includes('timeout')) {\r\n      suggestions.push('Increase connection timeout settings');\r\n      suggestions.push('Check network connectivity');\r\n    }\r\n\r\n    if (message.includes('websocket')) {\r\n      suggestions.push('Verify WebSocket server is running');\r\n      suggestions.push('Check WebSocket URL configuration');\r\n    }\r\n\r\n    if (message.includes('sse')) {\r\n      suggestions.push('Verify SSE endpoint is implemented on server');\r\n      suggestions.push('Check SSE URL configuration');\r\n    }\r\n\r\n    if (message.includes('supabase')) {\r\n      suggestions.push('Verify Supabase configuration');\r\n      suggestions.push('Check Supabase service status');\r\n    }\r\n\r\n    if (suggestions.length === 0) {\r\n      suggestions.push('Check network connectivity');\r\n      suggestions.push('Verify server is running');\r\n      suggestions.push('Check browser console for more details');\r\n    }\r\n\r\n    return suggestions;\r\n  }\r\n\r\n  // Log to console with appropriate styling\r\n  private logToConsole(errorReport: ErrorReport): void {\r\n    const { message, context, severity, retryable, suggestions } = errorReport;\r\n    \r\n    const severityColors = {\r\n      low: 'color: #6b7280',\r\n      medium: 'color: #f59e0b',\r\n      high: 'color: #ef4444',\r\n      critical: 'color: #dc2626; font-weight: bold',\r\n    };\r\n\r\n    const color = severityColors[severity];\r\n    const retryableText = retryable ? '🔄 Retryable' : '❌ Not Retryable';\r\n\r\n    console.group(`%c${severity.toUpperCase()} ERROR - ${context.service.toUpperCase()}`, color);\r\n    console.error(`Message: ${message}`);\r\n    console.error(`Service: ${context.service}`);\r\n    console.error(`Operation: ${context.operation}`);\r\n    console.error(`Status: ${retryableText}`);\r\n    console.error(`Timestamp: ${context.timestamp}`);\r\n    \r\n    if (suggestions.length > 0) {\r\n      console.warn('Suggestions:');\r\n      suggestions.forEach(suggestion => console.warn(`  • ${suggestion}`));\r\n    }\r\n    \r\n    console.groupEnd();\r\n  }\r\n\r\n  // Get error statistics\r\n  getErrorStats(): {\r\n    total: number;\r\n    byService: Record<string, number>;\r\n    bySeverity: Record<string, number>;\r\n    recentErrors: ErrorReport[];\r\n  } {\r\n    const byService: Record<string, number> = {};\r\n    const bySeverity: Record<string, number> = {};\r\n\r\n    this.errorLog.forEach(error => {\r\n      byService[error.context.service] = (byService[error.context.service] || 0) + 1;\r\n      bySeverity[error.severity] = (bySeverity[error.severity] || 0) + 1;\r\n    });\r\n\r\n    return {\r\n      total: this.errorLog.length,\r\n      byService,\r\n      bySeverity,\r\n      recentErrors: this.errorLog.slice(-10), // Last 10 errors\r\n    };\r\n  }\r\n\r\n  // Clear error log\r\n  clearLog(): void {\r\n    this.errorLog = [];\r\n  }\r\n\r\n  // Get all errors\r\n  getErrors(): ErrorReport[] {\r\n    return [...this.errorLog];\r\n  }\r\n\r\n  // Check if there are critical errors\r\n  hasCriticalErrors(): boolean {\r\n    return this.errorLog.some(error => error.severity === 'critical');\r\n  }\r\n\r\n  // Get retryable errors\r\n  getRetryableErrors(): ErrorReport[] {\r\n    return this.errorLog.filter(error => error.retryable);\r\n  }\r\n}\r\n\r\n// Create singleton instance\r\nexport const errorHandler = new ErrorHandler();\r\n\r\n// Export utility functions\r\nexport const logError = (\r\n  error: Error | string | Event | unknown,\r\n  context: Partial<ErrorContext>,\r\n  severity?: 'low' | 'medium' | 'high' | 'critical'\r\n) => errorHandler.logError(error, context, severity);\r\n\r\nexport const getErrorStats = () => errorHandler.getErrorStats();\r\nexport const hasCriticalErrors = () => errorHandler.hasCriticalErrors();\r\nexport const getRetryableErrors = () => errorHandler.getRetryableErrors();\r\n\r\nexport default errorHandler;\r\n","import { apiCircuitBreaker } from './CircuitBreaker';\r\nimport { standardBackoff } from './ExponentialBackoff';\r\nimport { offlineStorage } from '../offline/OfflineStorage';\r\nimport { logError } from '../../utils/errorHandler';\r\nimport { environment } from '../../config/environment';\r\n\r\nexport interface ApiRequestConfig {\r\n  endpoint: string;\r\n  method?: 'GET' | 'POST' | 'PUT' | 'DELETE';\r\n  data?: any;\r\n  headers?: Record<string, string>;\r\n  timeout?: number;\r\n  useOfflineStorage?: boolean;\r\n  retryOnFailure?: boolean;\r\n}\r\n\r\nexport interface ApiResponse<T = any> {\r\n  success: boolean;\r\n  data?: T;\r\n  error?: string;\r\n  fromCache?: boolean;\r\n  timestamp: string;\r\n}\r\n\r\nclass ResilientApiService {\r\n  private baseUrl: string;\r\n  private defaultTimeout: number = 10000; // 10 seconds\r\n\r\n  constructor(baseUrl?: string) {\r\n    this.baseUrl = baseUrl || environment.api.url;\r\n  }\r\n\r\n  // Main request method with full resilience\r\n  async request<T>(config: ApiRequestConfig): Promise<ApiResponse<T>> {\r\n    const {\r\n      endpoint,\r\n      method = 'GET',\r\n      data,\r\n      headers = {},\r\n      timeout = this.defaultTimeout,\r\n      useOfflineStorage = true,\r\n      retryOnFailure = true,\r\n    } = config;\r\n\r\n    const url = `${this.baseUrl}${endpoint}`;\r\n    const requestId = `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    try {\r\n      // Check if we should use offline storage for GET requests\r\n      if (method === 'GET' && useOfflineStorage) {\r\n        const cachedData = await this.getFromOfflineStorage(endpoint);\r\n        if (cachedData) {\r\n          console.log(`📦 Serving cached data for ${endpoint}`);\r\n          return {\r\n            success: true,\r\n            data: cachedData,\r\n            fromCache: true,\r\n            timestamp: new Date().toISOString(),\r\n          };\r\n        }\r\n      }\r\n\r\n      // Execute request with circuit breaker and exponential backoff\r\n      const result = await apiCircuitBreaker.execute(\r\n        () => this.executeRequest<T>(url, method, data, headers, timeout, requestId),\r\n        retryOnFailure ? () => this.getFallbackData<T>(endpoint) : undefined\r\n      );\r\n\r\n      // Store successful responses in offline storage (result is T, not ApiResponse)\r\n      if (useOfflineStorage && result) {\r\n        await this.storeInOfflineStorage(endpoint, result);\r\n      }\r\n\r\n      return {\r\n        success: true,\r\n        data: result,\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n\r\n    } catch (error) {\r\n      // Log error with context\r\n      logError(error, {\r\n        service: 'api',\r\n        operation: `${method.toLowerCase()}-${endpoint}`,\r\n      }, 'medium');\r\n\r\n      // Try to get fallback data from offline storage\r\n      if (useOfflineStorage) {\r\n        const fallbackData = await this.getFromOfflineStorage(endpoint);\r\n        if (fallbackData) {\r\n          console.log(`📦 Using fallback data for ${endpoint}`);\r\n          return {\r\n            success: true,\r\n            data: fallbackData,\r\n            fromCache: true,\r\n            timestamp: new Date().toISOString(),\r\n          };\r\n        }\r\n      }\r\n\r\n      // Queue failed requests for later sync (for non-GET requests)\r\n      if (method !== 'GET' && useOfflineStorage) {\r\n        await this.queueForSync(method, endpoint, data);\r\n      }\r\n\r\n      return {\r\n        success: false,\r\n        error: error instanceof Error ? error.message : 'Request failed',\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  // Execute actual HTTP request with timeout\r\n  private async executeRequest<T>(\r\n    url: string,\r\n    method: string,\r\n    data: any,\r\n    headers: Record<string, string>,\r\n    timeout: number,\r\n    requestId: string\r\n  ): Promise<T> {\r\n    const controller = new AbortController();\r\n    const timeoutId = setTimeout(() => controller.abort(), timeout);\r\n\r\n    try {\r\n      const response = await fetch(url, {\r\n        method,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'X-Request-ID': requestId,\r\n          ...headers,\r\n        },\r\n        body: data ? JSON.stringify(data) : undefined,\r\n        signal: controller.signal,\r\n      });\r\n\r\n      clearTimeout(timeoutId);\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      clearTimeout(timeoutId);\r\n      \r\n      if (error instanceof Error) {\r\n        if (error.name === 'AbortError') {\r\n          throw new Error('Request timeout');\r\n        }\r\n        throw error;\r\n      }\r\n      \r\n      throw new Error('Unknown error occurred');\r\n    }\r\n  }\r\n\r\n  // Get fallback data with exponential backoff\r\n  private async getFallbackData<T>(endpoint: string): Promise<T> {\r\n    const result = await standardBackoff.execute(async () => {\r\n      const cachedData = await this.getFromOfflineStorage(endpoint);\r\n      if (cachedData) {\r\n        return cachedData;\r\n      }\r\n      throw new Error('No fallback data available');\r\n    });\r\n    if (result.success && result.result) {\r\n      return result.result;\r\n    }\r\n    throw new Error('No fallback data available');\r\n  }\r\n\r\n  // Offline storage methods\r\n  private async getFromOfflineStorage(endpoint: string): Promise<any | null> {\r\n    try {\r\n      const dataType = this.getDataTypeFromEndpoint(endpoint);\r\n      const id = this.getStorageId(endpoint);\r\n      return await offlineStorage.getData(dataType, id);\r\n    } catch (error) {\r\n      console.warn('Failed to get data from offline storage:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  private async storeInOfflineStorage(endpoint: string, data: any): Promise<void> {\r\n    try {\r\n      const dataType = this.getDataTypeFromEndpoint(endpoint);\r\n      const id = this.getStorageId(endpoint);\r\n      await offlineStorage.storeData(dataType, id, data);\r\n    } catch (error) {\r\n      console.warn('Failed to store data in offline storage:', error);\r\n    }\r\n  }\r\n\r\n  private async queueForSync(method: string, endpoint: string, data: any): Promise<void> {\r\n    try {\r\n      const operation = method === 'DELETE' ? 'delete' : \r\n                      method === 'PUT' ? 'update' : 'create';\r\n      await offlineStorage.addToSyncQueue(operation, endpoint, data);\r\n    } catch (error) {\r\n      console.warn('Failed to queue request for sync:', error);\r\n    }\r\n  }\r\n\r\n  // Helper methods\r\n  private getDataTypeFromEndpoint(endpoint: string): 'bus' | 'route' | 'location' | 'driver' | 'user' {\r\n    if (endpoint.includes('/buses')) return 'bus';\r\n    if (endpoint.includes('/routes')) return 'route';\r\n    if (endpoint.includes('/locations')) return 'location';\r\n    if (endpoint.includes('/drivers')) return 'driver';\r\n    if (endpoint.includes('/users')) return 'user';\r\n    return 'bus'; // Default\r\n  }\r\n\r\n  private getStorageId(endpoint: string): string {\r\n    // Remove query parameters and create a unique ID\r\n    const cleanEndpoint = endpoint.split('?')[0];\r\n    return cleanEndpoint.replace(/[^a-zA-Z0-9]/g, '_');\r\n  }\r\n\r\n  // Convenience methods for common operations\r\n  async get<T>(endpoint: string, config?: Partial<ApiRequestConfig>): Promise<ApiResponse<T>> {\r\n    return this.request<T>({\r\n      endpoint,\r\n      method: 'GET',\r\n      ...config,\r\n    });\r\n  }\r\n\r\n  async post<T>(endpoint: string, data: any, config?: Partial<ApiRequestConfig>): Promise<ApiResponse<T>> {\r\n    return this.request<T>({\r\n      endpoint,\r\n      method: 'POST',\r\n      data,\r\n      ...config,\r\n    });\r\n  }\r\n\r\n  async put<T>(endpoint: string, data: any, config?: Partial<ApiRequestConfig>): Promise<ApiResponse<T>> {\r\n    return this.request<T>({\r\n      endpoint,\r\n      method: 'PUT',\r\n      data,\r\n      ...config,\r\n    });\r\n  }\r\n\r\n  async delete<T>(endpoint: string, config?: Partial<ApiRequestConfig>): Promise<ApiResponse<T>> {\r\n    return this.request<T>({\r\n      endpoint,\r\n      method: 'DELETE',\r\n      ...config,\r\n    });\r\n  }\r\n\r\n  // Health check with resilience\r\n  async healthCheck(): Promise<ApiResponse<{ status: string; timestamp: string }>> {\r\n    return this.get('/health', {\r\n      timeout: 5000,\r\n      retryOnFailure: true,\r\n      useOfflineStorage: false,\r\n    });\r\n  }\r\n\r\n  // Get offline storage statistics\r\n  async getOfflineStats() {\r\n    return await offlineStorage.getStats();\r\n  }\r\n\r\n  // Clear offline storage\r\n  async clearOfflineStorage() {\r\n    return await offlineStorage.clearAll();\r\n  }\r\n\r\n  // Force sync pending data\r\n  async syncPendingData() {\r\n    return await offlineStorage.syncPendingData();\r\n  }\r\n}\r\n\r\n// Global resilient API service instance\r\nexport const resilientApiService = new ResilientApiService();\r\n\r\nexport default ResilientApiService;\r\n","import { authService } from './authService';\r\nimport { HealthResponse, Bus, Route, Driver, BusLocation } from '../types';\r\nimport { environment } from '../config/environment';\r\nimport { resilientApiService } from './resilience/ResilientApiService';\r\nimport { logError } from '../utils/errorHandler';\r\n\r\nconst API_BASE_URL = environment.api.url;\r\n\r\nimport { IApiService } from './interfaces/IApiService';\r\n\r\nclass ApiService implements IApiService {\r\n  private baseUrl: string;\r\n\r\n  constructor(baseUrl: string) {\r\n    this.baseUrl = baseUrl;\r\n  }\r\n\r\n  // Backend API calls (for business logic) - Now using resilient API service\r\n  private async backendRequest<T>(\r\n    endpoint: string,\r\n    options?: RequestInit\r\n  ): Promise<T> {\r\n    const method = options?.method || 'GET';\r\n    const headers: Record<string, string> = {\r\n      'Content-Type': 'application/json',\r\n    };\r\n\r\n    // Try to get token, but don't fail if auth service is not available\r\n    try {\r\n      const token = authService.getAccessToken();\r\n      if (token) {\r\n        headers['Authorization'] = `Bearer ${token}`;\r\n      }\r\n    } catch (error) {\r\n      console.log('🔓 Public access - no authentication token available');\r\n    }\r\n\r\n    if (options?.headers) {\r\n      Object.assign(headers, options.headers);\r\n    }\r\n\r\n    try {\r\n      let response;\r\n      \r\n      if (method === 'GET') {\r\n        response = await resilientApiService.get<T>(endpoint, { headers });\r\n      } else if (method === 'POST') {\r\n        const body = options?.body ? JSON.parse(options.body as string) : undefined;\r\n        response = await resilientApiService.post<T>(endpoint, body, { headers });\r\n      } else if (method === 'PUT') {\r\n        const body = options?.body ? JSON.parse(options.body as string) : undefined;\r\n        response = await resilientApiService.put<T>(endpoint, body, { headers });\r\n      } else if (method === 'DELETE') {\r\n        response = await resilientApiService.delete<T>(endpoint, { headers });\r\n      } else {\r\n        throw new Error(`Unsupported HTTP method: ${method}`);\r\n      }\r\n\r\n      if (!response.success) {\r\n        throw new Error(response.error || 'API request failed');\r\n      }\r\n\r\n      return response.data as T;\r\n    } catch (error) {\r\n      // Log error with context\r\n      logError(error, {\r\n        service: 'api',\r\n        operation: `${method.toLowerCase()}-${endpoint}`,\r\n      }, 'medium');\r\n      \r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Health check\r\n  async getHealth(): Promise<HealthResponse> {\r\n    try {\r\n      // Direct fetch to bypass resilient service for debugging\r\n      const response = await fetch(`${this.baseUrl}/health`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        signal: AbortSignal.timeout(5000), // 5 second timeout\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      console.log('✅ Health check successful:', data);\r\n      return data;\r\n    } catch (error) {\r\n      console.error('❌ Health check failed:', error);\r\n      // Return a fallback health response that matches the expected structure\r\n      return {\r\n        status: 'unhealthy',\r\n        timestamp: new Date().toISOString(),\r\n        uptime: process.uptime(),\r\n        environment: 'development',\r\n        services: {\r\n          database: {\r\n            status: 'unhealthy',\r\n            details: {\r\n              status: 'disconnected',\r\n              details: {\r\n                currentTime: new Date().toISOString(),\r\n                postgresVersion: 'unknown',\r\n                poolSize: 0,\r\n                idleCount: 0,\r\n                waitingCount: 0,\r\n              },\r\n            },\r\n          },\r\n          api: {\r\n            status: 'down',\r\n            database: 'down',\r\n          },\r\n        },\r\n      };\r\n    }\r\n  }\r\n\r\n  // Bus operations (Backend API)\r\n  async getAllBuses(): Promise<{\r\n    success: boolean;\r\n    data: Bus[];\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      // Use backend API instead of direct Supabase call\r\n      const response = await this.backendRequest<{\r\n        success: boolean;\r\n        data: Bus[];\r\n        error?: string;\r\n        timestamp: string;\r\n      }>('/buses');\r\n\r\n      if (response.success && response.data) {\r\n        return {\r\n          success: true,\r\n          data: response.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error('❌ Error fetching buses from backend:', response.error);\r\n        return {\r\n          success: false,\r\n          data: [],\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in getAllBuses:', error);\r\n      return {\r\n        success: false,\r\n        data: [],\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  async getBusInfo(busId: string): Promise<{\r\n    success: boolean;\r\n    data: Bus | null;\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      // Use backend API instead of direct Supabase call\r\n      const response = await this.backendRequest<{\r\n        success: boolean;\r\n        data: Bus;\r\n        error?: string;\r\n        timestamp: string;\r\n      }>(`/buses/${busId}`);\r\n\r\n      if (response.success && response.data) {\r\n        return {\r\n          success: true,\r\n          data: response.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error(\r\n          '❌ Error fetching bus info from backend:',\r\n          response.error\r\n        );\r\n        return {\r\n          success: false,\r\n          data: null,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in getBusInfo:', error);\r\n      return {\r\n        success: false,\r\n        data: null,\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  // Route operations (Backend API)\r\n  async getRoutes(): Promise<{\r\n    success: boolean;\r\n    data: Route[];\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      // Use backend API instead of direct Supabase call\r\n      const response = await this.backendRequest<{\r\n        success: boolean;\r\n        data: Route[];\r\n        error?: string;\r\n        timestamp: string;\r\n      }>('/routes');\r\n\r\n      if (response.success && response.data) {\r\n        return {\r\n          success: true,\r\n          data: response.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error('❌ Error fetching routes from backend:', response.error);\r\n        return {\r\n          success: false,\r\n          data: [],\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in getRoutes:', error);\r\n      return {\r\n        success: false,\r\n        data: [],\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  async getRouteInfo(routeId: string): Promise<{\r\n    success: boolean;\r\n    data: Route | null;\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      // Use backend API instead of direct Supabase call\r\n      const response = await this.backendRequest<{\r\n        success: boolean;\r\n        data: Route;\r\n        error?: string;\r\n        timestamp: string;\r\n      }>(`/routes/${routeId}`);\r\n\r\n      if (response.success && response.data) {\r\n        return {\r\n          success: true,\r\n          data: response.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error(\r\n          '❌ Error fetching route info from backend:',\r\n          response.error\r\n        );\r\n        return {\r\n          success: false,\r\n          data: null,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in getRouteInfo:', error);\r\n      return {\r\n        success: false,\r\n        data: null,\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  // Driver operations (Backend API)\r\n  async getAllDrivers(): Promise<{\r\n    success: boolean;\r\n    data: Driver[];\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      // Use backend API instead of direct Supabase call\r\n      const response = await this.backendRequest<{\r\n        success: boolean;\r\n        data: Driver[];\r\n        error?: string;\r\n        timestamp: string;\r\n      }>('/admin/drivers');\r\n\r\n      if (response.success && response.data) {\r\n        return {\r\n          success: true,\r\n          data: response.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error(\r\n          '❌ Error fetching drivers from backend:',\r\n          response.error\r\n        );\r\n        return {\r\n          success: false,\r\n          data: [],\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in getAllDrivers:', error);\r\n      return {\r\n        success: false,\r\n        data: [],\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  async getDriverInfo(driverId: string): Promise<{\r\n    success: boolean;\r\n    data: Driver | null;\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      // Use backend API instead of direct Supabase call\r\n      const response = await this.backendRequest<{\r\n        success: boolean;\r\n        data: Driver;\r\n        error?: string;\r\n        timestamp: string;\r\n      }>(`/admin/drivers/${driverId}`);\r\n\r\n      if (response.success && response.data) {\r\n        return {\r\n          success: true,\r\n          data: response.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error(\r\n          '❌ Error fetching driver info from backend:',\r\n          response.error\r\n        );\r\n        return {\r\n          success: false,\r\n          data: null,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in getDriverInfo:', error);\r\n      return {\r\n        success: false,\r\n        data: null,\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  // Live location operations (Backend API)\r\n  async getLiveLocations(): Promise<{\r\n    success: boolean;\r\n    data: BusLocation[];\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      // Use backend API instead of direct Supabase call\r\n      const response = await this.backendRequest<{\r\n        success: boolean;\r\n        data: BusLocation[];\r\n        error?: string;\r\n        timestamp: string;\r\n      }>('/locations/current');\r\n\r\n      if (response.success && response.data) {\r\n        return {\r\n          success: true,\r\n          data: response.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error(\r\n          '❌ Error fetching live locations from backend:',\r\n          response.error\r\n        );\r\n        return {\r\n          success: false,\r\n          data: [],\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error: any) {\r\n      console.error('❌ Error in getLiveLocations:', error);\r\n      // Handle 401 Unauthorized gracefully for student access\r\n      if (error.message && error.message.includes('401')) {\r\n        console.log('ℹ️ Student access - no authentication required for viewing locations');\r\n        return {\r\n          success: true,\r\n          data: [],\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n      return {\r\n        success: false,\r\n        data: [],\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  async updateLiveLocation(\r\n    busId: string,\r\n    driverId: string,\r\n    location: {\r\n      latitude: number;\r\n      longitude: number;\r\n      speed?: number;\r\n      heading?: number;\r\n    }\r\n  ): Promise<{\r\n    success: boolean;\r\n    data: BusLocation | null;\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      // Use backend API instead of direct Supabase call\r\n      const response = await this.backendRequest<{\r\n        success: boolean;\r\n        data: BusLocation;\r\n        error?: string;\r\n        timestamp: string;\r\n      }>('/locations/update', {\r\n        method: 'POST',\r\n        body: JSON.stringify({\r\n          busId,\r\n          driverId,\r\n          latitude: location.latitude,\r\n          longitude: location.longitude,\r\n          speed: location.speed,\r\n          heading: location.heading,\r\n          timestamp: new Date().toISOString(),\r\n        }),\r\n      });\r\n\r\n      if (response.success && response.data) {\r\n        return {\r\n          success: true,\r\n          data: response.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error(\r\n          '❌ Error updating live location via backend:',\r\n          response.error\r\n        );\r\n        return {\r\n          success: false,\r\n          data: null,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in updateLiveLocation:', error);\r\n      return {\r\n        success: false,\r\n        data: null,\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  // Spatial optimization methods\r\n  async getRoutesInViewport(bounds: [[number, number], [number, number]]): Promise<{\r\n    success: boolean;\r\n    data: Route[];\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      const [minLng, minLat] = bounds[0];\r\n      const [maxLng, maxLat] = bounds[1];\r\n      \r\n      // Direct fetch to bypass resilient service for debugging\r\n      const response = await fetch(`${this.baseUrl}/routes/viewport?minLng=${minLng}&minLat=${minLat}&maxLng=${maxLng}&maxLat=${maxLat}`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        signal: AbortSignal.timeout(10000), // 10 second timeout\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      console.log('✅ Routes in viewport fetched successfully:', data);\r\n      \r\n      if (data.success && data.data) {\r\n        return {\r\n          success: true,\r\n          data: data.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error('❌ Error fetching routes in viewport:', data.error);\r\n        return {\r\n          success: false,\r\n          data: [],\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in getRoutesInViewport:', error);\r\n      return {\r\n        success: false,\r\n        data: [],\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  async getBusesInViewport(bounds: [[number, number], [number, number]]): Promise<{\r\n    success: boolean;\r\n    data: Bus[];\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      const [minLng, minLat] = bounds[0];\r\n      const [maxLng, maxLat] = bounds[1];\r\n      \r\n      // Direct fetch to bypass resilient service for debugging\r\n      const response = await fetch(`${this.baseUrl}/buses/viewport?minLng=${minLng}&minLat=${minLat}&maxLng=${maxLng}&maxLat=${maxLat}`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        signal: AbortSignal.timeout(10000), // 10 second timeout\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      console.log('✅ Buses in viewport fetched successfully:', data);\r\n      \r\n      if (data.success && data.data) {\r\n        return {\r\n          success: true,\r\n          data: data.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error('❌ Error fetching buses in viewport:', data.error);\r\n        return {\r\n          success: false,\r\n          data: [],\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in getBusesInViewport:', error);\r\n      return {\r\n        success: false,\r\n        data: [],\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  async getLiveLocationsInViewport(bounds: [[number, number], [number, number]]): Promise<{\r\n    success: boolean;\r\n    data: BusLocation[];\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      const [minLng, minLat] = bounds[0];\r\n      const [maxLng, maxLat] = bounds[1];\r\n      \r\n      // Direct fetch to bypass resilient service for debugging\r\n      const response = await fetch(`${this.baseUrl}/locations/viewport?minLng=${minLng}&minLat=${minLat}&maxLng=${maxLng}&maxLat=${maxLat}`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        signal: AbortSignal.timeout(10000), // 10 second timeout\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      console.log('✅ Live locations in viewport fetched successfully:', data);\r\n      \r\n      if (data.success && data.data) {\r\n        return {\r\n          success: true,\r\n          data: data.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error('❌ Error fetching live locations in viewport:', data.error);\r\n        return {\r\n          success: false,\r\n          data: [],\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in getLiveLocationsInViewport:', error);\r\n      return {\r\n        success: false,\r\n        data: [],\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n\r\n  async getBusClusters(bounds: [[number, number], [number, number]], zoom: number): Promise<{\r\n    success: boolean;\r\n    data: any[];\r\n    timestamp: string;\r\n  }> {\r\n    try {\r\n      const [minLng, minLat] = bounds[0];\r\n      const [maxLng, maxLat] = bounds[1];\r\n      \r\n      // Direct fetch to bypass resilient service for debugging\r\n      const response = await fetch(`${this.baseUrl}/buses/clusters?minLng=${minLng}&minLat=${minLat}&maxLng=${maxLng}&maxLat=${maxLat}&zoom=${zoom}`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        signal: AbortSignal.timeout(10000), // 10 second timeout\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      console.log('✅ Bus clusters fetched successfully:', data);\r\n      \r\n      if (data.success && data.data) {\r\n        return {\r\n          success: true,\r\n          data: data.data,\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      } else {\r\n        console.error('❌ Error fetching bus clusters:', data.error);\r\n        return {\r\n          success: false,\r\n          data: [],\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error in getBusClusters:', error);\r\n      return {\r\n        success: false,\r\n        data: [],\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\nexport const apiService = new ApiService(API_BASE_URL);\r\nexport default apiService;\r\n","import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { apiService } from '../services/api';\r\n\r\n// Query keys for consistent caching\r\nexport const queryKeys = {\r\n  health: ['health'],\r\n  routes: ['routes'],\r\n  route: (id: string) => ['route', id],\r\n  routesInViewport: (bounds: [[number, number], [number, number]]) => ['routes', 'viewport', bounds],\r\n  buses: ['buses'],\r\n  bus: (id: string) => ['bus', id],\r\n  busesInViewport: (bounds: [[number, number], [number, number]]) => ['buses', 'viewport', bounds],\r\n  drivers: ['drivers'],\r\n  driver: (id: string) => ['driver', id],\r\n  liveLocations: ['liveLocations'],\r\n  liveLocationsInViewport: (bounds: [[number, number], [number, number]]) => ['liveLocations', 'viewport', bounds],\r\n  busClusters: (bounds: [[number, number], [number, number]], zoom: number) => ['busClusters', bounds, zoom],\r\n} as const;\r\n\r\n// Health check query\r\nexport const useHealthCheck = () => {\r\n  return useQuery({\r\n    queryKey: queryKeys.health,\r\n    queryFn: async () => {\r\n      const result = await apiService.getHealth();\r\n      if (!result) {\r\n        throw new Error('Health check returned undefined');\r\n      }\r\n      return result;\r\n    },\r\n    staleTime: 30000, // 30 seconds\r\n    refetchInterval: 60000, // 1 minute\r\n    retry: 3,\r\n  });\r\n};\r\n\r\n// Routes queries\r\nexport const useRoutes = () => {\r\n  return useQuery({\r\n    queryKey: queryKeys.routes,\r\n    queryFn: () => apiService.getRoutes(),\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n    refetchInterval: 10 * 60 * 1000, // 10 minutes\r\n    retry: 3,\r\n  });\r\n};\r\n\r\n// Optimized routes query for viewport\r\nexport const useRoutesInViewport = (bounds: [[number, number], [number, number]], enabled = true) => {\r\n  return useQuery({\r\n    queryKey: queryKeys.routesInViewport(bounds),\r\n    queryFn: () => apiService.getRoutesInViewport(bounds),\r\n    enabled: enabled && bounds !== undefined,\r\n    staleTime: 2 * 60 * 1000, // 2 minutes for viewport data\r\n    refetchInterval: 5 * 60 * 1000, // 5 minutes\r\n    retry: 3,\r\n  });\r\n};\r\n\r\nexport const useRoute = (routeId: string) => {\r\n  return useQuery({\r\n    queryKey: queryKeys.route(routeId),\r\n    queryFn: () => apiService.getRouteInfo(routeId),\r\n    enabled: !!routeId,\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n    retry: 3,\r\n  });\r\n};\r\n\r\n// Buses queries\r\nexport const useBuses = () => {\r\n  return useQuery({\r\n    queryKey: queryKeys.buses,\r\n    queryFn: () => apiService.getAllBuses(),\r\n    staleTime: 30 * 1000, // 30 seconds\r\n    refetchInterval: 60 * 1000, // 1 minute\r\n    retry: 3,\r\n  });\r\n};\r\n\r\n// Optimized buses query for viewport\r\nexport const useBusesInViewport = (bounds: [[number, number], [number, number]], enabled = true) => {\r\n  return useQuery({\r\n    queryKey: queryKeys.busesInViewport(bounds),\r\n    queryFn: () => apiService.getBusesInViewport(bounds),\r\n    enabled: enabled && bounds !== undefined,\r\n    staleTime: 15 * 1000, // 15 seconds for viewport data\r\n    refetchInterval: 30 * 1000, // 30 seconds\r\n    retry: 3,\r\n  });\r\n};\r\n\r\nexport const useBus = (busId: string) => {\r\n  return useQuery({\r\n    queryKey: queryKeys.bus(busId),\r\n    queryFn: () => apiService.getBusInfo(busId),\r\n    enabled: !!busId,\r\n    staleTime: 30 * 1000, // 30 seconds\r\n    retry: 3,\r\n  });\r\n};\r\n\r\n// Drivers queries\r\nexport const useDrivers = () => {\r\n  return useQuery({\r\n    queryKey: queryKeys.drivers,\r\n    queryFn: () => apiService.getAllDrivers(),\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n    refetchInterval: 10 * 60 * 1000, // 10 minutes\r\n    retry: 3,\r\n  });\r\n};\r\n\r\nexport const useDriver = (driverId: string) => {\r\n  return useQuery({\r\n    queryKey: queryKeys.driver(driverId),\r\n    queryFn: () => apiService.getDriverInfo(driverId),\r\n    enabled: !!driverId,\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n    retry: 3,\r\n  });\r\n};\r\n\r\n// Live locations query\r\nexport const useLiveLocations = () => {\r\n  return useQuery({\r\n    queryKey: queryKeys.liveLocations,\r\n    queryFn: () => apiService.getLiveLocations(),\r\n    staleTime: 10 * 1000, // 10 seconds\r\n    refetchInterval: 30 * 1000, // 30 seconds\r\n    retry: 3,\r\n  });\r\n};\r\n\r\n// Optimized live locations query for viewport\r\nexport const useLiveLocationsInViewport = (bounds: [[number, number], [number, number]], enabled = true) => {\r\n  return useQuery({\r\n    queryKey: queryKeys.liveLocationsInViewport(bounds),\r\n    queryFn: () => apiService.getLiveLocationsInViewport(bounds),\r\n    enabled: enabled && bounds !== undefined,\r\n    staleTime: 5 * 1000, // 5 seconds for viewport data\r\n    refetchInterval: 15 * 1000, // 15 seconds\r\n    retry: 3,\r\n  });\r\n};\r\n\r\n// Bus clusters query\r\nexport const useBusClusters = (bounds: [[number, number], [number, number]], zoom: number, enabled = true) => {\r\n  return useQuery({\r\n    queryKey: queryKeys.busClusters(bounds, zoom),\r\n    queryFn: () => apiService.getBusClusters(bounds, zoom),\r\n    enabled: enabled && bounds !== undefined && zoom !== undefined,\r\n    staleTime: 10 * 1000, // 10 seconds for cluster data\r\n    refetchInterval: 20 * 1000, // 20 seconds\r\n    retry: 3,\r\n  });\r\n};\r\n\r\n// Mutations\r\nexport const useUpdateLiveLocation = () => {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: ({\r\n      busId,\r\n      driverId,\r\n      location,\r\n    }: {\r\n      busId: string;\r\n      driverId: string;\r\n      location: {\r\n        latitude: number;\r\n        longitude: number;\r\n        speed?: number;\r\n        heading?: number;\r\n      };\r\n    }) => apiService.updateLiveLocation(busId, driverId, location),\r\n    \r\n    onSuccess: () => {\r\n      // Invalidate and refetch live locations\r\n      queryClient.invalidateQueries({ queryKey: queryKeys.liveLocations });\r\n    },\r\n    \r\n    onError: (error) => {\r\n      console.error('Failed to update live location:', error);\r\n    },\r\n  });\r\n};\r\n","import { io, Socket } from 'socket.io-client';\r\nimport { environment } from '../config/environment';\r\n// import { authService } from './authService'; // Unused import\r\n\r\nexport interface BusLocation {\r\n  busId: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  timestamp: string;\r\n  speed?: number;\r\n  heading?: number;\r\n  eta?: {\r\n    estimated_arrival_minutes: number;\r\n    distance_remaining: number;\r\n    is_near_stop: boolean;\r\n  };\r\n}\r\n\r\nclass WebSocketService {\r\n  public socket: Socket | null = null;\r\n  private _isConnected: boolean = false;\r\n  private connectionState: 'disconnected' | 'connecting' | 'connected' | 'reconnecting' = 'disconnected';\r\n  private reconnectAttempts: number = 0;\r\n  private maxReconnectAttempts: number = 10;\r\n  private reconnectDelay: number = 1000;\r\n  private maxReconnectDelay: number = 30000;\r\n  private heartbeatInterval: NodeJS.Timeout | null = null;\r\n  private connectionTimeout: NodeJS.Timeout | null = null;\r\n  private lastHeartbeat: number = 0;\r\n  private isShuttingDown: boolean = false;\r\n  private connectionMonitorInterval: NodeJS.Timeout | null = null;\r\n\r\n  // Event listeners\r\n  private busLocationListeners: ((location: BusLocation) => void)[] = [];\r\n  private driverConnectedListeners: ((data: any) => void)[] = [];\r\n  private driverDisconnectedListeners: ((data: any) => void)[] = [];\r\n  private studentConnectedListeners: (() => void)[] = [];\r\n  private busArrivingListeners: ((data: any) => void)[] = [];\r\n\r\n  constructor() {\r\n    // Bind methods to preserve context\r\n    this.handleConnect = this.handleConnect.bind(this);\r\n    this.handleDisconnect = this.handleDisconnect.bind(this);\r\n    this.handleError = this.handleError.bind(this);\r\n    this.handleReconnect = this.handleReconnect.bind(this);\r\n    this.startHeartbeat = this.startHeartbeat.bind(this);\r\n    this.stopHeartbeat = this.stopHeartbeat.bind(this);\r\n    this.monitorConnection = this.monitorConnection.bind(this);\r\n  }\r\n\r\n  async connect(): Promise<void> {\r\n    if (this.socket?.connected || this.connectionState === 'connecting') {\r\n      console.log('🔌 WebSocket already connected or connecting');\r\n      return;\r\n    }\r\n\r\n    // Reset shutting down flag if we're trying to connect again\r\n    if (this.isShuttingDown) {\r\n      console.log('🔄 Resetting WebSocket service state for reconnection');\r\n      this.isShuttingDown = false;\r\n    }\r\n\r\n    try {\r\n      this.connectionState = 'connecting';\r\n      console.log('🔌 Connecting to WebSocket server...');\r\n\r\n      // Get WebSocket URL with fallback\r\n      const wsUrl = environment.api.websocketUrl;\r\n      console.log('🔌 WebSocket URL:', wsUrl);\r\n\r\n      // Enhanced Socket.IO configuration for production with improved stability\r\n      this.socket = io(wsUrl, {\r\n        transports: ['websocket', 'polling'], // Prefer WebSocket, fallback to polling\r\n        upgrade: true,\r\n        rememberUpgrade: true,\r\n        timeout: 15000, // Increased timeout for better stability\r\n        forceNew: false, // Changed to false to prevent connection churn\r\n        reconnection: true, // Enable automatic reconnection\r\n        reconnectionAttempts: 5,\r\n        reconnectionDelay: 1000,\r\n        reconnectionDelayMax: 5000,\r\n        autoConnect: false,\r\n        query: {\r\n          clientType: 'student', // Default to student for map interface\r\n          version: '1.0.0',\r\n          timestamp: Date.now().toString(),\r\n        },\r\n        extraHeaders: {\r\n          'User-Agent': 'BusTrackingStudent/1.0.0',\r\n        },\r\n      });\r\n\r\n      // Set up connection timeout\r\n      this.connectionTimeout = setTimeout(() => {\r\n        if (this.connectionState === 'connecting') {\r\n          console.error('❌ WebSocket connection timeout');\r\n          this.handleError(new Error('Connection timeout'));\r\n        }\r\n      }, 15000); // 15 seconds timeout\r\n\r\n      // Set up event listeners\r\n      this.socket.on('connect', this.handleConnect);\r\n      this.socket.on('disconnect', this.handleDisconnect);\r\n      this.socket.on('connect_error', this.handleError);\r\n      this.socket.on('error', this.handleError);\r\n      this.socket.on('reconnect', this.handleReconnect);\r\n      this.socket.on('reconnect_attempt', (attemptNumber) => {\r\n        console.log(`🔄 Reconnection attempt ${attemptNumber}`);\r\n      });\r\n      this.socket.on('reconnect_error', (error) => {\r\n        console.error('❌ Reconnection error:', error);\r\n      });\r\n      this.socket.on('reconnect_failed', () => {\r\n        console.error('❌ Reconnection failed after all attempts');\r\n        // Reset state to allow manual reconnection\r\n        this.isShuttingDown = false;\r\n        this.connectionState = 'disconnected';\r\n      });\r\n\r\n      // Connect to server\r\n      this.socket.connect();\r\n\r\n    } catch (error) {\r\n      console.error('❌ WebSocket connection error:', error);\r\n      this.handleError(error);\r\n    }\r\n  }\r\n\r\n  private handleConnect(): void {\r\n    console.log('✅ WebSocket connected');\r\n    this._isConnected = true;\r\n    this.connectionState = 'connected';\r\n    this.reconnectAttempts = 0;\r\n    this.reconnectDelay = 1000;\r\n\r\n    // Clear connection timeout\r\n    if (this.connectionTimeout) {\r\n      clearTimeout(this.connectionTimeout);\r\n      this.connectionTimeout = null;\r\n    }\r\n\r\n    // Start heartbeat and connection monitoring\r\n    this.startHeartbeat();\r\n    this.startConnectionMonitoring();\r\n\r\n    // Emit connection event based on client type\r\n    const clientType = this.socket?.io?.opts?.query?.clientType || 'student';\r\n    if (clientType === 'driver') {\r\n      this.socket?.emit('driver:connected', {\r\n        timestamp: new Date().toISOString(),\r\n        clientInfo: {\r\n          userAgent: navigator.userAgent,\r\n          platform: navigator.platform,\r\n          language: navigator.language,\r\n        },\r\n      });\r\n    } else {\r\n      this.socket?.emit('student:connect', {\r\n        timestamp: new Date().toISOString(),\r\n        clientInfo: {\r\n          userAgent: navigator.userAgent,\r\n          platform: navigator.platform,\r\n          language: navigator.language,\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  private handleDisconnect(reason: string): void {\r\n    console.log('❌ WebSocket disconnected:', reason);\r\n    this._isConnected = false;\r\n    this.connectionState = 'disconnected';\r\n    this.stopHeartbeat();\r\n    this.stopConnectionMonitoring();\r\n\r\n    // Clear connection timeout\r\n    if (this.connectionTimeout) {\r\n      clearTimeout(this.connectionTimeout);\r\n      this.connectionTimeout = null;\r\n    }\r\n\r\n    // Don't reconnect if we're shutting down or if it was a manual disconnect\r\n    if (this.isShuttingDown || reason === 'io client disconnect') {\r\n      return;\r\n    }\r\n\r\n    // Attempt reconnection\r\n    this.handleReconnect();\r\n  }\r\n\r\n  private handleError(error: any): void {\r\n    console.error('❌ WebSocket error:', error);\r\n    \r\n    // Clear connection timeout\r\n    if (this.connectionTimeout) {\r\n      clearTimeout(this.connectionTimeout);\r\n      this.connectionTimeout = null;\r\n    }\r\n\r\n    // Don't reconnect if we're shutting down\r\n    if (this.isShuttingDown) {\r\n      return;\r\n    }\r\n\r\n    // Attempt reconnection for network errors\r\n    if (error.type === 'TransportError' || error.type === 'TransportOpenError') {\r\n      this.handleReconnect();\r\n    }\r\n  }\r\n\r\n  private handleReconnect(): void {\r\n    if (this.isShuttingDown || this.connectionState === 'reconnecting') {\r\n      return;\r\n    }\r\n\r\n    if (this.reconnectAttempts >= this.maxReconnectAttempts) {\r\n      console.error('❌ Max reconnection attempts reached');\r\n      this.connectionState = 'disconnected';\r\n      return;\r\n    }\r\n\r\n    this.connectionState = 'reconnecting';\r\n    this.reconnectAttempts++;\r\n\r\n    console.log(`🔄 Attempting to reconnect... (${this.reconnectAttempts}/${this.maxReconnectAttempts})`);\r\n\r\n    // Exponential backoff with jitter\r\n    const delay = Math.min(\r\n      this.reconnectDelay * Math.pow(2, this.reconnectAttempts - 1) + Math.random() * 1000,\r\n      this.maxReconnectDelay\r\n    );\r\n\r\n    setTimeout(() => {\r\n      if (!this.isShuttingDown) {\r\n        this.connect();\r\n      }\r\n    }, delay);\r\n  }\r\n\r\n  private startHeartbeat(): void {\r\n    if (this.heartbeatInterval) {\r\n      clearInterval(this.heartbeatInterval);\r\n    }\r\n\r\n    this.heartbeatInterval = setInterval(() => {\r\n      if (this.socket?.connected) {\r\n        this.socket.emit('ping');\r\n        this.lastHeartbeat = Date.now();\r\n      }\r\n    }, 30000); // Send ping every 30 seconds\r\n  }\r\n\r\n  private stopHeartbeat(): void {\r\n    if (this.heartbeatInterval) {\r\n      clearInterval(this.heartbeatInterval);\r\n      this.heartbeatInterval = null;\r\n    }\r\n  }\r\n\r\n  private startConnectionMonitoring(): void {\r\n    if (this.connectionMonitorInterval) {\r\n      clearInterval(this.connectionMonitorInterval);\r\n    }\r\n\r\n    this.connectionMonitorInterval = setInterval(() => {\r\n      this.monitorConnection();\r\n    }, 10000); // Check connection every 10 seconds\r\n  }\r\n\r\n  private stopConnectionMonitoring(): void {\r\n    if (this.connectionMonitorInterval) {\r\n      clearInterval(this.connectionMonitorInterval);\r\n      this.connectionMonitorInterval = null;\r\n    }\r\n  }\r\n\r\n  private monitorConnection(): void {\r\n    if (!this.socket) {\r\n      console.log('🔍 Connection monitor: No socket available');\r\n      return;\r\n    }\r\n\r\n    const isConnected = this.socket.connected;\r\n    const timeSinceLastHeartbeat = Date.now() - this.lastHeartbeat;\r\n\r\n    console.log(`🔍 Connection monitor: Connected=${isConnected}, Last heartbeat=${timeSinceLastHeartbeat}ms ago`);\r\n\r\n    // If socket thinks it's connected but we haven't received a heartbeat in 60 seconds, consider it disconnected\r\n    if (isConnected && timeSinceLastHeartbeat > 60000 && this.lastHeartbeat > 0) {\r\n      console.warn('⚠️ Connection monitor: No heartbeat received, forcing reconnection');\r\n      this.socket.disconnect();\r\n      this.handleReconnect();\r\n    }\r\n\r\n    // Update internal state\r\n    if (this._isConnected !== isConnected) {\r\n      console.log(`🔄 Connection state changed: ${this._isConnected} -> ${isConnected}`);\r\n      this._isConnected = isConnected;\r\n      this.connectionState = isConnected ? 'connected' : 'disconnected';\r\n    }\r\n  }\r\n\r\n  disconnect(): void {\r\n    console.log('🔌 Disconnecting WebSocket...');\r\n    this.isShuttingDown = true;\r\n    this.connectionState = 'disconnected';\r\n    this._isConnected = false;\r\n\r\n    // Stop heartbeat\r\n    this.stopHeartbeat();\r\n    this.stopConnectionMonitoring();\r\n\r\n    // Clear connection timeout\r\n    if (this.connectionTimeout) {\r\n      clearTimeout(this.connectionTimeout);\r\n      this.connectionTimeout = null;\r\n    }\r\n\r\n    // Disconnect socket\r\n    if (this.socket) {\r\n      this.socket.disconnect();\r\n      this.socket = null;\r\n    }\r\n\r\n    // Reset state\r\n    this.reconnectAttempts = 0;\r\n    this.reconnectDelay = 1000;\r\n  }\r\n\r\n  // Soft disconnect for cleanup that allows reconnection\r\n  softDisconnect(): void {\r\n    console.log('🔌 Soft disconnecting WebSocket...');\r\n    this.connectionState = 'disconnected';\r\n    this._isConnected = false;\r\n\r\n    // Stop heartbeat\r\n    this.stopHeartbeat();\r\n    this.stopConnectionMonitoring();\r\n\r\n    // Clear connection timeout\r\n    if (this.connectionTimeout) {\r\n      clearTimeout(this.connectionTimeout);\r\n      this.connectionTimeout = null;\r\n    }\r\n\r\n    // Disconnect socket but don't set isShuttingDown\r\n    if (this.socket) {\r\n      this.socket.disconnect();\r\n      this.socket = null;\r\n    }\r\n\r\n    // Reset reconnection attempts to allow reconnection\r\n    this.reconnectAttempts = 0;\r\n    this.reconnectDelay = 1000;\r\n  }\r\n\r\n  isConnected(): boolean {\r\n    return this._isConnected && this.socket?.connected === true;\r\n  }\r\n\r\n  getConnectionState(): 'disconnected' | 'connecting' | 'connected' | 'reconnecting' {\r\n    return this.connectionState;\r\n  }\r\n\r\n  getConnectionStatus(): boolean {\r\n    return this._isConnected;\r\n  }\r\n\r\n  authenticateAsDriver(token: string, callbacks?: {\r\n    onSuccess?: (data: any) => void;\r\n    onFailure?: (error: any) => void;\r\n    onError?: (error: any) => void;\r\n  }): void {\r\n    console.log('🔐 Driver: Starting authentication process...');\r\n    console.log('🔐 Socket connected:', this.isConnected());\r\n    console.log('🔐 Socket state:', this.getConnectionState());\r\n    \r\n    if (this.socket && this.isConnected()) {\r\n      console.log('🔐 Driver: Sending authentication request...');\r\n      \r\n      // Remove any existing listeners to prevent duplicates\r\n      this.socket.off('driver:authenticated');\r\n      this.socket.off('driver:authentication_failed');\r\n      this.socket.off('error');\r\n      \r\n      // Set up authentication response listeners BEFORE sending the request\r\n      this.socket.once('driver:authenticated', (data) => {\r\n        console.log('✅ Driver: Authentication successful:', data);\r\n        if (callbacks?.onSuccess) {\r\n          callbacks.onSuccess(data);\r\n        }\r\n      });\r\n      \r\n      this.socket.once('driver:authentication_failed', (error) => {\r\n        console.error('❌ Driver: Authentication failed:', error);\r\n        if (callbacks?.onFailure) {\r\n          callbacks.onFailure(error);\r\n        }\r\n      });\r\n      \r\n      this.socket.once('error', (error) => {\r\n        console.error('❌ Driver: Socket error during authentication:', error);\r\n        if (callbacks?.onError) {\r\n          callbacks.onError(error);\r\n        }\r\n      });\r\n      \r\n      // Send the authentication request\r\n      this.socket.emit('driver:authenticate', { token });\r\n      console.log('📤 Authentication request sent with token length:', token.length);\r\n    } else {\r\n      console.error('❌ Driver: Cannot authenticate - socket not connected');\r\n      console.error('❌ Socket object:', !!this.socket);\r\n      console.error('❌ Connection state:', this.getConnectionState());\r\n      \r\n      if (callbacks?.onError) {\r\n        callbacks.onError(new Error('Socket not connected'));\r\n      }\r\n    }\r\n  }\r\n\r\n  sendLocationUpdate(locationData: {\r\n    driverId: string;\r\n    busId: string;\r\n    latitude: number;\r\n    longitude: number;\r\n    timestamp: string;\r\n    speed?: number;\r\n    heading?: number;\r\n  }): void {\r\n    if (this.socket && this.isConnected()) {\r\n      console.log('📍 Sending location update:', locationData);\r\n      this.socket.emit('driver:locationUpdate', locationData);\r\n    } else {\r\n      console.error('❌ Cannot send location update - socket not connected');\r\n    }\r\n  }\r\n\r\n  // Event listener methods\r\n  onBusLocationUpdate(callback: (location: BusLocation) => void): void {\r\n    this.busLocationListeners.push(callback);\r\n    this.socket?.on('bus:locationUpdate', callback);\r\n  }\r\n\r\n  onDriverConnected(callback: (data: any) => void): void {\r\n    this.driverConnectedListeners.push(callback);\r\n    this.socket?.on('driver:connected', callback);\r\n  }\r\n\r\n  onDriverDisconnected(callback: (data: any) => void): void {\r\n    this.driverDisconnectedListeners.push(callback);\r\n    this.socket?.on('driver:disconnected', callback);\r\n  }\r\n\r\n  onStudentConnected(callback: () => void): void {\r\n    this.studentConnectedListeners.push(callback);\r\n    this.socket?.on('student:connected', callback);\r\n  }\r\n\r\n  onBusArriving(callback: (data: any) => void): void {\r\n    this.busArrivingListeners.push(callback);\r\n    this.socket?.on('bus:arriving', callback);\r\n  }\r\n\r\n  off(event: string): void {\r\n    this.socket?.off(event);\r\n  }\r\n\r\n  // Enhanced method to get connection statistics\r\n  getConnectionStats(): {\r\n    isConnected: boolean;\r\n    connectionState: string;\r\n    reconnectAttempts: number;\r\n    maxReconnectAttempts: number;\r\n    lastHeartbeat: number;\r\n    uptime: number;\r\n  } {\r\n    return {\r\n      isConnected: this._isConnected,\r\n      connectionState: this.connectionState,\r\n      reconnectAttempts: this.reconnectAttempts,\r\n      maxReconnectAttempts: this.maxReconnectAttempts,\r\n      lastHeartbeat: this.lastHeartbeat,\r\n      uptime: this.lastHeartbeat > 0 ? Date.now() - this.lastHeartbeat : 0,\r\n    };\r\n  }\r\n\r\n  // Health check method\r\n  async healthCheck(): Promise<{ healthy: boolean; details: any }> {\r\n    const stats = this.getConnectionStats();\r\n    \r\n    const healthy = this.isConnected() && \r\n                   this.connectionState === 'connected' && \r\n                   stats.lastHeartbeat > 0 &&\r\n                   (Date.now() - stats.lastHeartbeat) < 60000; // Last heartbeat within 1 minute\r\n\r\n    return {\r\n      healthy,\r\n      details: {\r\n        ...stats,\r\n        socketExists: !!this.socket,\r\n        socketConnected: this.socket?.connected,\r\n        isShuttingDown: this.isShuttingDown,\r\n      }\r\n    };\r\n  }\r\n\r\n  // Reset WebSocket service state for reconnection\r\n  resetState(): void {\r\n    console.log('🔄 Resetting WebSocket service state...');\r\n    this.isShuttingDown = false;\r\n    this.connectionState = 'disconnected';\r\n    this._isConnected = false;\r\n    this.reconnectAttempts = 0;\r\n    this.reconnectDelay = 1000;\r\n    this.lastHeartbeat = 0;\r\n  }\r\n\r\n  // Set client type dynamically\r\n  setClientType(clientType: 'student' | 'driver' | 'admin'): void {\r\n    if (this.socket?.io?.opts?.query) {\r\n      this.socket.io.opts.query.clientType = clientType;\r\n    }\r\n    console.log(`🔄 Client type set to: ${clientType}`);\r\n  }\r\n}\r\n\r\nexport const websocketService = new WebSocketService();\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { Socket } from 'socket.io-client';\r\nimport { supabase } from '../config/supabase';\r\nimport { websocketService } from '../services/websocket';\r\nimport maplibregl from 'maplibre-gl';\r\nimport 'maplibre-gl/dist/maplibre-gl.css';\r\nimport './DriverInterface.css';\r\n\r\ninterface BusInfo {\r\n  bus_id: string;\r\n  bus_number: string;\r\n  route_id: string;\r\n  route_name: string;\r\n  driver_id: string;\r\n  driver_name: string;\r\n}\r\n\r\ninterface LocationData {\r\n  driverId: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  timestamp: string;\r\n  speed?: number;\r\n  heading?: number;\r\n}\r\n\r\ninterface LoginForm {\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\nconst DriverInterface: React.FC = () => {\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [isTracking, setIsTracking] = useState(false);\r\n  const [busInfo, setBusInfo] = useState<BusInfo | null>(null);\r\n  const [currentLocation, setCurrentLocation] =\r\n    useState<GeolocationPosition | null>(null);\r\n  const [locationError, setLocationError] = useState<string | null>(null);\r\n  const [socketError, setSocketError] = useState<string | null>(null);\r\n  const [lastUpdateTime, setLastUpdateTime] = useState<string | null>(null);\r\n  const [updateCount, setUpdateCount] = useState(0);\r\n  const [loginForm, setLoginForm] = useState<LoginForm>({\r\n    email: '',\r\n    password: '',\r\n  });\r\n  const [loginError, setLoginError] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const socketRef = useRef<Socket | null>(null);\r\n  const locationIntervalRef = useRef<NodeJS.Timeout | null>(null);\r\n  const watchIdRef = useRef<number | null>(null);\r\n  const mapRef = useRef<maplibregl.Map | null>(null);\r\n  const mapContainerRef = useRef<HTMLDivElement>(null);\r\n  const markerRef = useRef<maplibregl.Marker | null>(null);\r\n\r\n  // Initialize Supabase auth listener\r\n  useEffect(() => {\r\n    const {\r\n      data: { subscription },\r\n    } = supabase.auth.onAuthStateChange(async (event, session) => {\r\n      if (event === 'SIGNED_IN' && session) {\r\n        await authenticateWithSocket(session.access_token);\r\n      } else if (event === 'SIGNED_OUT') {\r\n        setIsAuthenticated(false);\r\n        setBusInfo(null);\r\n        disconnectSocket();\r\n        cleanupMap();\r\n      }\r\n    });\r\n\r\n    return () => subscription.unsubscribe();\r\n  }, []);\r\n\r\n  // Proactively request location permission when component mounts\r\n  useEffect(() => {\r\n    if (isAuthenticated && navigator.geolocation) {\r\n      console.log('🔍 Checking location permission on component mount...');\r\n\r\n      // Check current permission state\r\n      if ('permissions' in navigator) {\r\n        navigator.permissions\r\n          .query({ name: 'geolocation' })\r\n          .then((permission) => {\r\n            console.log('📍 Initial permission state:', permission.state);\r\n\r\n            // If permission is granted, we can proceed\r\n            if (permission.state === 'granted') {\r\n              console.log('✅ Location permission already granted');\r\n            } else if (permission.state === 'prompt') {\r\n              console.log('❓ Location permission needs to be requested');\r\n            } else if (permission.state === 'denied') {\r\n              console.log('❌ Location permission denied');\r\n              setLocationError(\r\n                'Location permission is denied. Please enable it in your browser settings.'\r\n              );\r\n            }\r\n          });\r\n      }\r\n    }\r\n  }, [isAuthenticated]);\r\n\r\n  // Check location permission on component mount\r\n  useEffect(() => {\r\n    const checkLocationPermission = async () => {\r\n      if (!navigator.geolocation) {\r\n        setLocationError('Geolocation is not supported by this browser');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // Check if permission is already granted\r\n        if ('permissions' in navigator) {\r\n          const permission = await navigator.permissions.query({\r\n            name: 'geolocation',\r\n          });\r\n          if (permission.state === 'denied') {\r\n            setLocationError(\r\n              'Location permission denied. Please enable location access in your browser settings.'\r\n            );\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.log(\r\n          'Permission API not supported, will check when user clicks Start Tracking'\r\n        );\r\n      }\r\n    };\r\n\r\n    checkLocationPermission();\r\n  }, []);\r\n\r\n  const cleanupMap = () => {\r\n    if (markerRef.current) {\r\n      markerRef.current.remove();\r\n      markerRef.current = null;\r\n    }\r\n    if (mapRef.current) {\r\n      mapRef.current.remove();\r\n      mapRef.current = null;\r\n    }\r\n  };\r\n\r\n  const initializeMap = (latitude: number, longitude: number) => {\r\n    if (!mapContainerRef.current || mapRef.current) return;\r\n\r\n    mapRef.current = new maplibregl.Map({\r\n      container: mapContainerRef.current,\r\n      style: {\r\n        version: 8,\r\n        sources: {\r\n          osm: {\r\n            type: 'raster',\r\n            tiles: [\r\n              'https://tile.openstreetmap.org/{z}/{x}/{y}.png',\r\n              'https://a.tile.openstreetmap.org/{z}/{x}/{y}.png',\r\n              'https://b.tile.openstreetmap.org/{z}/{x}/{y}.png',\r\n              'https://c.tile.openstreetmap.org/{z}/{x}/{y}.png',\r\n            ],\r\n            tileSize: 256,\r\n            attribution: '© OpenStreetMap contributors',\r\n            maxzoom: 19,\r\n          },\r\n        },\r\n        layers: [\r\n          {\r\n            id: 'osm-tiles',\r\n            type: 'raster',\r\n            source: 'osm',\r\n            minzoom: 0,\r\n            maxzoom: 19,\r\n          },\r\n        ],\r\n      },\r\n      center: [longitude, latitude],\r\n      zoom: 15,\r\n      bearing: 0,\r\n      pitch: 0,\r\n      attributionControl: true,\r\n      maxZoom: 19,\r\n      minZoom: 1,\r\n      preserveDrawingBuffer: false,\r\n      antialias: true,\r\n      dragRotate: false,\r\n    });\r\n\r\n    // Add navigation controls\r\n    mapRef.current.addControl(new maplibregl.NavigationControl(), 'top-right');\r\n\r\n    // Handle map load event\r\n    mapRef.current.once('load', () => {\r\n      console.log('✅ Driver map loaded successfully');\r\n\r\n      // Disable rotation features after map loads\r\n      if (mapRef.current) {\r\n        mapRef.current.dragRotate.disable();\r\n        mapRef.current.touchZoomRotate.disableRotation();\r\n        console.log('🔄 Rotation features disabled');\r\n      }\r\n    });\r\n\r\n    // Handle map errors\r\n    mapRef.current.on('error', (e: unknown) => {\r\n      console.error('❌ Driver map error:', e);\r\n    });\r\n\r\n    // Create marker for driver location with enhanced styling\r\n    const markerElement = document.createElement('div');\r\n    markerElement.className = 'driver-marker';\r\n    markerElement.innerHTML = `\r\n      <div class=\"driver-marker-content\">\r\n        <div style=\"font-size: 16px;\">🚌</div>\r\n      </div>\r\n    `;\r\n\r\n    markerRef.current = new maplibregl.Marker({\r\n      element: markerElement,\r\n      anchor: 'center',\r\n    })\r\n      .setLngLat([longitude, latitude])\r\n      .addTo(mapRef.current);\r\n\r\n    // Add popup to marker with enhanced styling\r\n    const popup = new maplibregl.Popup({\r\n      offset: 25,\r\n      className: 'driver-popup',\r\n    }).setHTML(`\r\n        <div class=\"driver-popup\">\r\n          <h3>🚌 Driver Location</h3>\r\n          <p><strong>Bus:</strong> ${busInfo?.bus_number || 'Unknown'}</p>\r\n          <p><strong>Route:</strong> ${busInfo?.route_name || 'Unknown'}</p>\r\n          <p><strong>Driver:</strong> ${busInfo?.driver_name || 'Unknown'}</p>\r\n          <p><strong>Status:</strong> <span style=\"color: #059669;\">Active</span></p>\r\n        </div>\r\n      `);\r\n\r\n    markerRef.current.setPopup(popup);\r\n  };\r\n\r\n  const updateMapLocation = (latitude: number, longitude: number) => {\r\n    if (!mapRef.current || !markerRef.current) return;\r\n\r\n    const newLocation = [longitude, latitude] as [number, number];\r\n\r\n    // Update marker position\r\n    markerRef.current.setLngLat(newLocation);\r\n\r\n    // Smoothly fly to new location\r\n    mapRef.current.flyTo({\r\n      center: newLocation,\r\n      duration: 1000,\r\n    });\r\n\r\n    // Update popup content with enhanced styling\r\n    const popup = new maplibregl.Popup({\r\n      offset: 25,\r\n      className: 'driver-popup',\r\n    }).setHTML(`\r\n        <div class=\"driver-popup\">\r\n          <h3>🚌 Driver Location</h3>\r\n          <p><strong>Bus:</strong> ${busInfo?.bus_number || 'Unknown'}</p>\r\n          <p><strong>Route:</strong> ${busInfo?.route_name || 'Unknown'}</p>\r\n          <p><strong>Driver:</strong> ${busInfo?.driver_name || 'Unknown'}</p>\r\n          <p><strong>Status:</strong> <span style=\"color: #059669;\">Active</span></p>\r\n          <p><strong>Updated:</strong> ${new Date().toLocaleTimeString()}</p>\r\n          <p><strong>Coordinates:</strong> ${latitude.toFixed(6)}, ${longitude.toFixed(6)}</p>\r\n        </div>\r\n      `);\r\n\r\n    markerRef.current.setPopup(popup);\r\n  };\r\n\r\n  const handleLogin = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setLoginError(null);\r\n\r\n    try {\r\n      // Driver login attempt\r\n\r\n      const { data, error } = await supabase.auth.signInWithPassword({\r\n        email: loginForm.email,\r\n        password: loginForm.password,\r\n      });\r\n\r\n      if (error) {\r\n        console.error('❌ Login error:', error);\r\n        setLoginError(error.message);\r\n        return;\r\n      }\r\n\r\n      if (data.user && data.session) {\r\n        console.log('✅ Login successful:', data.user.email);\r\n\r\n        // Authenticate with WebSocket immediately\r\n        await authenticateWithSocket(data.session.access_token);\r\n\r\n        // Clear form\r\n        setLoginForm({ email: '', password: '' });\r\n      } else {\r\n        setLoginError('Login failed - no user data received');\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Login error:', error);\r\n      setLoginError('An unexpected error occurred during login');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const authenticateWithSocket = async (token: string) => {\r\n    try {\r\n      console.log('🔌 Driver: Connecting to WebSocket...');\r\n\r\n      // Use the WebSocket service\r\n      await websocketService.connect();\r\n\r\n      // Handle socket events\r\n      websocketService.socket?.on('connect', () => {\r\n        console.log('🔌 Driver: Connected to WebSocket server');\r\n        setSocketError(null);\r\n      });\r\n\r\n      websocketService.socket?.on('disconnect', () => {\r\n        console.log('🔌 Driver: Disconnected from WebSocket server');\r\n        setSocketError('Disconnected from server');\r\n      });\r\n\r\n      websocketService.socket?.on('error', (error) => {\r\n        console.error('❌ Driver: Socket error:', error);\r\n        setSocketError(error.message || 'Socket error occurred');\r\n      });\r\n\r\n      websocketService.socket?.on(\r\n        'driver:authenticated',\r\n        (data: { driverId: string; busId: string; busInfo: BusInfo }) => {\r\n          console.log('✅ Driver: Authentication successful:', data);\r\n          setIsAuthenticated(true);\r\n          setBusInfo(data.busInfo);\r\n          setSocketError(null);\r\n        }\r\n      );\r\n\r\n      websocketService.socket?.on('driver:locationConfirmed', (data) => {\r\n        console.log('📍 Driver: Location confirmed:', data);\r\n        setLastUpdateTime(new Date().toLocaleTimeString());\r\n        setUpdateCount((prev) => prev + 1);\r\n      });\r\n\r\n      // Store the socket reference\r\n      socketRef.current = websocketService.socket;\r\n\r\n      // Authenticate with the server\r\n      websocketService.authenticateAsDriver(token);\r\n    } catch (error) {\r\n      console.error('❌ Driver: Authentication error:', error);\r\n      setSocketError('Failed to authenticate with server');\r\n    }\r\n  };\r\n\r\n  const disconnectSocket = () => {\r\n    websocketService.disconnect();\r\n    socketRef.current = null;\r\n  };\r\n\r\n  const startLocationTracking = async () => {\r\n    if (!navigator.geolocation) {\r\n      setLocationError('Geolocation is not supported by this browser');\r\n      return;\r\n    }\r\n\r\n    // Enhanced mobile detection\r\n    const isMobile =\r\n      /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n        navigator.userAgent\r\n      );\r\n    const isFirefox = navigator.userAgent.includes('Firefox');\r\n    const isChrome = navigator.userAgent.includes('Chrome');\r\n    const isSafari =\r\n      navigator.userAgent.includes('Safari') &&\r\n      !navigator.userAgent.includes('Chrome');\r\n\r\n    console.log(\r\n      `🌐 Device detected: ${isMobile ? 'Mobile' : 'Desktop'} - ${isFirefox ? 'Firefox' : isChrome ? 'Chrome' : isSafari ? 'Safari' : 'Other'}`\r\n    );\r\n\r\n    // Mobile-specific location options\r\n    const options = {\r\n      enableHighAccuracy: true,\r\n      timeout: isMobile ? 30000 : 60000, // Shorter timeout for mobile\r\n      maximumAge: 0, // Force fresh location - no caching\r\n    };\r\n\r\n    console.log('📍 Starting location tracking with options:', options);\r\n\r\n    // Force location permission request\r\n    try {\r\n      // Clear any cached permissions first\r\n      if ('permissions' in navigator) {\r\n        const permission = await navigator.permissions.query({\r\n          name: 'geolocation',\r\n        });\r\n        console.log(`🔐 Current permission state: ${permission.state}`);\r\n\r\n        if (permission.state === 'denied') {\r\n          const mobileError = isMobile\r\n            ? 'Location permission denied on mobile. Please:\\n1. Go to your phone Settings\\n2. Find this browser app\\n3. Enable Location permission\\n4. Refresh this page'\r\n            : 'Location permission denied. Please reset location permissions and try again.';\r\n          setLocationError(mobileError);\r\n          return;\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(\r\n        'Permission API not supported, proceeding with geolocation request'\r\n      );\r\n    }\r\n\r\n    console.log('📍 Requesting location permission...');\r\n    setLocationError(\r\n      isMobile\r\n        ? 'Requesting location permission on mobile... Please allow when prompted. If no prompt appears, check your phone settings.'\r\n        : 'Requesting location permission... Please allow when prompted.'\r\n    );\r\n\r\n    // Get initial position with enhanced error handling\r\n    navigator.geolocation.getCurrentPosition(\r\n      (position) => {\r\n        console.log('✅ Initial position obtained:', {\r\n          latitude: position.coords.latitude,\r\n          longitude: position.coords.longitude,\r\n          accuracy: position.coords.accuracy,\r\n          timestamp: new Date(position.timestamp).toLocaleString(),\r\n        });\r\n        setCurrentLocation(position);\r\n        setLocationError(null);\r\n\r\n        // Initialize map with current location\r\n        initializeMap(position.coords.latitude, position.coords.longitude);\r\n\r\n        sendLocationUpdate(position);\r\n      },\r\n      (error) => {\r\n        console.error('❌ Geolocation error:', error);\r\n        let errorMessage = 'Location error: ';\r\n\r\n        switch (error.code) {\r\n          case error.PERMISSION_DENIED:\r\n            if (isMobile) {\r\n              errorMessage =\r\n                'Mobile location permission denied. Please:\\n\\n' +\r\n                '1. Go to your phone Settings\\n' +\r\n                '2. Find this browser app (Chrome/Firefox/Safari)\\n' +\r\n                '3. Tap \"Permissions\" or \"Privacy\"\\n' +\r\n                '4. Enable \"Location\" permission\\n' +\r\n                '5. Return to this page and refresh\\n\\n' +\r\n                'Alternative: Try opening this page in a different browser app.';\r\n            } else if (isFirefox) {\r\n              errorMessage +=\r\n                'Firefox location permission issue. Please: 1) Click the lock icon in address bar 2) Set location to \"Allow\" 3) Refresh the page 4) Try again';\r\n            } else {\r\n              errorMessage +=\r\n                'Permission denied. Please enable location access in your browser settings. On mobile, check your browser permissions and try refreshing the page.';\r\n            }\r\n            break;\r\n          case error.POSITION_UNAVAILABLE:\r\n            errorMessage = isMobile\r\n              ? 'Location unavailable on mobile. Please:\\n1. Go outdoors or near a window\\n2. Wait 10-15 seconds\\n3. Make sure GPS is enabled in phone settings\\n4. Try again'\r\n              : 'Location information unavailable.';\r\n            break;\r\n          case error.TIMEOUT:\r\n            errorMessage = isMobile\r\n              ? 'Location request timed out on mobile. Please:\\n1. Go outdoors for better GPS signal\\n2. Wait 30 seconds and try again\\n3. Check if GPS is enabled in phone settings'\r\n              : 'Location request timed out. Please try again.';\r\n            break;\r\n          default:\r\n            errorMessage += error.message;\r\n        }\r\n\r\n        setLocationError(errorMessage);\r\n      },\r\n      options\r\n    );\r\n\r\n    // Start watching position with same options\r\n    watchIdRef.current = navigator.geolocation.watchPosition(\r\n      (position) => {\r\n        console.log('📍 Location update received:', {\r\n          latitude: position.coords.latitude,\r\n          longitude: position.coords.longitude,\r\n          accuracy: position.coords.accuracy,\r\n          timestamp: new Date(position.timestamp).toLocaleString(),\r\n        });\r\n        setCurrentLocation(position);\r\n        setLocationError(null);\r\n\r\n        // Update map with new location\r\n        updateMapLocation(position.coords.latitude, position.coords.longitude);\r\n\r\n        sendLocationUpdate(position);\r\n      },\r\n      (error) => {\r\n        console.error('❌ Geolocation watch error:', error);\r\n        let errorMessage = 'Location tracking error: ';\r\n\r\n        switch (error.code) {\r\n          case error.PERMISSION_DENIED:\r\n            errorMessage = isMobile\r\n              ? 'Location permission lost on mobile. Please refresh the page and allow location access again.'\r\n              : 'Permission denied. Please enable location access in your browser settings.';\r\n            break;\r\n          case error.POSITION_UNAVAILABLE:\r\n            errorMessage = isMobile\r\n              ? 'GPS signal lost on mobile. Please go outdoors or near a window.'\r\n              : 'Location information unavailable.';\r\n            break;\r\n          case error.TIMEOUT:\r\n            errorMessage = isMobile\r\n              ? 'GPS timeout on mobile. Please check your location and try again.'\r\n              : 'Location request timed out. Please try again.';\r\n            break;\r\n          default:\r\n            errorMessage += error.message;\r\n        }\r\n\r\n        setLocationError(errorMessage);\r\n      },\r\n      options\r\n    );\r\n\r\n    setIsTracking(true);\r\n    console.log('📍 Location tracking started');\r\n  };\r\n\r\n  const stopLocationTracking = () => {\r\n    if (watchIdRef.current) {\r\n      navigator.geolocation.clearWatch(watchIdRef.current);\r\n      watchIdRef.current = null;\r\n    }\r\n\r\n    if (locationIntervalRef.current) {\r\n      clearInterval(locationIntervalRef.current);\r\n      locationIntervalRef.current = null;\r\n    }\r\n\r\n    setIsTracking(false);\r\n    console.log('📍 Location tracking stopped');\r\n  };\r\n\r\n  const sendLocationUpdate = (position: GeolocationPosition) => {\r\n    if (!socketRef.current || !busInfo) return;\r\n\r\n    const locationData: LocationData = {\r\n      driverId: busInfo.driver_id,\r\n      latitude: position.coords.latitude,\r\n      longitude: position.coords.longitude,\r\n      timestamp: new Date().toISOString(),\r\n      speed: position.coords.speed || undefined,\r\n      heading: position.coords.heading || undefined,\r\n    };\r\n\r\n    socketRef.current.emit('driver:locationUpdate', locationData);\r\n  };\r\n\r\n  const handleSignOut = async () => {\r\n    try {\r\n      console.log('🔐 Driver: Starting sign out...');\r\n\r\n      // Stop tracking if active\r\n      if (isTracking) {\r\n        stopLocationTracking();\r\n      }\r\n\r\n      // Disconnect socket\r\n      disconnectSocket();\r\n\r\n      // Sign out from Supabase\r\n      const { error } = await supabase.auth.signOut();\r\n\r\n      if (error) {\r\n        console.error('❌ Sign out error:', error);\r\n      } else {\r\n        console.log('✅ Driver: Sign out successful');\r\n\r\n        // Clear local state\r\n        setIsAuthenticated(false);\r\n        setBusInfo(null);\r\n        setCurrentLocation(null);\r\n        setLocationError(null);\r\n        setSocketError(null);\r\n        setLastUpdateTime(null);\r\n        setUpdateCount(0);\r\n\r\n        // Clean up map\r\n        cleanupMap();\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Sign out error:', error);\r\n    }\r\n  };\r\n\r\n  if (!isAuthenticated) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center p-4\">\r\n        <div className=\"max-w-md w-full\">\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <div className=\"text-center mb-6\">\r\n              <h1 className=\"text-2xl font-bold text-gray-900\">\r\n                🚌 Driver Login\r\n              </h1>\r\n              <p className=\"text-gray-600 mt-2\">\r\n                Sign in to start tracking your bus\r\n              </p>\r\n            </div>\r\n\r\n            {loginError && (\r\n              <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-4\">\r\n                <p className=\"text-red-700 text-sm\">{loginError}</p>\r\n              </div>\r\n            )}\r\n\r\n            <form onSubmit={handleLogin} className=\"space-y-4\">\r\n              <div>\r\n                <label\r\n                  htmlFor=\"email\"\r\n                  className=\"block text-sm font-medium text-gray-700 mb-1\"\r\n                >\r\n                  Email Address\r\n                </label>\r\n                <input\r\n                  id=\"email\"\r\n                  type=\"email\"\r\n                  required\r\n                  value={loginForm.email}\r\n                  onChange={(e) =>\r\n                    setLoginForm((prev) => ({ ...prev, email: e.target.value }))\r\n                  }\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                  placeholder=\"Enter your email\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label\r\n                  htmlFor=\"password\"\r\n                  className=\"block text-sm font-medium text-gray-700 mb-1\"\r\n                >\r\n                  Password\r\n                </label>\r\n                <input\r\n                  id=\"password\"\r\n                  type=\"password\"\r\n                  required\r\n                  value={loginForm.password}\r\n                  onChange={(e) =>\r\n                    setLoginForm((prev) => ({\r\n                      ...prev,\r\n                      password: e.target.value,\r\n                    }))\r\n                  }\r\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n                  placeholder=\"Enter your password\"\r\n                />\r\n              </div>\r\n\r\n              <button\r\n                type=\"submit\"\r\n                disabled={isLoading}\r\n                className=\"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed\"\r\n              >\r\n                {isLoading ? 'Signing In...' : 'Sign In'}\r\n              </button>\r\n            </form>\r\n\r\n            <div className=\"mt-4 text-center\">\r\n              <p className=\"text-sm text-gray-600\">\r\n                Please contact your administrator for login credentials\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 p-4\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"bg-white rounded-lg shadow-lg p-6 mb-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold text-gray-900\">\r\n                🚌 Driver Dashboard\r\n              </h1>\r\n              <p className=\"text-gray-600 mt-1\">\r\n                Welcome, {busInfo?.driver_name} | Bus: {busInfo?.bus_number} |\r\n                Route: {busInfo?.route_name}\r\n              </p>\r\n            </div>\r\n            <button\r\n              onClick={handleSignOut}\r\n              className=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500\"\r\n            >\r\n              Sign Out\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Status Cards */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6\">\r\n          {/* Connection Status */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <div className=\"flex items-center\">\r\n              <div\r\n                className={`w-3 h-3 rounded-full mr-3 ${socketError ? 'bg-red-500' : 'bg-green-500'}`}\r\n              ></div>\r\n              <div>\r\n                <h3 className=\"font-semibold text-gray-900\">Connection</h3>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {socketError ? 'Disconnected' : 'Connected'}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Tracking Status */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <div className=\"flex items-center\">\r\n              <div\r\n                className={`w-3 h-3 rounded-full mr-3 ${isTracking ? 'bg-green-500' : 'bg-gray-400'}`}\r\n              ></div>\r\n              <div>\r\n                <h3 className=\"font-semibold text-gray-900\">GPS Tracking</h3>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {isTracking ? 'Active' : 'Inactive'}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Update Count */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <div>\r\n              <h3 className=\"font-semibold text-gray-900\">Updates Sent</h3>\r\n              <p className=\"text-2xl font-bold text-blue-600\">{updateCount}</p>\r\n              {lastUpdateTime && (\r\n                <p className=\"text-sm text-gray-600\">Last: {lastUpdateTime}</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Controls */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <div className=\"space-y-3\">\r\n              {!isTracking ? (\r\n                <>\r\n                  <button\r\n                    onClick={startLocationTracking}\r\n                    disabled={!!socketError}\r\n                    className=\"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:bg-gray-400 disabled:cursor-not-allowed text-sm\"\r\n                  >\r\n                    🚀 Start Tracking\r\n                  </button>\r\n\r\n                  <button\r\n                    onClick={() => {\r\n                      // Force location permission request\r\n                      if (navigator.geolocation) {\r\n                        navigator.geolocation.getCurrentPosition(\r\n                          (position) => {\r\n                            console.log(\r\n                              '✅ Manual location permission granted:',\r\n                              position\r\n                            );\r\n                            setLocationError(null);\r\n                            startLocationTracking();\r\n                          },\r\n                          (error) => {\r\n                            console.error(\r\n                              '❌ Manual location permission denied:',\r\n                              error\r\n                            );\r\n                            setLocationError(\r\n                              'Location permission denied. Please check your browser settings.'\r\n                            );\r\n                          },\r\n                          {\r\n                            enableHighAccuracy: true,\r\n                            timeout: 30000,\r\n                            maximumAge: 0,\r\n                          }\r\n                        );\r\n                      }\r\n                    }}\r\n                    className=\"w-full mt-2 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm\"\r\n                  >\r\n                    🔐 Request Location Permission\r\n                  </button>\r\n                  {locationError &&\r\n                    locationError.includes('Permission denied') && (\r\n                      <button\r\n                        onClick={() => {\r\n                          setLocationError(null);\r\n                          startLocationTracking();\r\n                        }}\r\n                        className=\"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm mt-2\"\r\n                      >\r\n                        🔄 Retry Location Permission\r\n                      </button>\r\n                    )}\r\n                </>\r\n              ) : (\r\n                <button\r\n                  onClick={stopLocationTracking}\r\n                  className=\"w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 text-sm\"\r\n                >\r\n                  ⏹️ Stop Tracking\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n          {/* Map */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">\r\n              🗺️ Live Location Map\r\n            </h2>\r\n\r\n            <div\r\n              ref={mapContainerRef}\r\n              className=\"w-full h-96 rounded-lg border border-gray-200\"\r\n              style={{ minHeight: '400px' }}\r\n            />\r\n\r\n            {locationError && (\r\n              <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mt-4\">\r\n                <p className=\"text-red-700 text-sm mb-3\">{locationError}</p>\r\n\r\n                {/* Enhanced mobile troubleshooting */}\r\n                <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\">\r\n                  <h4 className=\"font-semibold text-yellow-800 mb-2\">\r\n                    📱 Mobile Location Troubleshooting:\r\n                  </h4>\r\n\r\n                  {/* Mobile-specific instructions */}\r\n                  <div className=\"bg-blue-50 border border-blue-200 rounded p-2 mb-2\">\r\n                    <h5 className=\"font-semibold text-blue-800 text-xs mb-1\">\r\n                      📱 For Mobile Devices:\r\n                    </h5>\r\n                    <ul className=\"text-xs text-blue-700 space-y-1\">\r\n                      <li>\r\n                        • <strong>Android Chrome:</strong> Settings → Apps →\r\n                        Chrome → Permissions → Location → Allow\r\n                      </li>\r\n                      <li>\r\n                        • <strong>Android Firefox:</strong> Settings → Apps →\r\n                        Firefox → Permissions → Location → Allow\r\n                      </li>\r\n                      <li>\r\n                        • <strong>iPhone Safari:</strong> Settings → Safari →\r\n                        Location → Allow\r\n                      </li>\r\n                      <li>\r\n                        • <strong>iPhone Chrome:</strong> Settings → Chrome →\r\n                        Location → Allow\r\n                      </li>\r\n                      <li>\r\n                        • <strong>Make sure:</strong> GPS/Location Services are\r\n                        ON in phone settings\r\n                      </li>\r\n                      <li>\r\n                        • <strong>Try:</strong> Going outdoors or near a window\r\n                        for better GPS signal\r\n                      </li>\r\n                    </ul>\r\n                  </div>\r\n\r\n                  {/* Desktop instructions */}\r\n                  <div className=\"bg-green-50 border border-green-200 rounded p-2\">\r\n                    <h5 className=\"font-semibold text-green-800 text-xs mb-1\">\r\n                      💻 For Desktop Browsers:\r\n                    </h5>\r\n                    <ul className=\"text-xs text-green-700 space-y-1\">\r\n                      <li>\r\n                        • <strong>Chrome:</strong> Click lock icon → Location →\r\n                        Allow → Refresh\r\n                      </li>\r\n                      <li>\r\n                        • <strong>Firefox:</strong> Click lock icon → Location →\r\n                        Allow → Refresh\r\n                      </li>\r\n                      <li>\r\n                        • <strong>Safari:</strong> Safari → Preferences →\r\n                        Websites → Location → Allow\r\n                      </li>\r\n                    </ul>\r\n                  </div>\r\n                  <button\r\n                    onClick={() => window.location.reload()}\r\n                    className=\"mt-2 bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600\"\r\n                  >\r\n                    🔄 Refresh Page & Retry\r\n                  </button>\r\n\r\n                  <button\r\n                    onClick={() => {\r\n                      // Test location without starting tracking\r\n                      const isMobile =\r\n                        /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n                          navigator.userAgent\r\n                        );\r\n\r\n                      if (navigator.geolocation) {\r\n                        navigator.geolocation.getCurrentPosition(\r\n                          (position) => {\r\n                            const successMsg =\r\n                              `✅ Location Test Successful!\\n\\n` +\r\n                              `Latitude: ${position.coords.latitude}\\n` +\r\n                              `Longitude: ${position.coords.longitude}\\n` +\r\n                              `Accuracy: ${position.coords.accuracy}m\\n` +\r\n                              `Device: ${isMobile ? 'Mobile' : 'Desktop'}\\n\\n` +\r\n                              `Location is working! You can now start tracking.`;\r\n                            alert(successMsg);\r\n                            setLocationError(null);\r\n                          },\r\n                          (error) => {\r\n                            const errorMsg =\r\n                              `❌ Location Test Failed\\n\\n` +\r\n                              `Error Code: ${error.code}\\n` +\r\n                              `Error Message: ${error.message}\\n` +\r\n                              `Device: ${isMobile ? 'Mobile' : 'Desktop'}\\n\\n` +\r\n                              `Please check your location permissions.`;\r\n                            alert(errorMsg);\r\n                          },\r\n                          {\r\n                            enableHighAccuracy: true,\r\n                            timeout: 10000,\r\n                            maximumAge: 0,\r\n                          }\r\n                        );\r\n                      } else {\r\n                        alert('Geolocation is not supported by this browser.');\r\n                      }\r\n                    }}\r\n                    className=\"mt-2 bg-green-500 text-white px-3 py-1 rounded text-xs hover:bg-green-600 ml-2\"\r\n                  >\r\n                    🧪 Test Location\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Location Info */}\r\n          <div className=\"bg-white rounded-lg shadow-lg p-6\">\r\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">\r\n              📍 Current Location Details\r\n            </h2>\r\n\r\n            {currentLocation ? (\r\n              <div className=\"space-y-3\">\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600\">Latitude:</span>\r\n                  <span className=\"font-mono\">\r\n                    {currentLocation.coords.latitude.toFixed(6)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600\">Longitude:</span>\r\n                  <span className=\"font-mono\">\r\n                    {currentLocation.coords.longitude.toFixed(6)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600\">Accuracy:</span>\r\n                  <span>{currentLocation.coords.accuracy?.toFixed(1)}m</span>\r\n                </div>\r\n                {currentLocation.coords.speed && (\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Speed:</span>\r\n                    <span>\r\n                      {(currentLocation.coords.speed * 3.6).toFixed(1)} km/h\r\n                    </span>\r\n                  </div>\r\n                )}\r\n                {currentLocation.coords.heading && (\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-600\">Heading:</span>\r\n                    <span>{currentLocation.coords.heading.toFixed(1)}°</span>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600\">Timestamp:</span>\r\n                  <span className=\"text-sm\">\r\n                    {new Date(currentLocation.timestamp).toLocaleTimeString()}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <p className=\"text-gray-500\">No location data available</p>\r\n            )}\r\n\r\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6\">\r\n              <h3 className=\"font-semibold text-blue-900 mb-2\">\r\n                ℹ️ Instructions\r\n              </h3>\r\n              <ul className=\"text-sm text-blue-800 space-y-1\">\r\n                <li>\r\n                  • Click \"Start Tracking\" to begin sending location updates\r\n                </li>\r\n                <li>• Your location will be sent every few seconds</li>\r\n                <li>\r\n                  • Students and admin can see your bus location in real-time\r\n                </li>\r\n                <li>• Make sure to allow location access when prompted</li>\r\n                <li>\r\n                  • The map shows your current position with a blue marker\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DriverInterface;\r\n","import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\n\r\nexport type TransitionType =\r\n  | 'homepage-to-login'\r\n  | 'homepage-to-map'\r\n  | 'login-to-dashboard'\r\n  | 'default';\r\n\r\ninterface TransitionContextType {\r\n  currentTransition: TransitionType;\r\n  setTransition: (transition: TransitionType) => void;\r\n}\r\n\r\nconst TransitionContext = createContext<TransitionContextType | undefined>(\r\n  undefined\r\n);\r\n\r\nexport const useTransition = () => {\r\n  const context = useContext(TransitionContext);\r\n  if (!context) {\r\n    throw new Error('useTransition must be used within a TransitionProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\ninterface TransitionProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const TransitionProvider: React.FC<TransitionProviderProps> = ({\r\n  children,\r\n}) => {\r\n  const [currentTransition, setCurrentTransition] =\r\n    useState<TransitionType>('default');\r\n  const { pathname } = useLocation();\r\n\r\n  useEffect(() => {\r\n    // Determine transition based on route changes\r\n    if (\r\n      pathname.includes('login') ||\r\n      pathname.includes('admin-login') ||\r\n      pathname.includes('driver-login')\r\n    ) {\r\n      setCurrentTransition('homepage-to-login');\r\n    } else if (\r\n      pathname.includes('student') || \r\n      pathname.includes('student-map')\r\n    ) {\r\n      setCurrentTransition('homepage-to-map');\r\n    } else if (\r\n      pathname.includes('dashboard') ||\r\n      pathname.includes('admin') ||\r\n      pathname.includes('driver-dashboard')\r\n    ) {\r\n      setCurrentTransition('login-to-dashboard');\r\n    } else {\r\n      setCurrentTransition('default');\r\n    }\r\n  }, [pathname]);\r\n\r\n  const setTransition = (transition: TransitionType) => {\r\n    setCurrentTransition(transition);\r\n  };\r\n\r\n  return (\r\n    <TransitionContext.Provider value={{ currentTransition, setTransition }}>\r\n      {children}\r\n    </TransitionContext.Provider>\r\n  );\r\n};\r\n","import React from 'react';\nimport { motion } from 'framer-motion';\n\ninterface HomepageToLoginTransitionProps {\n  children: React.ReactNode;\n  isVisible: boolean;\n}\n\nexport const HomepageToLoginTransition: React.FC<\n  HomepageToLoginTransitionProps\n> = ({ children, isVisible }) => {\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 50 }}\n      animate={{\n        opacity: isVisible ? 1 : 0,\n        y: isVisible ? 0 : 50,\n      }}\n      transition={{\n        duration: 0.8,\n        ease: 'easeInOut',\n      }}\n      className=\"w-full h-full\"\n    >\n      {children}\n    </motion.div>\n  );\n};\n","import React from 'react';\nimport { motion } from 'framer-motion';\n\ninterface HomepageToMapTransitionProps {\n  children: React.ReactNode;\n  isVisible: boolean;\n}\n\nexport const HomepageToMapTransition: React.FC<\n  HomepageToMapTransitionProps\n> = ({ children, isVisible }) => {\n  return (\n    <motion.div\n      initial={{ opacity: 0, scale: 0.8 }}\n      animate={{\n        opacity: isVisible ? 1 : 0,\n        scale: isVisible ? 1 : 0.8,\n      }}\n      transition={{\n        duration: 1.2,\n        ease: 'easeInOut',\n      }}\n      className=\"w-full h-full\"\n    >\n      <motion.div\n        initial={{ opacity: 0, y: 100 }}\n        animate={{\n          opacity: isVisible ? 1 : 0,\n          y: isVisible ? 0 : 100,\n        }}\n        transition={{\n          duration: 0.8,\n          delay: 0.3,\n          ease: 'easeOut',\n        }}\n        className=\"w-full h-full\"\n      >\n        {children}\n      </motion.div>\n    </motion.div>\n  );\n};\n","import React from 'react';\nimport { motion } from 'framer-motion';\n\ninterface LoginToDashboardTransitionProps {\n  children: React.ReactNode;\n  isVisible: boolean;\n}\n\nexport const LoginToDashboardTransition: React.FC<\n  LoginToDashboardTransitionProps\n> = ({ children, isVisible }) => {\n  return (\n    <motion.div\n      initial={{ opacity: 0, scale: 0.9 }}\n      animate={{\n        opacity: isVisible ? 1 : 0,\n        scale: isVisible ? 1 : 0.9,\n      }}\n      transition={{\n        duration: 1.0,\n        ease: 'easeInOut',\n      }}\n      className=\"w-full h-full\"\n    >\n      <motion.div\n        initial={{ opacity: 0, y: 50 }}\n        animate={{\n          opacity: isVisible ? 1 : 0,\n          y: isVisible ? 0 : 50,\n        }}\n        transition={{\n          duration: 0.8,\n          delay: 0.2,\n          ease: 'easeOut',\n        }}\n        className=\"w-full h-full\"\n      >\n        {children}\n      </motion.div>\n    </motion.div>\n  );\n};\n","import React from 'react';\r\nimport { useTransition } from './TransitionContext';\r\nimport { HomepageToLoginTransition } from './HomepageToLoginTransition';\r\nimport { HomepageToMapTransition } from './HomepageToMapTransition';\r\nimport { LoginToDashboardTransition } from './LoginToDashboardTransition';\r\n\r\ninterface GlobalTransitionWrapperProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const GlobalTransitionWrapper: React.FC<\r\n  GlobalTransitionWrapperProps\r\n> = ({ children }) => {\r\n  const { currentTransition } = useTransition();\r\n\r\n  // Determine which transition to show based on current transition type\r\n  const renderTransition = () => {\r\n    switch (currentTransition) {\r\n      case 'homepage-to-login':\r\n        return (\r\n          <HomepageToLoginTransition isVisible={true}>\r\n            {children}\r\n          </HomepageToLoginTransition>\r\n        );\r\n      case 'homepage-to-map':\r\n        return (\r\n          <HomepageToMapTransition isVisible={true}>\r\n            {children}\r\n          </HomepageToMapTransition>\r\n        );\r\n      case 'login-to-dashboard':\r\n        return (\r\n          <LoginToDashboardTransition isVisible={true}>\r\n            {children}\r\n          </LoginToDashboardTransition>\r\n        );\r\n      default:\r\n        return children;\r\n    }\r\n  };\r\n\r\n  return <>{renderTransition()}</>;\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { supabase } from '../config/supabase';\r\nimport { websocketService } from '../services/websocket';\r\nimport { authService } from '../services/authService';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useTransition } from './transitions';\r\n\r\ninterface BusInfo {\r\n  bus_id: string;\r\n  bus_number: string;\r\n  route_id: string;\r\n  route_name: string;\r\n  driver_id: string;\r\n  driver_name: string;\r\n}\r\n\r\ninterface LoginForm {\r\n  email: string;\r\n  password: string;\r\n}\r\n\r\nconst DriverLogin: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { setTransition } = useTransition();\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [busInfo, setBusInfo] = useState<BusInfo | null>(null);\r\n  const [loginForm, setLoginForm] = useState<LoginForm>({\r\n    email: '',\r\n    password: '',\r\n  });\r\n  const [loginError, setLoginError] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isMobile, setIsMobile] = useState(false);\r\n\r\n  // Check if device is mobile\r\n  useEffect(() => {\r\n    const checkMobile = () => {\r\n      setIsMobile(window.innerWidth < 768);\r\n    };\r\n\r\n    checkMobile();\r\n    window.addEventListener('resize', checkMobile);\r\n\r\n    return () => window.removeEventListener('resize', checkMobile);\r\n  }, []);\r\n\r\n  // Initialize Supabase auth listener (same as original)\r\n  useEffect(() => {\r\n    const {\r\n      data: { subscription },\r\n    } = supabase.auth.onAuthStateChange(async (event, session) => {\r\n      if (event === 'SIGNED_IN' && session) {\r\n        await authenticateWithSocket(session.access_token);\r\n      } else if (event === 'SIGNED_OUT') {\r\n        setIsAuthenticated(false);\r\n        setBusInfo(null);\r\n        disconnectSocket();\r\n      }\r\n    });\r\n\r\n    return () => subscription.unsubscribe();\r\n  }, []);\r\n\r\n  const handleLogin = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setLoginError(null);\r\n\r\n    try {\r\n      const { data, error } = await supabase.auth.signInWithPassword({\r\n        email: loginForm.email,\r\n        password: loginForm.password,\r\n      });\r\n\r\n      if (error) {\r\n        console.error('❌ Login error:', error);\r\n        setLoginError(error.message);\r\n        return;\r\n      }\r\n\r\n      if (data.user && data.session) {\r\n        console.log('✅ Login successful:', data.user.email);\r\n        await authenticateWithSocket(data.session.access_token);\r\n        setLoginForm({ email: '', password: '' });\r\n      } else {\r\n        setLoginError('Login failed - no user data received');\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Login error:', error);\r\n      setLoginError('An unexpected error occurred during login');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const authenticateWithSocket = async (token: string) => {\r\n    try {\r\n      console.log('🔌 Driver: Connecting to WebSocket...');\r\n      await websocketService.connect();\r\n\r\n      // Wait for connection to be established with improved timeout handling\r\n      let connectionAttempts = 0;\r\n      const maxAttempts = 10; // Increased attempts for better reliability\r\n\r\n      while (\r\n        !websocketService.isConnected() &&\r\n        connectionAttempts < maxAttempts\r\n      ) {\r\n        console.log(\r\n          `⏳ Waiting for WebSocket connection... (attempt ${connectionAttempts + 1}/${maxAttempts})`\r\n        );\r\n        await new Promise((resolve) => setTimeout(resolve, 1500)); // Increased wait time\r\n        connectionAttempts++;\r\n      }\r\n\r\n      if (!websocketService.isConnected()) {\r\n        console.error('❌ WebSocket connection failed after all attempts');\r\n        throw new Error(\r\n          'Failed to establish WebSocket connection. Please check your internet connection and try again.'\r\n        );\r\n      }\r\n\r\n      console.log('✅ WebSocket connection established');\r\n\r\n      websocketService.socket?.on('connect', () => {\r\n        console.log('🔌 Driver: Connected to WebSocket server');\r\n      });\r\n\r\n      websocketService.socket?.on('disconnect', () => {\r\n        console.log('🔌 Driver: Disconnected from WebSocket server');\r\n      });\r\n\r\n      websocketService.socket?.on('error', (error) => {\r\n        console.error('❌ Driver: Socket error:', error);\r\n        setLoginError(error.message || 'Socket error occurred');\r\n      });\r\n\r\n      // Wait a moment for connection to stabilize - REDUCED WAIT TIME\r\n      await new Promise((resolve) => setTimeout(resolve, 500)); // Reduced from 1s to 500ms\r\n\r\n      // Double-check connection status\r\n      if (!websocketService.isConnected()) {\r\n        throw new Error('WebSocket connection failed to establish');\r\n      }\r\n\r\n      // Set up authentication response handler\r\n      const handleAuthenticationSuccess = async (data: {\r\n        driverId: string;\r\n        busId: string;\r\n        busInfo: BusInfo;\r\n      }) => {\r\n        console.log('✅ Driver: Authentication successful:', data);\r\n\r\n        try {\r\n          // Store driver-bus assignment in database instead of localStorage\r\n          const assignment = {\r\n            driver_id: data.driverId,\r\n            bus_id: data.busId,\r\n            bus_number: data.busInfo.bus_number,\r\n            route_id: data.busInfo.route_id,\r\n            route_name: data.busInfo.route_name,\r\n            driver_name: data.busInfo.driver_name,\r\n          };\r\n\r\n          console.log('💾 Storing driver assignment:', assignment);\r\n          const stored = await authService.storeDriverBusAssignment(assignment);\r\n          console.log('💾 Assignment stored result:', stored);\r\n\r\n          if (!stored) {\r\n            console.error('❌ Failed to store driver assignment in database');\r\n            setLoginError('Failed to store authentication data');\r\n            return;\r\n          }\r\n\r\n          console.log('✅ Setting authentication state...');\r\n          setIsAuthenticated(true);\r\n          setBusInfo(data.busInfo);\r\n\r\n          // Set transition type for login to dashboard\r\n          setTransition('login-to-dashboard');\r\n\r\n          // Navigate to driver dashboard after successful authentication\r\n          console.log('🚀 Driver: Navigating to dashboard immediately...');\r\n          navigate('/driver-dashboard');\r\n\r\n          console.log('✅ Navigation initiated successfully');\r\n        } catch (error) {\r\n          console.error('❌ Error storing authentication data:', error);\r\n          setLoginError('Failed to complete authentication');\r\n        }\r\n      };\r\n\r\n      const handleAuthenticationFailed = (error: any) => {\r\n        console.error('❌ Driver: Authentication failed:', error);\r\n        setLoginError(\r\n          'Authentication failed: ' + (error.message || 'Unknown error')\r\n        );\r\n      };\r\n\r\n      // Add timeout for authentication (increased to 60 seconds for better reliability)\r\n      const authTimeout = setTimeout(() => {\r\n        console.error('❌ Driver: Authentication timeout');\r\n        setLoginError('Authentication timeout - please try again');\r\n        // Clean up listeners\r\n        websocketService.socket?.off(\r\n          'driver:authenticated',\r\n          handleAuthenticationSuccess\r\n        );\r\n        websocketService.socket?.off(\r\n          'driver:authentication_failed',\r\n          handleAuthenticationFailed\r\n        );\r\n      }, 60000);\r\n\r\n      console.log('🔐 Driver: Sending authentication request...');\r\n\r\n      // Ensure we have a valid token\r\n      if (!token) {\r\n        throw new Error('No authentication token available');\r\n      }\r\n\r\n      // Send authentication request with callbacks\r\n      websocketService.authenticateAsDriver(token, {\r\n        onSuccess: (data) => {\r\n          clearTimeout(authTimeout);\r\n          handleAuthenticationSuccess(data);\r\n        },\r\n        onFailure: (error) => {\r\n          clearTimeout(authTimeout);\r\n          handleAuthenticationFailed(error);\r\n        },\r\n        onError: (error) => {\r\n          clearTimeout(authTimeout);\r\n          console.error('❌ Driver: Authentication error:', error);\r\n          setLoginError(\r\n            'Authentication error: ' + (error.message || 'Unknown error')\r\n          );\r\n        },\r\n      });\r\n\r\n      console.log('📤 Authentication request sent, waiting for response...');\r\n    } catch (error) {\r\n      console.error('❌ Driver: Authentication error:', error);\r\n      setLoginError('Failed to authenticate with server');\r\n    }\r\n  };\r\n\r\n  const disconnectSocket = () => {\r\n    websocketService.disconnect();\r\n  };\r\n\r\n  // If already authenticated, redirect to dashboard\r\n  if (isAuthenticated && busInfo) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center\">\r\n        <motion.div\r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          className=\"text-center\"\r\n        >\r\n          <div className=\"loading-spinner mx-auto mb-4\" />\r\n          <h2 className=\"text-2xl font-bold text-white mb-2\">\r\n            Authentication Successful!\r\n          </h2>\r\n          <p className=\"text-white/70\">Redirecting to dashboard...</p>\r\n        </motion.div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"relative min-h-screen overflow-hidden bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900\">\r\n      {/* Main Content */}\r\n      <div className=\"relative z-10 flex items-center justify-center min-h-screen p-4\">\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 50, scale: 0.95 }}\r\n          animate={{ opacity: 1, y: 0, scale: 1 }}\r\n          transition={{ duration: 0.8, ease: [0.4, 0.0, 0.2, 1] }}\r\n          className=\"w-full max-w-md\"\r\n        >\r\n          {/* Glassy Login Panel */}\r\n          <motion.div\r\n            whileHover={!isMobile ? { scale: 1.02 } : {}}\r\n            whileTap={{ scale: 0.98 }}\r\n            className=\"relative overflow-hidden rounded-3xl bg-white/10 backdrop-blur-2xl border border-white/20 shadow-2xl\"\r\n          >\r\n            {/* Animated background gradient */}\r\n            <div className=\"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-white/5 hover:bg-opacity-100 transition-all duration-500\" />\r\n\r\n            {/* Glow effect */}\r\n            <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/10 via-purple-500/10 to-pink-500/10 hover:bg-opacity-100 transition-all duration-500 rounded-3xl\" />\r\n\r\n            {/* Content */}\r\n            <div className=\"relative z-10 p-8\">\r\n              {/* Header */}\r\n              <motion.div\r\n                initial={{ opacity: 0, y: -20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ duration: 0.6, delay: 0.2 }}\r\n                className=\"text-center mb-8\"\r\n              >\r\n                <div className=\"text-6xl mb-4 animate-pulse icon-container\" style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', lineHeight: '1' }}>🚌</div>\r\n                <h1 className=\"text-3xl font-bold text-white mb-2\">\r\n                  Driver Login\r\n                </h1>\r\n                <p className=\"text-white/70\">\r\n                  Sign in to start tracking your bus\r\n                </p>\r\n              </motion.div>\r\n\r\n              {/* Error Message */}\r\n              <AnimatePresence>\r\n                {loginError && (\r\n                  <motion.div\r\n                    initial={{ opacity: 0, y: -10, scale: 0.95 }}\r\n                    animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                    exit={{ opacity: 0, y: -10, scale: 0.95 }}\r\n                    className=\"bg-red-500/20 backdrop-blur-sm border border-red-400/30 rounded-xl p-4 mb-6\"\r\n                  >\r\n                    <p className=\"text-red-200 text-sm\">{loginError}</p>\r\n                  </motion.div>\r\n                )}\r\n              </AnimatePresence>\r\n\r\n              {/* Login Form */}\r\n              <motion.form\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ duration: 0.6, delay: 0.4 }}\r\n                onSubmit={handleLogin}\r\n                className=\"space-y-6\"\r\n              >\r\n                {/* Email Input */}\r\n                <motion.div\r\n                  initial={{ opacity: 0, x: -20 }}\r\n                  animate={{ opacity: 1, x: 0 }}\r\n                  transition={{ duration: 0.5, delay: 0.5 }}\r\n                >\r\n                  <label\r\n                    htmlFor=\"email\"\r\n                    className=\"block text-sm font-medium text-white/90 mb-2\"\r\n                  >\r\n                    Email Address\r\n                  </label>\r\n                  <input\r\n                    id=\"email\"\r\n                    type=\"email\"\r\n                    required\r\n                    value={loginForm.email}\r\n                    onChange={(e) =>\r\n                      setLoginForm((prev) => ({\r\n                        ...prev,\r\n                        email: e.target.value,\r\n                      }))\r\n                    }\r\n                    className=\"w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-300\"\r\n                    placeholder=\"Enter your email\"\r\n                  />\r\n                </motion.div>\r\n\r\n                {/* Password Input */}\r\n                <motion.div\r\n                  initial={{ opacity: 0, x: -20 }}\r\n                  animate={{ opacity: 1, x: 0 }}\r\n                  transition={{ duration: 0.5, delay: 0.6 }}\r\n                >\r\n                  <label\r\n                    htmlFor=\"password\"\r\n                    className=\"block text-sm font-medium text-white/90 mb-2\"\r\n                  >\r\n                    Password\r\n                  </label>\r\n                  <input\r\n                    id=\"password\"\r\n                    type=\"password\"\r\n                    required\r\n                    value={loginForm.password}\r\n                    onChange={(e) =>\r\n                      setLoginForm((prev) => ({\r\n                        ...prev,\r\n                        password: e.target.value,\r\n                      }))\r\n                    }\r\n                    className=\"w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-300\"\r\n                    placeholder=\"Enter your password\"\r\n                  />\r\n                </motion.div>\r\n\r\n                {/* Login Button */}\r\n                <motion.button\r\n                  initial={{ opacity: 0, y: 20 }}\r\n                  animate={{ opacity: 1, y: 0 }}\r\n                  transition={{ duration: 0.5, delay: 0.7 }}\r\n                  whileHover={!isMobile ? { scale: 1.02, y: -2 } : {}}\r\n                  whileTap={{ scale: 0.98 }}\r\n                  type=\"submit\"\r\n                  disabled={isLoading}\r\n                  className=\"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl hover:shadow-blue-500/25 disabled:bg-gray-600 disabled:cursor-not-allowed disabled:shadow-none\"\r\n                >\r\n                  {isLoading ? (\r\n                    <div className=\"flex items-center justify-center\">\r\n                      <div className=\"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2\" />\r\n                      Signing In...\r\n                    </div>\r\n                  ) : (\r\n                    'Sign In'\r\n                  )}\r\n                </motion.button>\r\n              </motion.form>\r\n\r\n              {/* Footer */}\r\n              <motion.div\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                transition={{ duration: 0.6, delay: 0.8 }}\r\n                className=\"mt-6 text-center\"\r\n              >\r\n                <p className=\"text-sm text-white/60\">\r\n                  Please contact your administrator for login credentials\r\n                </p>\r\n              </motion.div>\r\n            </div>\r\n\r\n            {/* Shimmer effect */}\r\n            <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent transform -translate-x-full hover:translate-x-full transition-transform duration-1000\" />\r\n          </motion.div>\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Floating Particles Effect */}\r\n      <div className=\"absolute inset-0 pointer-events-none\">\r\n        {[...Array(isMobile ? 8 : 15)].map((_, i) => (\r\n          <motion.div\r\n            key={i}\r\n            className=\"absolute w-1 h-1 sm:w-2 sm:h-2 bg-white/20 rounded-full\"\r\n            style={{\r\n              left: `${Math.random() * 100}%`,\r\n              top: `${Math.random() * 100}%`,\r\n            }}\r\n            animate={{\r\n              y: [0, -30, 0],\r\n              opacity: [0, 1, 0],\r\n            }}\r\n            transition={{\r\n              duration: 3 + Math.random() * 2,\r\n              repeat: Infinity,\r\n              delay: Math.random() * 2,\r\n            }}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DriverLogin;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { Socket } from 'socket.io-client';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { supabase } from '../config/supabase';\r\nimport { websocketService } from '../services/websocket';\r\nimport { authService } from '../services/authService';\r\nimport { environment } from '../config/environment';\r\nimport maplibregl from 'maplibre-gl';\r\nimport 'maplibre-gl/dist/maplibre-gl.css';\r\nimport './DriverInterface.css';\r\nimport './DriverDashboard.css';\r\n\r\ninterface BusInfo {\r\n  bus_id: string;\r\n  bus_number: string;\r\n  route_id: string;\r\n  route_name: string;\r\n  driver_id: string;\r\n  driver_name: string;\r\n}\r\n\r\ninterface LocationData {\r\n  driverId: string;\r\n  latitude: number;\r\n  longitude: number;\r\n  timestamp: string;\r\n  speed?: number;\r\n  heading?: number;\r\n}\r\n\r\nconst DriverDashboard: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const [isTracking, setIsTracking] = useState(false);\r\n  const [busInfo, setBusInfo] = useState<BusInfo | null>(null);\r\n  const [currentLocation, setCurrentLocation] =\r\n    useState<GeolocationPosition | null>(null);\r\n  const [locationError, setLocationError] = useState<string | null>(null);\r\n\r\n  const [lastUpdateTime, setLastUpdateTime] = useState<string | null>(null);\r\n  const [updateCount, setUpdateCount] = useState(0);\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [connectionStatus, setConnectionStatus] = useState<\r\n    'connected' | 'disconnected' | 'connecting'\r\n  >('disconnected');\r\n\r\n  // Monitor busInfo changes for debugging\r\n  useEffect(() => {\r\n    console.log('🚌 BusInfo state changed:', busInfo);\r\n  }, [busInfo]);\r\n\r\n  const socketRef = useRef<Socket | null>(null);\r\n  // const locationIntervalRef = useRef<NodeJS.Timeout | null>(null);\r\n  const watchIdRef = useRef<number | null>(null);\r\n  const mapRef = useRef<maplibregl.Map | null>(null);\r\n  const mapContainerRef = useRef<HTMLDivElement>(null);\r\n  const markerRef = useRef<maplibregl.Marker | null>(null);\r\n  const initializationRef = useRef(false);\r\n  const fallbackTimerRef = useRef<NodeJS.Timeout | null>(null);\r\n  \r\n  // Store event listener references to properly remove them later\r\n  const eventListenersRef = useRef<{\r\n    webglcontextlost?: (event: Event) => void;\r\n    webglcontextrestored?: () => void;\r\n    error?: (e: any) => void;\r\n    load?: () => void;\r\n  }>({});\r\n\r\n  // Initialize driver data and WebSocket connection when component mounts\r\n  useEffect(() => {\r\n    // Prevent multiple initializations\r\n    if (initializationRef.current) {\r\n      console.log('🔄 Driver Dashboard: Already initialized, skipping...');\r\n      return;\r\n    }\r\n\r\n    console.log('🚀 Driver Dashboard: Starting initialization...');\r\n    \r\n    // Set initialization flag immediately to prevent multiple calls\r\n    initializationRef.current = true;\r\n\r\n    // Set up connection status monitoring\r\n    const updateConnectionStatus = () => {\r\n      if (websocketService.isConnected()) {\r\n        setConnectionStatus('connected');\r\n      } else if (\r\n        websocketService.getConnectionState() === 'connecting' ||\r\n        websocketService.getConnectionState() === 'reconnecting'\r\n      ) {\r\n        setConnectionStatus('connecting');\r\n      } else {\r\n        setConnectionStatus('disconnected');\r\n      }\r\n    };\r\n\r\n    // Initial status check\r\n    updateConnectionStatus();\r\n\r\n    // Set up periodic status monitoring\r\n    const statusInterval = setInterval(updateConnectionStatus, 2000);\r\n\r\n    const initializeDriverData = async () => {\r\n      try {\r\n        console.log(\r\n          '🚀 Driver Dashboard: Component mounted, starting initialization...'\r\n        );\r\n\r\n        // Get current user session\r\n        const {\r\n          data: { session },\r\n        } = await supabase.auth.getSession();\r\n\r\n        console.log(\r\n          '🔑 Session check:',\r\n          session ? 'Found' : 'Not found',\r\n          session?.user?.email\r\n        );\r\n\r\n        if (session?.user) {\r\n          console.log('🔌 Driver Dashboard: Initializing...');\r\n\r\n          // Check for existing bus info first (from DriverLogin)\r\n          const existingAssignment = authService.getCurrentDriverAssignment();\r\n          console.log(\r\n            '🔍 Checking for existing assignment:',\r\n            existingAssignment ? 'Found' : 'Not found'\r\n          );\r\n\r\n          if (existingAssignment) {\r\n            console.log(\r\n              '✅ Driver Dashboard: Using existing assignment from DriverLogin:',\r\n              existingAssignment\r\n            );\r\n            setBusInfo({\r\n              bus_id: existingAssignment.bus_id,\r\n              bus_number: existingAssignment.bus_number,\r\n              route_id: existingAssignment.route_id,\r\n              route_name: existingAssignment.route_name,\r\n              driver_id: existingAssignment.driver_id,\r\n              driver_name: existingAssignment.driver_name,\r\n            });\r\n            setIsAuthenticated(true);\r\n            console.log(\r\n              '✅ Bus info and authentication state set from existing assignment'\r\n            );\r\n          } else {\r\n            // Validate driver session using auth service as fallback\r\n            console.log(\r\n              '🔍 No existing assignment, validating driver session...'\r\n            );\r\n            const { isValid, assignment } =\r\n              await authService.validateDriverSession();\r\n            console.log('🔍 Validation result:', {\r\n              isValid,\r\n              assignment: assignment ? 'Found' : 'Not found',\r\n            });\r\n\r\n            if (isValid && assignment) {\r\n              console.log(\r\n                '✅ Driver Dashboard: Valid session found with assignment:',\r\n                assignment\r\n              );\r\n              setBusInfo({\r\n                bus_id: assignment.bus_id,\r\n                bus_number: assignment.bus_number,\r\n                route_id: assignment.route_id,\r\n                route_name: assignment.route_name,\r\n                driver_id: assignment.driver_id,\r\n                driver_name: assignment.driver_name,\r\n              });\r\n              setIsAuthenticated(true);\r\n              console.log(\r\n                '✅ Bus info and authentication state set from validation'\r\n              );\r\n            } else {\r\n              console.log(\r\n                '❌ Driver Dashboard: Invalid session or no assignment found'\r\n              );\r\n              return;\r\n            }\r\n          }\r\n\r\n          // Connect to WebSocket only if not already connected\r\n          if (!websocketService.isConnected()) {\r\n            console.log('🔌 Driver Dashboard: Connecting to WebSocket...');\r\n            try {\r\n              await websocketService.connect();\r\n            } catch (error) {\r\n              console.warn('⚠️ WebSocket connection failed, will use API fallback:', error);\r\n            }\r\n          } else {\r\n            console.log('✅ WebSocket already connected');\r\n          }\r\n\r\n          // Set up WebSocket listeners\r\n          websocketService.socket?.on('connect', () => {\r\n            console.log('🔌 Driver Dashboard: Connected to WebSocket server');\r\n          });\r\n\r\n          websocketService.socket?.on('disconnect', () => {\r\n            console.log(\r\n              '🔌 Driver Dashboard: Disconnected from WebSocket server'\r\n            );\r\n          });\r\n\r\n          websocketService.socket?.on('error', (error) => {\r\n            console.error('❌ Driver Dashboard: Socket error:', error);\r\n          });\r\n\r\n          websocketService.socket?.on(\r\n            'driver:authenticated',\r\n            (data: { driverId: string; busId: string; busInfo: BusInfo }) => {\r\n              console.log(\r\n                '✅ Driver Dashboard: Authentication successful:',\r\n                data\r\n              );\r\n              console.log('🚌 Bus Info received:', data.busInfo);\r\n              setBusInfo(data.busInfo);\r\n              setIsAuthenticated(true);\r\n            }\r\n          );\r\n\r\n          websocketService.socket?.on(\r\n            'driver:authentication_failed',\r\n            (error) => {\r\n              console.error(\r\n                '❌ Driver Dashboard: Authentication failed:',\r\n                error\r\n              );\r\n            }\r\n          );\r\n\r\n          websocketService.socket?.on('driver:locationConfirmed', () => {\r\n            console.log('📍 Driver Dashboard: Location confirmed');\r\n            setLastUpdateTime(new Date().toLocaleTimeString());\r\n            setUpdateCount((prev) => prev + 1);\r\n          });\r\n\r\n          // Store socket reference\r\n          socketRef.current = websocketService.socket;\r\n\r\n          // Emit driver:connected event to notify the server\r\n          const currentAssignment = authService.getCurrentDriverAssignment();\r\n          if (currentAssignment) {\r\n            websocketService.socket?.emit('driver:connected', {\r\n              driverId: currentAssignment.driver_id,\r\n              busId: currentAssignment.bus_id,\r\n              timestamp: new Date().toISOString(),\r\n            });\r\n          }\r\n\r\n          // Enhanced fallback mechanism with retry logic\r\n          let fallbackAttempt = 0;\r\n          const maxFallbackAttempts = 3;\r\n          const fallbackInterval = 5000; // 5 seconds between attempts\r\n          \r\n          fallbackTimerRef.current = setInterval(() => {\r\n            fallbackAttempt++;\r\n            \r\n            if (!busInfo && !isAuthenticated) {\r\n              console.log(`🔄 Fallback attempt ${fallbackAttempt}/${maxFallbackAttempts}: Fetching bus info from API...`);\r\n              fetchBusInfoFromAPI(session.user.id).then(success => {\r\n                if (success) {\r\n                  console.log('✅ Fallback API call successful');\r\n                  if (fallbackTimerRef.current) {\r\n                    clearInterval(fallbackTimerRef.current);\r\n                    fallbackTimerRef.current = null;\r\n                  }\r\n                } else if (fallbackAttempt >= maxFallbackAttempts) {\r\n                  console.log('❌ Max fallback attempts reached, stopping retries');\r\n                  if (fallbackTimerRef.current) {\r\n                    clearInterval(fallbackTimerRef.current);\r\n                    fallbackTimerRef.current = null;\r\n                  }\r\n                }\r\n              });\r\n            } else {\r\n              console.log('✅ Bus info already set, canceling fallback timer');\r\n              if (fallbackTimerRef.current) {\r\n                clearInterval(fallbackTimerRef.current);\r\n                fallbackTimerRef.current = null;\r\n              }\r\n            }\r\n          }, fallbackInterval);\r\n        } else {\r\n          console.log(\r\n            '❌ Driver Dashboard: No session found, redirecting to login'\r\n          );\r\n          // Redirect to login if no session\r\n          navigate('/driver-login');\r\n        }\r\n      } catch (error) {\r\n        console.error('❌ Driver Dashboard: Initialization error:', error);\r\n        console.error('Failed to initialize driver data');\r\n      }\r\n    };\r\n\r\n    initializeDriverData();\r\n\r\n    // Cleanup function\r\n    return () => {\r\n      clearInterval(statusInterval);\r\n      \r\n      // Clear fallback timer if it exists\r\n      if (fallbackTimerRef.current) {\r\n        clearInterval(fallbackTimerRef.current);\r\n        fallbackTimerRef.current = null;\r\n      }\r\n      \r\n      // Reset initialization flag on cleanup\r\n      initializationRef.current = false;\r\n      \r\n      // Clean up WebSocket listeners\r\n      if (websocketService.socket) {\r\n        websocketService.socket.off('connect');\r\n        websocketService.socket.off('disconnect');\r\n        websocketService.socket.off('error');\r\n        websocketService.socket.off('driver:authenticated');\r\n        websocketService.socket.off('driver:authentication_failed');\r\n        websocketService.socket.off('driver:locationConfirmed');\r\n      }\r\n      \r\n      console.log('🧹 Driver Dashboard: Cleanup completed');\r\n    };\r\n  }, [navigate]);\r\n\r\n  // Initialize map when component mounts\r\n  useEffect(() => {\r\n    if (mapContainerRef.current && !mapRef.current) {\r\n      console.log('🗺️ Initializing map...');\r\n      initializeMap();\r\n    }\r\n\r\n    return () => {\r\n      console.log('🗺️ Cleaning up map...');\r\n      cleanupMap();\r\n    };\r\n  }, []);\r\n\r\n  const initializeMap = () => {\r\n    if (!mapContainerRef.current) return;\r\n\r\n    const latitude = 23.0225;\r\n    const longitude = 72.5714;\r\n\r\n    // Clean up existing map if it exists\r\n    if (mapRef.current) {\r\n      mapRef.current.remove();\r\n      mapRef.current = null;\r\n    }\r\n\r\n    try {\r\n      // Create map with optimized settings to prevent WebGL context loss\r\n      mapRef.current = new maplibregl.Map({\r\n        container: mapContainerRef.current,\r\n        style: {\r\n          version: 8,\r\n          sources: {\r\n            osm: {\r\n              type: 'raster',\r\n              tiles: ['https://tile.openstreetmap.org/{z}/{x}/{y}.png'],\r\n              tileSize: 256,\r\n              attribution: '© OpenStreetMap contributors',\r\n            },\r\n          },\r\n          layers: [\r\n            {\r\n              id: 'osm-tiles',\r\n              type: 'raster',\r\n              source: 'osm',\r\n              minzoom: 0,\r\n              maxzoom: 22,\r\n            },\r\n          ],\r\n        },\r\n        center: [longitude, latitude],\r\n        zoom: 15,\r\n        attributionControl: false,\r\n        preserveDrawingBuffer: true, // Prevent WebGL context loss\r\n        antialias: true,\r\n        failIfMajorPerformanceCaveat: false, // Allow fallback rendering\r\n        maxPitch: 60, // Limit pitch to improve performance\r\n        localIdeographFontFamily: 'sans-serif', // Improve font rendering\r\n        renderWorldCopies: true, // Improve performance at world edges\r\n      });\r\n\r\n      // Handle WebGL context loss\r\n      const handleContextLost = (event: Event) => {\r\n        console.warn('⚠️ WebGL context lost, attempting to restore...');\r\n        // Prevent the default behavior which halts all rendering\r\n        if (event instanceof WebGLContextEvent) {\r\n          event.preventDefault();\r\n        }\r\n        \r\n        // Attempt to restore the context after a short delay\r\n        setTimeout(() => {\r\n          try {\r\n            if (mapRef.current) {\r\n              mapRef.current.resize();\r\n              console.log('✅ Attempted map context restoration');\r\n            }\r\n          } catch (error) {\r\n            console.error('❌ Failed to restore map context:', error);\r\n          }\r\n        }, 1000);\r\n      };\r\n      \r\n      // Store the listener reference\r\n      eventListenersRef.current.webglcontextlost = handleContextLost;\r\n      mapRef.current.on('webglcontextlost', handleContextLost);\r\n\r\n      const handleContextRestored = () => {\r\n        console.log('✅ WebGL context restored');\r\n        // Redraw the map and marker\r\n        if (mapRef.current && markerRef.current) {\r\n          mapRef.current.resize();\r\n          const currentLngLat = markerRef.current.getLngLat();\r\n          markerRef.current.setLngLat(currentLngLat);\r\n        }\r\n      };\r\n      \r\n      // Store the listener reference\r\n      eventListenersRef.current.webglcontextrestored = handleContextRestored;\r\n      mapRef.current.on('webglcontextrestored', handleContextRestored);\r\n      \r\n      // Create marker\r\n      const markerElement = document.createElement('div');\r\n      markerElement.className = 'driver-marker';\r\n      markerElement.innerHTML = `\r\n        <div class=\"driver-marker-content\">\r\n          <div style=\"font-size: 16px;\">🚌</div>\r\n        </div>\r\n      `;\r\n\r\n      markerRef.current = new maplibregl.Marker({\r\n        element: markerElement,\r\n        anchor: 'center',\r\n      })\r\n        .setLngLat([longitude, latitude])\r\n        .addTo(mapRef.current);\r\n        \r\n      // Add error handling for tile loading\r\n      const handleMapError = (e: any) => {\r\n        console.error('❌ Map error:', e);\r\n      };\r\n      \r\n      // Store the listener reference\r\n      eventListenersRef.current.error = handleMapError;\r\n      mapRef.current.on('error', handleMapError);\r\n      \r\n      // Optimize performance\r\n      const handleMapLoad = () => {\r\n        console.log('✅ Map loaded successfully');\r\n      };\r\n      \r\n      // Store the listener reference\r\n      eventListenersRef.current.load = handleMapLoad;\r\n      mapRef.current.on('load', handleMapLoad);\r\n      \r\n    } catch (error) {\r\n      console.error('❌ Error initializing map:', error);\r\n      // Fallback to a simpler map initialization if the first attempt fails\r\n      try {\r\n        console.log('🔄 Attempting fallback map initialization...');\r\n        if (mapContainerRef.current && !mapRef.current) {\r\n          mapRef.current = new maplibregl.Map({\r\n            container: mapContainerRef.current,\r\n            style: {\r\n              version: 8,\r\n              sources: {\r\n                osm: {\r\n                  type: 'raster',\r\n                  tiles: ['https://tile.openstreetmap.org/{z}/{x}/{y}.png'],\r\n                  tileSize: 256,\r\n                },\r\n              },\r\n              layers: [\r\n                {\r\n                  id: 'osm-tiles',\r\n                  type: 'raster',\r\n                  source: 'osm',\r\n                  minzoom: 0,\r\n                  maxzoom: 22,\r\n                },\r\n              ],\r\n            },\r\n            center: [longitude, latitude],\r\n            zoom: 15,\r\n            attributionControl: false,\r\n            preserveDrawingBuffer: true,\r\n          });\r\n          \r\n          // Create simple marker\r\n          const markerElement = document.createElement('div');\r\n          markerElement.className = 'driver-marker';\r\n          markerElement.innerHTML = `<div>🚌</div>`;\r\n          \r\n          markerRef.current = new maplibregl.Marker({\r\n            element: markerElement,\r\n          })\r\n            .setLngLat([longitude, latitude])\r\n            .addTo(mapRef.current);\r\n            \r\n          console.log('✅ Fallback map initialization successful');\r\n        }\r\n      } catch (fallbackError) {\r\n        console.error('❌ Fallback map initialization failed:', fallbackError);\r\n      }\r\n    }\r\n  };\r\n\r\n  const updateMapLocation = (latitude: number, longitude: number) => {\r\n    if (!mapRef.current || !markerRef.current) return;\r\n\r\n    const newLocation = [longitude, latitude] as [number, number];\r\n    markerRef.current.setLngLat(newLocation);\r\n\r\n    mapRef.current.flyTo({\r\n      center: newLocation,\r\n      duration: 1000,\r\n    });\r\n  };\r\n\r\n  const startLocationTracking = async () => {\r\n    if (!navigator.geolocation) {\r\n      setLocationError('Geolocation is not supported by this browser');\r\n      return;\r\n    }\r\n\r\n    const isMobile =\r\n      /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n        navigator.userAgent\r\n      );\r\n    const options = {\r\n      enableHighAccuracy: true,\r\n      timeout: isMobile ? 30000 : 60000,\r\n      maximumAge: 0,\r\n    };\r\n\r\n    try {\r\n      watchIdRef.current = navigator.geolocation.watchPosition(\r\n        (position) => {\r\n          setCurrentLocation(position);\r\n          setLocationError(null);\r\n\r\n          if (mapRef.current && markerRef.current) {\r\n            updateMapLocation(\r\n              position.coords.latitude,\r\n              position.coords.longitude\r\n            );\r\n          }\r\n\r\n          if (websocketService.socket && websocketService.isConnected()) {\r\n            const locationData: LocationData = {\r\n              driverId: busInfo?.driver_id || '',\r\n              latitude: position.coords.latitude,\r\n              longitude: position.coords.longitude,\r\n              timestamp: new Date().toISOString(),\r\n              speed: position.coords.speed || undefined,\r\n              heading: position.coords.heading || undefined,\r\n            };\r\n\r\n            websocketService.socket.emit('driver:locationUpdate', locationData);\r\n            setLastUpdateTime(new Date().toLocaleTimeString());\r\n            setUpdateCount((prev) => prev + 1);\r\n          }\r\n        },\r\n        (error) => {\r\n          console.error('❌ Location error:', error);\r\n          let errorMessage = '';\r\n\r\n          switch (error.code) {\r\n            case error.PERMISSION_DENIED:\r\n              errorMessage =\r\n                'Location permission denied. Please enable location access.';\r\n              break;\r\n            case error.POSITION_UNAVAILABLE:\r\n              errorMessage = 'Location information is unavailable.';\r\n              break;\r\n            case error.TIMEOUT:\r\n              errorMessage = 'Location request timed out.';\r\n              break;\r\n            default:\r\n              errorMessage = 'An unknown error occurred.';\r\n          }\r\n\r\n          setLocationError(errorMessage);\r\n          setIsTracking(false);\r\n        },\r\n        options\r\n      );\r\n\r\n      setIsTracking(true);\r\n    } catch (error) {\r\n      console.error('❌ Error starting location tracking:', error);\r\n      setLocationError('Failed to start location tracking');\r\n    }\r\n  };\r\n\r\n  const stopLocationTracking = () => {\r\n    if (watchIdRef.current) {\r\n      navigator.geolocation.clearWatch(watchIdRef.current);\r\n      watchIdRef.current = null;\r\n    }\r\n    setIsTracking(false);\r\n  };\r\n\r\n  const cleanupMap = () => {\r\n    try {\r\n      // Properly remove all event listeners before removing the map\r\n      if (mapRef.current) {\r\n        // Remove all event listeners using the stored references\r\n        if (eventListenersRef.current.webglcontextlost) {\r\n          mapRef.current.off('webglcontextlost', eventListenersRef.current.webglcontextlost);\r\n        }\r\n        if (eventListenersRef.current.webglcontextrestored) {\r\n          mapRef.current.off('webglcontextrestored', eventListenersRef.current.webglcontextrestored);\r\n        }\r\n        if (eventListenersRef.current.error) {\r\n          mapRef.current.off('error', eventListenersRef.current.error);\r\n        }\r\n        if (eventListenersRef.current.load) {\r\n          mapRef.current.off('load', eventListenersRef.current.load);\r\n        }\r\n        \r\n        // Clear the event listeners\r\n        eventListenersRef.current = {};\r\n        \r\n        // Remove the map\r\n        mapRef.current.remove();\r\n        mapRef.current = null;\r\n      }\r\n      \r\n      // Clear marker reference\r\n      markerRef.current = null;\r\n      \r\n      console.log('🗺️ Map cleanup completed');\r\n    } catch (error) {\r\n      console.error('❌ Error during map cleanup:', error);\r\n    }\r\n  };\r\n\r\n  const fetchBusInfoFromAPI = async (userId: string): Promise<boolean> => {\r\n    try {\r\n      console.log('🔄 Fetching bus info for user:', userId);\r\n\r\n      // Get current session for authentication\r\n      const {\r\n        data: { session },\r\n      } = await supabase.auth.getSession();\r\n\r\n      if (!session?.access_token) {\r\n        console.error('❌ No access token available for API call');\r\n        return false;\r\n      }\r\n\r\n      // Make API call to get driver bus info - use the correct endpoint without /api prefix\r\n      const response = await fetch(\r\n        `${environment.api.url}/buses?driver_id=${userId}`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${session.access_token}`,\r\n          },\r\n          // Add timeout handling\r\n          signal: AbortSignal.timeout(10000), // 10 second timeout\r\n        }\r\n      );\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        console.log('✅ Bus info from API:', data);\r\n\r\n        // Handle the response format from the buses endpoint\r\n        if (data.success && data.data && Array.isArray(data.data) && data.data.length > 0) {\r\n          const busData = data.data[0]; // Get the first bus assigned to this driver\r\n          setBusInfo({\r\n            bus_id: busData.bus_id || busData.id,\r\n            bus_number: busData.bus_number || busData.number_plate || busData.code,\r\n            route_id: busData.route_id || '',\r\n            route_name: busData.route_name || 'Route TBD',\r\n            driver_id: busData.driver_id || busData.assigned_driver_id,\r\n            driver_name: busData.driver_name || busData.driver_full_name || 'Driver TBD',\r\n          });\r\n          setIsAuthenticated(true);\r\n          return true;\r\n        } else if (data.data?.busInfo) {\r\n          setBusInfo(data.data.busInfo);\r\n          setIsAuthenticated(true);\r\n          return true;\r\n        } else if (data.busInfo) {\r\n          setBusInfo(data.busInfo);\r\n          setIsAuthenticated(true);\r\n          return true;\r\n        } else {\r\n          console.error('❌ No bus info in response:', data);\r\n          return false;\r\n        }\r\n      } else {\r\n        const errorText = await response.text();\r\n        console.error(\r\n          '❌ Failed to fetch bus info from API:',\r\n          response.status,\r\n          errorText\r\n        );\r\n        console.error(`API Error: ${response.status} - ${errorText}`);\r\n        return false;\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error fetching bus info from API:', error);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const disconnectSocket = () => {\r\n    websocketService.disconnect();\r\n    socketRef.current = null;\r\n  };\r\n\r\n  const handleSignOut = async () => {\r\n    try {\r\n      stopLocationTracking();\r\n      disconnectSocket();\r\n      cleanupMap();\r\n      await supabase.auth.signOut();\r\n    } catch (error) {\r\n      console.error('❌ Sign out error:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 p-4 driver-dashboard-container\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"card-glass p-6 mb-6\">\r\n          <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4\">\r\n            <div className=\"flex-1\">\r\n              <h1 className=\"text-2xl sm:text-3xl font-bold text-white mb-2\">\r\n                🚌 Driver Dashboard\r\n              </h1>\r\n              <div className=\"space-y-1\">\r\n                <p className=\"text-white/80 text-sm sm:text-base\">\r\n                  Welcome,{' '}\r\n                  <span className=\"font-semibold text-white\">\r\n                    {busInfo?.driver_name}\r\n                  </span>\r\n                </p>\r\n                <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 text-sm\">\r\n                  <span className=\"text-blue-300\">\r\n                    🚌 Bus:{' '}\r\n                    <span className=\"font-semibold text-white\">\r\n                      {busInfo?.bus_number}\r\n                    </span>\r\n                  </span>\r\n                  <span className=\"text-green-300\">\r\n                    🛣️ Route:{' '}\r\n                    <span className=\"font-semibold text-white\">\r\n                      {busInfo?.route_name}\r\n                    </span>\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex gap-2\">\r\n              <button\r\n                onClick={async () => {\r\n                  const {\r\n                    data: { session },\r\n                  } = await supabase.auth.getSession();\r\n                  if (session?.user?.id) {\r\n                    console.log('🔄 Manual refresh: Fetching bus info...');\r\n                    fetchBusInfoFromAPI(session.user.id);\r\n                  }\r\n                }}\r\n                className=\"btn-primary w-full sm:w-auto\"\r\n              >\r\n                🔄 Refresh\r\n              </button>\r\n              <button\r\n                onClick={handleSignOut}\r\n                className=\"btn-secondary w-full sm:w-auto\"\r\n              >\r\n                Sign Out\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Status Cards */}\r\n        <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\r\n          {/* Connection Status */}\r\n          <div className=\"card-glass p-4\">\r\n            <div className=\"flex items-center\">\r\n              <div\r\n                className={`w-3 h-3 rounded-full mr-3 ${\r\n                  connectionStatus === 'connected'\r\n                    ? 'bg-green-500'\r\n                    : connectionStatus === 'connecting'\r\n                      ? 'bg-yellow-500 animate-pulse'\r\n                      : 'bg-red-500'\r\n                }`}\r\n              ></div>\r\n              <div className=\"min-w-0 flex-1\">\r\n                <h3 className=\"font-semibold text-white text-sm\">Connection</h3>\r\n                <p className=\"text-xs text-white/70 truncate\">\r\n                  {connectionStatus === 'connected'\r\n                    ? 'Connected'\r\n                    : connectionStatus === 'connecting'\r\n                      ? 'Connecting...'\r\n                      : 'Disconnected'}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Tracking Status */}\r\n          <div className=\"card-glass p-4\">\r\n            <div className=\"flex items-center\">\r\n              <div\r\n                className={`w-3 h-3 rounded-full mr-3 ${isTracking ? 'bg-green-500' : 'bg-gray-400'}`}\r\n              ></div>\r\n              <div className=\"min-w-0 flex-1\">\r\n                <h3 className=\"font-semibold text-white text-sm\">\r\n                  GPS Tracking\r\n                </h3>\r\n                <p className=\"text-xs text-white/70 truncate\">\r\n                  {isTracking ? 'Active' : 'Inactive'}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Update Count */}\r\n          <div className=\"card-glass p-4\">\r\n            <div>\r\n              <h3 className=\"font-semibold text-white text-sm\">Updates Sent</h3>\r\n              <p className=\"text-xl font-bold text-blue-300\">{updateCount}</p>\r\n              {lastUpdateTime && (\r\n                <p className=\"text-xs text-white/70 truncate\">\r\n                  Last: {lastUpdateTime}\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Location Status */}\r\n          <div className=\"card-glass p-4\">\r\n            <div className=\"flex items-center\">\r\n              <div\r\n                className={`w-3 h-3 rounded-full mr-3 ${locationError ? 'bg-red-500' : currentLocation ? 'bg-green-500' : 'bg-gray-400'}`}\r\n              ></div>\r\n              <div className=\"min-w-0 flex-1\">\r\n                <h3 className=\"font-semibold text-white text-sm\">Location</h3>\r\n                <p className=\"text-xs text-white/70 truncate\">\r\n                  {locationError\r\n                    ? 'Error'\r\n                    : currentLocation\r\n                      ? 'Available'\r\n                      : 'Waiting'}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Tracking Controls */}\r\n        <div className=\"card-glass p-6 mb-6\">\r\n          <h2 className=\"text-xl font-semibold text-white mb-4\">\r\n            📍 Location Tracking Controls\r\n          </h2>\r\n          <div className=\"flex flex-col sm:flex-row gap-4\">\r\n            {!isTracking ? (\r\n              <>\r\n                <button\r\n                  onClick={startLocationTracking}\r\n                  className=\"btn-primary flex-1 py-3 px-6 text-lg font-semibold\"\r\n                >\r\n                  🚀 Start Tracking\r\n                </button>\r\n\r\n                {locationError && (\r\n                  <button\r\n                    onClick={() => {\r\n                      setLocationError(null);\r\n                      startLocationTracking();\r\n                    }}\r\n                    className=\"btn-secondary w-full py-2 px-4 text-sm\"\r\n                  >\r\n                    🔄 Retry Location Permission\r\n                  </button>\r\n                )}\r\n              </>\r\n            ) : (\r\n              <button\r\n                onClick={stopLocationTracking}\r\n                className=\"btn-primary bg-red-600 hover:bg-red-700 w-full py-3 px-6 text-lg font-semibold\"\r\n              >\r\n                ⏹️ Stop Tracking\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content */}\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n          {/* Map */}\r\n          <div className=\"card-glass p-6\">\r\n            <h2 className=\"text-xl font-semibold text-white mb-4\">\r\n              🗺️ Live Location Map\r\n            </h2>\r\n            <div\r\n              ref={mapContainerRef}\r\n              className=\"w-full h-64 sm:h-80 lg:h-96 rounded-lg border border-white/20 bg-white/5 driver-map-container\"\r\n              style={{ minHeight: '300px' }}\r\n            />\r\n\r\n            {locationError && (\r\n              <div className=\"bg-red-500/20 border border-red-400/30 rounded-lg p-4 mt-4\">\r\n                <p className=\"text-red-200 text-sm mb-3\">{locationError}</p>\r\n\r\n                {/* Enhanced mobile troubleshooting */}\r\n                <div className=\"bg-yellow-500/20 border border-yellow-400/30 rounded-lg p-3\">\r\n                  <h4 className=\"font-semibold text-yellow-200 mb-2\">\r\n                    📱 Mobile Location Troubleshooting:\r\n                  </h4>\r\n\r\n                  {/* Mobile-specific instructions */}\r\n                  <div className=\"bg-blue-500/20 border border-blue-400/30 rounded p-2 mb-2\">\r\n                    <h5 className=\"font-semibold text-blue-200 text-xs mb-1\">\r\n                      📱 For Mobile Devices:\r\n                    </h5>\r\n                    <ul className=\"text-xs text-blue-100 space-y-1\">\r\n                      <li>\r\n                        • <strong>Android Chrome:</strong> Settings → Apps →\r\n                        Chrome → Permissions → Location → Allow\r\n                      </li>\r\n                      <li>\r\n                        • <strong>Android Firefox:</strong> Settings → Apps →\r\n                        Firefox → Permissions → Location → Allow\r\n                      </li>\r\n                      <li>\r\n                        • <strong>iPhone Safari:</strong> Settings → Safari →\r\n                        Location → Allow\r\n                      </li>\r\n                      <li>\r\n                        • <strong>iPhone Chrome:</strong> Settings → Chrome →\r\n                        Location → Allow\r\n                      </li>\r\n                      <li>\r\n                        • <strong>Make sure:</strong> GPS/Location Services are\r\n                        ON in phone settings\r\n                      </li>\r\n                      <li>\r\n                        • <strong>Try:</strong> Going outdoors or near a window\r\n                        for better GPS signal\r\n                      </li>\r\n                    </ul>\r\n                  </div>\r\n\r\n                  {/* Desktop instructions */}\r\n                  <div className=\"bg-green-500/20 border border-green-400/30 rounded p-2\">\r\n                    <h5 className=\"font-semibold text-green-200 text-xs mb-1\">\r\n                      💻 For Desktop Browsers:\r\n                    </h5>\r\n                    <ul className=\"text-xs text-green-100 space-y-1\">\r\n                      <li>\r\n                        • <strong>Chrome:</strong> Click lock icon → Location →\r\n                        Allow → Refresh\r\n                      </li>\r\n                      <li>\r\n                        • <strong>Firefox:</strong> Click lock icon → Location →\r\n                        Allow → Refresh\r\n                      </li>\r\n                      <li>\r\n                        • <strong>Safari:</strong> Safari → Preferences →\r\n                        Websites → Location → Allow\r\n                      </li>\r\n                    </ul>\r\n                  </div>\r\n                  <div className=\"flex flex-col sm:flex-row gap-2 mt-2\">\r\n                    <button\r\n                      onClick={() => window.location.reload()}\r\n                      className=\"btn-secondary text-xs px-3 py-1\"\r\n                    >\r\n                      🔄 Refresh Page & Retry\r\n                    </button>\r\n\r\n                    <button\r\n                      onClick={() => {\r\n                        // Test location without starting tracking\r\n                        const isMobile =\r\n                          /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n                            navigator.userAgent\r\n                          );\r\n\r\n                        if (navigator.geolocation) {\r\n                          navigator.geolocation.getCurrentPosition(\r\n                            (position) => {\r\n                              const successMsg =\r\n                                `✅ Location Test Successful!\\n\\n` +\r\n                                `Latitude: ${position.coords.latitude}\\n` +\r\n                                `Longitude: ${position.coords.longitude}\\n` +\r\n                                `Accuracy: ${position.coords.accuracy}m\\n` +\r\n                                `Device: ${isMobile ? 'Mobile' : 'Desktop'}\\n\\n` +\r\n                                `Location is working! You can now start tracking.`;\r\n                              alert(successMsg);\r\n                              setLocationError(null);\r\n                            },\r\n                            (error) => {\r\n                              const errorMsg =\r\n                                `❌ Location Test Failed\\n\\n` +\r\n                                `Error Code: ${error.code}\\n` +\r\n                                `Error Message: ${error.message}\\n` +\r\n                                `Device: ${isMobile ? 'Mobile' : 'Desktop'}\\n\\n` +\r\n                                `Please check your location permissions.`;\r\n                              alert(errorMsg);\r\n                            },\r\n                            {\r\n                              enableHighAccuracy: true,\r\n                              timeout: 10000,\r\n                              maximumAge: 0,\r\n                            }\r\n                          );\r\n                        } else {\r\n                          alert(\r\n                            'Geolocation is not supported by this browser.'\r\n                          );\r\n                        }\r\n                      }}\r\n                      className=\"btn-primary text-xs px-3 py-1\"\r\n                    >\r\n                      🧪 Test Location\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Location Info */}\r\n          <div className=\"card-glass p-6\">\r\n            <h2 className=\"text-xl font-semibold text-white mb-4\">\r\n              📍 Current Location Details\r\n            </h2>\r\n            {currentLocation ? (\r\n              <div className=\"space-y-4 bg-white/10 rounded-lg p-4 border border-white/20\">\r\n                {/* Live indicator */}\r\n                <div className=\"flex items-center justify-center mb-2\">\r\n                  <div className=\"w-2 h-2 bg-green-400 rounded-full animate-pulse mr-2\"></div>\r\n                  <span className=\"text-sm text-green-300 font-medium\">\r\n                    📍 Live Location Data\r\n                  </span>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-white/70 text-sm\">Latitude:</span>\r\n                    <span className=\"font-mono text-white font-semibold text-sm\">\r\n                      {currentLocation.coords.latitude.toFixed(6)}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-white/70 text-sm\">Longitude:</span>\r\n                    <span className=\"font-mono text-white font-semibold text-sm\">\r\n                      {currentLocation.coords.longitude.toFixed(6)}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-white/70 text-sm\">Accuracy:</span>\r\n                    <span className=\"text-white font-semibold text-sm\">\r\n                      {currentLocation.coords.accuracy?.toFixed(1)}m\r\n                    </span>\r\n                  </div>\r\n                  {currentLocation.coords.speed && (\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-white/70 text-sm\">Speed:</span>\r\n                      <span className=\"text-white font-semibold text-sm\">\r\n                        {(currentLocation.coords.speed * 3.6).toFixed(1)} km/h\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                  {currentLocation.coords.heading && (\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-white/70 text-sm\">Heading:</span>\r\n                      <span className=\"text-white font-semibold text-sm\">\r\n                        {currentLocation.coords.heading.toFixed(1)}°\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-white/70 text-sm\">Updates Sent:</span>\r\n                    <span className=\"font-bold text-blue-300 text-sm\">\r\n                      {updateCount}\r\n                    </span>\r\n                  </div>\r\n                  {lastUpdateTime && (\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-white/70 text-sm\">\r\n                        Last Update:\r\n                      </span>\r\n                      <span className=\"text-white font-medium text-sm\">\r\n                        {lastUpdateTime}\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-white/70 text-sm\">Timestamp:</span>\r\n                    <span className=\"text-white font-medium text-sm\">\r\n                      {new Date(currentLocation.timestamp).toLocaleTimeString()}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className=\"bg-yellow-500/20 border border-yellow-400/30 rounded-lg p-4 text-center\">\r\n                <div className=\"text-yellow-300 mb-2 text-2xl\">📍</div>\r\n                <p className=\"text-yellow-200 font-medium\">\r\n                  No location data available\r\n                </p>\r\n                <p className=\"text-yellow-100 text-sm mt-1\">\r\n                  Click \"Start Tracking\" to begin location sharing\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"bg-blue-500/20 border border-blue-400/30 rounded-lg p-4 mt-6\">\r\n              <h3 className=\"font-semibold text-blue-200 mb-2\">\r\n                ℹ️ Instructions\r\n              </h3>\r\n              <ul className=\"text-sm text-blue-100 space-y-1\">\r\n                <li>\r\n                  • Click \"Start Tracking\" to begin sending location updates\r\n                </li>\r\n                <li>• Your location will be sent every few seconds</li>\r\n                <li>\r\n                  • Students and admin can see your bus location in real-time\r\n                </li>\r\n                <li>• Make sure to allow location access when prompted</li>\r\n                <li>\r\n                  • The map shows your current position with a blue marker\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DriverDashboard;\r\n","import { authService } from './authService';\r\nimport { environment } from '../config/environment';\r\n\r\nconst API_BASE_URL = environment.api.url;\r\n\r\ninterface ApiResponse<T = unknown> {\r\n  success: boolean;\r\n  data?: T;\r\n  error?: string;\r\n  message?: string;\r\n  timestamp?: string;\r\n}\r\n\r\ninterface BusData {\r\n  id?: string;\r\n  code: string;\r\n  number_plate: string;\r\n  capacity: number;\r\n  model?: string;\r\n  year?: number;\r\n  is_active: boolean;\r\n  assigned_driver_id?: string;\r\n  route_id?: string;\r\n  driver_full_name?: string;\r\n  driver_email?: string;\r\n  driver_first_name?: string;\r\n  driver_last_name?: string;\r\n  route_name?: string;\r\n}\r\n\r\ninterface DriverData {\r\n  id: string;\r\n  email: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  phone?: string;\r\n  role: string;\r\n  assigned_bus_id?: string;\r\n  assigned_bus_plate?: string;\r\n}\r\n\r\ninterface RouteData {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  distance_km: number;\r\n  estimated_duration_minutes: number;\r\n  is_active: boolean;\r\n  city: string;\r\n  custom_destination?: string;\r\n  custom_origin?: string;\r\n  destination_coordinates?: {\r\n    coordinates: [number, number];\r\n  };\r\n  origin_coordinates?: {\r\n    coordinates: [number, number];\r\n  };\r\n  bus_stops?: any[];\r\n  current_eta_minutes?: number;\r\n  last_eta_calculation?: string;\r\n  stops?: GeoJSON.LineString;\r\n}\r\n\r\ninterface AnalyticsData {\r\n  totalBuses: number;\r\n  activeBuses: number;\r\n  totalRoutes: number;\r\n  activeRoutes: number;\r\n  totalDrivers: number;\r\n  activeDrivers: number;\r\n  averageDelay: number;\r\n  busUsageStats: {\r\n    date: string;\r\n    activeBuses: number;\r\n    totalTrips: number;\r\n  }[];\r\n}\r\n\r\ninterface SystemHealth {\r\n  buses: number;\r\n  routes: number;\r\n  drivers: number;\r\n  recentLocations: number;\r\n  timestamp: string;\r\n}\r\n\r\nclass AdminApiService {\r\n  private async makeRequest<T>(\r\n    endpoint: string,\r\n    options: RequestInit = {}\r\n  ): Promise<ApiResponse<T>> {\r\n    let timeoutId: NodeJS.Timeout | undefined;\r\n\r\n    try {\r\n      const token = authService.getAccessToken();\r\n      console.log(\r\n        '🔑 Token check for',\r\n        endpoint,\r\n        ':',\r\n        token ? 'Token exists' : 'No token'\r\n      );\r\n\r\n      if (!token) {\r\n        console.error('❌ No access token available for', endpoint);\r\n        throw new Error('No access token available');\r\n      }\r\n\r\n      const controller = new AbortController();\r\n      timeoutId = setTimeout(() => controller.abort(), 15000); // 15 second timeout\r\n\r\n      // Ensure we're using the correct backend URL for production\r\n      const baseUrl = API_BASE_URL || environment.api.url;\r\n      const response = await fetch(`${baseUrl}/admin${endpoint}`, {\r\n        ...options,\r\n        signal: controller.signal,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: `Bearer ${token}`,\r\n          ...options.headers,\r\n        },\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (timeoutId) clearTimeout(timeoutId);\r\n\r\n      if (!response.ok) {\r\n        // Handle specific error cases\r\n        if (response.status === 429) {\r\n          throw new Error(\r\n            'Rate limit exceeded. Please wait a moment and try again.'\r\n          );\r\n        } else if (response.status === 401) {\r\n          throw new Error('Authentication required. Please log in again.');\r\n        } else if (response.status === 403) {\r\n          throw new Error(\r\n            'Access denied. You do not have permission for this action.'\r\n          );\r\n        } else if (response.status === 404) {\r\n          throw new Error('Resource not found.');\r\n        } else if (response.status === 409) {\r\n          throw new Error(data.message || 'Resource already exists');\r\n        } else if (response.status >= 500) {\r\n          throw new Error('Server error. Please try again later.');\r\n        } else {\r\n          throw new Error(data.message || data.error || 'Request failed');\r\n        }\r\n      }\r\n\r\n      return data;\r\n    } catch (error) {\r\n      if (timeoutId) clearTimeout(timeoutId);\r\n      console.error(`❌ API request failed for ${endpoint}:`, error);\r\n      return {\r\n        success: false,\r\n        error: error instanceof Error ? error.message : 'Request failed',\r\n      };\r\n    }\r\n  }\r\n\r\n  // ===== ANALYTICS ENDPOINTS =====\r\n\r\n  async getAnalytics(): Promise<ApiResponse<AnalyticsData>> {\r\n    return this.makeRequest<AnalyticsData>('/analytics');\r\n  }\r\n\r\n  async getSystemHealth(): Promise<ApiResponse<SystemHealth>> {\r\n    return this.makeRequest<SystemHealth>('/health');\r\n  }\r\n\r\n  // ===== BUS MANAGEMENT ENDPOINTS =====\r\n\r\n  async getAllBuses(): Promise<ApiResponse<BusData[]>> {\r\n    console.log('🚌 Fetching all buses...');\r\n    const result = await this.makeRequest<BusData[]>('/buses');\r\n    console.log(\r\n      '🚌 Buses result:',\r\n      result.success ? `${result.data?.length || 0} buses` : result.error\r\n    );\r\n    return result;\r\n  }\r\n\r\n  async getBusById(busId: string): Promise<ApiResponse<BusData>> {\r\n    return this.makeRequest<BusData>(`/buses/${busId}`);\r\n  }\r\n\r\n  async createBus(busData: Omit<BusData, 'id'>): Promise<ApiResponse<BusData>> {\r\n    return this.makeRequest<BusData>('/buses', {\r\n      method: 'POST',\r\n      body: JSON.stringify(busData),\r\n    });\r\n  }\r\n\r\n  async updateBus(\r\n    busId: string,\r\n    busData: Partial<BusData>\r\n  ): Promise<ApiResponse<BusData>> {\r\n    return this.makeRequest<BusData>(`/buses/${busId}`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(busData),\r\n    });\r\n  }\r\n\r\n  async deleteBus(busId: string): Promise<ApiResponse<BusData>> {\r\n    return this.makeRequest<BusData>(`/buses/${busId}`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  // ===== DRIVER MANAGEMENT ENDPOINTS =====\r\n\r\n  async getAllDrivers(): Promise<ApiResponse<DriverData[]>> {\r\n    console.log('👨‍💼 Fetching all drivers...');\r\n    const result = await this.makeRequest<DriverData[]>('/drivers');\r\n    console.log(\r\n      '👨‍💼 Drivers result:',\r\n      result.success ? `${result.data?.length || 0} drivers` : result.error\r\n    );\r\n    return result;\r\n  }\r\n\r\n  async getAssignedDrivers(): Promise<ApiResponse<any[]>> {\r\n    console.log('🚌 Fetching assigned drivers...');\r\n    const result = await this.makeRequest<any[]>('/assigned-drivers');\r\n    console.log(\r\n      '🚌 Assigned drivers result:',\r\n      result.success\r\n        ? `${result.data?.length || 0} assigned drivers`\r\n        : result.error\r\n    );\r\n    return result;\r\n  }\r\n\r\n  async getDriverById(driverId: string): Promise<ApiResponse<DriverData>> {\r\n    return this.makeRequest<DriverData>(`/drivers/${driverId}`);\r\n  }\r\n\r\n  async assignDriverToBus(\r\n    driverId: string,\r\n    busId: string\r\n  ): Promise<ApiResponse<BusData>> {\r\n    return this.makeRequest<BusData>(`/drivers/${driverId}/assign-bus`, {\r\n      method: 'POST',\r\n      body: JSON.stringify({ busId }),\r\n    });\r\n  }\r\n\r\n  async unassignDriverFromBus(\r\n    driverId: string\r\n  ): Promise<ApiResponse<BusData[]>> {\r\n    return this.makeRequest<BusData[]>(`/drivers/${driverId}/unassign-bus`, {\r\n      method: 'POST',\r\n    });\r\n  }\r\n\r\n  async createDriver(\r\n    driverData: Omit<\r\n      DriverData,\r\n      'id' | 'assigned_bus_id' | 'assigned_bus_plate'\r\n    > & {\r\n      password: string;\r\n    }\r\n  ): Promise<ApiResponse<DriverData>> {\r\n    return this.makeRequest<DriverData>('/drivers', {\r\n      method: 'POST',\r\n      body: JSON.stringify(driverData),\r\n    });\r\n  }\r\n\r\n  async updateDriver(\r\n    driverId: string,\r\n    driverData: Partial<DriverData>\r\n  ): Promise<ApiResponse<DriverData>> {\r\n    return this.makeRequest<DriverData>(`/drivers/${driverId}`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(driverData),\r\n    });\r\n  }\r\n\r\n  async deleteDriver(driverId: string): Promise<ApiResponse<DriverData>> {\r\n    return this.makeRequest<DriverData>(`/drivers/${driverId}`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n\r\n  // ===== ROUTE MANAGEMENT ENDPOINTS =====\r\n\r\n  async getAllRoutes(): Promise<ApiResponse<RouteData[]>> {\r\n    console.log('🛣️ Fetching all routes...');\r\n    const result = await this.makeRequest<RouteData[]>('/routes');\r\n    console.log(\r\n      '🛣️ Routes result:',\r\n      result.success ? `${result.data?.length || 0} routes` : result.error\r\n    );\r\n    return result;\r\n  }\r\n\r\n  async getRouteById(routeId: string): Promise<ApiResponse<RouteData>> {\r\n    return this.makeRequest<RouteData>(`/routes/${routeId}`);\r\n  }\r\n\r\n  async createRoute(routeData: {\r\n    name: string;\r\n    description: string;\r\n    distance_km: number;\r\n    estimated_duration_minutes: number;\r\n    is_active: boolean;\r\n    city: string;\r\n  }): Promise<ApiResponse<RouteData>> {\r\n    return this.makeRequest<RouteData>('/routes', {\r\n      method: 'POST',\r\n      body: JSON.stringify(routeData),\r\n    });\r\n  }\r\n\r\n  async updateRoute(\r\n    routeId: string,\r\n    routeData: Partial<{\r\n      name: string;\r\n      description: string;\r\n      distance_km: number;\r\n      estimated_duration_minutes: number;\r\n      is_active: boolean;\r\n      city: string;\r\n      custom_destination?: string;\r\n      custom_destination_coordinates?: [number, number];\r\n      custom_origin?: string;\r\n      custom_origin_coordinates?: [number, number];\r\n      bus_stops?: any[];\r\n      stops?: GeoJSON.LineString;\r\n    }>\r\n  ): Promise<ApiResponse<RouteData>> {\r\n    return this.makeRequest<RouteData>(`/routes/${routeId}`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(routeData),\r\n    });\r\n  }\r\n\r\n  async deleteRoute(routeId: string): Promise<ApiResponse<RouteData>> {\r\n    return this.makeRequest<RouteData>(`/routes/${routeId}`, {\r\n      method: 'DELETE',\r\n    });\r\n  }\r\n}\r\n\r\nexport const adminApiService = new AdminApiService();\r\nexport default adminApiService;\r\n","import { authService } from './authService';\nimport { environment } from '../config/environment';\n\nconst API_BASE_URL = environment.api.url;\n\nexport interface UploadResult {\n  success: boolean;\n  url?: string;\n  fileName?: string;\n  error?: string;\n}\n\nexport interface FileInfo {\n  success: boolean;\n  hasFile: boolean;\n  url?: string;\n  info?: unknown;\n  error?: string;\n}\n\nexport interface SignedUrlResult {\n  success: boolean;\n  signedUrl?: string;\n  expiresIn?: number;\n  error?: string;\n}\n\nexport class StorageService {\n  // Helper function to make authenticated requests\n  private static async makeRequest(\n    endpoint: string,\n    options: RequestInit = {}\n  ): Promise<Response> {\n    let token = authService.getAccessToken();\n\n    // If no token, only try to refresh if user is authenticated\n    if (!token && authService.isAuthenticated()) {\n      console.log(\n        '🔄 No token found but user is authenticated, attempting to refresh session...'\n      );\n      const refreshResult = await authService.refreshSession();\n      if (refreshResult.success) {\n        token = authService.getAccessToken();\n        console.log('✅ Session refreshed, new token obtained');\n      } else {\n        console.error('❌ Failed to refresh session:', refreshResult.error);\n        throw new Error('Authentication required');\n      }\n    }\n\n    const defaultHeaders = {\n      'Content-Type': 'application/json',\n      ...(token && { Authorization: `Bearer ${token}` }),\n    };\n\n    // Ensure we're using the correct backend URL for production\n    const baseUrl = API_BASE_URL || environment.api.url;\n    return fetch(`${baseUrl}/storage${endpoint}`, {\n      ...options,\n      headers: {\n        ...defaultHeaders,\n        ...options.headers,\n      },\n    });\n  }\n\n  // Upload bus image\n  static async uploadBusImage(\n    busId: string,\n    file: File\n  ): Promise<UploadResult> {\n    try {\n      console.log('🔐 Getting access token...');\n      const token = authService.getAccessToken();\n      if (!token) {\n        console.error('❌ No access token available');\n        return { success: false, error: 'Authentication required' };\n      }\n      console.log('✅ Access token obtained');\n\n      const formData = new FormData();\n      formData.append('image', file);\n      formData.append('busId', busId);\n\n      // Ensure we're using the correct backend URL for production\n      const baseUrl = API_BASE_URL || environment.api.url;\n      console.log(\n        '📤 Sending request to:',\n        `${baseUrl}/storage/upload/bus-image`\n      );\n      console.log('📋 FormData contents:', {\n        busId,\n        fileName: file.name,\n        fileSize: file.size,\n        fileType: file.type,\n      });\n\n      const response = await fetch(`${baseUrl}/storage/upload/bus-image`, {\n        method: 'POST',\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n        body: formData,\n      });\n\n      console.log('📥 Response status:', response.status);\n      console.log(\n        '📥 Response headers:',\n        Object.fromEntries(response.headers.entries())\n      );\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        console.error('❌ Upload failed:', errorData);\n        return { success: false, error: errorData.error || 'Upload failed' };\n      }\n\n      const data = await response.json();\n      console.log('✅ Upload successful:', data);\n      return {\n        success: true,\n        url: data.url,\n        fileName: data.fileName,\n      };\n    } catch (error) {\n      console.error('❌ Upload bus image error:', error);\n      return { success: false, error: 'Network error during upload' };\n    }\n  }\n\n  // Upload driver photo\n  static async uploadDriverPhoto(\n    driverId: string,\n    file: File\n  ): Promise<UploadResult> {\n    try {\n      const token = authService.getAccessToken();\n      if (!token) {\n        return { success: false, error: 'Authentication required' };\n      }\n\n      const formData = new FormData();\n      formData.append('photo', file);\n      formData.append('driverId', driverId);\n\n      // Ensure we're using the correct backend URL for production\n      const baseUrl = API_BASE_URL || environment.api.url;\n      const response = await fetch(`${baseUrl}/storage/upload/driver-photo`, {\n        method: 'POST',\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        return { success: false, error: errorData.error || 'Upload failed' };\n      }\n\n      const data = await response.json();\n      return {\n        success: true,\n        url: data.url,\n        fileName: data.fileName,\n      };\n    } catch (error) {\n      console.error('Upload driver photo error:', error);\n      return { success: false, error: 'Network error during upload' };\n    }\n  }\n\n  // Upload route map\n  static async uploadRouteMap(\n    routeId: string,\n    file: File\n  ): Promise<UploadResult> {\n    try {\n      const token = authService.getAccessToken();\n      if (!token) {\n        return { success: false, error: 'Authentication required' };\n      }\n\n      const formData = new FormData();\n      formData.append('map', file);\n      formData.append('routeId', routeId);\n\n      // Ensure we're using the correct backend URL for production\n      const baseUrl = API_BASE_URL || environment.api.url;\n      const response = await fetch(`${baseUrl}/storage/upload/route-map`, {\n        method: 'POST',\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        return { success: false, error: errorData.error || 'Upload failed' };\n      }\n\n      const data = await response.json();\n      return {\n        success: true,\n        url: data.url,\n        fileName: data.fileName,\n      };\n    } catch (error) {\n      console.error('Upload route map error:', error);\n      return { success: false, error: 'Network error during upload' };\n    }\n  }\n\n  // Get signed URL for file access (for private bucket)\n  static async getSignedUrl(\n    type: 'bus' | 'driver' | 'route',\n    id: string\n  ): Promise<SignedUrlResult> {\n    try {\n      const response = await this.makeRequest(`/signed-url/${type}/${id}`);\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        return {\n          success: false,\n          error: errorData.error || 'Failed to get signed URL',\n        };\n      }\n\n      const data = await response.json();\n      return {\n        success: true,\n        signedUrl: data.signedUrl,\n        expiresIn: data.expiresIn,\n      };\n    } catch (error) {\n      console.error('Get signed URL error:', error);\n      return { success: false, error: 'Network error' };\n    }\n  }\n\n  // Delete file\n  static async deleteFile(\n    type: 'bus' | 'driver' | 'route',\n    id: string,\n    fileUrl: string\n  ): Promise<{ success: boolean; error?: string }> {\n    try {\n      const response = await this.makeRequest(`/delete/${type}/${id}`, {\n        method: 'DELETE',\n        body: JSON.stringify({ fileUrl }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        return { success: false, error: errorData.error || 'Delete failed' };\n      }\n\n      return { success: true };\n    } catch (error) {\n      console.error('Delete file error:', error);\n      return { success: false, error: 'Network error during deletion' };\n    }\n  }\n\n  // Get file info\n  static async getFileInfo(\n    type: 'bus' | 'driver' | 'route',\n    id: string\n  ): Promise<FileInfo> {\n    try {\n      const response = await this.makeRequest(`/info/${type}/${id}`);\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        return {\n          success: false,\n          hasFile: false,\n          error: errorData.error || 'Failed to get file info',\n        };\n      }\n\n      const data = await response.json();\n      return {\n        success: true,\n        hasFile: data.hasFile,\n        url: data.url,\n        info: data.info,\n      };\n    } catch (error) {\n      console.error('Get file info error:', error);\n      return { success: false, hasFile: false, error: 'Network error' };\n    }\n  }\n\n  // List files in a folder\n  static async listFiles(\n    folder: string\n  ): Promise<{ success: boolean; files?: unknown[]; error?: string }> {\n    try {\n      const response = await this.makeRequest(`/list/${folder}`);\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        return {\n          success: false,\n          error: errorData.error || 'Failed to list files',\n        };\n      }\n\n      const data = await response.json();\n      return {\n        success: true,\n        files: data.files,\n      };\n    } catch (error) {\n      console.error('List files error:', error);\n      return { success: false, error: 'Network error' };\n    }\n  }\n\n  // File validation\n  static validateFile(\n    file: File,\n    allowedTypes: string[],\n    maxSize: number\n  ): { isValid: boolean; error?: string } {\n    if (!file) {\n      return { isValid: false, error: 'No file selected' };\n    }\n\n    if (!allowedTypes.includes(file.type)) {\n      return {\n        isValid: false,\n        error: `Invalid file type. Allowed types: ${allowedTypes.join(', ')}`,\n      };\n    }\n\n    if (file.size > maxSize) {\n      return {\n        isValid: false,\n        error: `File too large. Maximum size: ${maxSize / (1024 * 1024)}MB`,\n      };\n    }\n\n    return { isValid: true };\n  }\n\n  // Validate image file\n  static validateImage(file: File): { isValid: boolean; error?: string } {\n    const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'];\n    const maxSize = 5 * 1024 * 1024; // 5MB\n    return this.validateFile(file, allowedTypes, maxSize);\n  }\n\n  // Validate document file\n  static validateDocument(file: File): { isValid: boolean; error?: string } {\n    const allowedTypes = [\n      'application/pdf',\n      'image/jpeg',\n      'image/jpg',\n      'image/png',\n    ];\n    const maxSize = 10 * 1024 * 1024; // 10MB\n    return this.validateFile(file, allowedTypes, maxSize);\n  }\n}\n\nexport default StorageService;\n","import { useState, useEffect } from 'react';\r\nimport { StorageService } from '../services/storageService';\r\nimport { adminApiService } from '../services/adminApiService';\r\n\r\ninterface Bus {\r\n  id?: string;\r\n  number_plate: string;\r\n  bus_image_url?: string;\r\n}\r\n\r\ninterface Driver {\r\n  id: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  email?: string;\r\n  profile_photo_url?: string;\r\n}\r\n\r\ninterface Route {\r\n  id: string;\r\n  name: string;\r\n  route_map_url?: string;\r\n}\r\n\r\nexport default function MediaManagement() {\r\n  const [activeTab, setActiveTab] = useState<'bus' | 'driver' | 'route'>('bus');\r\n  const [buses, setBuses] = useState<Bus[]>([]);\r\n  const [drivers, setDrivers] = useState<Driver[]>([]);\r\n  const [routes, setRoutes] = useState<Route[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\r\n  const [selectedItem, setSelectedItem] = useState<string>('');\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, []);\r\n\r\n  const loadData = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const [busesResult, driversResult, routesResult] = await Promise.all([\r\n        adminApiService.getAllBuses(),\r\n        adminApiService.getAllDrivers(),\r\n        adminApiService.getAllRoutes(),\r\n      ]);\r\n\r\n      if (busesResult.success && busesResult.data) {\r\n        setBuses(busesResult.data);\r\n      }\r\n\r\n      if (driversResult.success && driversResult.data) {\r\n        // Additional frontend deduplication as safety measure\r\n        const uniqueDriversMap = new Map();\r\n        driversResult.data.forEach((driver: Driver) => {\r\n          const idKey = driver.id;\r\n\r\n          if (!uniqueDriversMap.has(idKey)) {\r\n            // First time seeing this ID\r\n            uniqueDriversMap.set(idKey, driver);\r\n          } else {\r\n            // We already have this ID, check if we should replace it\r\n            const existing = uniqueDriversMap.get(idKey);\r\n\r\n            // Prefer the entry with email over null email\r\n            if (!existing.email && driver.email) {\r\n              uniqueDriversMap.set(idKey, driver);\r\n            }\r\n            // If both have emails, prefer the one with more complete data\r\n            else if (existing.email && driver.email) {\r\n              // Keep the existing one unless the new one has more complete data\r\n              if (!existing.first_name && driver.first_name) {\r\n                uniqueDriversMap.set(idKey, driver);\r\n              }\r\n            }\r\n          }\r\n        });\r\n        const uniqueDrivers = Array.from(uniqueDriversMap.values());\r\n        setDrivers(uniqueDrivers);\r\n      }\r\n\r\n      if (routesResult.success && routesResult.data) {\r\n        setRoutes(routesResult.data);\r\n      }\r\n    } catch (err) {\r\n      setError('Failed to load data');\r\n      console.error('❌ Data loading error:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0];\r\n    if (file) {\r\n      setSelectedFile(file);\r\n      setError(null);\r\n    }\r\n  };\r\n\r\n  const handleUpload = async () => {\r\n    if (!selectedFile || !selectedItem) {\r\n      setError('Please select a file and an item');\r\n      return;\r\n    }\r\n\r\n    console.log('🚀 Starting upload...', {\r\n      activeTab,\r\n      selectedItem,\r\n      fileName: selectedFile.name,\r\n      fileSize: selectedFile.size,\r\n      fileType: selectedFile.type,\r\n    });\r\n\r\n    setUploading(true);\r\n    setError(null);\r\n    setSuccess(null);\r\n\r\n    try {\r\n      let result;\r\n\r\n      switch (activeTab) {\r\n        case 'bus':\r\n          console.log('📤 Uploading bus image...');\r\n          result = await StorageService.uploadBusImage(\r\n            selectedItem,\r\n            selectedFile\r\n          );\r\n          break;\r\n        case 'driver':\r\n          console.log('📤 Uploading driver photo...');\r\n          result = await StorageService.uploadDriverPhoto(\r\n            selectedItem,\r\n            selectedFile\r\n          );\r\n          break;\r\n        case 'route':\r\n          console.log('📤 Uploading route map...');\r\n          result = await StorageService.uploadRouteMap(\r\n            selectedItem,\r\n            selectedFile\r\n          );\r\n          break;\r\n      }\r\n\r\n      console.log('📥 Upload result:', result);\r\n\r\n      if (result.success) {\r\n        setSuccess('File uploaded successfully!');\r\n        setSelectedFile(null);\r\n        setSelectedItem('');\r\n        loadData(); // Refresh the data\r\n      } else {\r\n        setError(result.error || 'Upload failed');\r\n        console.error('❌ Upload failed:', result.error);\r\n      }\r\n    } catch (err) {\r\n      setError('Upload failed. Please try again.');\r\n      console.error('❌ Upload error:', err);\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (itemId: string, fileUrl: string) => {\r\n    if (!confirm('Are you sure you want to delete this file?')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = await StorageService.deleteFile(\r\n        activeTab,\r\n        itemId,\r\n        fileUrl\r\n      );\r\n      if (result.success) {\r\n        setSuccess('File deleted successfully!');\r\n        loadData(); // Refresh the data\r\n      } else {\r\n        setError(result.error || 'Delete failed');\r\n      }\r\n    } catch (err) {\r\n      setError('Delete failed. Please try again.');\r\n      console.error('❌ Delete error:', err);\r\n    }\r\n  };\r\n\r\n  const getCurrentItems = () => {\r\n    switch (activeTab) {\r\n      case 'bus':\r\n        return buses;\r\n      case 'driver':\r\n        return drivers;\r\n      case 'route':\r\n        return routes;\r\n      default:\r\n        return [];\r\n    }\r\n  };\r\n\r\n  const getDisplayName = (item: Bus | Driver | Route) => {\r\n    switch (activeTab) {\r\n      case 'bus':\r\n        return (item as Bus).number_plate;\r\n      case 'driver': {\r\n        const driver = item as Driver;\r\n        return `${driver.first_name} ${driver.last_name}`;\r\n      }\r\n      case 'route':\r\n        return (item as Route).name;\r\n      default:\r\n        return 'Unknown';\r\n    }\r\n  };\r\n\r\n  const getFileUrl = (item: Bus | Driver | Route) => {\r\n    let url: string | null = null;\r\n\r\n    switch (activeTab) {\r\n      case 'bus':\r\n        url = (item as Bus).bus_image_url || null;\r\n        break;\r\n      case 'driver':\r\n        url = (item as Driver).profile_photo_url || null;\r\n        break;\r\n      case 'route':\r\n        url = (item as Route).route_map_url || null;\r\n        break;\r\n      default:\r\n        return null;\r\n    }\r\n\r\n    // If no URL, return null\r\n    if (!url) return null;\r\n\r\n    // If it's already a full URL, return as is\r\n    if (url.startsWith('http')) {\r\n      return url;\r\n    }\r\n\r\n    // If it's a file path, convert to public URL\r\n    if (url.includes('/')) {\r\n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\r\n      const bucketName = 'bus-tracking-media';\r\n      return `${supabaseUrl}/storage/v1/object/public/${bucketName}/${url}`;\r\n    }\r\n\r\n    return url;\r\n  };\r\n\r\n  const getTabTitle = () => {\r\n    switch (activeTab) {\r\n      case 'bus':\r\n        return 'Bus Images';\r\n      case 'driver':\r\n        return 'Driver Photos';\r\n      case 'route':\r\n        return 'Route Maps';\r\n      default:\r\n        return 'Media';\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Loading media management...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <div className=\"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8\">\r\n        {/* Header */}\r\n        <div className=\"px-4 py-6 sm:px-0\">\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-6\">\r\n              Media Management\r\n            </h1>\r\n\r\n            {/* Error/Success Messages */}\r\n            {error && (\r\n              <div className=\"mb-4 bg-red-50 border border-red-200 rounded-md p-4\">\r\n                <p className=\"text-red-700\">{error}</p>\r\n              </div>\r\n            )}\r\n\r\n            {success && (\r\n              <div className=\"mb-4 bg-green-50 border border-green-200 rounded-md p-4\">\r\n                <p className=\"text-green-700\">{success}</p>\r\n              </div>\r\n            )}\r\n\r\n            {/* Tab Navigation */}\r\n            <div className=\"border-b border-gray-200 mb-6\">\r\n              <nav className=\"-mb-px flex space-x-8\">\r\n                {[\r\n                  { id: 'bus', name: 'Bus Images' },\r\n                  { id: 'driver', name: 'Driver Photos' },\r\n                  { id: 'route', name: 'Route Maps' },\r\n                ].map((tab) => (\r\n                  <button\r\n                    key={tab.id}\r\n                    onClick={() =>\r\n                      setActiveTab(tab.id as 'bus' | 'driver' | 'route')\r\n                    }\r\n                    className={`py-2 px-1 border-b-2 font-medium text-sm ${\r\n                      activeTab === tab.id\r\n                        ? 'border-purple-500 text-purple-600'\r\n                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n                    }`}\r\n                  >\r\n                    {tab.name}\r\n                  </button>\r\n                ))}\r\n              </nav>\r\n            </div>\r\n\r\n            {/* Upload Section */}\r\n            <div className=\"bg-gray-50 rounded-lg p-6 mb-6\">\r\n              <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n                Upload {getTabTitle()}\r\n              </h3>\r\n\r\n              <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-3\">\r\n                {/* File Selection */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Select File\r\n                  </label>\r\n                  <input\r\n                    type=\"file\"\r\n                    onChange={handleFileSelect}\r\n                    accept={\r\n                      activeTab === 'route'\r\n                        ? '.pdf,.jpg,.jpeg,.png'\r\n                        : '.jpg,.jpeg,.png,.webp'\r\n                    }\r\n                    className=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100\"\r\n                  />\r\n                  {selectedFile && (\r\n                    <p className=\"mt-1 text-sm text-gray-500\">\r\n                      Selected: {selectedFile.name} (\r\n                      {(selectedFile.size / 1024 / 1024).toFixed(2)} MB)\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Item Selection */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Select{' '}\r\n                    {activeTab === 'bus'\r\n                      ? 'Bus'\r\n                      : activeTab === 'driver'\r\n                        ? 'Driver'\r\n                        : 'Route'}\r\n                  </label>\r\n                  <select\r\n                    value={selectedItem}\r\n                    onChange={(e) => setSelectedItem(e.target.value)}\r\n                    className=\"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500\"\r\n                  >\r\n                    <option value=\"\">Choose...</option>\r\n                    {getCurrentItems().map((item) => (\r\n                      <option key={item.id || 'temp'} value={item.id || ''}>\r\n                        {getDisplayName(item)}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                {/* Upload Button */}\r\n                <div className=\"flex items-end\">\r\n                  <button\r\n                    onClick={handleUpload}\r\n                    disabled={!selectedFile || !selectedItem || uploading}\r\n                    className=\"w-full bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors\"\r\n                  >\r\n                    {uploading ? 'Uploading...' : 'Upload'}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Media List */}\r\n            <div>\r\n              <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n                Current {getTabTitle()}\r\n              </h3>\r\n\r\n              {getCurrentItems().length === 0 ? (\r\n                <p className=\"text-gray-500 text-center py-8\">\r\n                  No items found.\r\n                </p>\r\n              ) : (\r\n                <div className=\"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3\">\r\n                  {getCurrentItems().map((item) => {\r\n                    const fileUrl = getFileUrl(item);\r\n                    const displayName = getDisplayName(item);\r\n                    return (\r\n                      <div\r\n                        key={item.id || 'temp'}\r\n                        className=\"bg-white border border-gray-200 rounded-lg p-4\"\r\n                      >\r\n                        <h4 className=\"font-medium text-gray-900 mb-2\">\r\n                          {displayName}\r\n                        </h4>\r\n\r\n                        {fileUrl ? (\r\n                          <div>\r\n                            <div className=\"mb-3\">\r\n                              {activeTab !== 'route' ? (\r\n                                <img\r\n                                  src={fileUrl}\r\n                                  alt={displayName}\r\n                                  className=\"w-full h-32 object-cover rounded-md\"\r\n                                  onError={(e) => {\r\n                                    e.currentTarget.src =\r\n                                      'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2YzZjRmNiIvPjx0ZXh0IHg9IjEwMCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5Y2EzYWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5JbWFnZSBVbmF2YWlsYWJsZTwvdGV4dD48L3N2Zz4=';\r\n                                  }}\r\n                                />\r\n                              ) : (\r\n                                <div className=\"w-full h-32 bg-gray-100 rounded-md flex items-center justify-center\">\r\n                                  <svg\r\n                                    className=\"w-8 h-8 text-gray-400\"\r\n                                    fill=\"none\"\r\n                                    stroke=\"currentColor\"\r\n                                    viewBox=\"0 0 24 24\"\r\n                                  >\r\n                                    <path\r\n                                      strokeLinecap=\"round\"\r\n                                      strokeLinejoin=\"round\"\r\n                                      strokeWidth={2}\r\n                                      d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\r\n                                    />\r\n                                  </svg>\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n\r\n                            <div className=\"flex space-x-2\">\r\n                              <button\r\n                                onClick={() => window.open(fileUrl, '_blank')}\r\n                                className=\"flex-1 bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors\"\r\n                              >\r\n                                View\r\n                              </button>\r\n                              <button\r\n                                onClick={() =>\r\n                                  item.id && handleDelete(item.id, fileUrl)\r\n                                }\r\n                                className=\"flex-1 bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors\"\r\n                                disabled={!item.id}\r\n                              >\r\n                                Delete\r\n                              </button>\r\n                            </div>\r\n                          </div>\r\n                        ) : (\r\n                          <div className=\"text-center py-4\">\r\n                            <p className=\"text-gray-500 text-sm mb-2\">\r\n                              No file uploaded\r\n                            </p>\r\n                            <div className=\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-2\">\r\n                              <svg\r\n                                className=\"w-6 h-6 text-gray-400\"\r\n                                fill=\"none\"\r\n                                stroke=\"currentColor\"\r\n                                viewBox=\"0 0 24 24\"\r\n                              >\r\n                                <path\r\n                                  strokeLinecap=\"round\"\r\n                                  strokeLinejoin=\"round\"\r\n                                  strokeWidth={2}\r\n                                  d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\"\r\n                                />\r\n                              </svg>\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// Coordinate utilities for the bus management system\n\nexport interface Location {\n  name: string;\n  coordinates: [number, number]; // [longitude, latitude]\n  address: string;\n  city: string;\n}\n\n// Ganpat University coordinates (verified from distancesfrom.com)\nexport const GANPAT_UNIVERSITY: Location = {\n  name: 'Ganpat University',\n  coordinates: [72.4563, 23.5295], // [longitude, latitude] - Correct coordinates\n  address: 'Ganpat Vidyanagar, Mehsana-Gozaria Highway, Kherva, Gujarat 384012',\n  city: 'Mehsana',\n};\n\n// Common cities in Gujarat for reference\nexport const GUJARAT_CITIES: Location[] = [\n  {\n    name: 'Ahmedabad',\n    coordinates: [72.5714, 23.0225],\n    address: 'Ahmedabad, Gujarat, India',\n    city: 'Ahmedabad',\n  },\n  {\n    name: 'Gandhinagar',\n    coordinates: [72.6369, 23.2154], // Gandhinagar coordinates (different from Ganpat University)\n    address: 'Gandhinagar, Gujarat, India',\n    city: 'Gandhinagar',\n  },\n  {\n    name: 'Vadodara',\n    coordinates: [73.1811, 22.3072],\n    address: 'Vadodara, Gujarat, India',\n    city: 'Vadodara',\n  },\n  {\n    name: 'Surat',\n    coordinates: [72.8311, 21.1702],\n    address: 'Surat, Gujarat, India',\n    city: 'Surat',\n  },\n  {\n    name: 'Rajkot',\n    coordinates: [70.8022, 22.3039],\n    address: 'Rajkot, Gujarat, India',\n    city: 'Rajkot',\n  },\n];\n\n// Function to verify coordinates\nexport const verifyCoordinates = (coordinates: [number, number]): boolean => {\n  const [lng, lat] = coordinates;\n\n  // Check if coordinates are within reasonable bounds for Gujarat, India\n  return lng >= 68 && lng <= 75 && lat >= 20 && lat <= 25;\n};\n\n// Function to get distance between two points (Haversine formula)\nexport const calculateDistance = (\n  point1: [number, number],\n  point2: [number, number]\n): number => {\n  const R = 6371; // Earth's radius in km\n  const dLat = ((point2[1] - point1[1]) * Math.PI) / 180;\n  const dLon = ((point2[0] - point1[0]) * Math.PI) / 180;\n  const a =\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos((point1[1] * Math.PI) / 180) *\n      Math.cos((point2[1] * Math.PI) / 180) *\n      Math.sin(dLon / 2) *\n      Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n};\n\n// Function to format coordinates for display\nexport const formatCoordinates = (coordinates: [number, number]): string => {\n  const [lng, lat] = coordinates;\n  return `${lat.toFixed(6)}, ${lng.toFixed(6)}`;\n};\n\n// Function to get location name from coordinates (approximate)\nexport const getLocationName = (coordinates: [number, number]): string => {\n  const [lng, lat] = coordinates;\n\n  // Check if it's Ganpat University (correct coordinates)\n  if (Math.abs(lng - 72.4563) < 0.01 && Math.abs(lat - 23.5295) < 0.01) {\n    return 'Ganpat University';\n  }\n\n  // Check other known locations\n  for (const city of GUJARAT_CITIES) {\n    if (\n      Math.abs(lng - city.coordinates[0]) < 0.1 &&\n      Math.abs(lat - city.coordinates[1]) < 0.1\n    ) {\n      return city.name;\n    }\n  }\n\n  return 'Unknown Location';\n};\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport maplibregl from 'maplibre-gl';\r\nimport 'maplibre-gl/dist/maplibre-gl.css';\r\nimport { GANPAT_UNIVERSITY } from '../utils/coordinates';\r\n\r\ninterface MapSelectorProps {\r\n  onLocationSelect: (location: {\r\n    name: string;\r\n    coordinates: [number, number];\r\n    address?: string;\r\n  }) => void;\r\n  onClose: () => void;\r\n  title: string;\r\n  defaultCenter?: [number, number];\r\n  searchPlaceholder?: string;\r\n}\r\n\r\nconst MapSelector: React.FC<MapSelectorProps> = ({\r\n  onLocationSelect,\r\n  onClose,\r\n  title,\r\n  defaultCenter = GANPAT_UNIVERSITY.coordinates, // Ganpat University coordinates\r\n  searchPlaceholder = 'Search for a location...',\r\n}) => {\r\n  // Prevent multiple instances\r\n  const instanceId = React.useRef(Math.random().toString(36).substr(2, 9));\r\n  const mapContainer = useRef<HTMLDivElement>(null);\r\n  const map = useRef<maplibregl.Map | null>(null);\r\n  const marker = useRef<maplibregl.Marker | null>(null);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [selectedLocation, setSelectedLocation] = useState<{\r\n    name: string;\r\n    coordinates: [number, number];\r\n    address?: string;\r\n  } | null>(null);\r\n  const [isMapLoading, setIsMapLoading] = useState(true);\r\n  const [mapError, setMapError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!mapContainer.current || map.current) return; // Prevent multiple initializations\r\n\r\n    console.log(\r\n      `🗺️ [${instanceId.current}] Initializing map with center:`,\r\n      defaultCenter\r\n    );\r\n    console.log(\r\n      `🗺️ [${instanceId.current}] Ganpat University coordinates:`,\r\n      GANPAT_UNIVERSITY.coordinates\r\n    );\r\n\r\n    // Initialize map\r\n    map.current = new maplibregl.Map({\r\n      container: mapContainer.current,\r\n      style: {\r\n        version: 8,\r\n        sources: {\r\n          osm: {\r\n            type: 'raster',\r\n            tiles: ['https://tile.openstreetmap.org/{z}/{x}/{y}.png'],\r\n            tileSize: 256,\r\n            attribution: '© OpenStreetMap contributors',\r\n          },\r\n        },\r\n        layers: [\r\n          {\r\n            id: 'osm-tiles',\r\n            type: 'raster',\r\n            source: 'osm',\r\n            minzoom: 0,\r\n            maxzoom: 22,\r\n          },\r\n        ],\r\n      },\r\n      center: GANPAT_UNIVERSITY.coordinates, // Ganpat University coordinates\r\n      zoom: 12,\r\n      preserveDrawingBuffer: true, // Help with WebGL context stability\r\n      antialias: false, // Reduce GPU load\r\n      maxZoom: 18,\r\n      minZoom: 5,\r\n      maxPitch: 0, // Disable 3D to reduce GPU load\r\n      pitch: 0,\r\n    });\r\n\r\n    // Wait for map to load before adding controls and markers\r\n    map.current.on('load', () => {\r\n      console.log('🗺️ Map loaded, adding controls and marker');\r\n\r\n      try {\r\n        // Add navigation controls\r\n        map.current?.addControl(new maplibregl.NavigationControl());\r\n\r\n        // Add marker at default center\r\n        marker.current = new maplibregl.Marker({\r\n          draggable: true,\r\n          color: '#3B82F6',\r\n        })\r\n          .setLngLat(defaultCenter)\r\n          .addTo(map.current!);\r\n\r\n        // Force center the map on Ganpat University\r\n        map.current!.flyTo({\r\n          center: GANPAT_UNIVERSITY.coordinates, // Ganpat University\r\n          zoom: 12,\r\n          duration: 1000,\r\n        });\r\n\r\n        // Set initial selected location to Ganpat University\r\n        setSelectedLocation({\r\n          name: GANPAT_UNIVERSITY.name,\r\n          coordinates: GANPAT_UNIVERSITY.coordinates,\r\n          address: GANPAT_UNIVERSITY.address,\r\n        });\r\n\r\n        // Handle marker drag after marker is created\r\n        marker.current.on('dragend', () => {\r\n          const coordinates = marker.current?.getLngLat();\r\n          if (coordinates) {\r\n            reverseGeocode([coordinates.lng, coordinates.lat]);\r\n          }\r\n        });\r\n\r\n        console.log(\r\n          `🗺️ [${instanceId.current}] Map centered on ${GANPAT_UNIVERSITY.name}`\r\n        );\r\n\r\n        setIsMapLoading(false);\r\n      } catch (error) {\r\n        console.error('❌ Error setting up map:', error);\r\n        setMapError('Failed to initialize map');\r\n        setIsMapLoading(false);\r\n      }\r\n    });\r\n\r\n    // Handle map errors\r\n    map.current.on('error', (e) => {\r\n      console.error('❌ Map error:', e);\r\n      setMapError('Map failed to load');\r\n      setIsMapLoading(false);\r\n    });\r\n\r\n    // Handle map clicks\r\n    map.current.on('click', (e) => {\r\n      const coordinates: [number, number] = [e.lngLat.lng, e.lngLat.lat];\r\n      marker.current?.setLngLat(coordinates);\r\n\r\n      // Reverse geocode to get address\r\n      reverseGeocode(coordinates);\r\n    });\r\n\r\n    // Handle WebGL context loss\r\n    map.current.on('webglcontextlost', () => {\r\n      console.warn('⚠️ WebGL context lost, attempting to restore...');\r\n    });\r\n\r\n    map.current.on('webglcontextrestored', () => {\r\n      console.log('✅ WebGL context restored');\r\n    });\r\n\r\n    return () => {\r\n      if (map.current) {\r\n        console.log('🗺️ Cleaning up map instance');\r\n        try {\r\n          // Remove all event listeners\r\n          map.current.off('load', () => {});\r\n          map.current.off('click', () => {});\r\n          map.current.off('error', () => {});\r\n          map.current.off('webglcontextlost', () => {});\r\n          map.current.off('webglcontextrestored', () => {});\r\n\r\n          // Remove marker\r\n          if (marker.current) {\r\n            marker.current.remove();\r\n          }\r\n\r\n          // Remove map\r\n          map.current.remove();\r\n        } catch (error) {\r\n          console.warn('⚠️ Error during map cleanup:', error);\r\n        } finally {\r\n          map.current = null;\r\n          marker.current = null;\r\n        }\r\n      }\r\n    };\r\n  }, [defaultCenter]); // Include defaultCenter dependency\r\n\r\n  const reverseGeocode = async (coordinates: [number, number]) => {\r\n    try {\r\n      const response = await fetch(\r\n        `https://nominatim.openstreetmap.org/reverse?format=json&lat=${coordinates[1]}&lon=${coordinates[0]}&zoom=18&addressdetails=1`\r\n      );\r\n      const data = await response.json();\r\n\r\n      const location = {\r\n        name: data.display_name.split(',')[0] || 'Selected Location',\r\n        coordinates: coordinates,\r\n        address: data.display_name,\r\n      };\r\n\r\n      setSelectedLocation(location);\r\n    } catch (error) {\r\n      console.error('Error reverse geocoding:', error);\r\n      setSelectedLocation({\r\n        name: 'Selected Location',\r\n        coordinates: coordinates,\r\n        address: `${coordinates[1]}, ${coordinates[0]}`,\r\n      });\r\n    }\r\n  };\r\n\r\n  const searchLocation = async () => {\r\n    if (!searchQuery.trim() || !map.current) return;\r\n\r\n    try {\r\n      console.log('🔍 Searching for:', searchQuery);\r\n\r\n      const response = await fetch(\r\n        `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(searchQuery)}&limit=5&countrycodes=in`\r\n      );\r\n      const data = await response.json();\r\n\r\n      console.log('🔍 Search results:', data);\r\n\r\n      if (data.length > 0) {\r\n        const firstResult = data[0];\r\n        const coordinates: [number, number] = [\r\n          parseFloat(firstResult.lon),\r\n          parseFloat(firstResult.lat),\r\n        ];\r\n\r\n        console.log('🗺️ Flying to coordinates:', coordinates);\r\n\r\n        map.current!.flyTo({\r\n          center: coordinates,\r\n          zoom: 15,\r\n        });\r\n\r\n        marker.current?.setLngLat(coordinates);\r\n\r\n        const location = {\r\n          name: firstResult.display_name.split(',')[0] || searchQuery,\r\n          coordinates: coordinates,\r\n          address: firstResult.display_name,\r\n        };\r\n\r\n        setSelectedLocation(location);\r\n      } else {\r\n        console.log('🔍 No search results found');\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error searching location:', error);\r\n    }\r\n  };\r\n\r\n  const handleConfirm = () => {\r\n    if (selectedLocation) {\r\n      onLocationSelect(selectedLocation);\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter') {\r\n      searchLocation();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl h-[80vh] flex flex-col\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-4 border-b\">\r\n          <h2 className=\"text-xl font-semibold text-gray-800\">{title}</h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700\"\r\n          >\r\n            <svg\r\n              className=\"w-6 h-6\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M6 18L18 6M6 6l12 12\"\r\n              />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Search Bar */}\r\n        <div className=\"p-4 border-b\">\r\n          <div className=\"flex gap-2 mb-2\">\r\n            <input\r\n              type=\"text\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              onKeyPress={handleKeyPress}\r\n              placeholder={searchPlaceholder}\r\n              className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n            <button\r\n              onClick={searchLocation}\r\n              className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            >\r\n              Search\r\n            </button>\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <button\r\n              onClick={() => {\r\n                if (map.current) {\r\n                  console.log(\r\n                    '🏫 Resetting to Ganpat University at coordinates:',\r\n                    GANPAT_UNIVERSITY.coordinates\r\n                  );\r\n                  map.current!.flyTo({\r\n                    center: GANPAT_UNIVERSITY.coordinates, // Ganpat University\r\n                    zoom: 12,\r\n                  });\r\n                  marker.current?.setLngLat(GANPAT_UNIVERSITY.coordinates);\r\n                  setSelectedLocation({\r\n                    name: GANPAT_UNIVERSITY.name,\r\n                    coordinates: GANPAT_UNIVERSITY.coordinates,\r\n                    address: GANPAT_UNIVERSITY.address,\r\n                  });\r\n                }\r\n              }}\r\n              className=\"px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500\"\r\n            >\r\n              🏫 Reset to Ganpat University\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Map Container */}\r\n        <div className=\"flex-1 relative\">\r\n          {isMapLoading && (\r\n            <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100 z-10\">\r\n              <div className=\"text-center\">\r\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2\"></div>\r\n                <p className=\"text-gray-600\">Loading map...</p>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {mapError && (\r\n            <div className=\"absolute inset-0 flex items-center justify-center bg-red-50 z-10\">\r\n              <div className=\"text-center\">\r\n                <p className=\"text-red-600 mb-2\">⚠️ {mapError}</p>\r\n                <button\r\n                  onClick={() => {\r\n                    setMapError(null);\r\n                    setIsMapLoading(true);\r\n                    // Force re-initialization\r\n                    if (map.current) {\r\n                      map.current.remove();\r\n                      map.current = null;\r\n                      marker.current = null;\r\n                    }\r\n                    // Trigger useEffect again\r\n                    const container = mapContainer.current;\r\n                    if (container) {\r\n                      container.innerHTML = '';\r\n                    }\r\n                  }}\r\n                  className=\"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\r\n                >\r\n                  Retry\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div ref={mapContainer} className=\"w-full h-full\" />\r\n        </div>\r\n\r\n        {/* Selected Location Info */}\r\n        {selectedLocation && (\r\n          <div className=\"p-4 border-t bg-gray-50\">\r\n            <div className=\"mb-4\">\r\n              <h3 className=\"font-semibold text-gray-800 mb-2\">\r\n                Selected Location:\r\n              </h3>\r\n              <p className=\"text-gray-700 font-medium\">\r\n                {selectedLocation.name}\r\n              </p>\r\n              {selectedLocation.address && (\r\n                <p className=\"text-sm text-gray-600 mt-1\">\r\n                  {selectedLocation.address}\r\n                </p>\r\n              )}\r\n              <p className=\"text-sm text-gray-500 mt-1\">\r\n                Coordinates: {selectedLocation.coordinates[1].toFixed(6)},{' '}\r\n                {selectedLocation.coordinates[0].toFixed(6)}\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"flex gap-2\">\r\n              <button\r\n                onClick={handleConfirm}\r\n                className=\"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500\"\r\n              >\r\n                Confirm Selection\r\n              </button>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500\"\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MapSelector;\r\n","import { useState, useEffect, useCallback } from 'react';\r\nimport { adminApiService } from '../services/adminApiService';\r\n\r\nimport MapSelector from './MapSelector';\r\n\r\ninterface Bus {\r\n  id?: string;\r\n  code: string;\r\n  number_plate: string;\r\n  capacity: number;\r\n  model?: string;\r\n  year?: number;\r\n  is_active: boolean;\r\n  assigned_driver_id?: string;\r\n  route_id?: string;\r\n  // Driver information from backend join\r\n  driver_id?: string;\r\n  driver_full_name?: string;\r\n  driver_email?: string;\r\n  driver_first_name?: string;\r\n  driver_last_name?: string;\r\n  // Route information from backend join\r\n  route_name?: string;\r\n}\r\n\r\ninterface Driver {\r\n  id: string;\r\n  email: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  phone?: string;\r\n  role: string;\r\n  assigned_bus_id?: string;\r\n}\r\n\r\ninterface AssignedDriver {\r\n  driver_id: string;\r\n  driver_name: string;\r\n  driver_email: string;\r\n  bus_id: string;\r\n  bus_code: string;\r\n  number_plate: string;\r\n  route_name?: string;\r\n}\r\n\r\ninterface Route {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  distance_km: number;\r\n  estimated_duration_minutes: number;\r\n  is_active: boolean;\r\n  city?: string;\r\n  origin?: string;\r\n  destination?: string;\r\n  custom_destination?: string;\r\n  custom_origin?: string;\r\n  destination_coordinates?: {\r\n    coordinates: [number, number];\r\n  };\r\n  origin_coordinates?: {\r\n    coordinates: [number, number];\r\n  };\r\n  bus_stops?: Array<{\r\n    name: string;\r\n    coordinates: [number, number];\r\n    address?: string;\r\n  }>;\r\n  current_eta_minutes?: number;\r\n  last_eta_calculation?: string;\r\n  created_at?: string;\r\n  updated_at?: string;\r\n}\r\n\r\nexport default function StreamlinedManagement() {\r\n  const [activeTab, setActiveTab] = useState<'buses' | 'drivers' | 'routes'>(\r\n    'buses'\r\n  );\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\r\n\r\n  const [buses, setBuses] = useState<Bus[]>([]);\r\n  const [drivers, setDrivers] = useState<Driver[]>([]);\r\n\r\n  const [assignedDrivers, setAssignedDrivers] = useState<AssignedDriver[]>([]);\r\n  const [routes, setRoutes] = useState<Route[]>([]);\r\n\r\n  const [showBusForm, setShowBusForm] = useState(false);\r\n  const [showDriverForm, setShowDriverForm] = useState(false);\r\n  const [showCreateDriverForm, setShowCreateDriverForm] = useState(false);\r\n  const [showRouteForm, setShowRouteForm] = useState(false);\r\n\r\n  // Modal states for details and editing\r\n  const [showBusDetails, setShowBusDetails] = useState(false);\r\n  const [showRouteDetails, setShowRouteDetails] = useState(false);\r\n  const [selectedBus, setSelectedBus] = useState<Bus | null>(null);\r\n  const [selectedRoute, setSelectedRoute] = useState<Route | null>(null);\r\n  const [editingBus, setEditingBus] = useState(false);\r\n  const [editingRoute, setEditingRoute] = useState(false);\r\n\r\n  const [busForm, setBusForm] = useState({\r\n    code: '',\r\n    number_plate: '',\r\n    capacity: 50,\r\n    model: '',\r\n    year: new Date().getFullYear(),\r\n    is_active: true,\r\n  });\r\n\r\n  const [driverForm, setDriverForm] = useState({\r\n    email: '',\r\n    first_name: '',\r\n    last_name: '',\r\n    phone: '',\r\n    role: 'driver',\r\n    assigned_bus_id: '',\r\n  });\r\n\r\n  const [createDriverForm, setCreateDriverForm] = useState({\r\n    email: '',\r\n    first_name: '',\r\n    last_name: '',\r\n    phone: '',\r\n    password: '',\r\n    confirm_password: '',\r\n  });\r\n\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\r\n\r\n  const [selectedSupabaseDriver, setSelectedSupabaseDriver] =\r\n    useState<string>('');\r\n\r\n  const [routeForm, setRouteForm] = useState({\r\n    name: '',\r\n    description: '',\r\n    distance_km: '',\r\n    estimated_duration_minutes: '',\r\n    is_active: true,\r\n    city: '',\r\n  });\r\n\r\n  const [showMapSelector, setShowMapSelector] = useState(false);\r\n  const [mapSelectorType, setMapSelectorType] = useState<\r\n    'destination' | 'origin'\r\n  >('destination');\r\n  const [selectedDestination, setSelectedDestination] = useState<{\r\n    name: string;\r\n    coordinates: [number, number];\r\n    address?: string;\r\n  } | null>(null);\r\n  const [selectedOrigin, setSelectedOrigin] = useState<{\r\n    name: string;\r\n    coordinates: [number, number];\r\n    address?: string;\r\n  } | null>(null);\r\n\r\n  const loadAllData = useCallback(async () => {\r\n    // console.log('🔄 Starting to load all data...');\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // Load core data first\r\n      const [busesResult, driversResult, routesResult] = await Promise.all([\r\n        adminApiService.getAllBuses(),\r\n        adminApiService.getAllDrivers(),\r\n        adminApiService.getAllRoutes(),\r\n      ]);\r\n\r\n      if (busesResult.success && busesResult.data) setBuses(busesResult.data);\r\n      if (driversResult.success && driversResult.data) {\r\n        // Additional frontend deduplication as safety measure\r\n        const uniqueDriversMap = new Map();\r\n        driversResult.data.forEach((driver: Driver) => {\r\n          const idKey = driver.id;\r\n\r\n          if (!uniqueDriversMap.has(idKey)) {\r\n            // First time seeing this ID\r\n            uniqueDriversMap.set(idKey, driver);\r\n          } else {\r\n            // We already have this ID, check if we should replace it\r\n            const existing = uniqueDriversMap.get(idKey);\r\n\r\n            // Prefer the entry with email over null email\r\n            if (!existing.email && driver.email) {\r\n              uniqueDriversMap.set(idKey, driver);\r\n            }\r\n            // If both have emails, prefer the one with more complete data\r\n            else if (existing.email && driver.email) {\r\n              // Keep the existing one unless the new one has more complete data\r\n              if (!existing.first_name && driver.first_name) {\r\n                uniqueDriversMap.set(idKey, driver);\r\n              }\r\n            }\r\n          }\r\n        });\r\n        const uniqueDrivers = Array.from(uniqueDriversMap.values());\r\n        setDrivers(uniqueDrivers);\r\n      }\r\n      if (routesResult.success && routesResult.data) {\r\n        // console.log('🔍 Routes loaded:', routesResult.data);\r\n        // console.log(\r\n        //   '🔍 Routes with city info:',\r\n        //   routesResult.data.map((route) => ({\r\n        //     id: route.id,\r\n        //     name: route.name,\r\n        //     city: route.city,\r\n        //     cityType: typeof route.city,\r\n        //   }))\r\n        // );\r\n        setRoutes(routesResult.data);\r\n      }\r\n\r\n      // console.log('✅ Core data loaded successfully');\r\n\r\n      // Backend API already loaded drivers above, no need for separate Supabase loading\r\n      // console.log('✅ Using backend API drivers data');\r\n\r\n      // Load assigned drivers\r\n      await loadAssignedDrivers();\r\n\r\n      if (\r\n        !busesResult.success ||\r\n        !driversResult.success ||\r\n        !routesResult.success\r\n      ) {\r\n        setError('Failed to load some data');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while loading data');\r\n      console.error('❌ Data loading error:', err);\r\n    } finally {\r\n      // console.log('🏁 Finished loading data');\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    loadAllData();\r\n  }, [loadAllData]);\r\n\r\n  const loadAssignedDrivers = async () => {\r\n    try {\r\n      const result = await adminApiService.getAssignedDrivers();\r\n      if (result.success && result.data) {\r\n        // Additional frontend deduplication as safety measure\r\n        const uniqueAssignedDriversMap = new Map();\r\n        result.data.forEach((driver: AssignedDriver) => {\r\n          const idKey = driver.driver_id;\r\n\r\n          if (!uniqueAssignedDriversMap.has(idKey)) {\r\n            // First time seeing this ID\r\n            uniqueAssignedDriversMap.set(idKey, driver);\r\n          } else {\r\n            // We already have this ID, check if we should replace it\r\n            const existing = uniqueAssignedDriversMap.get(idKey);\r\n\r\n            // Prefer the entry with email over null email\r\n            if (!existing.driver_email && driver.driver_email) {\r\n              uniqueAssignedDriversMap.set(idKey, driver);\r\n            }\r\n            // If both have emails, prefer the one with more complete data\r\n            else if (existing.driver_email && driver.driver_email) {\r\n              // Keep the existing one unless the new one has more complete data\r\n              if (!existing.driver_name && driver.driver_name) {\r\n                uniqueAssignedDriversMap.set(idKey, driver);\r\n              }\r\n            }\r\n          }\r\n        });\r\n        const uniqueAssignedDrivers = Array.from(\r\n          uniqueAssignedDriversMap.values()\r\n        );\r\n        setAssignedDrivers(uniqueAssignedDrivers);\r\n        // console.log('✅ Assigned drivers loaded:', uniqueAssignedDrivers.length);\r\n      } else {\r\n        console.warn('⚠️ Failed to load assigned drivers:', result.error);\r\n        setAssignedDrivers([]);\r\n      }\r\n    } catch (error) {\r\n      console.warn('⚠️ Failed to load assigned drivers:', error);\r\n      setAssignedDrivers([]);\r\n    }\r\n  };\r\n\r\n  // Bus Management Functions\r\n  const handleCreateBus = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    // Check for duplicates before submitting\r\n    const existingBus = buses.find(\r\n      (bus) =>\r\n        bus.code === busForm.code || bus.number_plate === busForm.number_plate\r\n    );\r\n\r\n    if (existingBus) {\r\n      setError(\r\n        `Bus with code '${busForm.code}' or number plate '${busForm.number_plate}' already exists`\r\n      );\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const result = await adminApiService.createBus(busForm);\r\n      if (result.success && result.data) {\r\n        setBuses([...buses, result.data]);\r\n        setBusForm({\r\n          code: '',\r\n          number_plate: '',\r\n          capacity: 50,\r\n          model: '',\r\n          year: new Date().getFullYear(),\r\n          is_active: true,\r\n        });\r\n        setShowBusForm(false);\r\n        setSuccessMessage('Bus created successfully!');\r\n        setTimeout(() => setSuccessMessage(null), 3000);\r\n      } else {\r\n        setError(result.error || 'Failed to create bus');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while creating bus');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteBus = async (busId: string) => {\r\n    if (!confirm('Are you sure you want to delete this bus?')) return;\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const result = await adminApiService.deleteBus(busId);\r\n      if (result.success) {\r\n        setBuses(buses.filter((bus) => bus.id !== busId));\r\n        setSuccessMessage('Bus deleted successfully!');\r\n        setTimeout(() => setSuccessMessage(null), 3000);\r\n      } else {\r\n        setError(result.error || 'Failed to delete bus');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while deleting bus');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleAssignRouteToBus = async (busId: string, routeId: string) => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const result = await adminApiService.updateBus(busId, {\r\n        route_id: routeId,\r\n      });\r\n      if (result.success && result.data) {\r\n        setBuses(\r\n          buses.map((bus) =>\r\n            bus.id === busId ? { ...bus, route_id: routeId } : bus\r\n          )\r\n        );\r\n        setSuccessMessage('Route assigned to bus successfully!');\r\n        setTimeout(() => setSuccessMessage(null), 3000);\r\n      } else {\r\n        setError(result.error || 'Failed to assign route to bus');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while assigning route to bus');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Driver Management Functions\r\n\r\n  const handleCreateDriver = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    // Enhanced validation\r\n    if (\r\n      !createDriverForm.email ||\r\n      !createDriverForm.first_name ||\r\n      !createDriverForm.last_name ||\r\n      !createDriverForm.password\r\n    ) {\r\n      setError(\r\n        'All fields are required: Email, First Name, Last Name, and Password'\r\n      );\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // Validate email format\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(createDriverForm.email)) {\r\n      setError('Please enter a valid email address');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // Validate password\r\n    if (createDriverForm.password !== createDriverForm.confirm_password) {\r\n      setError('Passwords do not match');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (createDriverForm.password.length < 6) {\r\n      setError('Password must be at least 6 characters long');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // Check if email already exists in current drivers list\r\n    const existingDriver = drivers.find(\r\n      (driver) => driver.email === createDriverForm.email\r\n    );\r\n\r\n    if (existingDriver) {\r\n      setError('Driver with this email already exists');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // Prevent duplicate submissions\r\n    if (loading) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const driverData = {\r\n        email: createDriverForm.email,\r\n        first_name: createDriverForm.first_name,\r\n        last_name: createDriverForm.last_name,\r\n        phone: createDriverForm.phone,\r\n        role: 'driver',\r\n        password: createDriverForm.password,\r\n      };\r\n\r\n      const result = await adminApiService.createDriver(driverData);\r\n\r\n      if (result.success && result.data) {\r\n        // Refresh the entire driver list to get the latest data\r\n        const driversResult = await adminApiService.getAllDrivers();\r\n        if (driversResult.success && driversResult.data) {\r\n          // Additional frontend deduplication as safety measure\r\n          const uniqueDriversMap = new Map();\r\n          driversResult.data.forEach((driver: Driver) => {\r\n            const idKey = driver.id;\r\n\r\n            if (!uniqueDriversMap.has(idKey)) {\r\n              // First time seeing this ID\r\n              uniqueDriversMap.set(idKey, driver);\r\n            } else {\r\n              // We already have this ID, check if we should replace it\r\n              const existing = uniqueDriversMap.get(idKey);\r\n\r\n              // Prefer the entry with email over null email\r\n              if (!existing.email && driver.email) {\r\n                uniqueDriversMap.set(idKey, driver);\r\n              }\r\n              // If both have emails, prefer the one with more complete data\r\n              else if (existing.email && driver.email) {\r\n                // Keep the existing one unless the new one has more complete data\r\n                if (!existing.first_name && driver.first_name) {\r\n                  uniqueDriversMap.set(idKey, driver);\r\n                }\r\n              }\r\n            }\r\n          });\r\n          const uniqueDrivers = Array.from(uniqueDriversMap.values());\r\n          setDrivers(uniqueDrivers);\r\n        }\r\n\r\n        // Reset form\r\n        setCreateDriverForm({\r\n          email: '',\r\n          first_name: '',\r\n          last_name: '',\r\n          phone: '',\r\n          password: '',\r\n          confirm_password: '',\r\n        });\r\n        setShowPassword(false);\r\n        setShowConfirmPassword(false);\r\n        setShowCreateDriverForm(false);\r\n\r\n        setSuccessMessage(\r\n          `Driver ${result.data.first_name} ${result.data.last_name} created successfully! They can now login with their credentials.`\r\n        );\r\n        setTimeout(() => setSuccessMessage(null), 5000);\r\n      } else {\r\n        setError(result.error || 'Failed to create driver');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while creating driver');\r\n      console.error('❌ Error creating driver:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleAssignBusToDriver = async (driverId: string, busId: string) => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const result = await adminApiService.assignDriverToBus(driverId, busId);\r\n      if (result.success && result.data) {\r\n        // Reload all data to get the updated state from the server\r\n        await loadAllData();\r\n        setSuccessMessage('Bus assigned to driver successfully!');\r\n        setTimeout(() => setSuccessMessage(null), 3000);\r\n      } else {\r\n        setError(result.error || 'Failed to assign bus to driver');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while assigning bus to driver');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleUnassignDriver = async (driverId: string) => {\r\n    if (!confirm('Are you sure you want to unassign this driver?')) return;\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const result = await adminApiService.unassignDriverFromBus(driverId);\r\n      if (result.success) {\r\n        // Reload all data to get the updated state from the server\r\n        await loadAllData();\r\n        setSuccessMessage('Driver unassigned successfully!');\r\n        setTimeout(() => setSuccessMessage(null), 3000);\r\n      } else {\r\n        setError(result.error || 'Failed to unassign driver');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while unassigning driver');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteDriver = async (\r\n    driverId: string,\r\n    firstName: string,\r\n    lastName: string\r\n  ) => {\r\n    const driverName = `${firstName} ${lastName}`;\r\n    const confirmMessage = `Are you sure you want to delete driver \"${driverName}\"?\\n\\nThis action will:\\n• Remove the driver from all database tables\\n• Delete their Supabase Auth account\\n• Unassign them from any buses\\n• This action cannot be undone!`;\r\n\r\n    if (!confirm(confirmMessage)) return;\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const result = await adminApiService.deleteDriver(driverId);\r\n      if (result.success && result.data) {\r\n        // Remove driver from local state\r\n        setDrivers(drivers.filter((driver) => driver.id !== driverId));\r\n        setAssignedDrivers(\r\n          assignedDrivers.filter((assigned) => assigned.driver_id !== driverId)\r\n        );\r\n\r\n        setSuccessMessage(\r\n          `Driver \"${driverName}\" deleted successfully from all systems!`\r\n        );\r\n        setTimeout(() => setSuccessMessage(null), 5000);\r\n      } else {\r\n        setError(result.error || `Failed to delete driver \"${driverName}\"`);\r\n      }\r\n    } catch (err) {\r\n      setError(`An error occurred while deleting driver \"${driverName}\"`);\r\n      console.error('❌ Error deleting driver:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Route Management Functions\r\n  const handleCreateRoute = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    // Validate required fields\r\n    if (!routeForm.name.trim()) {\r\n      setError('Route name is required');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    if (!routeForm.city.trim()) {\r\n      setError('City is required');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    if (!routeForm.description.trim()) {\r\n      setError('Route description is required');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const routeData = {\r\n        ...routeForm,\r\n        distance_km: parseFloat(routeForm.distance_km) || 0,\r\n        estimated_duration_minutes:\r\n          parseInt(routeForm.estimated_duration_minutes) || 0,\r\n        custom_destination: selectedDestination?.name,\r\n        custom_destination_coordinates: selectedDestination?.coordinates,\r\n        custom_origin: selectedOrigin?.name,\r\n        custom_origin_coordinates: selectedOrigin?.coordinates,\r\n        bus_stops: [],\r\n      };\r\n\r\n      const result = await adminApiService.createRoute(routeData);\r\n      if (result.success && result.data) {\r\n        setRoutes([...routes, result.data]);\r\n        setRouteForm({\r\n          name: '',\r\n          description: '',\r\n          distance_km: '',\r\n          estimated_duration_minutes: '',\r\n          is_active: true,\r\n          city: '',\r\n        });\r\n        setSelectedDestination(null);\r\n        setSelectedOrigin(null);\r\n        setShowRouteForm(false);\r\n        setSuccessMessage('Route created successfully!');\r\n        setTimeout(() => setSuccessMessage(null), 3000);\r\n      } else {\r\n        setError(result.error || 'Failed to create route');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while creating route');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteRoute = async (routeId: string) => {\r\n    if (!confirm('Are you sure you want to delete this route?')) return;\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const result = await adminApiService.deleteRoute(routeId);\r\n      if (result.success) {\r\n        setRoutes(routes.filter((route) => route.id !== routeId));\r\n        setSuccessMessage('Route deleted successfully!');\r\n        setTimeout(() => setSuccessMessage(null), 3000);\r\n      } else {\r\n        setError(result.error || 'Failed to delete route');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while deleting route');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getRouteName = (routeId?: string) => {\r\n    if (!routeId) return 'Not Assigned';\r\n    const route = routes.find((r) => r.id === routeId);\r\n    if (!route) return 'Unknown Route';\r\n\r\n    // Format: City → Destination\r\n    const city = route.city || 'Unknown City';\r\n    const destination = route.destination || 'Ganpat University';\r\n    return `${city} → ${destination}`;\r\n  };\r\n\r\n  const handleMapSelectorOpen = (type: 'destination' | 'origin') => {\r\n    setMapSelectorType(type);\r\n    setShowMapSelector(true);\r\n  };\r\n\r\n  const handleLocationSelect = (location: {\r\n    name: string;\r\n    coordinates: [number, number];\r\n    address?: string;\r\n  }) => {\r\n    if (mapSelectorType === 'destination') {\r\n      setSelectedDestination(location);\r\n    } else {\r\n      setSelectedOrigin(location);\r\n    }\r\n  };\r\n\r\n  const getDriverName = (driverId?: string) => {\r\n    if (!driverId) return 'Not Assigned';\r\n    const driver = drivers.find((d) => d.id === driverId);\r\n    return driver\r\n      ? `${driver.first_name} ${driver.last_name}`\r\n      : 'Unknown Driver';\r\n  };\r\n\r\n  const getDriverNameFromBus = (bus: Bus) => {\r\n    // console.log('🔍 Getting driver name for bus:', {\r\n    //   driver_full_name: bus.driver_full_name,\r\n    //   driver_first_name: bus.driver_first_name,\r\n    //   driver_last_name: bus.driver_last_name,\r\n    //   assigned_driver_id: bus.assigned_driver_id,\r\n    // });\r\n\r\n    if (bus.driver_full_name) {\r\n      return bus.driver_full_name;\r\n    }\r\n    if (bus.driver_first_name && bus.driver_last_name) {\r\n      return `${bus.driver_first_name} ${bus.driver_last_name}`;\r\n    }\r\n    if (bus.assigned_driver_id) {\r\n      return getDriverName(bus.assigned_driver_id);\r\n    }\r\n    return 'Not Assigned';\r\n  };\r\n\r\n  const getBusPlate = (busId?: string) => {\r\n    if (!busId) return 'Not Assigned';\r\n    const bus = buses.find((b) => b.id === busId);\r\n    return bus ? bus.number_plate : 'Unknown Bus';\r\n  };\r\n\r\n  // Modal and Edit Handlers\r\n  const handleViewBusDetails = (bus: Bus) => {\r\n    // console.log('🔍 Bus details for modal:', bus);\r\n    setSelectedBus(bus);\r\n    setEditingBus(false);\r\n    setShowBusDetails(true);\r\n  };\r\n\r\n  const handleEditBus = (bus: Bus) => {\r\n    setSelectedBus(bus);\r\n    setBusForm({\r\n      code: bus.code,\r\n      number_plate: bus.number_plate,\r\n      capacity: bus.capacity,\r\n      model: bus.model || '',\r\n      year: bus.year || new Date().getFullYear(),\r\n      is_active: bus.is_active,\r\n    });\r\n    setEditingBus(true);\r\n    setShowBusDetails(true);\r\n  };\r\n\r\n  const handleViewRouteDetails = (route: Route) => {\r\n    setSelectedRoute(route);\r\n    setEditingRoute(false);\r\n    setShowRouteDetails(true);\r\n  };\r\n\r\n  const handleEditRoute = (route: Route) => {\r\n    setSelectedRoute(route);\r\n    setRouteForm({\r\n      name: route.name,\r\n      description: route.description,\r\n      distance_km: route.distance_km.toString(),\r\n      estimated_duration_minutes: route.estimated_duration_minutes.toString(),\r\n      is_active: route.is_active,\r\n      city: route.city || '',\r\n    });\r\n    setEditingRoute(true);\r\n    setShowRouteDetails(true);\r\n  };\r\n\r\n  const handleUpdateBus = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!selectedBus?.id) return;\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const result = await adminApiService.updateBus(selectedBus.id, busForm);\r\n      if (result.success && result.data) {\r\n        setBuses(\r\n          buses.map((bus) => (bus.id === selectedBus.id ? result.data! : bus))\r\n        );\r\n        setShowBusDetails(false);\r\n        setEditingBus(false);\r\n        setSelectedBus(null);\r\n        setSuccessMessage('Bus updated successfully!');\r\n        setTimeout(() => setSuccessMessage(null), 3000);\r\n      } else {\r\n        setError(result.error || 'Failed to update bus');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while updating bus');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleUpdateRoute = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!selectedRoute?.id) return;\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const routeData = {\r\n        ...routeForm,\r\n        distance_km: parseFloat(routeForm.distance_km) || 0,\r\n        estimated_duration_minutes:\r\n          parseInt(routeForm.estimated_duration_minutes) || 0,\r\n      };\r\n\r\n      const result = await adminApiService.updateRoute(\r\n        selectedRoute.id,\r\n        routeData\r\n      );\r\n      if (result.success && result.data) {\r\n        setRoutes(\r\n          routes.map((route) =>\r\n            route.id === selectedRoute.id ? result.data! : route\r\n          )\r\n        );\r\n        setShowRouteDetails(false);\r\n        setEditingRoute(false);\r\n        setSelectedRoute(null);\r\n        setSuccessMessage('Route updated successfully!');\r\n        setTimeout(() => setSuccessMessage(null), 3000);\r\n      } else {\r\n        setError(result.error || 'Failed to update route');\r\n      }\r\n    } catch (err) {\r\n      setError('An error occurred while updating route');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-8\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600\"></div>\r\n        <span className=\"ml-2 text-gray-600\">Loading management data...</span>\r\n        <p className=\"text-sm text-gray-500 mt-2\">\r\n          This may take a few moments\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow rounded-lg p-6\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div>\r\n            <h2 className=\"text-2xl font-bold text-gray-900\">\r\n              🚍 Streamlined System Management\r\n            </h2>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n              Manage buses, drivers, and routes in one unified interface\r\n            </p>\r\n          </div>\r\n          <button\r\n            onClick={loadAllData}\r\n            className=\"bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 transition-colors\"\r\n          >\r\n            🔄 Refresh Data\r\n          </button>\r\n        </div>\r\n\r\n        {/* Success/Error Messages */}\r\n        {successMessage && (\r\n          <div className=\"mb-4 p-4 bg-green-50 border border-green-200 rounded-md\">\r\n            <p className=\"text-green-800\">{successMessage}</p>\r\n          </div>\r\n        )}\r\n\r\n        {error && (\r\n          <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-md\">\r\n            <p className=\"text-red-800\">{error}</p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Tab Navigation */}\r\n        <div className=\"border-b border-gray-200\">\r\n          <nav className=\"-mb-px flex space-x-8\">\r\n            <button\r\n              onClick={() => setActiveTab('buses')}\r\n              className={`py-2 px-1 border-b-2 font-medium text-sm ${\r\n                activeTab === 'buses'\r\n                  ? 'border-purple-500 text-purple-600'\r\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n              }`}\r\n            >\r\n              🚌 Buses ({buses.length})\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab('drivers')}\r\n              className={`py-2 px-1 border-b-2 font-medium text-sm ${\r\n                activeTab === 'drivers'\r\n                  ? 'border-purple-500 text-purple-600'\r\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n              }`}\r\n            >\r\n              👨‍💼 Drivers ({drivers.length})\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveTab('routes')}\r\n              className={`py-2 px-1 border-b-2 font-medium text-sm ${\r\n                activeTab === 'routes'\r\n                  ? 'border-purple-500 text-purple-600'\r\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n              }`}\r\n            >\r\n              🗺️ Routes ({routes.length})\r\n            </button>\r\n          </nav>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Bus Management Tab */}\r\n      {activeTab === 'buses' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-white shadow rounded-lg p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-lg font-medium text-gray-900\">\r\n                Bus Management\r\n              </h3>\r\n              <div className=\"flex space-x-2\">\r\n                {/* {selectedBuses.size > 0 && (\r\n                  <button\r\n                    onClick={handleBulkDeleteBuses}\r\n                    disabled={loading}\r\n                    className=\"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors disabled:opacity-50\"\r\n                  >\r\n                    🗑️ Delete Selected ({selectedBuses.size})\r\n                  </button>\r\n                )} */}\r\n                <button\r\n                  onClick={() => setShowBusForm(!showBusForm)}\r\n                  className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors\"\r\n                >\r\n                  {showBusForm ? '❌ Cancel' : '➕ Add New Bus'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {showBusForm && (\r\n              <form\r\n                onSubmit={handleCreateBus}\r\n                className=\"mb-6 p-4 bg-gray-50 rounded-lg\"\r\n              >\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Bus Code *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={busForm.code}\r\n                      onChange={(e) =>\r\n                        setBusForm({ ...busForm, code: e.target.value })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      placeholder=\"e.g., BUS-2024-001\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Number Plate *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={busForm.number_plate}\r\n                      onChange={(e) =>\r\n                        setBusForm({ ...busForm, number_plate: e.target.value })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      placeholder=\"e.g., GJ-01-AB-1234\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Capacity *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      required\r\n                      value={busForm.capacity}\r\n                      onChange={(e) =>\r\n                        setBusForm({\r\n                          ...busForm,\r\n                          capacity: parseInt(e.target.value),\r\n                        })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      min=\"1\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Model\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={busForm.model}\r\n                      onChange={(e) =>\r\n                        setBusForm({ ...busForm, model: e.target.value })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      placeholder=\"e.g., Mercedes-Benz\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Year\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={busForm.year}\r\n                      onChange={(e) =>\r\n                        setBusForm({\r\n                          ...busForm,\r\n                          year: parseInt(e.target.value),\r\n                        })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      min=\"2000\"\r\n                      max={new Date().getFullYear() + 1}\r\n                    />\r\n                  </div>\r\n                  <div className=\"flex items-center\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={busForm.is_active}\r\n                      onChange={(e) =>\r\n                        setBusForm({ ...busForm, is_active: e.target.checked })\r\n                      }\r\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                    />\r\n                    <label className=\"ml-2 text-sm text-gray-700\">Active</label>\r\n                  </div>\r\n                </div>\r\n                <div className=\"mt-4 flex justify-end\">\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    className=\"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50\"\r\n                  >\r\n                    {loading ? 'Creating...' : 'Create Bus'}\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            )}\r\n\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"min-w-full divide-y divide-gray-200\">\r\n                <thead className=\"bg-gray-50\">\r\n                  <tr>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      {/* <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedBuses.size === buses.length && buses.length > 0}\r\n                        onChange={() => handleSelectAll('buses')}\r\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                      /> */}\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Bus Details\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Assigned Driver\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Assigned Route\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      City\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Status\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Actions\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                  {buses.map((bus) => (\r\n                    <tr key={bus.id} className=\"hover:bg-gray-50\">\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        {/* <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedBuses.has(bus.id!)}\r\n                          onChange={() => handleSelectItem('buses', bus.id!)}\r\n                          className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                        /> */}\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div>\r\n                          <div className=\"text-sm font-medium text-gray-900\">\r\n                            {bus.number_plate}\r\n                          </div>\r\n                          <div className=\"text-sm text-gray-900\">\r\n                            Capacity: {bus.capacity} | {bus.model} ({bus.year})\r\n                          </div>\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm text-gray-900\">\r\n                          {getDriverNameFromBus(bus)}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm text-gray-900\">\r\n                          {bus.route_name || getRouteName(bus.route_id)}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm text-gray-900\">\r\n                          {bus.route_id\r\n                            ? (() => {\r\n                                const route = routes.find(\r\n                                  (r) => r.id === bus.route_id\r\n                                );\r\n                                return route?.city || 'Not specified';\r\n                              })()\r\n                            : 'No route assigned'}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <span\r\n                          className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\r\n                            bus.is_active\r\n                              ? 'bg-green-100 text-green-800'\r\n                              : 'bg-red-100 text-red-800'\r\n                          }`}\r\n                        >\r\n                          {bus.is_active ? 'Active' : 'Inactive'}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\r\n                        <div className=\"flex flex-col space-y-2\">\r\n                          <div className=\"flex space-x-2\">\r\n                            <button\r\n                              onClick={() => handleViewBusDetails(bus)}\r\n                              className=\"text-blue-600 hover:text-blue-900\"\r\n                              title=\"View details\"\r\n                            >\r\n                              👁️ Details\r\n                            </button>\r\n                            <button\r\n                              onClick={() => handleEditBus(bus)}\r\n                              className=\"text-green-600 hover:text-green-900\"\r\n                              title=\"Edit bus\"\r\n                            >\r\n                              ✏️ Edit\r\n                            </button>\r\n                            <button\r\n                              onClick={() => handleDeleteBus(bus.id!)}\r\n                              className=\"text-red-600 hover:text-red-900\"\r\n                              title=\"Delete bus\"\r\n                            >\r\n                              🗑️ Delete\r\n                            </button>\r\n                          </div>\r\n                          <select\r\n                            onChange={(e) =>\r\n                              handleAssignRouteToBus(bus.id!, e.target.value)\r\n                            }\r\n                            value={bus.route_id || ''}\r\n                            className=\"text-sm border border-gray-300 rounded px-2 py-1 text-gray-900 bg-white\"\r\n                          >\r\n                            <option value=\"\" className=\"text-gray-900\">\r\n                              Select Route\r\n                            </option>\r\n                            {routes.map((route) => (\r\n                              <option\r\n                                key={route.id}\r\n                                value={route.id}\r\n                                className=\"text-gray-900\"\r\n                              >\r\n                                {route.name}\r\n                              </option>\r\n                            ))}\r\n                          </select>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Driver Management Tab */}\r\n      {activeTab === 'drivers' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-white shadow rounded-lg p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-lg font-medium text-gray-900\">\r\n                Driver & Bus Assignment Management\r\n              </h3>\r\n              <div className=\"flex space-x-2\">\r\n                <button\r\n                  onClick={() => setShowCreateDriverForm(!showCreateDriverForm)}\r\n                  className=\"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors\"\r\n                >\r\n                  {showCreateDriverForm ? '❌ Cancel' : '➕ Create New Driver'}\r\n                </button>\r\n                <button\r\n                  onClick={() => setShowDriverForm(!showDriverForm)}\r\n                  className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors\"\r\n                >\r\n                  {showDriverForm ? '❌ Cancel' : '🚗 Assign Driver to Bus'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {showDriverForm && (\r\n              <div className=\"mb-6 p-4 bg-gray-50 rounded-lg\">\r\n                <div className=\"mb-4\">\r\n                  <h4 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                    Assign Bus to Driver\r\n                  </h4>\r\n                  <p className=\"text-sm text-gray-600 mb-4\">\r\n                    Select a driver from Supabase authentication and assign them\r\n                    to a bus.\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Select Driver *\r\n                    </label>\r\n                    <select\r\n                      required\r\n                      value={selectedSupabaseDriver}\r\n                      onChange={(e) =>\r\n                        setSelectedSupabaseDriver(e.target.value)\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white\"\r\n                    >\r\n                      <option value=\"\" className=\"text-gray-900\">\r\n                        Choose a driver...\r\n                      </option>\r\n                      {drivers.map((driver) => (\r\n                        <option\r\n                          key={driver.id}\r\n                          value={driver.id}\r\n                          className=\"text-gray-900\"\r\n                        >\r\n                          {driver.first_name} {driver.last_name} ({driver.email}\r\n                          )\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                    {drivers.length === 0 && (\r\n                      <p className=\"text-sm text-orange-600 mt-1\">\r\n                        No drivers found. Please create driver accounts first.\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Select Bus *\r\n                    </label>\r\n                    <select\r\n                      required\r\n                      value={driverForm.assigned_bus_id || ''}\r\n                      onChange={(e) =>\r\n                        setDriverForm({\r\n                          ...driverForm,\r\n                          assigned_bus_id: e.target.value || '',\r\n                        })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white\"\r\n                    >\r\n                      <option value=\"\" className=\"text-gray-900\">\r\n                        Choose a bus...\r\n                      </option>\r\n                      {buses.map((bus) => (\r\n                        <option\r\n                          key={bus.id}\r\n                          value={bus.id}\r\n                          className=\"text-gray-900\"\r\n                        >\r\n                          {bus.number_plate} ({bus.model || 'Unknown Model'})\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"mt-4 flex justify-end space-x-2\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => {\r\n                      setShowDriverForm(false);\r\n                      setSelectedSupabaseDriver('');\r\n                      setDriverForm({ ...driverForm, assigned_bus_id: '' });\r\n                    }}\r\n                    className=\"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700\"\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    onClick={() =>\r\n                      handleAssignBusToDriver(\r\n                        selectedSupabaseDriver,\r\n                        driverForm.assigned_bus_id\r\n                      )\r\n                    }\r\n                    disabled={\r\n                      loading ||\r\n                      !selectedSupabaseDriver ||\r\n                      !driverForm.assigned_bus_id\r\n                    }\r\n                    className=\"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50\"\r\n                  >\r\n                    {loading ? 'Assigning...' : 'Assign Driver to Bus'}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Create New Driver Form */}\r\n            {showCreateDriverForm && (\r\n              <div className=\"mb-6 p-4 bg-green-50 rounded-lg border border-green-200\">\r\n                <div className=\"mb-4\">\r\n                  <h4 className=\"text-lg font-medium text-green-900 mb-2\">\r\n                    🆕 Create New Driver Account\r\n                  </h4>\r\n                  <p className=\"text-sm text-green-700 mb-4\">\r\n                    Create a new driver account with Supabase authentication.\r\n                    The driver will receive login credentials and can\r\n                    immediately access the driver interface.\r\n                  </p>\r\n                </div>\r\n\r\n                <form onSubmit={handleCreateDriver} className=\"space-y-4\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                        Email Address *\r\n                      </label>\r\n                      <input\r\n                        type=\"email\"\r\n                        required\r\n                        value={createDriverForm.email}\r\n                        onChange={(e) =>\r\n                          setCreateDriverForm({\r\n                            ...createDriverForm,\r\n                            email: e.target.value,\r\n                          })\r\n                        }\r\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-gray-900 bg-white\"\r\n                        placeholder=\"driver@university.com\"\r\n                      />\r\n                    </div>\r\n\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                        First Name *\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        required\r\n                        value={createDriverForm.first_name}\r\n                        onChange={(e) =>\r\n                          setCreateDriverForm({\r\n                            ...createDriverForm,\r\n                            first_name: e.target.value,\r\n                          })\r\n                        }\r\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500\"\r\n                        placeholder=\"John\"\r\n                      />\r\n                    </div>\r\n\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                        Last Name *\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        required\r\n                        value={createDriverForm.last_name}\r\n                        onChange={(e) =>\r\n                          setCreateDriverForm({\r\n                            ...createDriverForm,\r\n                            last_name: e.target.value,\r\n                          })\r\n                        }\r\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500\"\r\n                        placeholder=\"Smith\"\r\n                      />\r\n                    </div>\r\n\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                        Phone Number\r\n                      </label>\r\n                      <input\r\n                        type=\"tel\"\r\n                        value={createDriverForm.phone}\r\n                        onChange={(e) =>\r\n                          setCreateDriverForm({\r\n                            ...createDriverForm,\r\n                            phone: e.target.value,\r\n                          })\r\n                        }\r\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 text-gray-900 bg-white\"\r\n                        placeholder=\"+91-9876543210\"\r\n                      />\r\n                    </div>\r\n\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                        Password *\r\n                      </label>\r\n                      <div className=\"relative\">\r\n                        <input\r\n                          type={showPassword ? 'text' : 'password'}\r\n                          required\r\n                          value={createDriverForm.password}\r\n                          onChange={(e) => {\r\n                            console.log(\r\n                              'Password input changed:',\r\n                              e.target.value\r\n                            );\r\n                            setCreateDriverForm({\r\n                              ...createDriverForm,\r\n                              password: e.target.value,\r\n                            });\r\n                          }}\r\n                          onFocus={(e) => {\r\n                            console.log('Password field focused');\r\n                            e.target.select();\r\n                          }}\r\n                          className=\"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 text-gray-900 bg-white\"\r\n                          placeholder=\"Minimum 6 characters\"\r\n                          minLength={6}\r\n                          autoComplete=\"new-password\"\r\n                          id=\"driver-password-input\"\r\n                        />\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => setShowPassword(!showPassword)}\r\n                          className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600\"\r\n                        >\r\n                          {showPassword ? '🙈' : '👁️'}\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500 mt-1\">\r\n                        Current length: {createDriverForm.password.length}/6\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                        Confirm Password *\r\n                      </label>\r\n                      <div className=\"relative\">\r\n                        <input\r\n                          type={showConfirmPassword ? 'text' : 'password'}\r\n                          required\r\n                          value={createDriverForm.confirm_password}\r\n                          onChange={(e) => {\r\n                            console.log(\r\n                              'Confirm password input changed:',\r\n                              e.target.value\r\n                            );\r\n                            setCreateDriverForm({\r\n                              ...createDriverForm,\r\n                              confirm_password: e.target.value,\r\n                            });\r\n                          }}\r\n                          onFocus={(e) => {\r\n                            console.log('Confirm password field focused');\r\n                            e.target.select();\r\n                          }}\r\n                          className=\"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 text-gray-900 bg-white\"\r\n                          placeholder=\"Confirm password\"\r\n                          minLength={6}\r\n                          autoComplete=\"new-password\"\r\n                          id=\"driver-confirm-password-input\"\r\n                        />\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() =>\r\n                            setShowConfirmPassword(!showConfirmPassword)\r\n                          }\r\n                          className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600\"\r\n                        >\r\n                          {showConfirmPassword ? '🙈' : '👁️'}\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500 mt-1\">\r\n                        {createDriverForm.password !==\r\n                          createDriverForm.confirm_password &&\r\n                          createDriverForm.confirm_password.length > 0 && (\r\n                            <span className=\"text-red-500\">\r\n                              Passwords do not match\r\n                            </span>\r\n                          )}\r\n                        {createDriverForm.password ===\r\n                          createDriverForm.confirm_password &&\r\n                          createDriverForm.confirm_password.length > 0 && (\r\n                            <span className=\"text-green-500\">\r\n                              Passwords match ✓\r\n                            </span>\r\n                          )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\r\n                    <h5 className=\"font-medium text-blue-900 mb-2\">\r\n                      ℹ️ Important Information:\r\n                    </h5>\r\n                    <ul className=\"text-sm text-blue-800 space-y-1\">\r\n                      <li>• Driver account will be created in Supabase Auth</li>\r\n                      <li>\r\n                        • Driver can immediately login with these credentials\r\n                      </li>\r\n                      <li>\r\n                        • Email will be auto-confirmed (no email verification\r\n                        required)\r\n                      </li>\r\n                      <li>\r\n                        • Driver will have access to the driver interface at\r\n                        /driver\r\n                      </li>\r\n                      <li>• You can assign them to a bus after creation</li>\r\n                    </ul>\r\n                  </div>\r\n\r\n                  <div className=\"flex justify-end space-x-2\">\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        setShowCreateDriverForm(false);\r\n                        setCreateDriverForm({\r\n                          email: '',\r\n                          first_name: '',\r\n                          last_name: '',\r\n                          phone: '',\r\n                          password: '',\r\n                          confirm_password: '',\r\n                        });\r\n                        setShowPassword(false);\r\n                        setShowConfirmPassword(false);\r\n                      }}\r\n                      className=\"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700\"\r\n                    >\r\n                      Cancel\r\n                    </button>\r\n                    <button\r\n                      type=\"submit\"\r\n                      disabled={loading}\r\n                      className=\"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50\"\r\n                    >\r\n                      {loading ? 'Creating...' : 'Create Driver Account'}\r\n                    </button>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            )}\r\n\r\n            {/* Available Drivers Section */}\r\n            <div className=\"mb-6 p-4 bg-blue-50 rounded-lg\">\r\n              <div className=\"flex items-center justify-between mb-3\">\r\n                <h4 className=\"text-lg font-medium text-blue-900\">\r\n                  🚗 Available Drivers\r\n                </h4>\r\n                <button\r\n                  onClick={async () => {\r\n                    try {\r\n                      // console.log('🔄 Manually refreshing drivers...');\r\n                      const result = await adminApiService.getAllDrivers();\r\n                      if (result.success && result.data) {\r\n                        // Additional frontend deduplication as safety measure\r\n                        const uniqueDriversMap = new Map();\r\n                        result.data.forEach((driver: Driver) => {\r\n                          const idKey = driver.id;\r\n\r\n                          if (!uniqueDriversMap.has(idKey)) {\r\n                            // First time seeing this ID\r\n                            uniqueDriversMap.set(idKey, driver);\r\n                          } else {\r\n                            // We already have this ID, check if we should replace it\r\n                            const existing = uniqueDriversMap.get(idKey);\r\n\r\n                            // Prefer the entry with email over null email\r\n                            if (!existing.email && driver.email) {\r\n                              uniqueDriversMap.set(idKey, driver);\r\n                            }\r\n                            // If both have emails, prefer the one with more complete data\r\n                            else if (existing.email && driver.email) {\r\n                              // Keep the existing one unless the new one has more complete data\r\n                              if (!existing.first_name && driver.first_name) {\r\n                                uniqueDriversMap.set(idKey, driver);\r\n                              }\r\n                            }\r\n                          }\r\n                        });\r\n                        const uniqueDrivers = Array.from(\r\n                          uniqueDriversMap.values()\r\n                        );\r\n                        setDrivers(uniqueDrivers);\r\n                        // console.log(\r\n                        //   '✅ Manual refresh successful:',\r\n                        //   uniqueDrivers.length,\r\n                        //   'drivers'\r\n                        // );\r\n                      } else {\r\n                        console.warn('⚠️ Manual refresh failed:', result.error);\r\n                      }\r\n                    } catch (error) {\r\n                      console.warn('⚠️ Manual refresh failed:', error);\r\n                    }\r\n                  }}\r\n                  className=\"text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded hover:bg-blue-200\"\r\n                >\r\n                  🔄 Refresh\r\n                </button>\r\n              </div>\r\n              {drivers.length > 0 ? (\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3\">\r\n                  {drivers.map((driver) => (\r\n                    <div\r\n                      key={driver.id}\r\n                      className=\"bg-white p-3 rounded border\"\r\n                    >\r\n                      <div className=\"font-medium text-gray-900\">\r\n                        {driver.first_name} {driver.last_name}\r\n                      </div>\r\n                      <div className=\"text-sm text-gray-600\">\r\n                        {driver.email}\r\n                      </div>\r\n                      <div className=\"text-xs text-gray-500 mt-1\">\r\n                        Role: {driver.role}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              ) : (\r\n                <div className=\"text-center py-4\">\r\n                  <p className=\"text-gray-600\">No available drivers found.</p>\r\n                  <p className=\"text-sm text-gray-500 mt-1\">\r\n                    Create new driver accounts using the \"Create New Driver\"\r\n                    button above, or check if drivers exist in the system.\r\n                  </p>\r\n                  <p className=\"text-xs text-green-600 mt-2\">\r\n                    💡 Use the \"Create New Driver\" button to add drivers with\r\n                    full Supabase Auth integration.\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"min-w-full divide-y divide-gray-200\">\r\n                <thead className=\"bg-gray-50\">\r\n                  <tr>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      {/* <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedDrivers.size === drivers.length && drivers.length > 0}\r\n                        onChange={() => handleSelectAll('drivers')}\r\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                      /> */}\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Driver Details\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Contact Info\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Assigned Bus\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Actions\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                  {drivers.map((driver) => (\r\n                    <tr key={driver.id} className=\"hover:bg-gray-50\">\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        {/* <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedDrivers.has(driver.id)}\r\n                          onChange={() => handleSelectItem('drivers', driver.id)}\r\n                          className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                        /> */}\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div>\r\n                          <div className=\"text-sm font-medium text-gray-900\">\r\n                            {driver.first_name} {driver.last_name}\r\n                          </div>\r\n                          <div className=\"text-sm text-gray-900\">\r\n                            Role: {driver.role}\r\n                          </div>\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm text-gray-900\">\r\n                          {driver.email}\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-900\">\r\n                          {driver.phone || 'No phone'}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm text-gray-900\">\r\n                          {getBusPlate(driver.assigned_bus_id)}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2\">\r\n                        <select\r\n                          onChange={(e) =>\r\n                            handleAssignBusToDriver(driver.id, e.target.value)\r\n                          }\r\n                          value={driver.assigned_bus_id || ''}\r\n                          className=\"text-sm border border-gray-300 rounded px-2 py-1 text-gray-900 bg-white\"\r\n                        >\r\n                          <option value=\"\" className=\"text-gray-900\">\r\n                            Select Bus\r\n                          </option>\r\n                          {buses.map((bus) => (\r\n                            <option\r\n                              key={bus.id}\r\n                              value={bus.id}\r\n                              className=\"text-gray-900\"\r\n                            >\r\n                              {bus.number_plate}\r\n                            </option>\r\n                          ))}\r\n                        </select>\r\n                        <button\r\n                          onClick={() =>\r\n                            handleDeleteDriver(\r\n                              driver.id,\r\n                              driver.first_name,\r\n                              driver.last_name\r\n                            )\r\n                          }\r\n                          className=\"ml-2 bg-red-600 text-white px-3 py-1 rounded text-xs hover:bg-red-700 transition-colors\"\r\n                          title=\"Delete driver from all systems\"\r\n                        >\r\n                          🗑️ Delete\r\n                        </button>\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Assigned Drivers Section */}\r\n          <div className=\"bg-white shadow rounded-lg p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-lg font-medium text-gray-900\">\r\n                Currently Assigned Drivers\r\n              </h3>\r\n              <div className=\"text-sm text-gray-900\">\r\n                {assignedDrivers.length} driver\r\n                {assignedDrivers.length !== 1 ? 's' : ''} assigned\r\n              </div>\r\n            </div>\r\n\r\n            {assignedDrivers.length === 0 ? (\r\n              <div className=\"text-center py-8\">\r\n                <div className=\"text-gray-400 text-6xl mb-4\">🚌</div>\r\n                <h4 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n                  No Drivers Assigned\r\n                </h4>\r\n                <p className=\"text-gray-600\">\r\n                  No drivers are currently assigned to buses.\r\n                </p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"min-w-full divide-y divide-gray-200\">\r\n                  <thead className=\"bg-gray-50\">\r\n                    <tr>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Driver\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Assigned Bus\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Route\r\n                      </th>\r\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                        Actions\r\n                      </th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                    {assignedDrivers.map((assignedDriver) => (\r\n                      <tr\r\n                        key={assignedDriver.driver_id}\r\n                        className=\"hover:bg-gray-50\"\r\n                      >\r\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                          <div>\r\n                            <div className=\"text-sm font-medium text-gray-900\">\r\n                              {assignedDriver.driver_name}\r\n                            </div>\r\n                            <div className=\"text-sm text-gray-900\">\r\n                              {assignedDriver.driver_email}\r\n                            </div>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                          <div>\r\n                            <div className=\"text-sm font-medium text-gray-900\">\r\n                              {assignedDriver.bus_code}\r\n                            </div>\r\n                            <div className=\"text-sm text-gray-900\">\r\n                              {assignedDriver.number_plate}\r\n                            </div>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                          <div className=\"text-sm text-gray-900\">\r\n                            {assignedDriver.route_name || 'No route assigned'}\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2\">\r\n                          <button\r\n                            onClick={() =>\r\n                              handleUnassignDriver(assignedDriver.driver_id)\r\n                            }\r\n                            disabled={loading}\r\n                            className=\"text-red-600 hover:text-red-900 disabled:opacity-50\"\r\n                            title=\"Unassign driver from bus\"\r\n                          >\r\n                            🚫 Unassign\r\n                          </button>\r\n                          <button\r\n                            onClick={() => {\r\n                              const driver = drivers.find(\r\n                                (d) => d.id === assignedDriver.driver_id\r\n                              );\r\n                              if (driver) {\r\n                                handleDeleteDriver(\r\n                                  driver.id,\r\n                                  driver.first_name,\r\n                                  driver.last_name\r\n                                );\r\n                              }\r\n                            }}\r\n                            disabled={loading}\r\n                            className=\"text-red-800 hover:text-red-900 disabled:opacity-50 font-bold\"\r\n                            title=\"Delete driver from all systems\"\r\n                          >\r\n                            🗑️ Delete\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Route Management Tab */}\r\n      {activeTab === 'routes' && (\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-white shadow rounded-lg p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-lg font-medium text-gray-900\">\r\n                Route Management\r\n              </h3>\r\n              <div className=\"flex space-x-2\">\r\n                {/* {selectedRoutes.size > 0 && (\r\n                  <button\r\n                    onClick={handleBulkDeleteRoutes}\r\n                    disabled={loading}\r\n                    className=\"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors disabled:opacity-50\"\r\n                  >\r\n                    🗑️ Delete Selected ({selectedRoutes.size})\r\n                  </button>\r\n                )} */}\r\n                <button\r\n                  onClick={() => setShowRouteForm(!showRouteForm)}\r\n                  className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors\"\r\n                >\r\n                  {showRouteForm ? '❌ Cancel' : '➕ Add New Route'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {showRouteForm && (\r\n              <form\r\n                onSubmit={handleCreateRoute}\r\n                className=\"mb-6 p-4 bg-gray-50 rounded-lg\"\r\n              >\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Route Name *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={routeForm.name}\r\n                      onChange={(e) =>\r\n                        setRouteForm({ ...routeForm, name: e.target.value })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      placeholder=\"e.g., Downtown Express\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      City *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={routeForm.city}\r\n                      onChange={(e) =>\r\n                        setRouteForm({ ...routeForm, city: e.target.value })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      placeholder=\"e.g., Ahmedabad\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Distance (km) *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      required\r\n                      step=\"0.1\"\r\n                      value={routeForm.distance_km}\r\n                      onChange={(e) =>\r\n                        setRouteForm({\r\n                          ...routeForm,\r\n                          distance_km: e.target.value,\r\n                        })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      min=\"0\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Duration (minutes) *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      required\r\n                      value={routeForm.estimated_duration_minutes}\r\n                      onChange={(e) =>\r\n                        setRouteForm({\r\n                          ...routeForm,\r\n                          estimated_duration_minutes: e.target.value,\r\n                        })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      min=\"1\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"flex items-center\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={routeForm.is_active}\r\n                      onChange={(e) =>\r\n                        setRouteForm({\r\n                          ...routeForm,\r\n                          is_active: e.target.checked,\r\n                        })\r\n                      }\r\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                    />\r\n                    <label className=\"ml-2 text-sm text-gray-700\">Active</label>\r\n                  </div>\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                    Description\r\n                  </label>\r\n                  <textarea\r\n                    value={routeForm.description}\r\n                    onChange={(e) =>\r\n                      setRouteForm({\r\n                        ...routeForm,\r\n                        description: e.target.value,\r\n                      })\r\n                    }\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white\"\r\n                    rows={3}\r\n                    placeholder=\"Route description...\"\r\n                  />\r\n                </div>\r\n\r\n                {/* Destination and Origin Selection */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      Destination\r\n                    </label>\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"text-sm text-gray-600\">\r\n                        Default: Ganpat University\r\n                      </div>\r\n                      {selectedDestination && (\r\n                        <div className=\"p-2 bg-green-50 border border-green-200 rounded\">\r\n                          <div className=\"font-medium text-green-800\">\r\n                            {selectedDestination.name}\r\n                          </div>\r\n                          <div className=\"text-sm text-green-600\">\r\n                            {selectedDestination.address}\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => handleMapSelectorOpen('destination')}\r\n                        className=\"w-full px-3 py-2 border border-blue-300 text-blue-700 rounded-md hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      >\r\n                        🗺️ Set Custom Destination\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      Origin (Starting Point)\r\n                    </label>\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"text-sm text-gray-600\">\r\n                        Auto: Driver's live location\r\n                      </div>\r\n                      {selectedOrigin && (\r\n                        <div className=\"p-2 bg-blue-50 border border-blue-200 rounded\">\r\n                          <div className=\"font-medium text-blue-800\">\r\n                            {selectedOrigin.name}\r\n                          </div>\r\n                          <div className=\"text-sm text-blue-600\">\r\n                            {selectedOrigin.address}\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => handleMapSelectorOpen('origin')}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500\"\r\n                      >\r\n                        🗺️ Set Custom Origin (Optional)\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"mt-4 flex justify-end\">\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    className=\"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50\"\r\n                  >\r\n                    {loading ? 'Creating...' : 'Create Route'}\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            )}\r\n\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"min-w-full divide-y divide-gray-200\">\r\n                <thead className=\"bg-gray-50\">\r\n                  <tr>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      {/* <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedRoutes.size === routes.length && routes.length > 0}\r\n                        onChange={() => handleSelectAll('routes')}\r\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                      /> */}\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Route Details\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      City\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Distance & Duration\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Status\r\n                    </th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      Actions\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                  {routes.map((route) => (\r\n                    <tr key={route.id} className=\"hover:bg-gray-50\">\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        {/* <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedRoutes.has(route.id)}\r\n                          onChange={() => handleSelectItem('routes', route.id)}\r\n                          className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                        /> */}\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div>\r\n                          <div className=\"text-sm font-medium text-gray-900\">\r\n                            {route.name}\r\n                          </div>\r\n                          <div className=\"text-sm text-gray-900\">\r\n                            {route.description}\r\n                          </div>\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm text-gray-900\">\r\n                          {route.city || 'Not specified'}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm text-gray-900\">\r\n                          {route.distance_km} km\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-900\">\r\n                          {route.estimated_duration_minutes} min\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <span\r\n                          className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\r\n                            route.is_active\r\n                              ? 'bg-green-100 text-green-800'\r\n                              : 'bg-red-100 text-red-800'\r\n                          }`}\r\n                        >\r\n                          {route.is_active ? 'Active' : 'Inactive'}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\r\n                        <div className=\"flex space-x-2\">\r\n                          <button\r\n                            onClick={() => handleViewRouteDetails(route)}\r\n                            className=\"text-blue-600 hover:text-blue-900\"\r\n                            title=\"View details\"\r\n                          >\r\n                            👁️ Details\r\n                          </button>\r\n                          <button\r\n                            onClick={() => handleEditRoute(route)}\r\n                            className=\"text-green-600 hover:text-green-900\"\r\n                            title=\"Edit route\"\r\n                          >\r\n                            ✏️ Edit\r\n                          </button>\r\n                          <button\r\n                            onClick={() => handleDeleteRoute(route.id)}\r\n                            className=\"text-red-600 hover:text-red-900\"\r\n                            title=\"Delete route\"\r\n                          >\r\n                            🗑️ Delete\r\n                          </button>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Map Selector Modal */}\r\n      {showMapSelector && (\r\n        <MapSelector\r\n          key={`map-selector-${mapSelectorType}`} // Add key to prevent re-rendering issues\r\n          onLocationSelect={handleLocationSelect}\r\n          onClose={() => setShowMapSelector(false)}\r\n          title={\r\n            mapSelectorType === 'destination'\r\n              ? 'Select Destination'\r\n              : 'Select Origin'\r\n          }\r\n          searchPlaceholder={\r\n            mapSelectorType === 'destination'\r\n              ? 'Search for destination...'\r\n              : 'Search for origin...'\r\n          }\r\n        />\r\n      )}\r\n\r\n      {/* Bus Details Modal */}\r\n      {showBusDetails && selectedBus && (\r\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\r\n          <div className=\"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-lg font-medium text-gray-900\">\r\n                {editingBus ? 'Edit Bus Details' : 'Bus Details'}\r\n              </h3>\r\n              <button\r\n                onClick={() => {\r\n                  setShowBusDetails(false);\r\n                  setEditingBus(false);\r\n                  setSelectedBus(null);\r\n                }}\r\n                className=\"text-gray-400 hover:text-gray-600\"\r\n              >\r\n                ✕\r\n              </button>\r\n            </div>\r\n\r\n            {editingBus ? (\r\n              <form onSubmit={handleUpdateBus} className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Bus Code *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={busForm.code}\r\n                      onChange={(e) =>\r\n                        setBusForm({ ...busForm, code: e.target.value })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Number Plate *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={busForm.number_plate}\r\n                      onChange={(e) =>\r\n                        setBusForm({ ...busForm, number_plate: e.target.value })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Capacity *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      required\r\n                      value={busForm.capacity}\r\n                      onChange={(e) =>\r\n                        setBusForm({\r\n                          ...busForm,\r\n                          capacity: parseInt(e.target.value),\r\n                        })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      min=\"1\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Model\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={busForm.model}\r\n                      onChange={(e) =>\r\n                        setBusForm({ ...busForm, model: e.target.value })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Year\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={busForm.year}\r\n                      onChange={(e) =>\r\n                        setBusForm({\r\n                          ...busForm,\r\n                          year: parseInt(e.target.value),\r\n                        })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      min=\"2000\"\r\n                      max={new Date().getFullYear() + 1}\r\n                    />\r\n                  </div>\r\n                  <div className=\"flex items-center\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={busForm.is_active}\r\n                      onChange={(e) =>\r\n                        setBusForm({ ...busForm, is_active: e.target.checked })\r\n                      }\r\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                    />\r\n                    <label className=\"ml-2 text-sm text-gray-700\">Active</label>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex justify-end space-x-2 pt-4\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setEditingBus(false)}\r\n                    className=\"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700\"\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    className=\"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50\"\r\n                  >\r\n                    {loading ? 'Updating...' : 'Update Bus'}\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Bus Code\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">{selectedBus.code}</p>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Number Plate\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedBus.number_plate}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Capacity\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedBus.capacity} passengers\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Model\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedBus.model || 'Not specified'}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Year\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedBus.year || 'Not specified'}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Status\r\n                    </h4>\r\n                    <span\r\n                      className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\r\n                        selectedBus.is_active\r\n                          ? 'bg-green-100 text-green-800'\r\n                          : 'bg-red-100 text-red-800'\r\n                      }`}\r\n                    >\r\n                      {selectedBus.is_active ? 'Active' : 'Inactive'}\r\n                    </span>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Assigned Driver\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {getDriverNameFromBus(selectedBus)}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Assigned Route\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedBus.route_name ||\r\n                        getRouteName(selectedBus.route_id)}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex justify-end space-x-2 pt-4\">\r\n                  <button\r\n                    onClick={() => setEditingBus(true)}\r\n                    className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\"\r\n                  >\r\n                    ✏️ Edit\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Route Details Modal */}\r\n      {showRouteDetails && selectedRoute && (\r\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\r\n          <div className=\"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-lg font-medium text-gray-900\">\r\n                {editingRoute ? 'Edit Route Details' : 'Route Details'}\r\n              </h3>\r\n              <button\r\n                onClick={() => {\r\n                  setShowRouteDetails(false);\r\n                  setEditingRoute(false);\r\n                  setSelectedRoute(null);\r\n                }}\r\n                className=\"text-gray-400 hover:text-gray-600\"\r\n              >\r\n                ✕\r\n              </button>\r\n            </div>\r\n\r\n            {editingRoute ? (\r\n              <form onSubmit={handleUpdateRoute} className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Route Name *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={routeForm.name}\r\n                      onChange={(e) =>\r\n                        setRouteForm({ ...routeForm, name: e.target.value })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      City *\r\n                    </label>\r\n                    <input\r\n                      type=\"text\"\r\n                      required\r\n                      value={routeForm.city}\r\n                      onChange={(e) =>\r\n                        setRouteForm({ ...routeForm, city: e.target.value })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Distance (km) *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      required\r\n                      step=\"0.1\"\r\n                      value={routeForm.distance_km}\r\n                      onChange={(e) =>\r\n                        setRouteForm({\r\n                          ...routeForm,\r\n                          distance_km: e.target.value,\r\n                        })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      min=\"0\"\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                      Duration (minutes) *\r\n                    </label>\r\n                    <input\r\n                      type=\"number\"\r\n                      required\r\n                      value={routeForm.estimated_duration_minutes}\r\n                      onChange={(e) =>\r\n                        setRouteForm({\r\n                          ...routeForm,\r\n                          estimated_duration_minutes: e.target.value,\r\n                        })\r\n                      }\r\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      min=\"1\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"flex items-center\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={routeForm.is_active}\r\n                      onChange={(e) =>\r\n                        setRouteForm({\r\n                          ...routeForm,\r\n                          is_active: e.target.checked,\r\n                        })\r\n                      }\r\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\r\n                    />\r\n                    <label className=\"ml-2 text-sm text-gray-700\">Active</label>\r\n                  </div>\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                    Description\r\n                  </label>\r\n                  <textarea\r\n                    value={routeForm.description}\r\n                    onChange={(e) =>\r\n                      setRouteForm({\r\n                        ...routeForm,\r\n                        description: e.target.value,\r\n                      })\r\n                    }\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white\"\r\n                    rows={3}\r\n                  />\r\n                </div>\r\n                <div className=\"flex justify-end space-x-2 pt-4\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setEditingRoute(false)}\r\n                    className=\"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700\"\r\n                  >\r\n                    Cancel\r\n                  </button>\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    className=\"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50\"\r\n                  >\r\n                    {loading ? 'Updating...' : 'Update Route'}\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Route Name\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedRoute.name}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      City\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedRoute.city || 'Not specified'}\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Distance\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedRoute.distance_km} km\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Duration\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedRoute.estimated_duration_minutes} minutes\r\n                    </p>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Status\r\n                    </h4>\r\n                    <span\r\n                      className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\r\n                        selectedRoute.is_active\r\n                          ? 'bg-green-100 text-green-800'\r\n                          : 'bg-red-100 text-red-800'\r\n                      }`}\r\n                    >\r\n                      {selectedRoute.is_active ? 'Active' : 'Inactive'}\r\n                    </span>\r\n                  </div>\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Created\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedRoute.created_at\r\n                        ? new Date(\r\n                            selectedRoute.created_at\r\n                          ).toLocaleDateString()\r\n                        : 'Not available'}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                {selectedRoute.description && (\r\n                  <div>\r\n                    <h4 className=\"text-sm font-medium text-gray-500 mb-1\">\r\n                      Description\r\n                    </h4>\r\n                    <p className=\"text-sm text-gray-900\">\r\n                      {selectedRoute.description}\r\n                    </p>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex justify-end space-x-2 pt-4\">\r\n                  <button\r\n                    onClick={() => setEditingRoute(true)}\r\n                    className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\"\r\n                  >\r\n                    ✏️ Edit\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import { useState, useEffect } from 'react';\nimport { adminApiService } from '../services/adminApiService';\nimport { authService } from '../services/authService';\nimport MediaManagement from './MediaManagement';\nimport StreamlinedManagement from './StreamlinedManagement';\n\ninterface AnalyticsData {\n  totalBuses: number;\n  activeBuses: number;\n  totalRoutes: number;\n  activeRoutes: number;\n  totalDrivers: number;\n  activeDrivers: number;\n  averageDelay: number;\n  busUsageStats: {\n    date: string;\n    activeBuses: number;\n    totalTrips: number;\n  }[];\n}\n\ninterface SystemHealth {\n  buses: number;\n  routes: number;\n  drivers: number;\n  recentLocations: number;\n  timestamp: string;\n}\n\nexport default function AdminDashboard() {\n  const [analytics, setAnalytics] = useState<AnalyticsData | null>(null);\n  const [systemHealth, setSystemHealth] = useState<SystemHealth | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [activeTab, setActiveTab] = useState<\n    'overview' | 'analytics' | 'management' | 'media'\n  >('overview');\n\n  useEffect(() => {\n    loadDashboardData();\n  }, []);\n\n  const loadDashboardData = async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const [analyticsResult, healthResult] = await Promise.all([\n        adminApiService.getAnalytics(),\n        adminApiService.getSystemHealth(),\n      ]);\n\n      if (analyticsResult.success && analyticsResult.data) {\n        setAnalytics(analyticsResult.data);\n      }\n\n      if (healthResult.success && healthResult.data) {\n        setSystemHealth(healthResult.data);\n      }\n\n      if (!analyticsResult.success || !healthResult.success) {\n        setError('Failed to load dashboard data');\n      }\n    } catch (err) {\n      setError('An error occurred while loading dashboard data');\n      console.error('❌ Dashboard data loading error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSignOut = async () => {\n    try {\n      await authService.signOut();\n      window.location.href = '/';\n    } catch (error) {\n      console.error('❌ Sign out error:', error);\n    }\n  };\n\n  const currentUser = authService.getCurrentProfile();\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"loading-spinner mx-auto\"></div>\n          <p className=\"mt-4 text-white/70\">Loading admin dashboard...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"card-glass p-8\">\n            <h3 className=\"text-lg font-medium text-red-300 mb-2\">\n              Error Loading Dashboard\n            </h3>\n            <p className=\"text-red-200 mb-4\">{error}</p>\n            <button\n              onClick={loadDashboardData}\n              className=\"btn-primary bg-red-600 hover:bg-red-700\"\n            >\n              Retry\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900\">\n      {/* Header */}\n      <header className=\"bg-white/10 backdrop-blur-sm border-b border-white/20\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center py-6\">\n            <div className=\"flex items-center\">\n              <div className=\"flex-shrink-0\">\n                <h1 className=\"text-2xl font-bold text-white\">\n                  🚍 Admin Dashboard\n                </h1>\n              </div>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <span className=\"text-sm text-white/80\">\n                Welcome,{' '}\n                {currentUser?.first_name ||\n                  currentUser?.full_name ||\n                  currentUser?.email}\n              </span>\n              <button\n                onClick={loadDashboardData}\n                className=\"btn-primary text-sm\"\n                disabled={loading}\n              >\n                {loading ? 'Refreshing...' : '🔄 Refresh'}\n              </button>\n              <button onClick={handleSignOut} className=\"btn-secondary text-sm\">\n                Sign Out\n              </button>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Navigation Tabs */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"border-b border-white/20\">\n          <nav className=\"-mb-px flex space-x-8\">\n            <button\n              onClick={() => setActiveTab('overview')}\n              className={`py-2 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${\n                activeTab === 'overview'\n                  ? 'border-blue-400 text-blue-300'\n                  : 'border-transparent text-white/60 hover:text-white/80 hover:border-white/40'\n              }`}\n            >\n              Overview\n            </button>\n            <button\n              onClick={() => setActiveTab('analytics')}\n              className={`py-2 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${\n                activeTab === 'analytics'\n                  ? 'border-blue-400 text-blue-300'\n                  : 'border-transparent text-white/60 hover:text-white/80 hover:border-white/40'\n              }`}\n            >\n              Analytics\n            </button>\n            <button\n              onClick={() => setActiveTab('management')}\n              className={`py-2 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${\n                activeTab === 'management'\n                  ? 'border-blue-400 text-blue-300'\n                  : 'border-transparent text-white/60 hover:text-white/80 hover:border-white/40'\n              }`}\n            >\n              Management\n            </button>\n            <button\n              onClick={() => setActiveTab('media')}\n              className={`py-2 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ${\n                activeTab === 'media'\n                  ? 'border-blue-400 text-blue-300'\n                  : 'border-transparent text-white/60 hover:text-white/80 hover:border-white/40'\n              }`}\n            >\n              Media\n            </button>\n          </nav>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <main className=\"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8\">\n        {activeTab === 'overview' && (\n          <div className=\"px-4 py-6 sm:px-0\">\n            <div className=\"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4\">\n              {/* System Health Cards */}\n              <div className=\"card-glass overflow-hidden\">\n                <div className=\"p-5\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <div className=\"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center\">\n                        <svg\n                          className=\"w-5 h-5 text-white\"\n                          fill=\"currentColor\"\n                          viewBox=\"0 0 20 20\"\n                        >\n                          <path d=\"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z\" />\n                        </svg>\n                      </div>\n                    </div>\n                    <div className=\"ml-5 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-white/70 truncate\">\n                          Total Buses\n                        </dt>\n                        <dd className=\"text-lg font-medium text-white\">\n                          {systemHealth?.buses || 0}\n                        </dd>\n                      </dl>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"card-glass overflow-hidden\">\n                <div className=\"p-5\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <div className=\"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center\">\n                        <svg\n                          className=\"w-5 h-5 text-white\"\n                          fill=\"currentColor\"\n                          viewBox=\"0 0 20 20\"\n                        >\n                          <path\n                            fillRule=\"evenodd\"\n                            d=\"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z\"\n                            clipRule=\"evenodd\"\n                          />\n                        </svg>\n                      </div>\n                    </div>\n                    <div className=\"ml-5 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-white/70 truncate\">\n                          Total Routes\n                        </dt>\n                        <dd className=\"text-lg font-medium text-white\">\n                          {systemHealth?.routes || 0}\n                        </dd>\n                      </dl>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"card-glass overflow-hidden\">\n                <div className=\"p-5\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <div className=\"w-8 h-8 bg-yellow-500 rounded-md flex items-center justify-center\">\n                        <svg\n                          className=\"w-5 h-5 text-white\"\n                          fill=\"currentColor\"\n                          viewBox=\"0 0 20 20\"\n                        >\n                          <path d=\"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z\" />\n                        </svg>\n                      </div>\n                    </div>\n                    <div className=\"ml-5 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-white/70 truncate\">\n                          Total Drivers\n                        </dt>\n                        <dd className=\"text-lg font-medium text-white\">\n                          {systemHealth?.drivers || 0}\n                        </dd>\n                      </dl>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"card-glass overflow-hidden\">\n                <div className=\"p-5\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <div className=\"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center\">\n                        <svg\n                          className=\"w-5 h-5 text-white\"\n                          fill=\"currentColor\"\n                          viewBox=\"0 0 20 20\"\n                        >\n                          <path\n                            fillRule=\"evenodd\"\n                            d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\"\n                            clipRule=\"evenodd\"\n                          />\n                        </svg>\n                      </div>\n                    </div>\n                    <div className=\"ml-5 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-white/70 truncate\">\n                          Recent Locations\n                        </dt>\n                        <dd className=\"text-lg font-medium text-white\">\n                          {systemHealth?.recentLocations || 0}\n                        </dd>\n                      </dl>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* Quick Stats */}\n            {analytics && (\n              <div className=\"mt-8 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3\">\n                <div className=\"card-glass overflow-hidden\">\n                  <div className=\"p-5\">\n                    <h3 className=\"text-lg font-medium text-white mb-4\">\n                      System Status\n                    </h3>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-white/70\">\n                          Active Buses\n                        </span>\n                        <span className=\"text-sm font-medium text-white\">\n                          {analytics.activeBuses}/{analytics.totalBuses}\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-white/70\">\n                          Active Routes\n                        </span>\n                        <span className=\"text-sm font-medium text-white\">\n                          {analytics.activeRoutes}/{analytics.totalRoutes}\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-white/70\">\n                          Active Drivers\n                        </span>\n                        <span className=\"text-sm font-medium text-white\">\n                          {analytics.activeDrivers}/{analytics.totalDrivers}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"card-glass overflow-hidden\">\n                  <div className=\"p-5\">\n                    <h3 className=\"text-lg font-medium text-white mb-4\">\n                      Performance\n                    </h3>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-white/70\">\n                          Average Delay\n                        </span>\n                        <span className=\"text-sm font-medium text-white\">\n                          {analytics.averageDelay.toFixed(1)} min\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-white/70\">\n                          System Health\n                        </span>\n                        <span className=\"text-sm font-medium text-green-400\">\n                          Good\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"card-glass overflow-hidden\">\n                  <div className=\"p-5\">\n                    <h3 className=\"text-lg font-medium text-white mb-4\">\n                      Last Updated\n                    </h3>\n                    <div className=\"text-sm text-white/70\">\n                      {systemHealth?.timestamp\n                        ? new Date(systemHealth.timestamp).toLocaleString()\n                        : 'N/A'}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n\n        {activeTab === 'analytics' && analytics && (\n          <div className=\"px-4 py-6 sm:px-0\">\n            <div className=\"grid grid-cols-1 gap-8 lg:grid-cols-2\">\n              {/* System Statistics */}\n              <div className=\"card-glass p-6\">\n                <h3 className=\"text-lg font-medium text-white mb-4\">\n                  System Statistics\n                </h3>\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center p-3 bg-blue-500/20 rounded-lg border border-blue-400/30\">\n                    <span className=\"text-blue-300 font-medium\">\n                      Active Buses\n                    </span>\n                    <span className=\"text-2xl font-bold text-blue-200\">\n                      {analytics.activeBuses}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-green-500/20 rounded-lg border border-green-400/30\">\n                    <span className=\"text-green-300 font-medium\">\n                      Active Routes\n                    </span>\n                    <span className=\"text-2xl font-bold text-green-200\">\n                      {analytics.activeRoutes}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-yellow-500/20 rounded-lg border border-yellow-400/30\">\n                    <span className=\"text-yellow-300 font-medium\">\n                      Active Drivers\n                    </span>\n                    <span className=\"text-2xl font-bold text-yellow-200\">\n                      {analytics.activeDrivers}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between items-center p-3 bg-purple-500/20 rounded-lg border border-purple-400/30\">\n                    <span className=\"text-purple-300 font-medium\">\n                      Average Delay\n                    </span>\n                    <span className=\"text-2xl font-bold text-purple-200\">\n                      {analytics.averageDelay.toFixed(1)} min\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              {/* System Distribution */}\n              <div className=\"card-glass p-6\">\n                <h3 className=\"text-lg font-medium text-white mb-4\">\n                  System Distribution\n                </h3>\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm font-medium text-white/80\">\n                      Active Buses\n                    </span>\n                    <div className=\"flex items-center\">\n                      <div className=\"w-32 bg-white/20 rounded-full h-2 mr-2\">\n                        <div\n                          className=\"bg-blue-400 h-2 rounded-full\"\n                          style={{\n                            width: `${(analytics.activeBuses / analytics.totalBuses) * 100}%`,\n                          }}\n                        ></div>\n                      </div>\n                      <span className=\"text-sm text-white/70\">\n                        {analytics.activeBuses}/{analytics.totalBuses}\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm font-medium text-white/80\">\n                      Active Routes\n                    </span>\n                    <div className=\"flex items-center\">\n                      <div className=\"w-32 bg-white/20 rounded-full h-2 mr-2\">\n                        <div\n                          className=\"bg-green-400 h-2 rounded-full\"\n                          style={{\n                            width: `${(analytics.activeRoutes / analytics.totalRoutes) * 100}%`,\n                          }}\n                        ></div>\n                      </div>\n                      <span className=\"text-sm text-white/70\">\n                        {analytics.activeRoutes}/{analytics.totalRoutes}\n                      </span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm font-medium text-white/80\">\n                      Active Drivers\n                    </span>\n                    <div className=\"flex items-center\">\n                      <div className=\"w-32 bg-white/20 rounded-full h-2 mr-2\">\n                        <div\n                          className=\"bg-yellow-400 h-2 rounded-full\"\n                          style={{\n                            width: `${(analytics.activeDrivers / analytics.totalDrivers) * 100}%`,\n                          }}\n                        ></div>\n                      </div>\n                      <span className=\"text-sm text-white/70\">\n                        {analytics.activeDrivers}/{analytics.totalDrivers}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Management Tab - All bus, driver, and route management */}\n        {activeTab === 'management' && <StreamlinedManagement />}\n\n        {/* Media Management Tab */}\n        {activeTab === 'media' && <MediaManagement />}\n      </main>\n    </div>\n  );\n}\n","import React from 'react';\r\nimport { motion } from 'framer-motion';\r\n\r\ninterface GlassyCardProps {\r\n  children: React.ReactNode;\r\n  className?: string;\r\n  variant?: 'default' | 'premium' | 'ultra';\r\n  hover?: boolean;\r\n  glow?: boolean;\r\n  onClick?: () => void;\r\n  delay?: number;\r\n}\r\n\r\nconst GlassyCard: React.FC<GlassyCardProps> = ({\r\n  children,\r\n  className = '',\r\n  variant = 'default',\r\n  hover = true,\r\n  glow = false,\r\n  onClick,\r\n  delay = 0,\r\n}) => {\r\n  const baseClasses =\r\n    'relative overflow-hidden rounded-2xl transition-all duration-500 layout-stable';\r\n\r\n  const variantClasses = {\r\n    default: 'bg-white/10 backdrop-blur-md border border-white/20 shadow-xl',\r\n    premium: 'bg-white/5 backdrop-blur-xl border border-white/10 shadow-2xl',\r\n    ultra: 'bg-white/5 backdrop-blur-2xl border border-white/10 shadow-2xl',\r\n  };\r\n\r\n  const hoverClasses = hover\r\n    ? 'hover:bg-white/15 hover:border-white/30 hover:-translate-y-1 hover:shadow-2xl'\r\n    : '';\r\n  const glowClasses = glow ? 'hover:shadow-blue-500/20 hover:shadow-2xl' : '';\r\n  const clickableClasses = onClick ? 'cursor-pointer' : '';\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ opacity: 0, y: 20, scale: 0.95 }}\r\n      animate={{ opacity: 1, y: 0, scale: 1 }}\r\n      transition={{\r\n        duration: 0.6,\r\n        delay,\r\n        ease: [0.4, 0.0, 0.2, 1],\r\n      }}\r\n      whileHover={\r\n        hover\r\n          ? {\r\n              y: -8,\r\n              scale: 1.02,\r\n              transition: { duration: 0.3 },\r\n            }\r\n          : {}\r\n      }\r\n      whileTap={onClick ? { scale: 0.98 } : {}}\r\n      onClick={onClick}\r\n      className={`\r\n        ${baseClasses}\r\n        ${variantClasses[variant]}\r\n        ${hoverClasses}\r\n        ${glowClasses}\r\n        ${clickableClasses}\r\n        ${className}\r\n      `}\r\n    >\r\n      {/* Animated background gradient */}\r\n      <div className=\"absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-white/5 opacity-0 hover:opacity-100 transition-opacity duration-500\" />\r\n\r\n      {/* Glow effect */}\r\n      {glow && (\r\n        <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/10 via-purple-500/10 to-pink-500/10 opacity-0 hover:opacity-100 transition-opacity duration-500 rounded-2xl\" />\r\n      )}\r\n\r\n      {/* Content */}\r\n      <div className=\"relative z-10 p-6 space-stable\">{children}</div>\r\n\r\n      {/* Shimmer effect */}\r\n      <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full hover:translate-x-full transition-transform duration-1000\" />\r\n    </motion.div>\r\n  );\r\n};\r\n\r\n// Specialized card variants\r\nexport const InfoCard: React.FC<GlassyCardProps> = (props) => (\r\n  <GlassyCard variant=\"premium\" glow={true} {...props} />\r\n);\r\n\r\nexport const ActionCard: React.FC<GlassyCardProps> = (props) => (\r\n  <GlassyCard\r\n    variant=\"default\"\r\n    hover={true}\r\n    onClick={props.onClick}\r\n    {...props}\r\n  />\r\n);\r\n\r\nexport const PremiumCard: React.FC<GlassyCardProps> = (props) => (\r\n  <GlassyCard variant=\"ultra\" glow={true} hover={true} {...props} />\r\n);\r\n\r\n// Floating card with continuous animation\r\nexport const FloatingCard: React.FC<GlassyCardProps> = ({\r\n  children,\r\n  className = '',\r\n  ...props\r\n}) => {\r\n  return (\r\n    <motion.div\r\n      animate={{\r\n        y: [0, -10, 0],\r\n      }}\r\n      transition={{\r\n        duration: 3,\r\n        repeat: Infinity,\r\n        ease: 'easeInOut',\r\n      }}\r\n    >\r\n      <GlassyCard className={className} {...props}>\r\n        {children}\r\n      </GlassyCard>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\n// Interactive card with ripple effect\r\nexport const InteractiveCard: React.FC<GlassyCardProps> = ({\r\n  children,\r\n  className = '',\r\n  onClick,\r\n  ...props\r\n}) => {\r\n  return (\r\n    <motion.div\r\n      whileHover={{ scale: 1.02 }}\r\n      whileTap={{ scale: 0.98 }}\r\n      onClick={onClick}\r\n      className=\"cursor-pointer\"\r\n    >\r\n      <GlassyCard className={className} onClick={onClick} {...props}>\r\n        {children}\r\n      </GlassyCard>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default GlassyCard;\r\n","import React from 'react';\nimport { motion } from 'framer-motion';\n\ninterface PremiumButtonProps {\n  children: React.ReactNode;\n  variant?: 'primary' | 'secondary' | 'danger' | 'ghost' | 'gradient';\n  size?: 'sm' | 'md' | 'lg' | 'xl';\n  className?: string;\n  onClick?: () => void;\n  disabled?: boolean;\n  loading?: boolean;\n  icon?: React.ReactNode;\n  iconPosition?: 'left' | 'right';\n}\n\nconst PremiumButton: React.FC<PremiumButtonProps> = ({\n  children,\n  variant = 'primary',\n  size = 'md',\n  className = '',\n  onClick,\n  disabled = false,\n  loading = false,\n  icon,\n  iconPosition = 'left',\n}) => {\n  const baseClasses =\n    'relative inline-flex items-center justify-center font-semibold rounded-xl transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 disabled:opacity-50 disabled:cursor-not-allowed overflow-hidden';\n\n  const sizeClasses = {\n    sm: 'px-4 py-2 text-sm',\n    md: 'px-6 py-3 text-base',\n    lg: 'px-8 py-4 text-lg',\n    xl: 'px-10 py-5 text-xl',\n  };\n\n  const variantClasses = {\n    primary:\n      'bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white shadow-lg hover:shadow-xl hover:shadow-blue-500/25 focus:ring-blue-400',\n    secondary:\n      'bg-white/10 backdrop-blur-sm border border-white/20 text-white hover:bg-white/20 hover:border-white/30 shadow-lg hover:shadow-xl focus:ring-white/20',\n    danger:\n      'bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-500 hover:to-pink-500 text-white shadow-lg hover:shadow-xl hover:shadow-red-500/25 focus:ring-red-400',\n    ghost:\n      'bg-transparent text-white hover:bg-white/10 border border-transparent hover:border-white/20 focus:ring-white/20',\n    gradient:\n      'bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 hover:from-purple-500 hover:via-pink-500 hover:to-red-500 text-white shadow-lg hover:shadow-xl hover:shadow-purple-500/25 focus:ring-purple-400',\n  };\n\n  const hoverEffect = 'hover:-translate-y-0.5 active:translate-y-0';\n\n  return (\n    <motion.button\n      whileHover={{ scale: 1.02 }}\n      whileTap={{ scale: 0.98 }}\n      onClick={onClick}\n      disabled={disabled || loading}\n      className={`\n        ${baseClasses}\n        ${sizeClasses[size]}\n        ${variantClasses[variant]}\n        ${hoverEffect}\n        ${className}\n      `}\n    >\n      {/* Animated background */}\n      <div className=\"absolute inset-0 bg-gradient-to-r from-white/10 via-transparent to-white/10 opacity-0 hover:opacity-100 transition-opacity duration-300\" />\n\n      {/* Shimmer effect */}\n      <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full hover:translate-x-full transition-transform duration-700\" />\n\n      {/* Content */}\n      <div className=\"relative z-10 flex items-center gap-2\">\n        {loading && (\n          <motion.div\n            animate={{ rotate: 360 }}\n            transition={{ duration: 1, repeat: Infinity, ease: 'linear' }}\n            className=\"w-4 h-4 border-2 border-white/30 border-t-white rounded-full\"\n          />\n        )}\n\n        {icon && iconPosition === 'left' && !loading && (\n          <span className=\"flex-shrink-0\">{icon}</span>\n        )}\n\n        <span>{children}</span>\n\n        {icon && iconPosition === 'right' && !loading && (\n          <span className=\"flex-shrink-0\">{icon}</span>\n        )}\n      </div>\n    </motion.button>\n  );\n};\n\n// Specialized button variants\nexport const GlowButton: React.FC<PremiumButtonProps> = ({\n  children,\n  className = '',\n  ...props\n}) => (\n  <motion.div whileHover={{ scale: 1.05 }} className=\"relative\">\n    <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl blur-lg opacity-0 hover:opacity-50 transition-opacity duration-300\" />\n    <PremiumButton className={`relative ${className}`} {...props}>\n      {children}\n    </PremiumButton>\n  </motion.div>\n);\n\nexport const FloatingButton: React.FC<PremiumButtonProps> = ({\n  children,\n  className = '',\n  ...props\n}) => (\n  <motion.div\n    animate={{\n      y: [0, -5, 0],\n    }}\n    transition={{\n      duration: 2,\n      repeat: Infinity,\n      ease: 'easeInOut',\n    }}\n  >\n    <PremiumButton className={className} {...props}>\n      {children}\n    </PremiumButton>\n  </motion.div>\n);\n\nexport const IconButton: React.FC<PremiumButtonProps> = ({\n  children,\n  className = '',\n  ...props\n}) => (\n  <PremiumButton\n    size=\"md\"\n    className={`p-3 rounded-full ${className}`}\n    {...props}\n  >\n    {children}\n  </PremiumButton>\n);\n\nexport default PremiumButton;\n","import { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { authService } from '../services/authService';\r\nimport GlassyCard from './ui/GlassyCard';\r\nimport PremiumButton from './ui/PremiumButton';\r\nimport { useTransition } from './transitions';\r\n\r\ninterface AdminLoginProps {\r\n  onLoginSuccess?: () => void;\r\n}\r\n\r\nexport default function AdminLogin({ onLoginSuccess }: AdminLoginProps) {\r\n  const navigate = useNavigate();\r\n  const { setTransition } = useTransition();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [twoFactorCode, setTwoFactorCode] = useState('');\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n\r\n  // Try to recover session on component mount\r\n  useEffect(() => {\r\n    const attemptSessionRecovery = async () => {\r\n      try {\r\n        console.log('🔄 Attempting automatic session recovery...');\r\n\r\n        // Wait for auth service to be fully initialized\r\n        while (!authService.isInitialized()) {\r\n          await new Promise((resolve) => setTimeout(resolve, 100));\r\n        }\r\n\r\n        const result = await authService.recoverSession();\r\n        if (result.success && authService.isAdmin()) {\r\n          console.log('✅ Session recovered, redirecting to admin panel');\r\n          handleLoginSuccess();\r\n        } else {\r\n          console.log(\r\n            '📝 Session recovery failed or user is not admin:',\r\n            result.error\r\n          );\r\n        }\r\n      } catch (error) {\r\n        console.log('📝 No valid session to recover:', error);\r\n      }\r\n    };\r\n\r\n    // Delay the recovery attempt to ensure auth service is fully initialized\r\n    setTimeout(attemptSessionRecovery, 2000);\r\n  }, []);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setError(null);\r\n    setSuccess(null);\r\n\r\n    try {\r\n      // Add timeout to prevent infinite loading - REDUCED TIMEOUT\r\n      const timeoutPromise = new Promise((_, reject) => {\r\n        setTimeout(() => reject(new Error('Login timeout')), 5000); // Reduced from 8s to 5s\r\n      });\r\n\r\n      const loginPromise = authService.signIn(email, password);\r\n\r\n      const result = (await Promise.race([loginPromise, timeoutPromise])) as {\r\n        success: boolean;\r\n        user?: { role: string };\r\n        error?: string;\r\n      };\r\n\r\n      if (result.success && result.user) {\r\n        if (result.user.role === 'admin') {\r\n          setSuccess('Login successful! Loading admin dashboard...');\r\n          setTimeout(() => {\r\n            handleLoginSuccess();\r\n          }, 500); // Reduced from 1s to 500ms\r\n        } else {\r\n          setError('Access denied. Admin privileges required.');\r\n          await authService.signOut();\r\n        }\r\n      } else {\r\n        setError(\r\n          result.error || 'Login failed. Please check your credentials.'\r\n        );\r\n      }\r\n    } catch (err) {\r\n      console.error('❌ Login error:', err);\r\n      if (err instanceof Error && err.message === 'Login timeout') {\r\n        setError(\r\n          'Login timed out. This might be due to slow network or profile loading. Please try again.'\r\n        );\r\n      } else if (\r\n        err instanceof Error &&\r\n        err.message.includes('environment variables')\r\n      ) {\r\n        setError('Configuration error. Please check your environment setup.');\r\n      } else if (\r\n        err instanceof Error &&\r\n        err.message.includes('Profile loading timeout')\r\n      ) {\r\n        setError(\r\n          'Profile loading is taking longer than expected. Please try again.'\r\n        );\r\n      } else {\r\n        setError('Network error. Please check your connection and try again.');\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleLoginSuccess = () => {\r\n    // Set transition type for login to dashboard\r\n    setTransition('login-to-dashboard');\r\n\r\n    // Add a small delay to ensure session is properly set\r\n    setTimeout(() => {\r\n      if (onLoginSuccess) {\r\n        onLoginSuccess();\r\n      } else {\r\n        // Use replace to avoid 404 issues\r\n        navigate('/admin-dashboard', { replace: true });\r\n      }\r\n    }, 500);\r\n  };\r\n\r\n  const handleRecoverSession = async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    try {\r\n      const result = await authService.recoverSession();\r\n      if (result.success && authService.isAdmin()) {\r\n        setSuccess('Session recovered! Redirecting...');\r\n        setTimeout(() => {\r\n          handleLoginSuccess();\r\n        }, 1000);\r\n      } else {\r\n        setError('No valid session found. Please log in again.');\r\n      }\r\n    } catch (error) {\r\n      setError('Session recovery failed. Please log in again.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleForceFreshLogin = async () => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n    try {\r\n      await authService.forceFreshLogin();\r\n      setSuccess('Session cleared. Please log in again with your credentials.');\r\n    } catch (error) {\r\n      setError('Failed to clear session.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4 relative overflow-hidden\">\r\n      {/* Animated background elements */}\r\n      <div className=\"absolute inset-0 overflow-hidden\">\r\n        <div className=\"absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob\"></div>\r\n        <div className=\"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob animation-delay-2000\"></div>\r\n        <div className=\"absolute top-40 left-40 w-80 h-80 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob animation-delay-4000\"></div>\r\n      </div>\r\n\r\n      {/* Floating particles */}\r\n      <div className=\"absolute inset-0\">\r\n        {[...Array(20)].map((_, i) => (\r\n          <motion.div\r\n            key={i}\r\n            className=\"absolute w-1 h-1 bg-white/30 rounded-full\"\r\n            animate={{\r\n              x: [0, 100, 0],\r\n              y: [0, -100, 0],\r\n              opacity: [0, 1, 0],\r\n            }}\r\n            transition={{\r\n              duration: Math.random() * 10 + 10,\r\n              repeat: Infinity,\r\n              delay: Math.random() * 5,\r\n            }}\r\n            style={{\r\n              left: `${Math.random() * 100}%`,\r\n              top: `${Math.random() * 100}%`,\r\n            }}\r\n          />\r\n        ))}\r\n      </div>\r\n\r\n      <motion.div\r\n        initial={{ opacity: 0, y: 50, scale: 0.9 }}\r\n        animate={{ opacity: 1, y: 0, scale: 1 }}\r\n        transition={{ duration: 0.8, ease: [0.4, 0.0, 0.2, 1] }}\r\n        className=\"w-full max-w-md relative z-10\"\r\n      >\r\n        <GlassyCard variant=\"ultra\" glow={true} className=\"p-8 relative\">\r\n          {/* Header */}\r\n          <motion.div\r\n            initial={{ opacity: 0, y: -20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ delay: 0.2, duration: 0.6 }}\r\n            className=\"text-center mb-8\"\r\n          >\r\n            <div className=\"mx-auto h-16 w-16 flex items-center justify-center rounded-full bg-gradient-to-br from-purple-500 to-blue-500 mb-4 relative\">\r\n              <div className=\"absolute inset-0 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full blur-lg opacity-50\"></div>\r\n              <svg\r\n                className=\"h-8 w-8 text-white relative z-10\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <h2 className=\"text-3xl font-bold bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent\">\r\n              Admin Login\r\n            </h2>\r\n            <p className=\"text-blue-200/80 mt-2 text-sm\">\r\n              Access the administrative dashboard\r\n            </p>\r\n          </motion.div>\r\n\r\n          {/* Form */}\r\n          <motion.form\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            transition={{ delay: 0.4, duration: 0.6 }}\r\n            onSubmit={handleSubmit}\r\n            className=\"space-y-6\"\r\n          >\r\n            {/* Email Input */}\r\n            <motion.div\r\n              initial={{ opacity: 0, x: -20 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              transition={{ delay: 0.5, duration: 0.6 }}\r\n            >\r\n              <label\r\n                htmlFor=\"email\"\r\n                className=\"block text-sm font-medium text-blue-200 mb-2\"\r\n              >\r\n                Email Address\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  id=\"email\"\r\n                  name=\"email\"\r\n                  type=\"email\"\r\n                  autoComplete=\"email\"\r\n                  required\r\n                  value={email}\r\n                  onChange={(e) => setEmail(e.target.value)}\r\n                  className=\"w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl text-white placeholder-blue-200/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-300\"\r\n                  placeholder=\"admin@university.edu\"\r\n                  disabled={isLoading}\r\n                />\r\n                <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-xl opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none\"></div>\r\n              </div>\r\n            </motion.div>\r\n\r\n            {/* Password Input */}\r\n            <motion.div\r\n              initial={{ opacity: 0, x: -20 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              transition={{ delay: 0.6, duration: 0.6 }}\r\n            >\r\n              <label\r\n                htmlFor=\"password\"\r\n                className=\"block text-sm font-medium text-blue-200 mb-2\"\r\n              >\r\n                Password\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  id=\"password\"\r\n                  name=\"password\"\r\n                  type=\"password\"\r\n                  autoComplete=\"current-password\"\r\n                  required\r\n                  value={password}\r\n                  onChange={(e) => setPassword(e.target.value)}\r\n                  className=\"w-full px-4 py-3 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl text-white placeholder-blue-200/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all duration-300\"\r\n                  placeholder=\"••••••••\"\r\n                  disabled={isLoading}\r\n                />\r\n                <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-xl opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none\"></div>\r\n              </div>\r\n            </motion.div>\r\n\r\n            {/* 2FA Code Input (Optional) */}\r\n            <motion.div\r\n              initial={{ opacity: 0, x: -20 }}\r\n              animate={{ opacity: 1, x: 0 }}\r\n              transition={{ delay: 0.7, duration: 0.6 }}\r\n            >\r\n              <label\r\n                htmlFor=\"twoFactorCode\"\r\n                className=\"block text-sm font-medium text-blue-200/80 mb-2\"\r\n              >\r\n                2FA Code <span className=\"text-blue-200/50\">(Optional)</span>\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  id=\"twoFactorCode\"\r\n                  name=\"twoFactorCode\"\r\n                  type=\"text\"\r\n                  autoComplete=\"one-time-code\"\r\n                  value={twoFactorCode}\r\n                  onChange={(e) => setTwoFactorCode(e.target.value)}\r\n                  className=\"w-full px-4 py-3 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl text-white placeholder-blue-200/30 focus:outline-none focus:ring-2 focus:ring-blue-400/50 focus:border-transparent transition-all duration-300\"\r\n                  placeholder=\"Enter 2FA code if enabled\"\r\n                  disabled={isLoading}\r\n                />\r\n                <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/5 to-purple-500/5 rounded-xl opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none\"></div>\r\n              </div>\r\n            </motion.div>\r\n\r\n            {/* Loading State */}\r\n            <AnimatePresence>\r\n              {isLoading && (\r\n                <motion.div\r\n                  initial={{ opacity: 0, height: 0 }}\r\n                  animate={{ opacity: 1, height: 'auto' }}\r\n                  exit={{ opacity: 0, height: 0 }}\r\n                  className=\"text-center\"\r\n                >\r\n                  <div className=\"inline-flex items-center px-4 py-2 text-sm text-blue-200 bg-blue-500/20 backdrop-blur-sm border border-blue-400/30 rounded-xl\">\r\n                    <motion.div\r\n                      animate={{ rotate: 360 }}\r\n                      transition={{\r\n                        duration: 1,\r\n                        repeat: Infinity,\r\n                        ease: 'linear',\r\n                      }}\r\n                      className=\"w-4 h-4 border-2 border-blue-300/30 border-t-blue-300 rounded-full mr-3\"\r\n                    />\r\n                    Signing in and loading profile...\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n            </AnimatePresence>\r\n\r\n            {/* Error Message */}\r\n            <AnimatePresence>\r\n              {error && (\r\n                <motion.div\r\n                  initial={{ opacity: 0, y: -10, scale: 0.95 }}\r\n                  animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                  exit={{ opacity: 0, y: -10, scale: 0.95 }}\r\n                  className=\"bg-red-500/20 backdrop-blur-sm border border-red-400/30 rounded-xl p-4\"\r\n                >\r\n                  <div className=\"flex\">\r\n                    <div className=\"flex-shrink-0\">\r\n                      <svg\r\n                        className=\"h-5 w-5 text-red-400\"\r\n                        viewBox=\"0 0 20 20\"\r\n                        fill=\"currentColor\"\r\n                      >\r\n                        <path\r\n                          fillRule=\"evenodd\"\r\n                          d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\"\r\n                          clipRule=\"evenodd\"\r\n                        />\r\n                      </svg>\r\n                    </div>\r\n                    <div className=\"ml-3\">\r\n                      <h3 className=\"text-sm font-medium text-red-300\">\r\n                        Login Error\r\n                      </h3>\r\n                      <p className=\"text-sm text-red-200 mt-1\">{error}</p>\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n            </AnimatePresence>\r\n\r\n            {/* Success Message */}\r\n            <AnimatePresence>\r\n              {success && (\r\n                <motion.div\r\n                  initial={{ opacity: 0, y: -10, scale: 0.95 }}\r\n                  animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                  exit={{ opacity: 0, y: -10, scale: 0.95 }}\r\n                  className=\"bg-green-500/20 backdrop-blur-sm border border-green-400/30 rounded-xl p-4\"\r\n                >\r\n                  <div className=\"flex\">\r\n                    <div className=\"flex-shrink-0\">\r\n                      <svg\r\n                        className=\"h-5 w-5 text-green-400\"\r\n                        viewBox=\"0 0 20 20\"\r\n                        fill=\"currentColor\"\r\n                      >\r\n                        <path\r\n                          fillRule=\"evenodd\"\r\n                          d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\"\r\n                          clipRule=\"evenodd\"\r\n                        />\r\n                      </svg>\r\n                    </div>\r\n                    <div className=\"ml-3\">\r\n                      <h3 className=\"text-sm font-medium text-green-300\">\r\n                        Success\r\n                      </h3>\r\n                      <p className=\"text-sm text-green-200 mt-1\">{success}</p>\r\n                    </div>\r\n                  </div>\r\n                </motion.div>\r\n              )}\r\n            </AnimatePresence>\r\n\r\n            {/* Login Button */}\r\n            <motion.div\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ delay: 0.8, duration: 0.6 }}\r\n            >\r\n              <PremiumButton\r\n                variant=\"gradient\"\r\n                size=\"lg\"\r\n                className=\"w-full relative group\"\r\n                disabled={isLoading}\r\n                loading={isLoading}\r\n                icon={\r\n                  <svg\r\n                    className=\"w-5 h-5 mr-2\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n                    />\r\n                  </svg>\r\n                }\r\n              >\r\n                {isLoading ? 'Signing In...' : 'Admin Login'}\r\n              </PremiumButton>\r\n            </motion.div>\r\n\r\n            {/* Additional Actions */}\r\n            <motion.div\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              transition={{ delay: 0.9, duration: 0.6 }}\r\n              className=\"text-center space-y-3\"\r\n            >\r\n              <div className=\"flex flex-col sm:flex-row gap-2 justify-center text-xs\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleRecoverSession}\r\n                  disabled={isLoading}\r\n                  className=\"text-blue-300 hover:text-blue-200 underline transition-colors duration-200\"\r\n                >\r\n                  Recover Session\r\n                </button>\r\n                <span className=\"hidden sm:inline text-blue-200/50\">•</span>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleForceFreshLogin}\r\n                  disabled={isLoading}\r\n                  className=\"text-red-300 hover:text-red-200 underline transition-colors duration-200\"\r\n                >\r\n                  Force Fresh Login\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"text-xs text-blue-200/50 space-y-1\">\r\n                <p>Enter your admin credentials to access the system</p>\r\n                <p>Using Supabase Authentication</p>\r\n              </div>\r\n            </motion.div>\r\n          </motion.form>\r\n        </GlassyCard>\r\n      </motion.div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\ninterface PageTransitionProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nconst PageTransition: React.FC<PageTransitionProps> = ({\n  children,\n  className = '',\n}) => {\n  return (\n    <AnimatePresence mode=\"wait\">\n      <motion.div\n        initial={{ opacity: 0, y: 20, scale: 0.95 }}\n        animate={{ opacity: 1, y: 0, scale: 1 }}\n        exit={{ opacity: 0, y: -20, scale: 0.95 }}\n        transition={{\n          duration: 0.5,\n          ease: [0.4, 0.0, 0.2, 1],\n        }}\n        className={className}\n      >\n        {children}\n      </motion.div>\n    </AnimatePresence>\n  );\n};\n\n// Slide transition for horizontal navigation\nexport const SlideTransition: React.FC<PageTransitionProps> = ({\n  children,\n  className = '',\n}) => {\n  return (\n    <motion.div\n      initial={{ x: 300, opacity: 0 }}\n      animate={{ x: 0, opacity: 1 }}\n      exit={{ x: -300, opacity: 0 }}\n      transition={{\n        duration: 0.4,\n        ease: [0.4, 0.0, 0.2, 1],\n      }}\n      className={className}\n    >\n      {children}\n    </motion.div>\n  );\n};\n\n// Fade transition for subtle effects\nexport const FadeTransition: React.FC<PageTransitionProps> = ({\n  children,\n  className = '',\n}) => {\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n      transition={{\n        duration: 0.3,\n        ease: [0.4, 0.0, 0.2, 1],\n      }}\n      className={className}\n    >\n      {children}\n    </motion.div>\n  );\n};\n\n// Scale transition for modal-like effects\nexport const ScaleTransition: React.FC<PageTransitionProps> = ({\n  children,\n  className = '',\n}) => {\n  return (\n    <motion.div\n      initial={{ scale: 0.8, opacity: 0 }}\n      animate={{ scale: 1, opacity: 1 }}\n      exit={{ scale: 0.8, opacity: 0 }}\n      transition={{\n        duration: 0.4,\n        ease: [0.4, 0.0, 0.2, 1],\n      }}\n      className={className}\n    >\n      {children}\n    </motion.div>\n  );\n};\n\n// Stagger transition for lists\nexport const StaggerContainer: React.FC<PageTransitionProps> = ({\n  children,\n  className = '',\n}) => {\n  return (\n    <motion.div\n      initial=\"hidden\"\n      animate=\"visible\"\n      variants={{\n        hidden: { opacity: 0 },\n        visible: {\n          opacity: 1,\n          transition: {\n            staggerChildren: 0.1,\n          },\n        },\n      }}\n      className={className}\n    >\n      {children}\n    </motion.div>\n  );\n};\n\nexport const StaggerItem: React.FC<PageTransitionProps> = ({\n  children,\n  className = '',\n}) => {\n  return (\n    <motion.div\n      variants={{\n        hidden: { opacity: 0, y: 20 },\n        visible: { opacity: 1, y: 0 },\n      }}\n      transition={{\n        duration: 0.4,\n        ease: [0.4, 0.0, 0.2, 1],\n      }}\n      className={className}\n    >\n      {children}\n    </motion.div>\n  );\n};\n\nexport default PageTransition;\n","import React, { useEffect, useState } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { StaggerContainer, StaggerItem } from './PageTransition';\r\nimport GlassyCard from './ui/GlassyCard';\r\nimport { useTransition } from './transitions';\r\n\r\n// SVG Icon Components - Production Optimized\r\nconst BusIcon = () => (\r\n  <svg\r\n    className=\"w-12 h-12 sm:w-16 sm:h-16 custom-icon\"\r\n    viewBox=\"0 0 48 48\"\r\n    width=\"48\"\r\n    height=\"48\"\r\n    fill=\"none\"\r\n    aria-label=\"Bus Icon\"\r\n    style={{ display: 'block', margin: '0 auto' }}\r\n  >\r\n    {/* Bus Body - Main Structure */}\r\n    <rect\r\n      x=\"4\"\r\n      y=\"12\"\r\n      width=\"40\"\r\n      height=\"20\"\r\n      rx=\"2\"\r\n      fill=\"#3B82F6\"\r\n      stroke=\"#1E40AF\"\r\n      strokeWidth=\"1\"\r\n    />\r\n\r\n    {/* Bus Windows */}\r\n    <rect\r\n      x=\"6\"\r\n      y=\"14\"\r\n      width=\"8\"\r\n      height=\"6\"\r\n      rx=\"1\"\r\n      fill=\"#E0F2FE\"\r\n      stroke=\"#0EA5E9\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"16\"\r\n      y=\"14\"\r\n      width=\"8\"\r\n      height=\"6\"\r\n      rx=\"1\"\r\n      fill=\"#E0F2FE\"\r\n      stroke=\"#0EA5E9\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"26\"\r\n      y=\"14\"\r\n      width=\"8\"\r\n      height=\"6\"\r\n      rx=\"1\"\r\n      fill=\"#E0F2FE\"\r\n      stroke=\"#0EA5E9\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"36\"\r\n      y=\"14\"\r\n      width=\"6\"\r\n      height=\"6\"\r\n      rx=\"1\"\r\n      fill=\"#E0F2FE\"\r\n      stroke=\"#0EA5E9\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n\r\n    {/* Bus Door */}\r\n    <rect\r\n      x=\"18\"\r\n      y=\"22\"\r\n      width=\"12\"\r\n      height=\"8\"\r\n      rx=\"1\"\r\n      fill=\"#FEF3C7\"\r\n      stroke=\"#F59E0B\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <line x1=\"24\" y1=\"22\" x2=\"24\" y2=\"30\" stroke=\"#F59E0B\" strokeWidth=\"1\" />\r\n\r\n    {/* Wheels */}\r\n    <circle\r\n      cx=\"12\"\r\n      cy=\"34\"\r\n      r=\"3\"\r\n      fill=\"#374151\"\r\n      stroke=\"#1F2937\"\r\n      strokeWidth=\"1\"\r\n    />\r\n    <circle cx=\"12\" cy=\"34\" r=\"1.5\" fill=\"#6B7280\" />\r\n    <circle\r\n      cx=\"36\"\r\n      cy=\"34\"\r\n      r=\"3\"\r\n      fill=\"#374151\"\r\n      stroke=\"#1F2937\"\r\n      strokeWidth=\"1\"\r\n    />\r\n    <circle cx=\"36\" cy=\"34\" r=\"1.5\" fill=\"#6B7280\" />\r\n\r\n    {/* Headlights */}\r\n    <circle cx=\"8\" cy=\"16\" r=\"1\" fill=\"#FEF3C7\" />\r\n    <circle cx=\"40\" cy=\"16\" r=\"1\" fill=\"#FEF3C7\" />\r\n\r\n    {/* Side Mirrors */}\r\n    <rect x=\"2\" y=\"16\" width=\"2\" height=\"4\" rx=\"1\" fill=\"#6B7280\" />\r\n    <rect x=\"44\" y=\"16\" width=\"2\" height=\"4\" rx=\"1\" fill=\"#6B7280\" />\r\n\r\n    {/* Bus Number/Logo Area */}\r\n    <rect\r\n      x=\"28\"\r\n      y=\"16\"\r\n      width=\"8\"\r\n      height=\"3\"\r\n      rx=\"0.5\"\r\n      fill=\"#FEF3C7\"\r\n      opacity=\"0.8\"\r\n    />\r\n    <text\r\n      x=\"32\"\r\n      y=\"18\"\r\n      textAnchor=\"middle\"\r\n      fontSize=\"2\"\r\n      fill=\"#1F2937\"\r\n      fontFamily=\"Arial, sans-serif\"\r\n    >\r\n      GU\r\n    </text>\r\n  </svg>\r\n);\r\n\r\nconst MapIcon = () => (\r\n  <svg\r\n    className=\"w-12 h-12 sm:w-16 sm:h-16 custom-icon\"\r\n    viewBox=\"0 0 48 48\"\r\n    width=\"48\"\r\n    height=\"48\"\r\n    fill=\"none\"\r\n    aria-label=\"Map Icon\"\r\n    style={{ display: 'block', margin: '0 auto' }}\r\n  >\r\n    {/* Map Background */}\r\n    <rect\r\n      x=\"4\"\r\n      y=\"8\"\r\n      width=\"40\"\r\n      height=\"32\"\r\n      rx=\"2\"\r\n      fill=\"#F0FDF4\"\r\n      stroke=\"#16A34A\"\r\n      strokeWidth=\"1\"\r\n    />\r\n\r\n    {/* Map Grid Lines */}\r\n    <line x1=\"8\" y1=\"16\" x2=\"40\" y2=\"16\" stroke=\"#BBF7D0\" strokeWidth=\"0.5\" />\r\n    <line x1=\"8\" y1=\"24\" x2=\"40\" y2=\"24\" stroke=\"#BBF7D0\" strokeWidth=\"0.5\" />\r\n    <line x1=\"8\" y1=\"32\" x2=\"40\" y2=\"32\" stroke=\"#BBF7D0\" strokeWidth=\"0.5\" />\r\n    <line x1=\"16\" y1=\"12\" x2=\"16\" y2=\"36\" stroke=\"#BBF7D0\" strokeWidth=\"0.5\" />\r\n    <line x1=\"24\" y1=\"12\" x2=\"24\" y2=\"36\" stroke=\"#BBF7D0\" strokeWidth=\"0.5\" />\r\n    <line x1=\"32\" y1=\"12\" x2=\"32\" y2=\"36\" stroke=\"#BBF7D0\" strokeWidth=\"0.5\" />\r\n\r\n    {/* Roads */}\r\n    <rect\r\n      x=\"12\"\r\n      y=\"20\"\r\n      width=\"16\"\r\n      height=\"2\"\r\n      fill=\"#FEF3C7\"\r\n      stroke=\"#F59E0B\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"20\"\r\n      y=\"12\"\r\n      width=\"2\"\r\n      height=\"16\"\r\n      fill=\"#FEF3C7\"\r\n      stroke=\"#F59E0B\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n\r\n    {/* Buildings */}\r\n    <rect\r\n      x=\"10\"\r\n      y=\"26\"\r\n      width=\"4\"\r\n      height=\"8\"\r\n      fill=\"#E5E7EB\"\r\n      stroke=\"#6B7280\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"16\"\r\n      y=\"28\"\r\n      width=\"4\"\r\n      height=\"6\"\r\n      fill=\"#E5E7EB\"\r\n      stroke=\"#6B7280\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"22\"\r\n      y=\"26\"\r\n      width=\"4\"\r\n      height=\"8\"\r\n      fill=\"#E5E7EB\"\r\n      stroke=\"#6B7280\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"28\"\r\n      y=\"28\"\r\n      width=\"4\"\r\n      height=\"6\"\r\n      fill=\"#E5E7EB\"\r\n      stroke=\"#6B7280\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"34\"\r\n      y=\"26\"\r\n      width=\"4\"\r\n      height=\"8\"\r\n      fill=\"#E5E7EB\"\r\n      stroke=\"#6B7280\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n\r\n    {/* Windows on Buildings */}\r\n    <rect x=\"11\" y=\"28\" width=\"1\" height=\"1\" fill=\"#3B82F6\" />\r\n    <rect x=\"13\" y=\"28\" width=\"1\" height=\"1\" fill=\"#3B82F6\" />\r\n    <rect x=\"17\" y=\"30\" width=\"1\" height=\"1\" fill=\"#3B82F6\" />\r\n    <rect x=\"19\" y=\"30\" width=\"1\" height=\"1\" fill=\"#3B82F6\" />\r\n    <rect x=\"23\" y=\"28\" width=\"1\" height=\"1\" fill=\"#3B82F6\" />\r\n    <rect x=\"25\" y=\"28\" width=\"1\" height=\"1\" fill=\"#3B82F6\" />\r\n    <rect x=\"29\" y=\"30\" width=\"1\" height=\"1\" fill=\"#3B82F6\" />\r\n    <rect x=\"31\" y=\"30\" width=\"1\" height=\"1\" fill=\"#3B82F6\" />\r\n    <rect x=\"35\" y=\"28\" width=\"1\" height=\"1\" fill=\"#3B82F6\" />\r\n    <rect x=\"37\" y=\"28\" width=\"1\" height=\"1\" fill=\"#3B82F6\" />\r\n\r\n    {/* Location Pin */}\r\n    <circle\r\n      cx=\"24\"\r\n      cy=\"22\"\r\n      r=\"2\"\r\n      fill=\"#EF4444\"\r\n      stroke=\"#DC2626\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <path\r\n      d=\"M24 24 L26 28 L22 28 Z\"\r\n      fill=\"#EF4444\"\r\n      stroke=\"#DC2626\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <circle cx=\"24\" cy=\"22\" r=\"0.5\" fill=\"#FFFFFF\" />\r\n\r\n    {/* Compass Rose */}\r\n    <circle\r\n      cx=\"36\"\r\n      cy=\"16\"\r\n      r=\"3\"\r\n      fill=\"#FEF3C7\"\r\n      stroke=\"#F59E0B\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <text\r\n      x=\"36\"\r\n      y=\"18\"\r\n      textAnchor=\"middle\"\r\n      fontSize=\"2\"\r\n      fill=\"#1F2937\"\r\n      fontFamily=\"Arial, sans-serif\"\r\n    >\r\n      N\r\n    </text>\r\n    <text\r\n      x=\"36\"\r\n      y=\"22\"\r\n      textAnchor=\"middle\"\r\n      fontSize=\"2\"\r\n      fill=\"#1F2937\"\r\n      fontFamily=\"Arial, sans-serif\"\r\n    >\r\n      S\r\n    </text>\r\n    <text\r\n      x=\"33\"\r\n      y=\"20\"\r\n      textAnchor=\"middle\"\r\n      fontSize=\"2\"\r\n      fill=\"#1F2937\"\r\n      fontFamily=\"Arial, sans-serif\"\r\n    >\r\n      W\r\n    </text>\r\n    <text\r\n      x=\"39\"\r\n      y=\"20\"\r\n      textAnchor=\"middle\"\r\n      fontSize=\"2\"\r\n      fill=\"#1F2937\"\r\n      fontFamily=\"Arial, sans-serif\"\r\n    >\r\n      E\r\n    </text>\r\n  </svg>\r\n);\r\n\r\nconst AdminIcon = () => (\r\n  <svg\r\n    className=\"w-12 h-12 sm:w-16 sm:h-16 custom-icon\"\r\n    viewBox=\"0 0 48 48\"\r\n    width=\"48\"\r\n    height=\"48\"\r\n    fill=\"none\"\r\n    aria-label=\"Admin Icon\"\r\n    style={{ display: 'block', margin: '0 auto' }}\r\n  >\r\n    {/* Dashboard Background */}\r\n    <rect\r\n      x=\"4\"\r\n      y=\"8\"\r\n      width=\"40\"\r\n      height=\"32\"\r\n      rx=\"3\"\r\n      fill=\"#F8FAFC\"\r\n      stroke=\"#8B5CF6\"\r\n      strokeWidth=\"1\"\r\n    />\r\n\r\n    {/* Header Bar */}\r\n    <rect\r\n      x=\"6\"\r\n      y=\"10\"\r\n      width=\"36\"\r\n      height=\"4\"\r\n      rx=\"1\"\r\n      fill=\"#8B5CF6\"\r\n      opacity=\"0.8\"\r\n    />\r\n    <circle cx=\"8\" cy=\"12\" r=\"1\" fill=\"#FFFFFF\" />\r\n    <circle cx=\"10\" cy=\"12\" r=\"1\" fill=\"#FFFFFF\" />\r\n    <circle cx=\"12\" cy=\"12\" r=\"1\" fill=\"#FFFFFF\" />\r\n\r\n    {/* Sidebar */}\r\n    <rect\r\n      x=\"6\"\r\n      y=\"16\"\r\n      width=\"8\"\r\n      height=\"20\"\r\n      rx=\"1\"\r\n      fill=\"#E9D5FF\"\r\n      stroke=\"#A855F7\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n\r\n    {/* Sidebar Icons */}\r\n    <rect x=\"8\" y=\"18\" width=\"4\" height=\"2\" rx=\"0.5\" fill=\"#7C3AED\" />\r\n    <rect x=\"8\" y=\"22\" width=\"4\" height=\"2\" rx=\"0.5\" fill=\"#7C3AED\" />\r\n    <rect x=\"8\" y=\"26\" width=\"4\" height=\"2\" rx=\"0.5\" fill=\"#7C3AED\" />\r\n    <rect x=\"8\" y=\"30\" width=\"4\" height=\"2\" rx=\"0.5\" fill=\"#7C3AED\" />\r\n\r\n    {/* Main Content Area */}\r\n    <rect\r\n      x=\"16\"\r\n      y=\"16\"\r\n      width=\"26\"\r\n      height=\"20\"\r\n      rx=\"1\"\r\n      fill=\"#FFFFFF\"\r\n      stroke=\"#DDD6FE\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n\r\n    {/* Content Grid */}\r\n    <rect\r\n      x=\"18\"\r\n      y=\"18\"\r\n      width=\"10\"\r\n      height=\"6\"\r\n      rx=\"1\"\r\n      fill=\"#F3E8FF\"\r\n      stroke=\"#C084FC\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"30\"\r\n      y=\"18\"\r\n      width=\"10\"\r\n      height=\"6\"\r\n      rx=\"1\"\r\n      fill=\"#F3E8FF\"\r\n      stroke=\"#C084FC\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"18\"\r\n      y=\"26\"\r\n      width=\"10\"\r\n      height=\"8\"\r\n      rx=\"1\"\r\n      fill=\"#F3E8FF\"\r\n      stroke=\"#C084FC\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <rect\r\n      x=\"30\"\r\n      y=\"26\"\r\n      width=\"10\"\r\n      height=\"8\"\r\n      rx=\"1\"\r\n      fill=\"#F3E8FF\"\r\n      stroke=\"#C084FC\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n\r\n    {/* Chart Lines */}\r\n    <path\r\n      d=\"M20 22 L22 21 L24 23 L26 20 L28 22\"\r\n      stroke=\"#8B5CF6\"\r\n      strokeWidth=\"1\"\r\n      fill=\"none\"\r\n    />\r\n    <path\r\n      d=\"M32 22 L34 21 L36 23 L38 20 L40 22\"\r\n      stroke=\"#8B5CF6\"\r\n      strokeWidth=\"1\"\r\n      fill=\"none\"\r\n    />\r\n\r\n    {/* Data Points */}\r\n    <circle cx=\"20\" cy=\"22\" r=\"0.5\" fill=\"#8B5CF6\" />\r\n    <circle cx=\"22\" cy=\"21\" r=\"0.5\" fill=\"#8B5CF6\" />\r\n    <circle cx=\"24\" cy=\"23\" r=\"0.5\" fill=\"#8B5CF6\" />\r\n    <circle cx=\"26\" cy=\"20\" r=\"0.5\" fill=\"#8B5CF6\" />\r\n    <circle cx=\"28\" cy=\"22\" r=\"0.5\" fill=\"#8B5CF6\" />\r\n    <circle cx=\"32\" cy=\"22\" r=\"0.5\" fill=\"#8B5CF6\" />\r\n    <circle cx=\"34\" cy=\"21\" r=\"0.5\" fill=\"#8B5CF6\" />\r\n    <circle cx=\"36\" cy=\"23\" r=\"0.5\" fill=\"#8B5CF6\" />\r\n    <circle cx=\"38\" cy=\"20\" r=\"0.5\" fill=\"#8B5CF6\" />\r\n    <circle cx=\"40\" cy=\"22\" r=\"0.5\" fill=\"#8B5CF6\" />\r\n\r\n    {/* Bar Chart */}\r\n    <rect x=\"20\" y=\"30\" width=\"2\" height=\"2\" fill=\"#8B5CF6\" />\r\n    <rect x=\"23\" y=\"29\" width=\"2\" height=\"3\" fill=\"#8B5CF6\" />\r\n    <rect x=\"26\" y=\"28\" width=\"2\" height=\"4\" fill=\"#8B5CF6\" />\r\n    <rect x=\"29\" y=\"31\" width=\"2\" height=\"1\" fill=\"#8B5CF6\" />\r\n    <rect x=\"32\" y=\"30\" width=\"2\" height=\"2\" fill=\"#8B5CF6\" />\r\n    <rect x=\"35\" y=\"29\" width=\"2\" height=\"3\" fill=\"#8B5CF6\" />\r\n    <rect x=\"38\" y=\"28\" width=\"2\" height=\"4\" fill=\"#8B5CF6\" />\r\n\r\n    {/* Settings Gear */}\r\n    <circle\r\n      cx=\"40\"\r\n      cy=\"12\"\r\n      r=\"2\"\r\n      fill=\"#8B5CF6\"\r\n      stroke=\"#7C3AED\"\r\n      strokeWidth=\"0.5\"\r\n    />\r\n    <circle cx=\"40\" cy=\"12\" r=\"1\" fill=\"#FFFFFF\" />\r\n    <path\r\n      d=\"M40 10 L40 8 M40 16 L40 14 M46 12 L44 12 M36 12 L34 12\"\r\n      stroke=\"#7C3AED\"\r\n      strokeWidth=\"0.5\"\r\n      strokeLinecap=\"round\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst PremiumHomepage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const [isMobile, setIsMobile] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Check if device is mobile\r\n    const checkMobile = () => {\r\n      setIsMobile(window.innerWidth < 768);\r\n    };\r\n\r\n    checkMobile();\r\n    window.addEventListener('resize', checkMobile);\r\n\r\n    return () => window.removeEventListener('resize', checkMobile);\r\n  }, []);\r\n\r\n  const { setTransition } = useTransition();\r\n\r\n  const handleNavigation = (path: string) => {\r\n    // Set transition type based on destination\r\n    if (path.includes('login')) {\r\n      setTransition('homepage-to-login');\r\n    } else if (path.includes('student') || path.includes('student-map')) {\r\n      setTransition('homepage-to-map');\r\n    } else {\r\n      setTransition('default');\r\n    }\r\n\r\n    // setIsTransitioning(true); // This line was removed as per the new_code\r\n\r\n    // Add a small delay for smooth transition\r\n    setTimeout(() => {\r\n      navigate(path);\r\n    }, 200);\r\n  };\r\n\r\n  // Optimize particle count for mobile\r\n  const particleCount = isMobile ? 8 : 20;\r\n\r\n  return (\r\n    <div className=\"relative min-h-screen overflow-hidden bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900\">\r\n      {/* Main Content */}\r\n      <div className=\"relative z-10 flex flex-col items-center justify-center min-h-screen p-4 sm:p-6\">\r\n        {/* Premium Heading */}\r\n        <motion.div\r\n          initial={{ opacity: 0, y: -50 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.8 }}\r\n          className=\"text-center mb-8 sm:mb-16 px-4\"\r\n        >\r\n          <h1 className=\"text-3xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-bold mb-2 sm:mb-4 leading-tight\">\r\n            <span className=\"bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent\">\r\n              Ganpat University\r\n            </span>\r\n          </h1>\r\n          <h2 className=\"text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold text-white mb-4 sm:mb-6 leading-tight\">\r\n            Bus Tracker\r\n          </h2>\r\n          <div className=\"w-20 sm:w-32 h-1 bg-gradient-to-r from-blue-400 to-purple-400 mx-auto rounded-full\" />\r\n        </motion.div>\r\n\r\n        {/* Interactive Buttons Container */}\r\n        <StaggerContainer className=\"flex flex-col sm:flex-row gap-4 sm:gap-6 md:gap-8 lg:gap-12 items-center justify-center w-full max-w-6xl px-4\">\r\n          {/* Driver Interface Button */}\r\n          <StaggerItem>\r\n            <motion.div\r\n              whileHover={\r\n                !isMobile ? { scale: 1.05, rotateY: 5, rotateX: 2 } : {}\r\n              }\r\n              whileTap={{ scale: 0.95 }}\r\n              className=\"relative group w-full sm:w-auto\"\r\n            >\r\n              {/* Glow Effect */}\r\n              <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/30 to-purple-500/30 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300\" />\r\n\r\n              <GlassyCard\r\n                variant=\"ultra\"\r\n                glow={true}\r\n                className=\"w-full sm:w-72 md:w-80 h-40 sm:h-48 flex flex-col items-center justify-center cursor-pointer relative z-10\"\r\n                onClick={() => handleNavigation('/driver-login')}\r\n              >\r\n                <div className=\"text-center px-2\">\r\n                  <div className=\"mb-2 sm:mb-4 animate-pulse icon-container\" style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\r\n                    <BusIcon />\r\n                  </div>\r\n                  <h3 className=\"text-lg sm:text-xl md:text-2xl font-bold text-white mb-1 sm:mb-2\">\r\n                    Driver Interface\r\n                  </h3>\r\n                  <p className=\"text-white/70 text-xs sm:text-sm\">\r\n                    Real-time location sharing & navigation\r\n                  </p>\r\n                </div>\r\n\r\n                {/* Hover/Touch Indicator */}\r\n                <div className=\"absolute bottom-2 sm:bottom-4 right-2 sm:right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300\">\r\n                  <div className=\"w-6 h-6 sm:w-8 sm:h-8 border-2 border-white/30 border-t-white rounded-full animate-spin\" />\r\n                </div>\r\n              </GlassyCard>\r\n            </motion.div>\r\n          </StaggerItem>\r\n\r\n          {/* Student Map Button */}\r\n          <StaggerItem>\r\n            <motion.div\r\n              whileHover={\r\n                !isMobile ? { scale: 1.05, rotateY: 5, rotateX: 2 } : {}\r\n              }\r\n              whileTap={{ scale: 0.95 }}\r\n              className=\"relative group w-full sm:w-auto\"\r\n            >\r\n              {/* Glow Effect */}\r\n              <div className=\"absolute inset-0 bg-gradient-to-r from-green-500/30 to-blue-500/30 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300\" />\r\n\r\n              <GlassyCard\r\n                variant=\"ultra\"\r\n                glow={true}\r\n                className=\"w-full sm:w-72 md:w-80 h-40 sm:h-48 flex flex-col items-center justify-center cursor-pointer relative z-10\"\r\n                onClick={() => handleNavigation('/student-map')}\r\n              >\r\n                <div className=\"text-center px-2\">\r\n                  <div className=\"mb-2 sm:mb-4 animate-pulse icon-container\" style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\r\n                    <MapIcon />\r\n                  </div>\r\n                  <h3 className=\"text-lg sm:text-xl md:text-2xl font-bold text-white mb-1 sm:mb-2\">\r\n                    Student Map\r\n                  </h3>\r\n                  <p className=\"text-white/70 text-xs sm:text-sm\">\r\n                    Live bus tracking & route information\r\n                  </p>\r\n                </div>\r\n\r\n                {/* Hover/Touch Indicator */}\r\n                <div className=\"absolute bottom-2 sm:bottom-4 right-2 sm:right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300\">\r\n                  <div className=\"w-6 h-6 sm:w-8 sm:h-8 border-2 border-white/30 border-t-white rounded-full animate-spin\" />\r\n                </div>\r\n              </GlassyCard>\r\n            </motion.div>\r\n          </StaggerItem>\r\n\r\n          {/* Admin Panel Button */}\r\n          <StaggerItem>\r\n            <motion.div\r\n              whileHover={\r\n                !isMobile ? { scale: 1.05, rotateY: 5, rotateX: 2 } : {}\r\n              }\r\n              whileTap={{ scale: 0.95 }}\r\n              className=\"relative group w-full sm:w-auto\"\r\n            >\r\n              {/* Glow Effect */}\r\n              <div className=\"absolute inset-0 bg-gradient-to-r from-purple-500/30 to-pink-500/30 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300\" />\r\n\r\n              <GlassyCard\r\n                variant=\"ultra\"\r\n                glow={true}\r\n                className=\"w-full sm:w-72 md:w-80 h-40 sm:h-48 flex flex-col items-center justify-center cursor-pointer relative z-10\"\r\n                onClick={() => handleNavigation('/admin-login')}\r\n              >\r\n                <div className=\"text-center px-2\">\r\n                  <div className=\"mb-2 sm:mb-4 animate-pulse icon-container\" style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\r\n                    <AdminIcon />\r\n                  </div>\r\n                  <h3 className=\"text-lg sm:text-xl md:text-2xl font-bold text-white mb-1 sm:mb-2\">\r\n                    Admin Panel\r\n                  </h3>\r\n                  <p className=\"text-white/70 text-xs sm:text-sm\">\r\n                    Fleet management & analytics dashboard\r\n                  </p>\r\n                </div>\r\n\r\n                {/* Hover/Touch Indicator */}\r\n                <div className=\"absolute bottom-2 sm:bottom-4 right-2 sm:right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300\">\r\n                  <div className=\"w-6 h-6 sm:w-8 sm:h-8 border-2 border-white/30 border-t-white rounded-full animate-spin\" />\r\n                </div>\r\n              </GlassyCard>\r\n            </motion.div>\r\n          </StaggerItem>\r\n        </StaggerContainer>\r\n\r\n        {/* Footer Info */}\r\n        <motion.div\r\n          initial={{ opacity: 0 }}\r\n          animate={{ opacity: 1 }}\r\n          transition={{ duration: 0.8, delay: 1.2 }}\r\n          className=\"absolute bottom-4 sm:bottom-8 left-1/2 transform -translate-x-1/2 text-center px-4\"\r\n        >\r\n          <p className=\"text-white/60 text-xs sm:text-sm\">\r\n            Powered by cutting-edge technology • Real-time tracking • Premium\r\n            experience\r\n          </p>\r\n        </motion.div>\r\n\r\n        {/* Floating Particles Effect - Optimized for mobile */}\r\n        <div className=\"absolute inset-0 pointer-events-none\">\r\n          {[...Array(particleCount)].map((_, i) => (\r\n            <motion.div\r\n              key={i}\r\n              className=\"absolute w-1 h-1 sm:w-2 sm:h-2 bg-white/20 rounded-full\"\r\n              style={{\r\n                left: `${Math.random() * 100}%`,\r\n                top: `${Math.random() * 100}%`,\r\n              }}\r\n              animate={{\r\n                y: [0, -50, 0],\r\n                opacity: [0, 1, 0],\r\n              }}\r\n              transition={{\r\n                duration: 2 + Math.random() * 2,\r\n                repeat: Infinity,\r\n                delay: Math.random() * 2,\r\n              }}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PremiumHomepage;\r\n","import { Component, ErrorInfo, ReactNode } from 'react';\r\nimport { logError } from '../../utils/errorHandler';\r\n\r\ninterface Props {\r\n  children: ReactNode;\r\n  fallback?: ReactNode;\r\n  onError?: (error: Error, errorInfo: ErrorInfo) => void;\r\n  resetKey?: string | number; // Key to force reset\r\n  showDetails?: boolean; // Whether to show error details in development\r\n}\r\n\r\ninterface State {\r\n  hasError: boolean;\r\n  error?: Error;\r\n  errorInfo?: ErrorInfo;\r\n  errorId: string;\r\n  retryCount: number;\r\n}\r\n\r\nclass ErrorBoundary extends Component<Props, State> {\r\n  public state: State = {\r\n    hasError: false,\r\n    errorId: '',\r\n    retryCount: 0,\r\n  };\r\n\r\n  public static getDerivedStateFromError(error: Error): Partial<State> {\r\n    return { \r\n      hasError: true, \r\n      error,\r\n      errorId: `error_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n    };\r\n  }\r\n\r\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {\r\n    // Log error with context\r\n    logError(error, {\r\n      service: 'ui',\r\n      operation: 'component-error',\r\n    }, 'high');\r\n\r\n    this.setState({ errorInfo });\r\n\r\n    // Call custom error handler if provided\r\n    if (this.props.onError) {\r\n      this.props.onError(error, errorInfo);\r\n    }\r\n\r\n    // Log additional error details\r\n    console.error('🚨 Error Boundary caught error:', {\r\n      error: error.message,\r\n      stack: error.stack,\r\n      componentStack: errorInfo.componentStack,\r\n      errorId: this.state.errorId,\r\n    });\r\n  }\r\n\r\n  public componentDidUpdate(prevProps: Props) {\r\n    // Reset error boundary when resetKey changes\r\n    if (prevProps.resetKey !== this.props.resetKey && this.state.hasError) {\r\n      this.resetError();\r\n    }\r\n  }\r\n\r\n  private resetError = (): void => {\r\n    this.setState({\r\n      hasError: false,\r\n      error: undefined,\r\n      errorInfo: undefined,\r\n      errorId: '',\r\n      retryCount: this.state.retryCount + 1,\r\n    });\r\n  };\r\n\r\n  private handleRetry = (): void => {\r\n    this.resetError();\r\n  };\r\n\r\n  private handleReportError = (): void => {\r\n    const { error, errorInfo, errorId } = this.state;\r\n    if (error) {\r\n      // In a real app, you would send this to your error reporting service\r\n      console.log('📧 Error Report:', {\r\n        errorId,\r\n        error: error.message,\r\n        stack: error.stack,\r\n        componentStack: errorInfo?.componentStack,\r\n        userAgent: navigator.userAgent,\r\n        url: window.location.href,\r\n        timestamp: new Date().toISOString(),\r\n      });\r\n      \r\n      // Show feedback to user\r\n      alert('Thank you for reporting this error. We will investigate and fix it.');\r\n    }\r\n  };\r\n\r\n  private handleGoHome = (): void => {\r\n    window.location.href = '/';\r\n  };\r\n\r\n  public render() {\r\n    if (this.state.hasError) {\r\n      // Use custom fallback if provided\r\n      if (this.props.fallback) {\r\n        return this.props.fallback;\r\n      }\r\n\r\n      const { error, errorInfo, errorId, retryCount } = this.state;\r\n      const isDevelopment = import.meta.env.DEV;\r\n      const showDetails = this.props.showDetails !== false && isDevelopment;\r\n\r\n      return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-red-50 to-red-100 flex items-center justify-center p-4\">\r\n          <div className=\"max-w-2xl w-full mx-auto\">\r\n            <div className=\"bg-white rounded-xl shadow-2xl p-8 border border-red-200\">\r\n              {/* Error Header */}\r\n              <div className=\"text-center mb-6\">\r\n                <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                  <svg className=\"w-8 h-8 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n                  </svg>\r\n                </div>\r\n                <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">\r\n                  Oops! Something went wrong\r\n                </h1>\r\n                <p className=\"text-gray-600 mb-4\">\r\n                  We're sorry, but something unexpected happened. Our team has been notified.\r\n                </p>\r\n                {errorId && (\r\n                  <p className=\"text-sm text-gray-500 mb-4\">\r\n                    Error ID: <code className=\"bg-gray-100 px-2 py-1 rounded\">{errorId}</code>\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Error Details (Development Only) */}\r\n              {showDetails && error && (\r\n                <details className=\"mb-6 bg-gray-50 rounded-lg p-4\">\r\n                  <summary className=\"cursor-pointer font-medium text-gray-700 mb-2\">\r\n                    Error Details (Development)\r\n                  </summary>\r\n                  <div className=\"space-y-3\">\r\n                    <div>\r\n                      <strong className=\"text-red-600\">Message:</strong>\r\n                      <pre className=\"text-sm text-gray-800 mt-1 p-2 bg-white rounded border overflow-x-auto\">\r\n                        {error.message}\r\n                      </pre>\r\n                    </div>\r\n                    {error.stack && (\r\n                      <div>\r\n                        <strong className=\"text-red-600\">Stack Trace:</strong>\r\n                        <pre className=\"text-xs text-gray-800 mt-1 p-2 bg-white rounded border overflow-x-auto max-h-32\">\r\n                          {error.stack}\r\n                        </pre>\r\n                      </div>\r\n                    )}\r\n                    {errorInfo?.componentStack && (\r\n                      <div>\r\n                        <strong className=\"text-red-600\">Component Stack:</strong>\r\n                        <pre className=\"text-xs text-gray-800 mt-1 p-2 bg-white rounded border overflow-x-auto max-h-32\">\r\n                          {errorInfo.componentStack}\r\n                        </pre>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </details>\r\n              )}\r\n\r\n              {/* Action Buttons */}\r\n              <div className=\"flex flex-col sm:flex-row gap-3 justify-center\">\r\n                <button\r\n                  onClick={this.handleRetry}\r\n                  className=\"flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors\"\r\n                >\r\n                  🔄 Try Again\r\n                </button>\r\n                \r\n                <button\r\n                  onClick={this.handleGoHome}\r\n                  className=\"flex-1 bg-gray-600 text-white py-3 px-6 rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors\"\r\n                >\r\n                  🏠 Go Home\r\n                </button>\r\n                \r\n                <button\r\n                  onClick={this.handleReportError}\r\n                  className=\"flex-1 bg-red-600 text-white py-3 px-6 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors\"\r\n                >\r\n                  📧 Report Error\r\n                </button>\r\n              </div>\r\n\r\n              {/* Additional Help */}\r\n              <div className=\"mt-6 text-center\">\r\n                <p className=\"text-sm text-gray-500 mb-2\">\r\n                  If the problem persists, try:\r\n                </p>\r\n                <ul className=\"text-sm text-gray-600 space-y-1\">\r\n                  <li>• Refreshing the page</li>\r\n                  <li>• Clearing your browser cache</li>\r\n                  <li>• Checking your internet connection</li>\r\n                  <li>• Contacting support if the issue continues</li>\r\n                </ul>\r\n              </div>\r\n\r\n              {/* Retry Count */}\r\n              {retryCount > 0 && (\r\n                <div className=\"mt-4 text-center\">\r\n                  <p className=\"text-xs text-gray-400\">\r\n                    Retry attempts: {retryCount}\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport default ErrorBoundary;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { logError } from '../../utils/errorHandler';\r\n\r\ninterface NetworkStatusProps {\r\n  showOfflineMessage?: boolean;\r\n  onNetworkChange?: (isOnline: boolean) => void;\r\n}\r\n\r\ninterface NetworkInfo {\r\n  isOnline: boolean;\r\n  effectiveType?: string;\r\n  downlink?: number;\r\n  rtt?: number;\r\n  saveData?: boolean;\r\n}\r\n\r\nconst NetworkStatus: React.FC<NetworkStatusProps> = ({\r\n  showOfflineMessage = true,\r\n  onNetworkChange,\r\n}) => {\r\n  const [networkInfo, setNetworkInfo] = useState<NetworkInfo>({\r\n    isOnline: navigator.onLine,\r\n  });\r\n  const [showBanner, setShowBanner] = useState(false);\r\n  const [lastOnlineTime, setLastOnlineTime] = useState<number>(Date.now());\r\n\r\n  useEffect(() => {\r\n    const updateNetworkInfo = () => {\r\n      const isOnline = navigator.onLine;\r\n      const newNetworkInfo: NetworkInfo = { isOnline };\r\n\r\n      // Get additional network information if available\r\n      if ('connection' in navigator) {\r\n        const conn = (navigator as any).connection;\r\n        if (conn) {\r\n          newNetworkInfo.effectiveType = conn.effectiveType;\r\n          newNetworkInfo.downlink = conn.downlink;\r\n          newNetworkInfo.rtt = conn.rtt;\r\n          newNetworkInfo.saveData = conn.saveData;\r\n        }\r\n      }\r\n\r\n      setNetworkInfo(newNetworkInfo);\r\n\r\n      // Handle network state changes\r\n      if (isOnline) {\r\n        setLastOnlineTime(Date.now());\r\n        setShowBanner(false);\r\n        \r\n        // Only log network restoration if we were previously offline\r\n        if (!networkInfo.isOnline) {\r\n          logError('Network connection restored', {\r\n            service: 'network',\r\n            operation: 'connection-restored',\r\n          }, 'low');\r\n        }\r\n      } else {\r\n        setShowBanner(true);\r\n        \r\n        // Only log network loss if we were previously online\r\n        if (networkInfo.isOnline) {\r\n          logError('Network connection lost', {\r\n            service: 'network',\r\n            operation: 'connection-lost',\r\n          }, 'medium');\r\n        }\r\n      }\r\n\r\n      // Call callback if provided\r\n      if (onNetworkChange) {\r\n        onNetworkChange(isOnline);\r\n      }\r\n    };\r\n\r\n    // Initial network info\r\n    updateNetworkInfo();\r\n\r\n    // Listen for online/offline events\r\n    window.addEventListener('online', updateNetworkInfo);\r\n    window.addEventListener('offline', updateNetworkInfo);\r\n\r\n    // Listen for network information changes\r\n    if ('connection' in navigator) {\r\n      const conn = (navigator as any).connection;\r\n      if (conn) {\r\n        conn.addEventListener('change', updateNetworkInfo);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      window.removeEventListener('online', updateNetworkInfo);\r\n      window.removeEventListener('offline', updateNetworkInfo);\r\n      \r\n      if ('connection' in navigator) {\r\n        const conn = (navigator as any).connection;\r\n        if (conn) {\r\n          conn.removeEventListener('change', updateNetworkInfo);\r\n        }\r\n      }\r\n    };\r\n  }, [onNetworkChange]);\r\n\r\n  // Auto-hide offline banner after 5 seconds\r\n  useEffect(() => {\r\n    if (showBanner && !networkInfo.isOnline) {\r\n      const timer = setTimeout(() => {\r\n        setShowBanner(false);\r\n      }, 5000);\r\n\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [showBanner, networkInfo.isOnline]);\r\n\r\n  // Don't render anything if online and not showing offline message\r\n  if (networkInfo.isOnline && !showOfflineMessage) {\r\n    return null;\r\n  }\r\n\r\n  // Offline banner\r\n  if (!networkInfo.isOnline && showBanner) {\r\n    const offlineDuration = Math.floor((Date.now() - lastOnlineTime) / 1000);\r\n\r\n    return (\r\n      <div className=\"fixed top-0 left-0 right-0 z-50 bg-red-600 text-white px-4 py-3 shadow-lg\">\r\n        <div className=\"flex items-center justify-between max-w-7xl mx-auto\">\r\n          <div className=\"flex items-center space-x-3\">\r\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192L5.636 18.364M12 2.25a9.75 9.75 0 100 19.5 9.75 9.75 0 000-19.5z\" />\r\n            </svg>\r\n            <div>\r\n              <p className=\"font-medium\">You're offline</p>\r\n              <p className=\"text-sm opacity-90\">\r\n                Offline for {offlineDuration}s • Some features may be limited\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <button\r\n            onClick={() => setShowBanner(false)}\r\n            className=\"text-white hover:text-red-200 transition-colors\"\r\n          >\r\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Online indicator (optional)\r\n  if (networkInfo.isOnline && showOfflineMessage) {\r\n    return (\r\n      <div className=\"fixed top-4 right-4 z-40\">\r\n        <div className=\"bg-green-500 text-white px-3 py-2 rounded-lg shadow-lg flex items-center space-x-2\">\r\n          <div className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></div>\r\n          <span className=\"text-sm font-medium\">Online</span>\r\n          {networkInfo.effectiveType && (\r\n            <span className=\"text-xs opacity-75\">({networkInfo.effectiveType})</span>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nexport default NetworkStatus;\r\n","import React, { useEffect, Suspense } from 'react';\r\nimport { BrowserRouter as Router, Routes, Route, Link } from 'react-router-dom';\r\nimport { useAuthStore } from './stores/useAuthStore';\r\nimport { useHealthCheck } from './hooks/useApiQueries';\r\nimport { authService } from './services/authService';\r\nimport DriverInterface from './components/DriverInterface';\r\nimport DriverLogin from './components/DriverLogin';\r\nimport DriverDashboard from './components/DriverDashboard';\r\n// Lazy load the enhanced student map for better performance\r\nconst EnhancedStudentMap = React.lazy(() => import('./components/EnhancedStudentMap'));\r\nimport AdminDashboard from './components/AdminDashboard';\r\nimport AdminLogin from './components/AdminLogin';\r\nimport PremiumHomepage from './components/PremiumHomepage';\r\nimport {\r\n  TransitionProvider,\r\n  GlobalTransitionWrapper,\r\n} from './components/transitions';\r\n\r\n// Import error handling components\r\nimport { ErrorBoundary, NetworkStatus } from './components/error';\r\n\r\nfunction App() {\r\n  console.log('🚀 App component is rendering...');\r\n\r\n  // Zustand auth store\r\n  const {\r\n    loading: authLoading,\r\n    error: authError,\r\n    setUser,\r\n    setLoading,\r\n    setError,\r\n  } = useAuthStore();\r\n\r\n  // React Query health check\r\n  const { data: health, isLoading: healthLoading, error: healthError } = useHealthCheck();\r\n\r\n  // Global auth state listener\r\n  useEffect(() => {\r\n    const updateAuthState = () => {\r\n      const currentUser = authService.getCurrentUser();\r\n\r\n      setUser(currentUser ? {\r\n        id: currentUser.id,\r\n        email: currentUser.email || '',\r\n        role: 'student' as const,\r\n        created_at: currentUser.created_at,\r\n        updated_at: currentUser.updated_at,\r\n      } : null);\r\n      \r\n      setLoading(false);\r\n    };\r\n\r\n    // Set up auth state listener\r\n    authService.onAuthStateChange(updateAuthState);\r\n\r\n    // Initial auth state check\r\n    updateAuthState();\r\n\r\n    return () => {\r\n      authService.removeAuthStateChangeListener();\r\n    };\r\n  }, [setUser, setLoading]);\r\n\r\n  // Handle health check errors\r\n  useEffect(() => {\r\n    if (healthError) {\r\n      setError('Failed to connect to backend');\r\n    } else {\r\n      setError(null);\r\n    }\r\n  }, [healthError, setError]);\r\n\r\n  // Legacy Homepage (for backward compatibility)\r\n  const LegacyHomePage = () => (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center p-6\">\r\n      <div className=\"max-w-4xl w-full mx-auto\">\r\n        <div className=\"card-glass p-8\">\r\n          <h1 className=\"text-4xl font-bold gradient-text mb-6 text-center\">\r\n            🚍 University Bus Tracking System\r\n          </h1>\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n            {/* Driver Interface */}\r\n            <Link\r\n              to=\"/driver-login\"\r\n              className=\"card-glass p-6 text-center hover:scale-105 transition-transform duration-300\"\r\n            >\r\n              <div className=\"text-4xl mb-4\">🚌</div>\r\n              <h2 className=\"text-xl font-semibold mb-2\">Driver Interface</h2>\r\n              <p className=\"text-white/70\">\r\n                Real-time location sharing & navigation\r\n              </p>\r\n            </Link>\r\n\r\n            {/* Student Map */}\r\n            <Link\r\n              to=\"/student-map\"\r\n              className=\"card-glass p-6 text-center hover:scale-105 transition-transform duration-300\"\r\n            >\r\n              <div className=\"text-4xl mb-4\">🗺️</div>\r\n              <h2 className=\"text-xl font-semibold mb-2\">Student Map</h2>\r\n              <p className=\"text-white/70\">\r\n                Live bus tracking & route information\r\n              </p>\r\n            </Link>\r\n\r\n            {/* Admin Panel */}\r\n            <Link\r\n              to=\"/admin-login\"\r\n              className=\"card-glass p-6 text-center hover:scale-105 transition-transform duration-300\"\r\n            >\r\n              <div className=\"text-4xl mb-4\">⚙️</div>\r\n              <h2 className=\"text-xl font-semibold mb-2\">Admin Panel</h2>\r\n              <p className=\"text-white/70\">\r\n                Fleet management & analytics dashboard\r\n              </p>\r\n            </Link>\r\n          </div>\r\n\r\n          {/* Health Status */}\r\n          {health && (\r\n            <div className=\"mt-8 p-4 bg-green-500/20 border border-green-400/30 rounded-xl\">\r\n              <p className=\"text-green-200 text-center\">\r\n                ✅ Backend Status: {health.status}\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {authError && (\r\n            <div className=\"mt-4 p-4 bg-red-500/20 border border-red-400/30 rounded-xl\">\r\n              <p className=\"text-red-200 text-center\">{authError}</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Loading state\r\n  if (authLoading || healthLoading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"loading-spinner mx-auto mb-4\" />\r\n          <p className=\"text-white\">Loading application...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <ErrorBoundary>\r\n      <Router>\r\n        <NetworkStatus onNetworkChange={(isOnline) => {\r\n          console.log(`🌐 Network status changed: ${isOnline ? 'Online' : 'Offline'}`);\r\n        }} />\r\n        <TransitionProvider>\r\n          <GlobalTransitionWrapper>\r\n            <Routes>\r\n              {/* Homepage Routes */}\r\n              <Route path=\"/\" element={<PremiumHomepage />} />\r\n              <Route path=\"/legacy\" element={<LegacyHomePage />} />\r\n\r\n              {/* Driver Routes */}\r\n              <Route path=\"/driver-login\" element={<DriverLogin />} />\r\n              <Route path=\"/driver-dashboard\" element={<DriverDashboard />} />\r\n              <Route path=\"/driver-interface\" element={<DriverInterface />} />\r\n\r\n              {/* Student Routes */}\r\n              <Route \r\n                path=\"/student-map\" \r\n                element={\r\n                  <Suspense fallback={\r\n                    <div className=\"flex items-center justify-center h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900\">\r\n                      <div className=\"text-center\">\r\n                        <div className=\"loading-spinner mx-auto mb-4\" />\r\n                        <p className=\"text-white text-lg\">Loading Student Map...</p>\r\n                      </div>\r\n                    </div>\r\n                  }>\r\n                    <EnhancedStudentMap />\r\n                  </Suspense>\r\n                } \r\n              />\r\n\r\n              {/* Admin Routes */}\r\n              <Route path=\"/admin-login\" element={<AdminLogin />} />\r\n              <Route path=\"/admin-dashboard\" element={<AdminDashboard />} />\r\n\r\n              {/* Fallback */}\r\n              <Route path=\"*\" element={<PremiumHomepage />} />\r\n            </Routes>\r\n          </GlobalTransitionWrapper>\r\n        </TransitionProvider>\r\n      </Router>\r\n    </ErrorBoundary>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// Console filter utility to suppress expected warnings in development\nexport const setupConsoleFilter = () => {\n  if (import.meta.env.DEV) {\n    const originalWarn = console.warn;\n    console.warn = (...args) => {\n      const message = args[0];\n\n      // Filter out React Router future flag warnings\n      if (\n        typeof message === 'string' &&\n        (message.includes('React Router Future Flag Warning') ||\n          message.includes('v7_startTransition') ||\n          message.includes('v7_relativeSplatPath'))\n      ) {\n        return; // Suppress these warnings\n      }\n\n      // Filter out WebGL context lost warnings (normal in development)\n      if (\n        typeof message === 'string' &&\n        message.includes('WebGL context was lost')\n      ) {\n        return; // Suppress these warnings\n      }\n\n      // Filter out Firefox WebSocket connection warnings during page load\n      if (\n        typeof message === 'string' &&\n        (message.includes(\"Firefox can't establish a connection\") ||\n          message.includes(\n            'connection was interrupted while the page was loading'\n          ))\n      ) {\n        return; // Suppress these warnings\n      }\n\n      // Log all other warnings normally\n      originalWarn.apply(console, args);\n    };\n  }\n};\n","import { authService } from '../services/authService';\nimport { environment } from '../config/environment';\n\n// Global fetch interceptor to add authorization headers\nconst originalFetch = window.fetch;\n\nwindow.fetch = async function (input: RequestInfo | URL, init?: RequestInit) {\n  // Only add auth headers for your API requests\n  if (\n    typeof input === 'string' &&\n    (input.includes(environment.api.url) || input.includes('localhost'))\n  ) {\n    try {\n      let token = authService.getAccessToken();\n\n      // If no token, only try to refresh if user is authenticated\n      if (!token && authService.isAuthenticated()) {\n        console.log(\n          '🔄 No token found but user is authenticated, attempting to refresh session...'\n        );\n        const refreshResult = await authService.refreshSession();\n        if (refreshResult.success) {\n          token = authService.getAccessToken();\n          console.log('✅ Session refreshed, new token obtained');\n        }\n      }\n\n      if (token) {\n        init = init || {};\n        init.headers = {\n          ...init.headers,\n          Authorization: `Bearer ${token}`,\n        };\n      }\n    } catch (error) {\n      console.log('🔓 Public access - authentication not available');\n    }\n  }\n\n  return originalFetch(input, init);\n};\n","// ../../node_modules/.pnpm/solid-js@1.9.7/node_modules/solid-js/dist/solid.js\nvar sharedConfig = {\n  context: void 0,\n  registry: void 0,\n  effects: void 0,\n  done: false,\n  getContextId() {\n    return getContextId(this.context.count);\n  },\n  getNextContextId() {\n    return getContextId(this.context.count++);\n  }\n};\nfunction getContextId(count) {\n  const num = String(count), len = num.length - 1;\n  return sharedConfig.context.id + (len ? String.fromCharCode(96 + len) : \"\") + num;\n}\nfunction setHydrateContext(context) {\n  sharedConfig.context = context;\n}\nfunction nextHydrateContext() {\n  return {\n    ...sharedConfig.context,\n    id: sharedConfig.getNextContextId(),\n    count: 0\n  };\n}\nvar IS_DEV = false;\nvar equalFn = (a, b) => a === b;\nvar $PROXY = Symbol(\"solid-proxy\");\nvar SUPPORTS_PROXY = typeof Proxy === \"function\";\nvar $TRACK = Symbol(\"solid-track\");\nvar signalOptions = {\n  equals: equalFn\n};\nvar ERROR = null;\nvar runEffects = runQueue;\nvar STALE = 1;\nvar PENDING = 2;\nvar UNOWNED = {\n  owned: null,\n  cleanups: null,\n  context: null,\n  owner: null\n};\nvar NO_INIT = {};\nvar Owner = null;\nvar Transition = null;\nvar Scheduler = null;\nvar ExternalSourceConfig = null;\nvar Listener = null;\nvar Updates = null;\nvar Effects = null;\nvar ExecCount = 0;\nfunction createRoot(fn, detachedOwner) {\n  const listener = Listener, owner = Owner, unowned = fn.length === 0, current = detachedOwner === void 0 ? owner : detachedOwner, root = unowned ? UNOWNED : {\n    owned: null,\n    cleanups: null,\n    context: current ? current.context : null,\n    owner: current\n  }, updateFn = unowned ? fn : () => fn(() => untrack(() => cleanNode(root)));\n  Owner = root;\n  Listener = null;\n  try {\n    return runUpdates(updateFn, true);\n  } finally {\n    Listener = listener;\n    Owner = owner;\n  }\n}\nfunction createSignal(value, options) {\n  options = options ? Object.assign({}, signalOptions, options) : signalOptions;\n  const s = {\n    value,\n    observers: null,\n    observerSlots: null,\n    comparator: options.equals || void 0\n  };\n  const setter = (value2) => {\n    if (typeof value2 === \"function\") {\n      if (Transition && Transition.running && Transition.sources.has(s)) value2 = value2(s.tValue);\n      else value2 = value2(s.value);\n    }\n    return writeSignal(s, value2);\n  };\n  return [readSignal.bind(s), setter];\n}\nfunction createComputed(fn, value, options) {\n  const c = createComputation(fn, value, true, STALE);\n  if (Scheduler && Transition && Transition.running) Updates.push(c);\n  else updateComputation(c);\n}\nfunction createRenderEffect(fn, value, options) {\n  const c = createComputation(fn, value, false, STALE);\n  if (Scheduler && Transition && Transition.running) Updates.push(c);\n  else updateComputation(c);\n}\nfunction createEffect(fn, value, options) {\n  runEffects = runUserEffects;\n  const c = createComputation(fn, value, false, STALE), s = SuspenseContext && useContext(SuspenseContext);\n  if (s) c.suspense = s;\n  if (!options || !options.render) c.user = true;\n  Effects ? Effects.push(c) : updateComputation(c);\n}\nfunction createMemo(fn, value, options) {\n  options = options ? Object.assign({}, signalOptions, options) : signalOptions;\n  const c = createComputation(fn, value, true, 0);\n  c.observers = null;\n  c.observerSlots = null;\n  c.comparator = options.equals || void 0;\n  if (Scheduler && Transition && Transition.running) {\n    c.tState = STALE;\n    Updates.push(c);\n  } else updateComputation(c);\n  return readSignal.bind(c);\n}\nfunction isPromise(v) {\n  return v && typeof v === \"object\" && \"then\" in v;\n}\nfunction createResource(pSource, pFetcher, pOptions) {\n  let source;\n  let fetcher;\n  let options;\n  {\n    source = true;\n    fetcher = pSource;\n    options = {};\n  }\n  let pr = null, initP = NO_INIT, id = null, loadedUnderTransition = false, scheduled = false, resolved = \"initialValue\" in options, dynamic = typeof source === \"function\" && createMemo(source);\n  const contexts = /* @__PURE__ */ new Set(), [value, setValue] = (options.storage || createSignal)(options.initialValue), [error, setError] = createSignal(void 0), [track, trigger] = createSignal(void 0, {\n    equals: false\n  }), [state, setState] = createSignal(resolved ? \"ready\" : \"unresolved\");\n  if (sharedConfig.context) {\n    id = sharedConfig.getNextContextId();\n    if (options.ssrLoadFrom === \"initial\") initP = options.initialValue;\n    else if (sharedConfig.load && sharedConfig.has(id)) initP = sharedConfig.load(id);\n  }\n  function loadEnd(p, v, error2, key) {\n    if (pr === p) {\n      pr = null;\n      key !== void 0 && (resolved = true);\n      if ((p === initP || v === initP) && options.onHydrated) queueMicrotask(() => options.onHydrated(key, {\n        value: v\n      }));\n      initP = NO_INIT;\n      if (Transition && p && loadedUnderTransition) {\n        Transition.promises.delete(p);\n        loadedUnderTransition = false;\n        runUpdates(() => {\n          Transition.running = true;\n          completeLoad(v, error2);\n        }, false);\n      } else completeLoad(v, error2);\n    }\n    return v;\n  }\n  function completeLoad(v, err) {\n    runUpdates(() => {\n      if (err === void 0) setValue(() => v);\n      setState(err !== void 0 ? \"errored\" : resolved ? \"ready\" : \"unresolved\");\n      setError(err);\n      for (const c of contexts.keys()) c.decrement();\n      contexts.clear();\n    }, false);\n  }\n  function read() {\n    const c = SuspenseContext && useContext(SuspenseContext), v = value(), err = error();\n    if (err !== void 0 && !pr) throw err;\n    if (Listener && !Listener.user && c) {\n      createComputed(() => {\n        track();\n        if (pr) {\n          if (c.resolved && Transition && loadedUnderTransition) Transition.promises.add(pr);\n          else if (!contexts.has(c)) {\n            c.increment();\n            contexts.add(c);\n          }\n        }\n      });\n    }\n    return v;\n  }\n  function load(refetching = true) {\n    if (refetching !== false && scheduled) return;\n    scheduled = false;\n    const lookup = dynamic ? dynamic() : source;\n    loadedUnderTransition = Transition && Transition.running;\n    if (lookup == null || lookup === false) {\n      loadEnd(pr, untrack(value));\n      return;\n    }\n    if (Transition && pr) Transition.promises.delete(pr);\n    let error2;\n    const p = initP !== NO_INIT ? initP : untrack(() => {\n      try {\n        return fetcher(lookup, {\n          value: value(),\n          refetching\n        });\n      } catch (fetcherError) {\n        error2 = fetcherError;\n      }\n    });\n    if (error2 !== void 0) {\n      loadEnd(pr, void 0, castError(error2), lookup);\n      return;\n    } else if (!isPromise(p)) {\n      loadEnd(pr, p, void 0, lookup);\n      return p;\n    }\n    pr = p;\n    if (\"v\" in p) {\n      if (p.s === 1) loadEnd(pr, p.v, void 0, lookup);\n      else loadEnd(pr, void 0, castError(p.v), lookup);\n      return p;\n    }\n    scheduled = true;\n    queueMicrotask(() => scheduled = false);\n    runUpdates(() => {\n      setState(resolved ? \"refreshing\" : \"pending\");\n      trigger();\n    }, false);\n    return p.then((v) => loadEnd(p, v, void 0, lookup), (e) => loadEnd(p, void 0, castError(e), lookup));\n  }\n  Object.defineProperties(read, {\n    state: {\n      get: () => state()\n    },\n    error: {\n      get: () => error()\n    },\n    loading: {\n      get() {\n        const s = state();\n        return s === \"pending\" || s === \"refreshing\";\n      }\n    },\n    latest: {\n      get() {\n        if (!resolved) return read();\n        const err = error();\n        if (err && !pr) throw err;\n        return value();\n      }\n    }\n  });\n  let owner = Owner;\n  if (dynamic) createComputed(() => (owner = Owner, load(false)));\n  else load(false);\n  return [read, {\n    refetch: (info) => runWithOwner(owner, () => load(info)),\n    mutate: setValue\n  }];\n}\nfunction batch(fn) {\n  return runUpdates(fn, false);\n}\nfunction untrack(fn) {\n  if (!ExternalSourceConfig && Listener === null) return fn();\n  const listener = Listener;\n  Listener = null;\n  try {\n    if (ExternalSourceConfig) return ExternalSourceConfig.untrack(fn);\n    return fn();\n  } finally {\n    Listener = listener;\n  }\n}\nfunction on(deps, fn, options) {\n  const isArray3 = Array.isArray(deps);\n  let prevInput;\n  let defer = options && options.defer;\n  return (prevValue) => {\n    let input;\n    if (isArray3) {\n      input = Array(deps.length);\n      for (let i = 0; i < deps.length; i++) input[i] = deps[i]();\n    } else input = deps();\n    if (defer) {\n      defer = false;\n      return prevValue;\n    }\n    const result = untrack(() => fn(input, prevInput, prevValue));\n    prevInput = input;\n    return result;\n  };\n}\nfunction onMount(fn) {\n  createEffect(() => untrack(fn));\n}\nfunction onCleanup(fn) {\n  if (Owner === null) ;\n  else if (Owner.cleanups === null) Owner.cleanups = [fn];\n  else Owner.cleanups.push(fn);\n  return fn;\n}\nfunction getOwner() {\n  return Owner;\n}\nfunction runWithOwner(o, fn) {\n  const prev = Owner;\n  const prevListener = Listener;\n  Owner = o;\n  Listener = null;\n  try {\n    return runUpdates(fn, true);\n  } catch (err) {\n    handleError(err);\n  } finally {\n    Owner = prev;\n    Listener = prevListener;\n  }\n}\nfunction startTransition(fn) {\n  if (Transition && Transition.running) {\n    fn();\n    return Transition.done;\n  }\n  const l = Listener;\n  const o = Owner;\n  return Promise.resolve().then(() => {\n    Listener = l;\n    Owner = o;\n    let t;\n    if (Scheduler || SuspenseContext) {\n      t = Transition || (Transition = {\n        sources: /* @__PURE__ */ new Set(),\n        effects: [],\n        promises: /* @__PURE__ */ new Set(),\n        disposed: /* @__PURE__ */ new Set(),\n        queue: /* @__PURE__ */ new Set(),\n        running: true\n      });\n      t.done || (t.done = new Promise((res) => t.resolve = res));\n      t.running = true;\n    }\n    runUpdates(fn, false);\n    Listener = Owner = null;\n    return t ? t.done : void 0;\n  });\n}\nvar [transPending, setTransPending] = /* @__PURE__ */ createSignal(false);\nfunction useTransition() {\n  return [transPending, startTransition];\n}\nfunction createContext(defaultValue, options) {\n  const id = Symbol(\"context\");\n  return {\n    id,\n    Provider: createProvider(id),\n    defaultValue\n  };\n}\nfunction useContext(context) {\n  let value;\n  return Owner && Owner.context && (value = Owner.context[context.id]) !== void 0 ? value : context.defaultValue;\n}\nfunction children(fn) {\n  const children2 = createMemo(fn);\n  const memo2 = createMemo(() => resolveChildren(children2()));\n  memo2.toArray = () => {\n    const c = memo2();\n    return Array.isArray(c) ? c : c != null ? [c] : [];\n  };\n  return memo2;\n}\nvar SuspenseContext;\nfunction readSignal() {\n  const runningTransition = Transition && Transition.running;\n  if (this.sources && (runningTransition ? this.tState : this.state)) {\n    if ((runningTransition ? this.tState : this.state) === STALE) updateComputation(this);\n    else {\n      const updates = Updates;\n      Updates = null;\n      runUpdates(() => lookUpstream(this), false);\n      Updates = updates;\n    }\n  }\n  if (Listener) {\n    const sSlot = this.observers ? this.observers.length : 0;\n    if (!Listener.sources) {\n      Listener.sources = [this];\n      Listener.sourceSlots = [sSlot];\n    } else {\n      Listener.sources.push(this);\n      Listener.sourceSlots.push(sSlot);\n    }\n    if (!this.observers) {\n      this.observers = [Listener];\n      this.observerSlots = [Listener.sources.length - 1];\n    } else {\n      this.observers.push(Listener);\n      this.observerSlots.push(Listener.sources.length - 1);\n    }\n  }\n  if (runningTransition && Transition.sources.has(this)) return this.tValue;\n  return this.value;\n}\nfunction writeSignal(node, value, isComp) {\n  let current = Transition && Transition.running && Transition.sources.has(node) ? node.tValue : node.value;\n  if (!node.comparator || !node.comparator(current, value)) {\n    if (Transition) {\n      const TransitionRunning = Transition.running;\n      if (TransitionRunning || !isComp && Transition.sources.has(node)) {\n        Transition.sources.add(node);\n        node.tValue = value;\n      }\n      if (!TransitionRunning) node.value = value;\n    } else node.value = value;\n    if (node.observers && node.observers.length) {\n      runUpdates(() => {\n        for (let i = 0; i < node.observers.length; i += 1) {\n          const o = node.observers[i];\n          const TransitionRunning = Transition && Transition.running;\n          if (TransitionRunning && Transition.disposed.has(o)) continue;\n          if (TransitionRunning ? !o.tState : !o.state) {\n            if (o.pure) Updates.push(o);\n            else Effects.push(o);\n            if (o.observers) markDownstream(o);\n          }\n          if (!TransitionRunning) o.state = STALE;\n          else o.tState = STALE;\n        }\n        if (Updates.length > 1e6) {\n          Updates = [];\n          if (IS_DEV) ;\n          throw new Error();\n        }\n      }, false);\n    }\n  }\n  return value;\n}\nfunction updateComputation(node) {\n  if (!node.fn) return;\n  cleanNode(node);\n  const time = ExecCount;\n  runComputation(node, Transition && Transition.running && Transition.sources.has(node) ? node.tValue : node.value, time);\n  if (Transition && !Transition.running && Transition.sources.has(node)) {\n    queueMicrotask(() => {\n      runUpdates(() => {\n        Transition && (Transition.running = true);\n        Listener = Owner = node;\n        runComputation(node, node.tValue, time);\n        Listener = Owner = null;\n      }, false);\n    });\n  }\n}\nfunction runComputation(node, value, time) {\n  let nextValue;\n  const owner = Owner, listener = Listener;\n  Listener = Owner = node;\n  try {\n    nextValue = node.fn(value);\n  } catch (err) {\n    if (node.pure) {\n      if (Transition && Transition.running) {\n        node.tState = STALE;\n        node.tOwned && node.tOwned.forEach(cleanNode);\n        node.tOwned = void 0;\n      } else {\n        node.state = STALE;\n        node.owned && node.owned.forEach(cleanNode);\n        node.owned = null;\n      }\n    }\n    node.updatedAt = time + 1;\n    return handleError(err);\n  } finally {\n    Listener = listener;\n    Owner = owner;\n  }\n  if (!node.updatedAt || node.updatedAt <= time) {\n    if (node.updatedAt != null && \"observers\" in node) {\n      writeSignal(node, nextValue, true);\n    } else if (Transition && Transition.running && node.pure) {\n      Transition.sources.add(node);\n      node.tValue = nextValue;\n    } else node.value = nextValue;\n    node.updatedAt = time;\n  }\n}\nfunction createComputation(fn, init, pure, state = STALE, options) {\n  const c = {\n    fn,\n    state,\n    updatedAt: null,\n    owned: null,\n    sources: null,\n    sourceSlots: null,\n    cleanups: null,\n    value: init,\n    owner: Owner,\n    context: Owner ? Owner.context : null,\n    pure\n  };\n  if (Transition && Transition.running) {\n    c.state = 0;\n    c.tState = state;\n  }\n  if (Owner === null) ;\n  else if (Owner !== UNOWNED) {\n    if (Transition && Transition.running && Owner.pure) {\n      if (!Owner.tOwned) Owner.tOwned = [c];\n      else Owner.tOwned.push(c);\n    } else {\n      if (!Owner.owned) Owner.owned = [c];\n      else Owner.owned.push(c);\n    }\n  }\n  if (ExternalSourceConfig && c.fn) {\n    const [track, trigger] = createSignal(void 0, {\n      equals: false\n    });\n    const ordinary = ExternalSourceConfig.factory(c.fn, trigger);\n    onCleanup(() => ordinary.dispose());\n    const triggerInTransition = () => startTransition(trigger).then(() => inTransition.dispose());\n    const inTransition = ExternalSourceConfig.factory(c.fn, triggerInTransition);\n    c.fn = (x) => {\n      track();\n      return Transition && Transition.running ? inTransition.track(x) : ordinary.track(x);\n    };\n  }\n  return c;\n}\nfunction runTop(node) {\n  const runningTransition = Transition && Transition.running;\n  if ((runningTransition ? node.tState : node.state) === 0) return;\n  if ((runningTransition ? node.tState : node.state) === PENDING) return lookUpstream(node);\n  if (node.suspense && untrack(node.suspense.inFallback)) return node.suspense.effects.push(node);\n  const ancestors = [node];\n  while ((node = node.owner) && (!node.updatedAt || node.updatedAt < ExecCount)) {\n    if (runningTransition && Transition.disposed.has(node)) return;\n    if (runningTransition ? node.tState : node.state) ancestors.push(node);\n  }\n  for (let i = ancestors.length - 1; i >= 0; i--) {\n    node = ancestors[i];\n    if (runningTransition) {\n      let top = node, prev = ancestors[i + 1];\n      while ((top = top.owner) && top !== prev) {\n        if (Transition.disposed.has(top)) return;\n      }\n    }\n    if ((runningTransition ? node.tState : node.state) === STALE) {\n      updateComputation(node);\n    } else if ((runningTransition ? node.tState : node.state) === PENDING) {\n      const updates = Updates;\n      Updates = null;\n      runUpdates(() => lookUpstream(node, ancestors[0]), false);\n      Updates = updates;\n    }\n  }\n}\nfunction runUpdates(fn, init) {\n  if (Updates) return fn();\n  let wait = false;\n  if (!init) Updates = [];\n  if (Effects) wait = true;\n  else Effects = [];\n  ExecCount++;\n  try {\n    const res = fn();\n    completeUpdates(wait);\n    return res;\n  } catch (err) {\n    if (!wait) Effects = null;\n    Updates = null;\n    handleError(err);\n  }\n}\nfunction completeUpdates(wait) {\n  if (Updates) {\n    if (Scheduler && Transition && Transition.running) scheduleQueue(Updates);\n    else runQueue(Updates);\n    Updates = null;\n  }\n  if (wait) return;\n  let res;\n  if (Transition) {\n    if (!Transition.promises.size && !Transition.queue.size) {\n      const sources = Transition.sources;\n      const disposed = Transition.disposed;\n      Effects.push.apply(Effects, Transition.effects);\n      res = Transition.resolve;\n      for (const e2 of Effects) {\n        \"tState\" in e2 && (e2.state = e2.tState);\n        delete e2.tState;\n      }\n      Transition = null;\n      runUpdates(() => {\n        for (const d of disposed) cleanNode(d);\n        for (const v of sources) {\n          v.value = v.tValue;\n          if (v.owned) {\n            for (let i = 0, len = v.owned.length; i < len; i++) cleanNode(v.owned[i]);\n          }\n          if (v.tOwned) v.owned = v.tOwned;\n          delete v.tValue;\n          delete v.tOwned;\n          v.tState = 0;\n        }\n        setTransPending(false);\n      }, false);\n    } else if (Transition.running) {\n      Transition.running = false;\n      Transition.effects.push.apply(Transition.effects, Effects);\n      Effects = null;\n      setTransPending(true);\n      return;\n    }\n  }\n  const e = Effects;\n  Effects = null;\n  if (e.length) runUpdates(() => runEffects(e), false);\n  if (res) res();\n}\nfunction runQueue(queue) {\n  for (let i = 0; i < queue.length; i++) runTop(queue[i]);\n}\nfunction scheduleQueue(queue) {\n  for (let i = 0; i < queue.length; i++) {\n    const item = queue[i];\n    const tasks = Transition.queue;\n    if (!tasks.has(item)) {\n      tasks.add(item);\n      Scheduler(() => {\n        tasks.delete(item);\n        runUpdates(() => {\n          Transition.running = true;\n          runTop(item);\n        }, false);\n        Transition && (Transition.running = false);\n      });\n    }\n  }\n}\nfunction runUserEffects(queue) {\n  let i, userLength = 0;\n  for (i = 0; i < queue.length; i++) {\n    const e = queue[i];\n    if (!e.user) runTop(e);\n    else queue[userLength++] = e;\n  }\n  if (sharedConfig.context) {\n    if (sharedConfig.count) {\n      sharedConfig.effects || (sharedConfig.effects = []);\n      sharedConfig.effects.push(...queue.slice(0, userLength));\n      return;\n    }\n    setHydrateContext();\n  }\n  if (sharedConfig.effects && (sharedConfig.done || !sharedConfig.count)) {\n    queue = [...sharedConfig.effects, ...queue];\n    userLength += sharedConfig.effects.length;\n    delete sharedConfig.effects;\n  }\n  for (i = 0; i < userLength; i++) runTop(queue[i]);\n}\nfunction lookUpstream(node, ignore) {\n  const runningTransition = Transition && Transition.running;\n  if (runningTransition) node.tState = 0;\n  else node.state = 0;\n  for (let i = 0; i < node.sources.length; i += 1) {\n    const source = node.sources[i];\n    if (source.sources) {\n      const state = runningTransition ? source.tState : source.state;\n      if (state === STALE) {\n        if (source !== ignore && (!source.updatedAt || source.updatedAt < ExecCount)) runTop(source);\n      } else if (state === PENDING) lookUpstream(source, ignore);\n    }\n  }\n}\nfunction markDownstream(node) {\n  const runningTransition = Transition && Transition.running;\n  for (let i = 0; i < node.observers.length; i += 1) {\n    const o = node.observers[i];\n    if (runningTransition ? !o.tState : !o.state) {\n      if (runningTransition) o.tState = PENDING;\n      else o.state = PENDING;\n      if (o.pure) Updates.push(o);\n      else Effects.push(o);\n      o.observers && markDownstream(o);\n    }\n  }\n}\nfunction cleanNode(node) {\n  let i;\n  if (node.sources) {\n    while (node.sources.length) {\n      const source = node.sources.pop(), index = node.sourceSlots.pop(), obs = source.observers;\n      if (obs && obs.length) {\n        const n = obs.pop(), s = source.observerSlots.pop();\n        if (index < obs.length) {\n          n.sourceSlots[s] = index;\n          obs[index] = n;\n          source.observerSlots[index] = s;\n        }\n      }\n    }\n  }\n  if (node.tOwned) {\n    for (i = node.tOwned.length - 1; i >= 0; i--) cleanNode(node.tOwned[i]);\n    delete node.tOwned;\n  }\n  if (Transition && Transition.running && node.pure) {\n    reset(node, true);\n  } else if (node.owned) {\n    for (i = node.owned.length - 1; i >= 0; i--) cleanNode(node.owned[i]);\n    node.owned = null;\n  }\n  if (node.cleanups) {\n    for (i = node.cleanups.length - 1; i >= 0; i--) node.cleanups[i]();\n    node.cleanups = null;\n  }\n  if (Transition && Transition.running) node.tState = 0;\n  else node.state = 0;\n}\nfunction reset(node, top) {\n  if (!top) {\n    node.tState = 0;\n    Transition.disposed.add(node);\n  }\n  if (node.owned) {\n    for (let i = 0; i < node.owned.length; i++) reset(node.owned[i]);\n  }\n}\nfunction castError(err) {\n  if (err instanceof Error) return err;\n  return new Error(typeof err === \"string\" ? err : \"Unknown error\", {\n    cause: err\n  });\n}\nfunction runErrors(err, fns, owner) {\n  try {\n    for (const f of fns) f(err);\n  } catch (e) {\n    handleError(e, owner && owner.owner || null);\n  }\n}\nfunction handleError(err, owner = Owner) {\n  const fns = ERROR && owner && owner.context && owner.context[ERROR];\n  const error = castError(err);\n  if (!fns) throw error;\n  if (Effects) Effects.push({\n    fn() {\n      runErrors(error, fns, owner);\n    },\n    state: STALE\n  });\n  else runErrors(error, fns, owner);\n}\nfunction resolveChildren(children2) {\n  if (typeof children2 === \"function\" && !children2.length) return resolveChildren(children2());\n  if (Array.isArray(children2)) {\n    const results = [];\n    for (let i = 0; i < children2.length; i++) {\n      const result = resolveChildren(children2[i]);\n      Array.isArray(result) ? results.push.apply(results, result) : results.push(result);\n    }\n    return results;\n  }\n  return children2;\n}\nfunction createProvider(id, options) {\n  return function provider(props) {\n    let res;\n    createRenderEffect(() => res = untrack(() => {\n      Owner.context = {\n        ...Owner.context,\n        [id]: props.value\n      };\n      return children(() => props.children);\n    }), void 0);\n    return res;\n  };\n}\nvar FALLBACK = Symbol(\"fallback\");\nfunction dispose(d) {\n  for (let i = 0; i < d.length; i++) d[i]();\n}\nfunction mapArray(list, mapFn, options = {}) {\n  let items = [], mapped = [], disposers = [], len = 0, indexes = mapFn.length > 1 ? [] : null;\n  onCleanup(() => dispose(disposers));\n  return () => {\n    let newItems = list() || [], newLen = newItems.length, i, j;\n    newItems[$TRACK];\n    return untrack(() => {\n      let newIndices, newIndicesNext, temp, tempdisposers, tempIndexes, start, end, newEnd, item;\n      if (newLen === 0) {\n        if (len !== 0) {\n          dispose(disposers);\n          disposers = [];\n          items = [];\n          mapped = [];\n          len = 0;\n          indexes && (indexes = []);\n        }\n        if (options.fallback) {\n          items = [FALLBACK];\n          mapped[0] = createRoot((disposer) => {\n            disposers[0] = disposer;\n            return options.fallback();\n          });\n          len = 1;\n        }\n      } else if (len === 0) {\n        mapped = new Array(newLen);\n        for (j = 0; j < newLen; j++) {\n          items[j] = newItems[j];\n          mapped[j] = createRoot(mapper);\n        }\n        len = newLen;\n      } else {\n        temp = new Array(newLen);\n        tempdisposers = new Array(newLen);\n        indexes && (tempIndexes = new Array(newLen));\n        for (start = 0, end = Math.min(len, newLen); start < end && items[start] === newItems[start]; start++) ;\n        for (end = len - 1, newEnd = newLen - 1; end >= start && newEnd >= start && items[end] === newItems[newEnd]; end--, newEnd--) {\n          temp[newEnd] = mapped[end];\n          tempdisposers[newEnd] = disposers[end];\n          indexes && (tempIndexes[newEnd] = indexes[end]);\n        }\n        newIndices = /* @__PURE__ */ new Map();\n        newIndicesNext = new Array(newEnd + 1);\n        for (j = newEnd; j >= start; j--) {\n          item = newItems[j];\n          i = newIndices.get(item);\n          newIndicesNext[j] = i === void 0 ? -1 : i;\n          newIndices.set(item, j);\n        }\n        for (i = start; i <= end; i++) {\n          item = items[i];\n          j = newIndices.get(item);\n          if (j !== void 0 && j !== -1) {\n            temp[j] = mapped[i];\n            tempdisposers[j] = disposers[i];\n            indexes && (tempIndexes[j] = indexes[i]);\n            j = newIndicesNext[j];\n            newIndices.set(item, j);\n          } else disposers[i]();\n        }\n        for (j = start; j < newLen; j++) {\n          if (j in temp) {\n            mapped[j] = temp[j];\n            disposers[j] = tempdisposers[j];\n            if (indexes) {\n              indexes[j] = tempIndexes[j];\n              indexes[j](j);\n            }\n          } else mapped[j] = createRoot(mapper);\n        }\n        mapped = mapped.slice(0, len = newLen);\n        items = newItems.slice(0);\n      }\n      return mapped;\n    });\n    function mapper(disposer) {\n      disposers[j] = disposer;\n      if (indexes) {\n        const [s, set] = createSignal(j);\n        indexes[j] = set;\n        return mapFn(newItems[j], s);\n      }\n      return mapFn(newItems[j]);\n    }\n  };\n}\nfunction indexArray(list, mapFn, options = {}) {\n  let items = [], mapped = [], disposers = [], signals = [], len = 0, i;\n  onCleanup(() => dispose(disposers));\n  return () => {\n    const newItems = list() || [], newLen = newItems.length;\n    newItems[$TRACK];\n    return untrack(() => {\n      if (newLen === 0) {\n        if (len !== 0) {\n          dispose(disposers);\n          disposers = [];\n          items = [];\n          mapped = [];\n          len = 0;\n          signals = [];\n        }\n        if (options.fallback) {\n          items = [FALLBACK];\n          mapped[0] = createRoot((disposer) => {\n            disposers[0] = disposer;\n            return options.fallback();\n          });\n          len = 1;\n        }\n        return mapped;\n      }\n      if (items[0] === FALLBACK) {\n        disposers[0]();\n        disposers = [];\n        items = [];\n        mapped = [];\n        len = 0;\n      }\n      for (i = 0; i < newLen; i++) {\n        if (i < items.length && items[i] !== newItems[i]) {\n          signals[i](() => newItems[i]);\n        } else if (i >= items.length) {\n          mapped[i] = createRoot(mapper);\n        }\n      }\n      for (; i < items.length; i++) {\n        disposers[i]();\n      }\n      len = signals.length = disposers.length = newLen;\n      items = newItems.slice(0);\n      return mapped = mapped.slice(0, len);\n    });\n    function mapper(disposer) {\n      disposers[i] = disposer;\n      const [s, set] = createSignal(newItems[i]);\n      signals[i] = set;\n      return mapFn(s, i);\n    }\n  };\n}\nvar hydrationEnabled = false;\nfunction createComponent(Comp, props) {\n  if (hydrationEnabled) {\n    if (sharedConfig.context) {\n      const c = sharedConfig.context;\n      setHydrateContext(nextHydrateContext());\n      const r = untrack(() => Comp(props || {}));\n      setHydrateContext(c);\n      return r;\n    }\n  }\n  return untrack(() => Comp(props || {}));\n}\nfunction trueFn() {\n  return true;\n}\nvar propTraps = {\n  get(_, property, receiver) {\n    if (property === $PROXY) return receiver;\n    return _.get(property);\n  },\n  has(_, property) {\n    if (property === $PROXY) return true;\n    return _.has(property);\n  },\n  set: trueFn,\n  deleteProperty: trueFn,\n  getOwnPropertyDescriptor(_, property) {\n    return {\n      configurable: true,\n      enumerable: true,\n      get() {\n        return _.get(property);\n      },\n      set: trueFn,\n      deleteProperty: trueFn\n    };\n  },\n  ownKeys(_) {\n    return _.keys();\n  }\n};\nfunction resolveSource(s) {\n  return !(s = typeof s === \"function\" ? s() : s) ? {} : s;\n}\nfunction resolveSources() {\n  for (let i = 0, length = this.length; i < length; ++i) {\n    const v = this[i]();\n    if (v !== void 0) return v;\n  }\n}\nfunction mergeProps(...sources) {\n  let proxy = false;\n  for (let i = 0; i < sources.length; i++) {\n    const s = sources[i];\n    proxy = proxy || !!s && $PROXY in s;\n    sources[i] = typeof s === \"function\" ? (proxy = true, createMemo(s)) : s;\n  }\n  if (SUPPORTS_PROXY && proxy) {\n    return new Proxy({\n      get(property) {\n        for (let i = sources.length - 1; i >= 0; i--) {\n          const v = resolveSource(sources[i])[property];\n          if (v !== void 0) return v;\n        }\n      },\n      has(property) {\n        for (let i = sources.length - 1; i >= 0; i--) {\n          if (property in resolveSource(sources[i])) return true;\n        }\n        return false;\n      },\n      keys() {\n        const keys = [];\n        for (let i = 0; i < sources.length; i++) keys.push(...Object.keys(resolveSource(sources[i])));\n        return [...new Set(keys)];\n      }\n    }, propTraps);\n  }\n  const sourcesMap = {};\n  const defined = /* @__PURE__ */ Object.create(null);\n  for (let i = sources.length - 1; i >= 0; i--) {\n    const source = sources[i];\n    if (!source) continue;\n    const sourceKeys = Object.getOwnPropertyNames(source);\n    for (let i2 = sourceKeys.length - 1; i2 >= 0; i2--) {\n      const key = sourceKeys[i2];\n      if (key === \"__proto__\" || key === \"constructor\") continue;\n      const desc = Object.getOwnPropertyDescriptor(source, key);\n      if (!defined[key]) {\n        defined[key] = desc.get ? {\n          enumerable: true,\n          configurable: true,\n          get: resolveSources.bind(sourcesMap[key] = [desc.get.bind(source)])\n        } : desc.value !== void 0 ? desc : void 0;\n      } else {\n        const sources2 = sourcesMap[key];\n        if (sources2) {\n          if (desc.get) sources2.push(desc.get.bind(source));\n          else if (desc.value !== void 0) sources2.push(() => desc.value);\n        }\n      }\n    }\n  }\n  const target = {};\n  const definedKeys = Object.keys(defined);\n  for (let i = definedKeys.length - 1; i >= 0; i--) {\n    const key = definedKeys[i], desc = defined[key];\n    if (desc && desc.get) Object.defineProperty(target, key, desc);\n    else target[key] = desc ? desc.value : void 0;\n  }\n  return target;\n}\nfunction splitProps(props, ...keys) {\n  if (SUPPORTS_PROXY && $PROXY in props) {\n    const blocked = new Set(keys.length > 1 ? keys.flat() : keys[0]);\n    const res = keys.map((k) => {\n      return new Proxy({\n        get(property) {\n          return k.includes(property) ? props[property] : void 0;\n        },\n        has(property) {\n          return k.includes(property) && property in props;\n        },\n        keys() {\n          return k.filter((property) => property in props);\n        }\n      }, propTraps);\n    });\n    res.push(new Proxy({\n      get(property) {\n        return blocked.has(property) ? void 0 : props[property];\n      },\n      has(property) {\n        return blocked.has(property) ? false : property in props;\n      },\n      keys() {\n        return Object.keys(props).filter((k) => !blocked.has(k));\n      }\n    }, propTraps));\n    return res;\n  }\n  const otherObject = {};\n  const objects = keys.map(() => ({}));\n  for (const propName of Object.getOwnPropertyNames(props)) {\n    const desc = Object.getOwnPropertyDescriptor(props, propName);\n    const isDefaultDesc = !desc.get && !desc.set && desc.enumerable && desc.writable && desc.configurable;\n    let blocked = false;\n    let objectIndex = 0;\n    for (const k of keys) {\n      if (k.includes(propName)) {\n        blocked = true;\n        isDefaultDesc ? objects[objectIndex][propName] = desc.value : Object.defineProperty(objects[objectIndex], propName, desc);\n      }\n      ++objectIndex;\n    }\n    if (!blocked) {\n      isDefaultDesc ? otherObject[propName] = desc.value : Object.defineProperty(otherObject, propName, desc);\n    }\n  }\n  return [...objects, otherObject];\n}\nfunction lazy(fn) {\n  let comp;\n  let p;\n  const wrap = (props) => {\n    const ctx = sharedConfig.context;\n    if (ctx) {\n      const [s, set] = createSignal();\n      sharedConfig.count || (sharedConfig.count = 0);\n      sharedConfig.count++;\n      (p || (p = fn())).then((mod) => {\n        !sharedConfig.done && setHydrateContext(ctx);\n        sharedConfig.count--;\n        set(() => mod.default);\n        setHydrateContext();\n      });\n      comp = s;\n    } else if (!comp) {\n      const [s] = createResource(() => (p || (p = fn())).then((mod) => mod.default));\n      comp = s;\n    }\n    let Comp;\n    return createMemo(() => (Comp = comp()) ? untrack(() => {\n      if (IS_DEV) ;\n      if (!ctx || sharedConfig.done) return Comp(props);\n      const c = sharedConfig.context;\n      setHydrateContext(ctx);\n      const r = Comp(props);\n      setHydrateContext(c);\n      return r;\n    }) : \"\");\n  };\n  wrap.preload = () => p || ((p = fn()).then((mod) => comp = () => mod.default), p);\n  return wrap;\n}\nvar counter = 0;\nfunction createUniqueId() {\n  const ctx = sharedConfig.context;\n  return ctx ? sharedConfig.getNextContextId() : `cl-${counter++}`;\n}\nvar narrowedError = (name) => `Stale read from <${name}>.`;\nfunction For(props) {\n  const fallback = \"fallback\" in props && {\n    fallback: () => props.fallback\n  };\n  return createMemo(mapArray(() => props.each, props.children, fallback || void 0));\n}\nfunction Index(props) {\n  const fallback = \"fallback\" in props && {\n    fallback: () => props.fallback\n  };\n  return createMemo(indexArray(() => props.each, props.children, fallback || void 0));\n}\nfunction Show(props) {\n  const keyed = props.keyed;\n  const conditionValue = createMemo(() => props.when, void 0, void 0);\n  const condition = keyed ? conditionValue : createMemo(conditionValue, void 0, {\n    equals: (a, b) => !a === !b\n  });\n  return createMemo(() => {\n    const c = condition();\n    if (c) {\n      const child = props.children;\n      const fn = typeof child === \"function\" && child.length > 0;\n      return fn ? untrack(() => child(keyed ? c : () => {\n        if (!untrack(condition)) throw narrowedError(\"Show\");\n        return conditionValue();\n      })) : child;\n    }\n    return props.fallback;\n  }, void 0, void 0);\n}\nfunction Switch(props) {\n  const chs = children(() => props.children);\n  const switchFunc = createMemo(() => {\n    const ch = chs();\n    const mps = Array.isArray(ch) ? ch : [ch];\n    let func = () => void 0;\n    for (let i = 0; i < mps.length; i++) {\n      const index = i;\n      const mp = mps[i];\n      const prevFunc = func;\n      const conditionValue = createMemo(() => prevFunc() ? void 0 : mp.when, void 0, void 0);\n      const condition = mp.keyed ? conditionValue : createMemo(conditionValue, void 0, {\n        equals: (a, b) => !a === !b\n      });\n      func = () => prevFunc() || (condition() ? [index, conditionValue, mp] : void 0);\n    }\n    return func;\n  });\n  return createMemo(() => {\n    const sel = switchFunc()();\n    if (!sel) return props.fallback;\n    const [index, conditionValue, mp] = sel;\n    const child = mp.children;\n    const fn = typeof child === \"function\" && child.length > 0;\n    return fn ? untrack(() => child(mp.keyed ? conditionValue() : () => {\n      if (untrack(switchFunc)()?.[0] !== index) throw narrowedError(\"Match\");\n      return conditionValue();\n    })) : child;\n  }, void 0, void 0);\n}\nfunction Match(props) {\n  return props;\n}\nvar DEV = void 0;\n\n// ../../node_modules/.pnpm/solid-js@1.9.7/node_modules/solid-js/web/dist/web.js\nvar booleans = [\"allowfullscreen\", \"async\", \"autofocus\", \"autoplay\", \"checked\", \"controls\", \"default\", \"disabled\", \"formnovalidate\", \"hidden\", \"indeterminate\", \"inert\", \"ismap\", \"loop\", \"multiple\", \"muted\", \"nomodule\", \"novalidate\", \"open\", \"playsinline\", \"readonly\", \"required\", \"reversed\", \"seamless\", \"selected\"];\nvar Properties = /* @__PURE__ */ new Set([\"className\", \"value\", \"readOnly\", \"noValidate\", \"formNoValidate\", \"isMap\", \"noModule\", \"playsInline\", ...booleans]);\nvar ChildProperties = /* @__PURE__ */ new Set([\"innerHTML\", \"textContent\", \"innerText\", \"children\"]);\nvar Aliases = /* @__PURE__ */ Object.assign(/* @__PURE__ */ Object.create(null), {\n  className: \"class\",\n  htmlFor: \"for\"\n});\nvar PropAliases = /* @__PURE__ */ Object.assign(/* @__PURE__ */ Object.create(null), {\n  class: \"className\",\n  novalidate: {\n    $: \"noValidate\",\n    FORM: 1\n  },\n  formnovalidate: {\n    $: \"formNoValidate\",\n    BUTTON: 1,\n    INPUT: 1\n  },\n  ismap: {\n    $: \"isMap\",\n    IMG: 1\n  },\n  nomodule: {\n    $: \"noModule\",\n    SCRIPT: 1\n  },\n  playsinline: {\n    $: \"playsInline\",\n    VIDEO: 1\n  },\n  readonly: {\n    $: \"readOnly\",\n    INPUT: 1,\n    TEXTAREA: 1\n  }\n});\nfunction getPropAlias(prop, tagName) {\n  const a = PropAliases[prop];\n  return typeof a === \"object\" ? a[tagName] ? a[\"$\"] : void 0 : a;\n}\nvar DelegatedEvents = /* @__PURE__ */ new Set([\"beforeinput\", \"click\", \"dblclick\", \"contextmenu\", \"focusin\", \"focusout\", \"input\", \"keydown\", \"keyup\", \"mousedown\", \"mousemove\", \"mouseout\", \"mouseover\", \"mouseup\", \"pointerdown\", \"pointermove\", \"pointerout\", \"pointerover\", \"pointerup\", \"touchend\", \"touchmove\", \"touchstart\"]);\nvar SVGElements = /* @__PURE__ */ new Set([\n  \"altGlyph\",\n  \"altGlyphDef\",\n  \"altGlyphItem\",\n  \"animate\",\n  \"animateColor\",\n  \"animateMotion\",\n  \"animateTransform\",\n  \"circle\",\n  \"clipPath\",\n  \"color-profile\",\n  \"cursor\",\n  \"defs\",\n  \"desc\",\n  \"ellipse\",\n  \"feBlend\",\n  \"feColorMatrix\",\n  \"feComponentTransfer\",\n  \"feComposite\",\n  \"feConvolveMatrix\",\n  \"feDiffuseLighting\",\n  \"feDisplacementMap\",\n  \"feDistantLight\",\n  \"feDropShadow\",\n  \"feFlood\",\n  \"feFuncA\",\n  \"feFuncB\",\n  \"feFuncG\",\n  \"feFuncR\",\n  \"feGaussianBlur\",\n  \"feImage\",\n  \"feMerge\",\n  \"feMergeNode\",\n  \"feMorphology\",\n  \"feOffset\",\n  \"fePointLight\",\n  \"feSpecularLighting\",\n  \"feSpotLight\",\n  \"feTile\",\n  \"feTurbulence\",\n  \"filter\",\n  \"font\",\n  \"font-face\",\n  \"font-face-format\",\n  \"font-face-name\",\n  \"font-face-src\",\n  \"font-face-uri\",\n  \"foreignObject\",\n  \"g\",\n  \"glyph\",\n  \"glyphRef\",\n  \"hkern\",\n  \"image\",\n  \"line\",\n  \"linearGradient\",\n  \"marker\",\n  \"mask\",\n  \"metadata\",\n  \"missing-glyph\",\n  \"mpath\",\n  \"path\",\n  \"pattern\",\n  \"polygon\",\n  \"polyline\",\n  \"radialGradient\",\n  \"rect\",\n  \"set\",\n  \"stop\",\n  \"svg\",\n  \"switch\",\n  \"symbol\",\n  \"text\",\n  \"textPath\",\n  \"tref\",\n  \"tspan\",\n  \"use\",\n  \"view\",\n  \"vkern\"\n]);\nvar SVGNamespace = {\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\"\n};\nvar memo = (fn) => createMemo(() => fn());\nfunction reconcileArrays(parentNode, a, b) {\n  let bLength = b.length, aEnd = a.length, bEnd = bLength, aStart = 0, bStart = 0, after = a[aEnd - 1].nextSibling, map = null;\n  while (aStart < aEnd || bStart < bEnd) {\n    if (a[aStart] === b[bStart]) {\n      aStart++;\n      bStart++;\n      continue;\n    }\n    while (a[aEnd - 1] === b[bEnd - 1]) {\n      aEnd--;\n      bEnd--;\n    }\n    if (aEnd === aStart) {\n      const node = bEnd < bLength ? bStart ? b[bStart - 1].nextSibling : b[bEnd - bStart] : after;\n      while (bStart < bEnd) parentNode.insertBefore(b[bStart++], node);\n    } else if (bEnd === bStart) {\n      while (aStart < aEnd) {\n        if (!map || !map.has(a[aStart])) a[aStart].remove();\n        aStart++;\n      }\n    } else if (a[aStart] === b[bEnd - 1] && b[bStart] === a[aEnd - 1]) {\n      const node = a[--aEnd].nextSibling;\n      parentNode.insertBefore(b[bStart++], a[aStart++].nextSibling);\n      parentNode.insertBefore(b[--bEnd], node);\n      a[aEnd] = b[bEnd];\n    } else {\n      if (!map) {\n        map = /* @__PURE__ */ new Map();\n        let i = bStart;\n        while (i < bEnd) map.set(b[i], i++);\n      }\n      const index = map.get(a[aStart]);\n      if (index != null) {\n        if (bStart < index && index < bEnd) {\n          let i = aStart, sequence = 1, t;\n          while (++i < aEnd && i < bEnd) {\n            if ((t = map.get(a[i])) == null || t !== index + sequence) break;\n            sequence++;\n          }\n          if (sequence > index - bStart) {\n            const node = a[aStart];\n            while (bStart < index) parentNode.insertBefore(b[bStart++], node);\n          } else parentNode.replaceChild(b[bStart++], a[aStart++]);\n        } else aStart++;\n      } else a[aStart++].remove();\n    }\n  }\n}\nvar $$EVENTS = \"_$DX_DELEGATE\";\nfunction render(code, element, init, options = {}) {\n  let disposer;\n  createRoot((dispose2) => {\n    disposer = dispose2;\n    element === document ? code() : insert(element, code(), element.firstChild ? null : void 0, init);\n  }, options.owner);\n  return () => {\n    disposer();\n    element.textContent = \"\";\n  };\n}\nfunction template(html, isImportNode, isSVG, isMathML) {\n  let node;\n  const create = () => {\n    const t = isMathML ? document.createElementNS(\"http://www.w3.org/1998/Math/MathML\", \"template\") : document.createElement(\"template\");\n    t.innerHTML = html;\n    return isSVG ? t.content.firstChild.firstChild : isMathML ? t.firstChild : t.content.firstChild;\n  };\n  const fn = isImportNode ? () => untrack(() => document.importNode(node || (node = create()), true)) : () => (node || (node = create())).cloneNode(true);\n  fn.cloneNode = fn;\n  return fn;\n}\nfunction delegateEvents(eventNames, document2 = window.document) {\n  const e = document2[$$EVENTS] || (document2[$$EVENTS] = /* @__PURE__ */ new Set());\n  for (let i = 0, l = eventNames.length; i < l; i++) {\n    const name = eventNames[i];\n    if (!e.has(name)) {\n      e.add(name);\n      document2.addEventListener(name, eventHandler);\n    }\n  }\n}\nfunction clearDelegatedEvents(document2 = window.document) {\n  if (document2[$$EVENTS]) {\n    for (let name of document2[$$EVENTS].keys()) document2.removeEventListener(name, eventHandler);\n    delete document2[$$EVENTS];\n  }\n}\nfunction setAttribute(node, name, value) {\n  if (isHydrating(node)) return;\n  if (value == null) node.removeAttribute(name);\n  else node.setAttribute(name, value);\n}\nfunction setAttributeNS(node, namespace, name, value) {\n  if (isHydrating(node)) return;\n  if (value == null) node.removeAttributeNS(namespace, name);\n  else node.setAttributeNS(namespace, name, value);\n}\nfunction setBoolAttribute(node, name, value) {\n  if (isHydrating(node)) return;\n  value ? node.setAttribute(name, \"\") : node.removeAttribute(name);\n}\nfunction className(node, value) {\n  if (isHydrating(node)) return;\n  if (value == null) node.removeAttribute(\"class\");\n  else node.className = value;\n}\nfunction addEventListener(node, name, handler, delegate) {\n  if (delegate) {\n    if (Array.isArray(handler)) {\n      node[`$$${name}`] = handler[0];\n      node[`$$${name}Data`] = handler[1];\n    } else node[`$$${name}`] = handler;\n  } else if (Array.isArray(handler)) {\n    const handlerFn = handler[0];\n    node.addEventListener(name, handler[0] = (e) => handlerFn.call(node, handler[1], e));\n  } else node.addEventListener(name, handler, typeof handler !== \"function\" && handler);\n}\nfunction classList(node, value, prev = {}) {\n  const classKeys = Object.keys(value || {}), prevKeys = Object.keys(prev);\n  let i, len;\n  for (i = 0, len = prevKeys.length; i < len; i++) {\n    const key = prevKeys[i];\n    if (!key || key === \"undefined\" || value[key]) continue;\n    toggleClassKey(node, key, false);\n    delete prev[key];\n  }\n  for (i = 0, len = classKeys.length; i < len; i++) {\n    const key = classKeys[i], classValue = !!value[key];\n    if (!key || key === \"undefined\" || prev[key] === classValue || !classValue) continue;\n    toggleClassKey(node, key, true);\n    prev[key] = classValue;\n  }\n  return prev;\n}\nfunction style(node, value, prev) {\n  if (!value) return prev ? setAttribute(node, \"style\") : value;\n  const nodeStyle = node.style;\n  if (typeof value === \"string\") return nodeStyle.cssText = value;\n  typeof prev === \"string\" && (nodeStyle.cssText = prev = void 0);\n  prev || (prev = {});\n  value || (value = {});\n  let v, s;\n  for (s in prev) {\n    value[s] == null && nodeStyle.removeProperty(s);\n    delete prev[s];\n  }\n  for (s in value) {\n    v = value[s];\n    if (v !== prev[s]) {\n      nodeStyle.setProperty(s, v);\n      prev[s] = v;\n    }\n  }\n  return prev;\n}\nfunction spread(node, props = {}, isSVG, skipChildren) {\n  const prevProps = {};\n  if (!skipChildren) {\n    createRenderEffect(() => prevProps.children = insertExpression(node, props.children, prevProps.children));\n  }\n  createRenderEffect(() => typeof props.ref === \"function\" && use(props.ref, node));\n  createRenderEffect(() => assign(node, props, isSVG, true, prevProps, true));\n  return prevProps;\n}\nfunction use(fn, element, arg) {\n  return untrack(() => fn(element, arg));\n}\nfunction insert(parent, accessor, marker, initial) {\n  if (marker !== void 0 && !initial) initial = [];\n  if (typeof accessor !== \"function\") return insertExpression(parent, accessor, initial, marker);\n  createRenderEffect((current) => insertExpression(parent, accessor(), current, marker), initial);\n}\nfunction assign(node, props, isSVG, skipChildren, prevProps = {}, skipRef = false) {\n  props || (props = {});\n  for (const prop in prevProps) {\n    if (!(prop in props)) {\n      if (prop === \"children\") continue;\n      prevProps[prop] = assignProp(node, prop, null, prevProps[prop], isSVG, skipRef, props);\n    }\n  }\n  for (const prop in props) {\n    if (prop === \"children\") {\n      continue;\n    }\n    const value = props[prop];\n    prevProps[prop] = assignProp(node, prop, value, prevProps[prop], isSVG, skipRef, props);\n  }\n}\nfunction getNextElement(template2) {\n  let node, key, hydrating = isHydrating();\n  if (!hydrating || !(node = sharedConfig.registry.get(key = getHydrationKey()))) {\n    return template2();\n  }\n  if (sharedConfig.completed) sharedConfig.completed.add(node);\n  sharedConfig.registry.delete(key);\n  return node;\n}\nfunction isHydrating(node) {\n  return !!sharedConfig.context && !sharedConfig.done && (!node || node.isConnected);\n}\nfunction toPropertyName(name) {\n  return name.toLowerCase().replace(/-([a-z])/g, (_, w) => w.toUpperCase());\n}\nfunction toggleClassKey(node, key, value) {\n  const classNames = key.trim().split(/\\s+/);\n  for (let i = 0, nameLen = classNames.length; i < nameLen; i++) node.classList.toggle(classNames[i], value);\n}\nfunction assignProp(node, prop, value, prev, isSVG, skipRef, props) {\n  let isCE, isProp, isChildProp, propAlias, forceProp;\n  if (prop === \"style\") return style(node, value, prev);\n  if (prop === \"classList\") return classList(node, value, prev);\n  if (value === prev) return prev;\n  if (prop === \"ref\") {\n    if (!skipRef) value(node);\n  } else if (prop.slice(0, 3) === \"on:\") {\n    const e = prop.slice(3);\n    prev && node.removeEventListener(e, prev, typeof prev !== \"function\" && prev);\n    value && node.addEventListener(e, value, typeof value !== \"function\" && value);\n  } else if (prop.slice(0, 10) === \"oncapture:\") {\n    const e = prop.slice(10);\n    prev && node.removeEventListener(e, prev, true);\n    value && node.addEventListener(e, value, true);\n  } else if (prop.slice(0, 2) === \"on\") {\n    const name = prop.slice(2).toLowerCase();\n    const delegate = DelegatedEvents.has(name);\n    if (!delegate && prev) {\n      const h = Array.isArray(prev) ? prev[0] : prev;\n      node.removeEventListener(name, h);\n    }\n    if (delegate || value) {\n      addEventListener(node, name, value, delegate);\n      delegate && delegateEvents([name]);\n    }\n  } else if (prop.slice(0, 5) === \"attr:\") {\n    setAttribute(node, prop.slice(5), value);\n  } else if (prop.slice(0, 5) === \"bool:\") {\n    setBoolAttribute(node, prop.slice(5), value);\n  } else if ((forceProp = prop.slice(0, 5) === \"prop:\") || (isChildProp = ChildProperties.has(prop)) || !isSVG && ((propAlias = getPropAlias(prop, node.tagName)) || (isProp = Properties.has(prop))) || (isCE = node.nodeName.includes(\"-\") || \"is\" in props)) {\n    if (forceProp) {\n      prop = prop.slice(5);\n      isProp = true;\n    } else if (isHydrating(node)) return value;\n    if (prop === \"class\" || prop === \"className\") className(node, value);\n    else if (isCE && !isProp && !isChildProp) node[toPropertyName(prop)] = value;\n    else node[propAlias || prop] = value;\n  } else {\n    const ns = isSVG && prop.indexOf(\":\") > -1 && SVGNamespace[prop.split(\":\")[0]];\n    if (ns) setAttributeNS(node, ns, prop, value);\n    else setAttribute(node, Aliases[prop] || prop, value);\n  }\n  return value;\n}\nfunction eventHandler(e) {\n  if (sharedConfig.registry && sharedConfig.events) {\n    if (sharedConfig.events.find(([el, ev]) => ev === e)) return;\n  }\n  let node = e.target;\n  const key = `$$${e.type}`;\n  const oriTarget = e.target;\n  const oriCurrentTarget = e.currentTarget;\n  const retarget = (value) => Object.defineProperty(e, \"target\", {\n    configurable: true,\n    value\n  });\n  const handleNode = () => {\n    const handler = node[key];\n    if (handler && !node.disabled) {\n      const data = node[`${key}Data`];\n      data !== void 0 ? handler.call(node, data, e) : handler.call(node, e);\n      if (e.cancelBubble) return;\n    }\n    node.host && typeof node.host !== \"string\" && !node.host._$host && node.contains(e.target) && retarget(node.host);\n    return true;\n  };\n  const walkUpTree = () => {\n    while (handleNode() && (node = node._$host || node.parentNode || node.host)) ;\n  };\n  Object.defineProperty(e, \"currentTarget\", {\n    configurable: true,\n    get() {\n      return node || document;\n    }\n  });\n  if (sharedConfig.registry && !sharedConfig.done) sharedConfig.done = _$HY.done = true;\n  if (e.composedPath) {\n    const path = e.composedPath();\n    retarget(path[0]);\n    for (let i = 0; i < path.length - 2; i++) {\n      node = path[i];\n      if (!handleNode()) break;\n      if (node._$host) {\n        node = node._$host;\n        walkUpTree();\n        break;\n      }\n      if (node.parentNode === oriCurrentTarget) {\n        break;\n      }\n    }\n  } else walkUpTree();\n  retarget(oriTarget);\n}\nfunction insertExpression(parent, value, current, marker, unwrapArray) {\n  const hydrating = isHydrating(parent);\n  if (hydrating) {\n    !current && (current = [...parent.childNodes]);\n    let cleaned = [];\n    for (let i = 0; i < current.length; i++) {\n      const node = current[i];\n      if (node.nodeType === 8 && node.data.slice(0, 2) === \"!$\") node.remove();\n      else cleaned.push(node);\n    }\n    current = cleaned;\n  }\n  while (typeof current === \"function\") current = current();\n  if (value === current) return current;\n  const t = typeof value, multi = marker !== void 0;\n  parent = multi && current[0] && current[0].parentNode || parent;\n  if (t === \"string\" || t === \"number\") {\n    if (hydrating) return current;\n    if (t === \"number\") {\n      value = value.toString();\n      if (value === current) return current;\n    }\n    if (multi) {\n      let node = current[0];\n      if (node && node.nodeType === 3) {\n        node.data !== value && (node.data = value);\n      } else node = document.createTextNode(value);\n      current = cleanChildren(parent, current, marker, node);\n    } else {\n      if (current !== \"\" && typeof current === \"string\") {\n        current = parent.firstChild.data = value;\n      } else current = parent.textContent = value;\n    }\n  } else if (value == null || t === \"boolean\") {\n    if (hydrating) return current;\n    current = cleanChildren(parent, current, marker);\n  } else if (t === \"function\") {\n    createRenderEffect(() => {\n      let v = value();\n      while (typeof v === \"function\") v = v();\n      current = insertExpression(parent, v, current, marker);\n    });\n    return () => current;\n  } else if (Array.isArray(value)) {\n    const array = [];\n    const currentArray = current && Array.isArray(current);\n    if (normalizeIncomingArray(array, value, current, unwrapArray)) {\n      createRenderEffect(() => current = insertExpression(parent, array, current, marker, true));\n      return () => current;\n    }\n    if (hydrating) {\n      if (!array.length) return current;\n      if (marker === void 0) return current = [...parent.childNodes];\n      let node = array[0];\n      if (node.parentNode !== parent) return current;\n      const nodes = [node];\n      while ((node = node.nextSibling) !== marker) nodes.push(node);\n      return current = nodes;\n    }\n    if (array.length === 0) {\n      current = cleanChildren(parent, current, marker);\n      if (multi) return current;\n    } else if (currentArray) {\n      if (current.length === 0) {\n        appendNodes(parent, array, marker);\n      } else reconcileArrays(parent, current, array);\n    } else {\n      current && cleanChildren(parent);\n      appendNodes(parent, array);\n    }\n    current = array;\n  } else if (value.nodeType) {\n    if (hydrating && value.parentNode) return current = multi ? [value] : value;\n    if (Array.isArray(current)) {\n      if (multi) return current = cleanChildren(parent, current, marker, value);\n      cleanChildren(parent, current, null, value);\n    } else if (current == null || current === \"\" || !parent.firstChild) {\n      parent.appendChild(value);\n    } else parent.replaceChild(value, parent.firstChild);\n    current = value;\n  } else ;\n  return current;\n}\nfunction normalizeIncomingArray(normalized, array, current, unwrap) {\n  let dynamic = false;\n  for (let i = 0, len = array.length; i < len; i++) {\n    let item = array[i], prev = current && current[normalized.length], t;\n    if (item == null || item === true || item === false) ;\n    else if ((t = typeof item) === \"object\" && item.nodeType) {\n      normalized.push(item);\n    } else if (Array.isArray(item)) {\n      dynamic = normalizeIncomingArray(normalized, item, prev) || dynamic;\n    } else if (t === \"function\") {\n      if (unwrap) {\n        while (typeof item === \"function\") item = item();\n        dynamic = normalizeIncomingArray(normalized, Array.isArray(item) ? item : [item], Array.isArray(prev) ? prev : [prev]) || dynamic;\n      } else {\n        normalized.push(item);\n        dynamic = true;\n      }\n    } else {\n      const value = String(item);\n      if (prev && prev.nodeType === 3 && prev.data === value) normalized.push(prev);\n      else normalized.push(document.createTextNode(value));\n    }\n  }\n  return dynamic;\n}\nfunction appendNodes(parent, array, marker = null) {\n  for (let i = 0, len = array.length; i < len; i++) parent.insertBefore(array[i], marker);\n}\nfunction cleanChildren(parent, current, marker, replacement) {\n  if (marker === void 0) return parent.textContent = \"\";\n  const node = replacement || document.createTextNode(\"\");\n  if (current.length) {\n    let inserted = false;\n    for (let i = current.length - 1; i >= 0; i--) {\n      const el = current[i];\n      if (node !== el) {\n        const isParent = el.parentNode === parent;\n        if (!inserted && !i) isParent ? parent.replaceChild(node, el) : parent.insertBefore(node, marker);\n        else isParent && el.remove();\n      } else inserted = true;\n    }\n  } else parent.insertBefore(node, marker);\n  return [node];\n}\nfunction getHydrationKey() {\n  return sharedConfig.getNextContextId();\n}\nvar isServer = false;\nvar SVG_NAMESPACE = \"http://www.w3.org/2000/svg\";\nfunction createElement(tagName, isSVG = false) {\n  return isSVG ? document.createElementNS(SVG_NAMESPACE, tagName) : document.createElement(tagName);\n}\nfunction Portal(props) {\n  const {\n    useShadow\n  } = props, marker = document.createTextNode(\"\"), mount = () => props.mount || document.body, owner = getOwner();\n  let content;\n  let hydrating = !!sharedConfig.context;\n  createEffect(() => {\n    if (hydrating) getOwner().user = hydrating = false;\n    content || (content = runWithOwner(owner, () => createMemo(() => props.children)));\n    const el = mount();\n    if (el instanceof HTMLHeadElement) {\n      const [clean, setClean] = createSignal(false);\n      const cleanup = () => setClean(true);\n      createRoot((dispose2) => insert(el, () => !clean() ? content() : dispose2(), null));\n      onCleanup(cleanup);\n    } else {\n      const container = createElement(props.isSVG ? \"g\" : \"div\", props.isSVG), renderRoot = useShadow && container.attachShadow ? container.attachShadow({\n        mode: \"open\"\n      }) : container;\n      Object.defineProperty(container, \"_$host\", {\n        get() {\n          return marker.parentNode;\n        },\n        configurable: true\n      });\n      insert(renderRoot, content);\n      el.appendChild(container);\n      props.ref && props.ref(container);\n      onCleanup(() => el.removeChild(container));\n    }\n  }, void 0, {\n    render: !hydrating\n  });\n  return marker;\n}\nfunction createDynamic(component, props) {\n  const cached = createMemo(component);\n  return createMemo(() => {\n    const component2 = cached();\n    switch (typeof component2) {\n      case \"function\":\n        return untrack(() => component2(props));\n      case \"string\":\n        const isSvg = SVGElements.has(component2);\n        const el = sharedConfig.context ? getNextElement() : createElement(component2, isSvg);\n        spread(el, props, isSvg);\n        return el;\n    }\n  });\n}\nfunction Dynamic(props) {\n  const [, others] = splitProps(props, [\"component\"]);\n  return createDynamic(() => props.component, others);\n}\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/double-indexed-kv.js\nvar DoubleIndexedKV = class {\n  constructor() {\n    this.keyToValue = /* @__PURE__ */ new Map();\n    this.valueToKey = /* @__PURE__ */ new Map();\n  }\n  set(key, value) {\n    this.keyToValue.set(key, value);\n    this.valueToKey.set(value, key);\n  }\n  getByKey(key) {\n    return this.keyToValue.get(key);\n  }\n  getByValue(value) {\n    return this.valueToKey.get(value);\n  }\n  clear() {\n    this.keyToValue.clear();\n    this.valueToKey.clear();\n  }\n};\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/registry.js\nvar Registry = class {\n  constructor(generateIdentifier) {\n    this.generateIdentifier = generateIdentifier;\n    this.kv = new DoubleIndexedKV();\n  }\n  register(value, identifier) {\n    if (this.kv.getByValue(value)) {\n      return;\n    }\n    if (!identifier) {\n      identifier = this.generateIdentifier(value);\n    }\n    this.kv.set(identifier, value);\n  }\n  clear() {\n    this.kv.clear();\n  }\n  getIdentifier(value) {\n    return this.kv.getByValue(value);\n  }\n  getValue(identifier) {\n    return this.kv.getByKey(identifier);\n  }\n};\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/class-registry.js\nvar ClassRegistry = class extends Registry {\n  constructor() {\n    super((c) => c.name);\n    this.classToAllowedProps = /* @__PURE__ */ new Map();\n  }\n  register(value, options) {\n    if (typeof options === \"object\") {\n      if (options.allowProps) {\n        this.classToAllowedProps.set(value, options.allowProps);\n      }\n      super.register(value, options.identifier);\n    } else {\n      super.register(value, options);\n    }\n  }\n  getAllowedProps(value) {\n    return this.classToAllowedProps.get(value);\n  }\n};\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/util.js\nfunction valuesOfObj(record) {\n  if (\"values\" in Object) {\n    return Object.values(record);\n  }\n  const values = [];\n  for (const key in record) {\n    if (record.hasOwnProperty(key)) {\n      values.push(record[key]);\n    }\n  }\n  return values;\n}\nfunction find(record, predicate) {\n  const values = valuesOfObj(record);\n  if (\"find\" in values) {\n    return values.find(predicate);\n  }\n  const valuesNotNever = values;\n  for (let i = 0; i < valuesNotNever.length; i++) {\n    const value = valuesNotNever[i];\n    if (predicate(value)) {\n      return value;\n    }\n  }\n  return void 0;\n}\nfunction forEach(record, run) {\n  Object.entries(record).forEach(([key, value]) => run(value, key));\n}\nfunction includes(arr, value) {\n  return arr.indexOf(value) !== -1;\n}\nfunction findArr(record, predicate) {\n  for (let i = 0; i < record.length; i++) {\n    const value = record[i];\n    if (predicate(value)) {\n      return value;\n    }\n  }\n  return void 0;\n}\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/custom-transformer-registry.js\nvar CustomTransformerRegistry = class {\n  constructor() {\n    this.transfomers = {};\n  }\n  register(transformer) {\n    this.transfomers[transformer.name] = transformer;\n  }\n  findApplicable(v) {\n    return find(this.transfomers, (transformer) => transformer.isApplicable(v));\n  }\n  findByName(name) {\n    return this.transfomers[name];\n  }\n};\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/is.js\nvar getType = (payload) => Object.prototype.toString.call(payload).slice(8, -1);\nvar isUndefined = (payload) => typeof payload === \"undefined\";\nvar isNull = (payload) => payload === null;\nvar isPlainObject = (payload) => {\n  if (typeof payload !== \"object\" || payload === null)\n    return false;\n  if (payload === Object.prototype)\n    return false;\n  if (Object.getPrototypeOf(payload) === null)\n    return true;\n  return Object.getPrototypeOf(payload) === Object.prototype;\n};\nvar isEmptyObject = (payload) => isPlainObject(payload) && Object.keys(payload).length === 0;\nvar isArray = (payload) => Array.isArray(payload);\nvar isString = (payload) => typeof payload === \"string\";\nvar isNumber = (payload) => typeof payload === \"number\" && !isNaN(payload);\nvar isBoolean = (payload) => typeof payload === \"boolean\";\nvar isRegExp = (payload) => payload instanceof RegExp;\nvar isMap = (payload) => payload instanceof Map;\nvar isSet = (payload) => payload instanceof Set;\nvar isSymbol = (payload) => getType(payload) === \"Symbol\";\nvar isDate = (payload) => payload instanceof Date && !isNaN(payload.valueOf());\nvar isError = (payload) => payload instanceof Error;\nvar isNaNValue = (payload) => typeof payload === \"number\" && isNaN(payload);\nvar isPrimitive = (payload) => isBoolean(payload) || isNull(payload) || isUndefined(payload) || isNumber(payload) || isString(payload) || isSymbol(payload);\nvar isBigint = (payload) => typeof payload === \"bigint\";\nvar isInfinite = (payload) => payload === Infinity || payload === -Infinity;\nvar isTypedArray = (payload) => ArrayBuffer.isView(payload) && !(payload instanceof DataView);\nvar isURL = (payload) => payload instanceof URL;\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/pathstringifier.js\nvar escapeKey = (key) => key.replace(/\\./g, \"\\\\.\");\nvar stringifyPath = (path) => path.map(String).map(escapeKey).join(\".\");\nvar parsePath = (string) => {\n  const result = [];\n  let segment = \"\";\n  for (let i = 0; i < string.length; i++) {\n    let char = string.charAt(i);\n    const isEscapedDot = char === \"\\\\\" && string.charAt(i + 1) === \".\";\n    if (isEscapedDot) {\n      segment += \".\";\n      i++;\n      continue;\n    }\n    const isEndOfSegment = char === \".\";\n    if (isEndOfSegment) {\n      result.push(segment);\n      segment = \"\";\n      continue;\n    }\n    segment += char;\n  }\n  const lastSegment = segment;\n  result.push(lastSegment);\n  return result;\n};\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/transformer.js\nfunction simpleTransformation(isApplicable, annotation, transform, untransform) {\n  return {\n    isApplicable,\n    annotation,\n    transform,\n    untransform\n  };\n}\nvar simpleRules = [\n  simpleTransformation(isUndefined, \"undefined\", () => null, () => void 0),\n  simpleTransformation(isBigint, \"bigint\", (v) => v.toString(), (v) => {\n    if (typeof BigInt !== \"undefined\") {\n      return BigInt(v);\n    }\n    console.error(\"Please add a BigInt polyfill.\");\n    return v;\n  }),\n  simpleTransformation(isDate, \"Date\", (v) => v.toISOString(), (v) => new Date(v)),\n  simpleTransformation(isError, \"Error\", (v, superJson) => {\n    const baseError = {\n      name: v.name,\n      message: v.message\n    };\n    superJson.allowedErrorProps.forEach((prop) => {\n      baseError[prop] = v[prop];\n    });\n    return baseError;\n  }, (v, superJson) => {\n    const e = new Error(v.message);\n    e.name = v.name;\n    e.stack = v.stack;\n    superJson.allowedErrorProps.forEach((prop) => {\n      e[prop] = v[prop];\n    });\n    return e;\n  }),\n  simpleTransformation(isRegExp, \"regexp\", (v) => \"\" + v, (regex) => {\n    const body = regex.slice(1, regex.lastIndexOf(\"/\"));\n    const flags = regex.slice(regex.lastIndexOf(\"/\") + 1);\n    return new RegExp(body, flags);\n  }),\n  simpleTransformation(\n    isSet,\n    \"set\",\n    // (sets only exist in es6+)\n    // eslint-disable-next-line es5/no-es6-methods\n    (v) => [...v.values()],\n    (v) => new Set(v)\n  ),\n  simpleTransformation(isMap, \"map\", (v) => [...v.entries()], (v) => new Map(v)),\n  simpleTransformation((v) => isNaNValue(v) || isInfinite(v), \"number\", (v) => {\n    if (isNaNValue(v)) {\n      return \"NaN\";\n    }\n    if (v > 0) {\n      return \"Infinity\";\n    } else {\n      return \"-Infinity\";\n    }\n  }, Number),\n  simpleTransformation((v) => v === 0 && 1 / v === -Infinity, \"number\", () => {\n    return \"-0\";\n  }, Number),\n  simpleTransformation(isURL, \"URL\", (v) => v.toString(), (v) => new URL(v))\n];\nfunction compositeTransformation(isApplicable, annotation, transform, untransform) {\n  return {\n    isApplicable,\n    annotation,\n    transform,\n    untransform\n  };\n}\nvar symbolRule = compositeTransformation((s, superJson) => {\n  if (isSymbol(s)) {\n    const isRegistered = !!superJson.symbolRegistry.getIdentifier(s);\n    return isRegistered;\n  }\n  return false;\n}, (s, superJson) => {\n  const identifier = superJson.symbolRegistry.getIdentifier(s);\n  return [\"symbol\", identifier];\n}, (v) => v.description, (_, a, superJson) => {\n  const value = superJson.symbolRegistry.getValue(a[1]);\n  if (!value) {\n    throw new Error(\"Trying to deserialize unknown symbol\");\n  }\n  return value;\n});\nvar constructorToName = [\n  Int8Array,\n  Uint8Array,\n  Int16Array,\n  Uint16Array,\n  Int32Array,\n  Uint32Array,\n  Float32Array,\n  Float64Array,\n  Uint8ClampedArray\n].reduce((obj, ctor) => {\n  obj[ctor.name] = ctor;\n  return obj;\n}, {});\nvar typedArrayRule = compositeTransformation(isTypedArray, (v) => [\"typed-array\", v.constructor.name], (v) => [...v], (v, a) => {\n  const ctor = constructorToName[a[1]];\n  if (!ctor) {\n    throw new Error(\"Trying to deserialize unknown typed array\");\n  }\n  return new ctor(v);\n});\nfunction isInstanceOfRegisteredClass(potentialClass, superJson) {\n  if (potentialClass?.constructor) {\n    const isRegistered = !!superJson.classRegistry.getIdentifier(potentialClass.constructor);\n    return isRegistered;\n  }\n  return false;\n}\nvar classRule = compositeTransformation(isInstanceOfRegisteredClass, (clazz, superJson) => {\n  const identifier = superJson.classRegistry.getIdentifier(clazz.constructor);\n  return [\"class\", identifier];\n}, (clazz, superJson) => {\n  const allowedProps = superJson.classRegistry.getAllowedProps(clazz.constructor);\n  if (!allowedProps) {\n    return { ...clazz };\n  }\n  const result = {};\n  allowedProps.forEach((prop) => {\n    result[prop] = clazz[prop];\n  });\n  return result;\n}, (v, a, superJson) => {\n  const clazz = superJson.classRegistry.getValue(a[1]);\n  if (!clazz) {\n    throw new Error(`Trying to deserialize unknown class '${a[1]}' - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564`);\n  }\n  return Object.assign(Object.create(clazz.prototype), v);\n});\nvar customRule = compositeTransformation((value, superJson) => {\n  return !!superJson.customTransformerRegistry.findApplicable(value);\n}, (value, superJson) => {\n  const transformer = superJson.customTransformerRegistry.findApplicable(value);\n  return [\"custom\", transformer.name];\n}, (value, superJson) => {\n  const transformer = superJson.customTransformerRegistry.findApplicable(value);\n  return transformer.serialize(value);\n}, (v, a, superJson) => {\n  const transformer = superJson.customTransformerRegistry.findByName(a[1]);\n  if (!transformer) {\n    throw new Error(\"Trying to deserialize unknown custom value\");\n  }\n  return transformer.deserialize(v);\n});\nvar compositeRules = [classRule, symbolRule, customRule, typedArrayRule];\nvar transformValue = (value, superJson) => {\n  const applicableCompositeRule = findArr(compositeRules, (rule) => rule.isApplicable(value, superJson));\n  if (applicableCompositeRule) {\n    return {\n      value: applicableCompositeRule.transform(value, superJson),\n      type: applicableCompositeRule.annotation(value, superJson)\n    };\n  }\n  const applicableSimpleRule = findArr(simpleRules, (rule) => rule.isApplicable(value, superJson));\n  if (applicableSimpleRule) {\n    return {\n      value: applicableSimpleRule.transform(value, superJson),\n      type: applicableSimpleRule.annotation\n    };\n  }\n  return void 0;\n};\nvar simpleRulesByAnnotation = {};\nsimpleRules.forEach((rule) => {\n  simpleRulesByAnnotation[rule.annotation] = rule;\n});\nvar untransformValue = (json, type, superJson) => {\n  if (isArray(type)) {\n    switch (type[0]) {\n      case \"symbol\":\n        return symbolRule.untransform(json, type, superJson);\n      case \"class\":\n        return classRule.untransform(json, type, superJson);\n      case \"custom\":\n        return customRule.untransform(json, type, superJson);\n      case \"typed-array\":\n        return typedArrayRule.untransform(json, type, superJson);\n      default:\n        throw new Error(\"Unknown transformation: \" + type);\n    }\n  } else {\n    const transformation = simpleRulesByAnnotation[type];\n    if (!transformation) {\n      throw new Error(\"Unknown transformation: \" + type);\n    }\n    return transformation.untransform(json, superJson);\n  }\n};\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/accessDeep.js\nvar getNthKey = (value, n) => {\n  if (n > value.size)\n    throw new Error(\"index out of bounds\");\n  const keys = value.keys();\n  while (n > 0) {\n    keys.next();\n    n--;\n  }\n  return keys.next().value;\n};\nfunction validatePath(path) {\n  if (includes(path, \"__proto__\")) {\n    throw new Error(\"__proto__ is not allowed as a property\");\n  }\n  if (includes(path, \"prototype\")) {\n    throw new Error(\"prototype is not allowed as a property\");\n  }\n  if (includes(path, \"constructor\")) {\n    throw new Error(\"constructor is not allowed as a property\");\n  }\n}\nvar getDeep = (object, path) => {\n  validatePath(path);\n  for (let i = 0; i < path.length; i++) {\n    const key = path[i];\n    if (isSet(object)) {\n      object = getNthKey(object, +key);\n    } else if (isMap(object)) {\n      const row = +key;\n      const type = +path[++i] === 0 ? \"key\" : \"value\";\n      const keyOfRow = getNthKey(object, row);\n      switch (type) {\n        case \"key\":\n          object = keyOfRow;\n          break;\n        case \"value\":\n          object = object.get(keyOfRow);\n          break;\n      }\n    } else {\n      object = object[key];\n    }\n  }\n  return object;\n};\nvar setDeep = (object, path, mapper) => {\n  validatePath(path);\n  if (path.length === 0) {\n    return mapper(object);\n  }\n  let parent = object;\n  for (let i = 0; i < path.length - 1; i++) {\n    const key = path[i];\n    if (isArray(parent)) {\n      const index = +key;\n      parent = parent[index];\n    } else if (isPlainObject(parent)) {\n      parent = parent[key];\n    } else if (isSet(parent)) {\n      const row = +key;\n      parent = getNthKey(parent, row);\n    } else if (isMap(parent)) {\n      const isEnd = i === path.length - 2;\n      if (isEnd) {\n        break;\n      }\n      const row = +key;\n      const type = +path[++i] === 0 ? \"key\" : \"value\";\n      const keyOfRow = getNthKey(parent, row);\n      switch (type) {\n        case \"key\":\n          parent = keyOfRow;\n          break;\n        case \"value\":\n          parent = parent.get(keyOfRow);\n          break;\n      }\n    }\n  }\n  const lastKey = path[path.length - 1];\n  if (isArray(parent)) {\n    parent[+lastKey] = mapper(parent[+lastKey]);\n  } else if (isPlainObject(parent)) {\n    parent[lastKey] = mapper(parent[lastKey]);\n  }\n  if (isSet(parent)) {\n    const oldValue = getNthKey(parent, +lastKey);\n    const newValue = mapper(oldValue);\n    if (oldValue !== newValue) {\n      parent.delete(oldValue);\n      parent.add(newValue);\n    }\n  }\n  if (isMap(parent)) {\n    const row = +path[path.length - 2];\n    const keyToRow = getNthKey(parent, row);\n    const type = +lastKey === 0 ? \"key\" : \"value\";\n    switch (type) {\n      case \"key\": {\n        const newKey = mapper(keyToRow);\n        parent.set(newKey, parent.get(keyToRow));\n        if (newKey !== keyToRow) {\n          parent.delete(keyToRow);\n        }\n        break;\n      }\n      case \"value\": {\n        parent.set(keyToRow, mapper(parent.get(keyToRow)));\n        break;\n      }\n    }\n  }\n  return object;\n};\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/plainer.js\nfunction traverse(tree, walker2, origin = []) {\n  if (!tree) {\n    return;\n  }\n  if (!isArray(tree)) {\n    forEach(tree, (subtree, key) => traverse(subtree, walker2, [...origin, ...parsePath(key)]));\n    return;\n  }\n  const [nodeValue, children2] = tree;\n  if (children2) {\n    forEach(children2, (child, key) => {\n      traverse(child, walker2, [...origin, ...parsePath(key)]);\n    });\n  }\n  walker2(nodeValue, origin);\n}\nfunction applyValueAnnotations(plain, annotations, superJson) {\n  traverse(annotations, (type, path) => {\n    plain = setDeep(plain, path, (v) => untransformValue(v, type, superJson));\n  });\n  return plain;\n}\nfunction applyReferentialEqualityAnnotations(plain, annotations) {\n  function apply(identicalPaths, path) {\n    const object = getDeep(plain, parsePath(path));\n    identicalPaths.map(parsePath).forEach((identicalObjectPath) => {\n      plain = setDeep(plain, identicalObjectPath, () => object);\n    });\n  }\n  if (isArray(annotations)) {\n    const [root, other] = annotations;\n    root.forEach((identicalPath) => {\n      plain = setDeep(plain, parsePath(identicalPath), () => plain);\n    });\n    if (other) {\n      forEach(other, apply);\n    }\n  } else {\n    forEach(annotations, apply);\n  }\n  return plain;\n}\nvar isDeep = (object, superJson) => isPlainObject(object) || isArray(object) || isMap(object) || isSet(object) || isInstanceOfRegisteredClass(object, superJson);\nfunction addIdentity(object, path, identities) {\n  const existingSet = identities.get(object);\n  if (existingSet) {\n    existingSet.push(path);\n  } else {\n    identities.set(object, [path]);\n  }\n}\nfunction generateReferentialEqualityAnnotations(identitites, dedupe) {\n  const result = {};\n  let rootEqualityPaths = void 0;\n  identitites.forEach((paths) => {\n    if (paths.length <= 1) {\n      return;\n    }\n    if (!dedupe) {\n      paths = paths.map((path) => path.map(String)).sort((a, b) => a.length - b.length);\n    }\n    const [representativePath, ...identicalPaths] = paths;\n    if (representativePath.length === 0) {\n      rootEqualityPaths = identicalPaths.map(stringifyPath);\n    } else {\n      result[stringifyPath(representativePath)] = identicalPaths.map(stringifyPath);\n    }\n  });\n  if (rootEqualityPaths) {\n    if (isEmptyObject(result)) {\n      return [rootEqualityPaths];\n    } else {\n      return [rootEqualityPaths, result];\n    }\n  } else {\n    return isEmptyObject(result) ? void 0 : result;\n  }\n}\nvar walker = (object, identities, superJson, dedupe, path = [], objectsInThisPath = [], seenObjects = /* @__PURE__ */ new Map()) => {\n  const primitive = isPrimitive(object);\n  if (!primitive) {\n    addIdentity(object, path, identities);\n    const seen = seenObjects.get(object);\n    if (seen) {\n      return dedupe ? {\n        transformedValue: null\n      } : seen;\n    }\n  }\n  if (!isDeep(object, superJson)) {\n    const transformed2 = transformValue(object, superJson);\n    const result2 = transformed2 ? {\n      transformedValue: transformed2.value,\n      annotations: [transformed2.type]\n    } : {\n      transformedValue: object\n    };\n    if (!primitive) {\n      seenObjects.set(object, result2);\n    }\n    return result2;\n  }\n  if (includes(objectsInThisPath, object)) {\n    return {\n      transformedValue: null\n    };\n  }\n  const transformationResult = transformValue(object, superJson);\n  const transformed = transformationResult?.value ?? object;\n  const transformedValue = isArray(transformed) ? [] : {};\n  const innerAnnotations = {};\n  forEach(transformed, (value, index) => {\n    if (index === \"__proto__\" || index === \"constructor\" || index === \"prototype\") {\n      throw new Error(`Detected property ${index}. This is a prototype pollution risk, please remove it from your object.`);\n    }\n    const recursiveResult = walker(value, identities, superJson, dedupe, [...path, index], [...objectsInThisPath, object], seenObjects);\n    transformedValue[index] = recursiveResult.transformedValue;\n    if (isArray(recursiveResult.annotations)) {\n      innerAnnotations[index] = recursiveResult.annotations;\n    } else if (isPlainObject(recursiveResult.annotations)) {\n      forEach(recursiveResult.annotations, (tree, key) => {\n        innerAnnotations[escapeKey(index) + \".\" + key] = tree;\n      });\n    }\n  });\n  const result = isEmptyObject(innerAnnotations) ? {\n    transformedValue,\n    annotations: !!transformationResult ? [transformationResult.type] : void 0\n  } : {\n    transformedValue,\n    annotations: !!transformationResult ? [transformationResult.type, innerAnnotations] : innerAnnotations\n  };\n  if (!primitive) {\n    seenObjects.set(object, result);\n  }\n  return result;\n};\n\n// ../../node_modules/.pnpm/is-what@4.1.16/node_modules/is-what/dist/index.js\nfunction getType2(payload) {\n  return Object.prototype.toString.call(payload).slice(8, -1);\n}\nfunction isArray2(payload) {\n  return getType2(payload) === \"Array\";\n}\nfunction isPlainObject2(payload) {\n  if (getType2(payload) !== \"Object\")\n    return false;\n  const prototype = Object.getPrototypeOf(payload);\n  return !!prototype && prototype.constructor === Object && prototype === Object.prototype;\n}\n\n// ../../node_modules/.pnpm/copy-anything@3.0.5/node_modules/copy-anything/dist/index.js\nfunction assignProp2(carry, key, newVal, originalObject, includeNonenumerable) {\n  const propType = {}.propertyIsEnumerable.call(originalObject, key) ? \"enumerable\" : \"nonenumerable\";\n  if (propType === \"enumerable\")\n    carry[key] = newVal;\n  if (includeNonenumerable && propType === \"nonenumerable\") {\n    Object.defineProperty(carry, key, {\n      value: newVal,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    });\n  }\n}\nfunction copy(target, options = {}) {\n  if (isArray2(target)) {\n    return target.map((item) => copy(item, options));\n  }\n  if (!isPlainObject2(target)) {\n    return target;\n  }\n  const props = Object.getOwnPropertyNames(target);\n  const symbols = Object.getOwnPropertySymbols(target);\n  return [...props, ...symbols].reduce((carry, key) => {\n    if (isArray2(options.props) && !options.props.includes(key)) {\n      return carry;\n    }\n    const val = target[key];\n    const newVal = copy(val, options);\n    assignProp2(carry, key, newVal, target, options.nonenumerable);\n    return carry;\n  }, {});\n}\n\n// ../../node_modules/.pnpm/superjson@2.2.2/node_modules/superjson/dist/index.js\nvar SuperJSON = class {\n  /**\n   * @param dedupeReferentialEqualities  If true, SuperJSON will make sure only one instance of referentially equal objects are serialized and the rest are replaced with `null`.\n   */\n  constructor({ dedupe = false } = {}) {\n    this.classRegistry = new ClassRegistry();\n    this.symbolRegistry = new Registry((s) => s.description ?? \"\");\n    this.customTransformerRegistry = new CustomTransformerRegistry();\n    this.allowedErrorProps = [];\n    this.dedupe = dedupe;\n  }\n  serialize(object) {\n    const identities = /* @__PURE__ */ new Map();\n    const output = walker(object, identities, this, this.dedupe);\n    const res = {\n      json: output.transformedValue\n    };\n    if (output.annotations) {\n      res.meta = {\n        ...res.meta,\n        values: output.annotations\n      };\n    }\n    const equalityAnnotations = generateReferentialEqualityAnnotations(identities, this.dedupe);\n    if (equalityAnnotations) {\n      res.meta = {\n        ...res.meta,\n        referentialEqualities: equalityAnnotations\n      };\n    }\n    return res;\n  }\n  deserialize(payload) {\n    const { json, meta } = payload;\n    let result = copy(json);\n    if (meta?.values) {\n      result = applyValueAnnotations(result, meta.values, this);\n    }\n    if (meta?.referentialEqualities) {\n      result = applyReferentialEqualityAnnotations(result, meta.referentialEqualities);\n    }\n    return result;\n  }\n  stringify(object) {\n    return JSON.stringify(this.serialize(object));\n  }\n  parse(string) {\n    return this.deserialize(JSON.parse(string));\n  }\n  registerClass(v, options) {\n    this.classRegistry.register(v, options);\n  }\n  registerSymbol(v, identifier) {\n    this.symbolRegistry.register(v, identifier);\n  }\n  registerCustom(transformer, name) {\n    this.customTransformerRegistry.register({\n      name,\n      ...transformer\n    });\n  }\n  allowErrorProps(...props) {\n    this.allowedErrorProps.push(...props);\n  }\n};\nSuperJSON.defaultInstance = new SuperJSON();\nSuperJSON.serialize = SuperJSON.defaultInstance.serialize.bind(SuperJSON.defaultInstance);\nSuperJSON.deserialize = SuperJSON.defaultInstance.deserialize.bind(SuperJSON.defaultInstance);\nSuperJSON.stringify = SuperJSON.defaultInstance.stringify.bind(SuperJSON.defaultInstance);\nSuperJSON.parse = SuperJSON.defaultInstance.parse.bind(SuperJSON.defaultInstance);\nSuperJSON.registerClass = SuperJSON.defaultInstance.registerClass.bind(SuperJSON.defaultInstance);\nSuperJSON.registerSymbol = SuperJSON.defaultInstance.registerSymbol.bind(SuperJSON.defaultInstance);\nSuperJSON.registerCustom = SuperJSON.defaultInstance.registerCustom.bind(SuperJSON.defaultInstance);\nSuperJSON.allowErrorProps = SuperJSON.defaultInstance.allowErrorProps.bind(SuperJSON.defaultInstance);\nvar serialize = SuperJSON.serialize;\nSuperJSON.deserialize;\nvar stringify = SuperJSON.stringify;\nSuperJSON.parse;\nSuperJSON.registerClass;\nSuperJSON.registerCustom;\nSuperJSON.registerSymbol;\nSuperJSON.allowErrorProps;\n\n// src/utils.tsx\nfunction getQueryStatusLabel(query) {\n  return query.state.fetchStatus === \"fetching\" ? \"fetching\" : !query.getObserversCount() ? \"inactive\" : query.state.fetchStatus === \"paused\" ? \"paused\" : query.isStale() ? \"stale\" : \"fresh\";\n}\nfunction getSidedProp(prop, side) {\n  return `${prop}${side.charAt(0).toUpperCase() + side.slice(1)}`;\n}\nfunction getQueryStatusColor({\n  queryState,\n  observerCount,\n  isStale\n}) {\n  return queryState.fetchStatus === \"fetching\" ? \"blue\" : !observerCount ? \"gray\" : queryState.fetchStatus === \"paused\" ? \"purple\" : isStale ? \"yellow\" : \"green\";\n}\nfunction getMutationStatusColor({\n  status,\n  isPaused\n}) {\n  return isPaused ? \"purple\" : status === \"error\" ? \"red\" : status === \"pending\" ? \"yellow\" : status === \"success\" ? \"green\" : \"gray\";\n}\nfunction getQueryStatusColorByLabel(label) {\n  return label === \"fresh\" ? \"green\" : label === \"stale\" ? \"yellow\" : label === \"paused\" ? \"purple\" : label === \"inactive\" ? \"gray\" : \"blue\";\n}\nvar displayValue = (value, beautify = false) => {\n  const {\n    json\n  } = serialize(value);\n  return JSON.stringify(json, null, beautify ? 2 : void 0);\n};\nvar getStatusRank = (q) => q.state.fetchStatus !== \"idle\" ? 0 : !q.getObserversCount() ? 3 : q.isStale() ? 2 : 1;\nvar queryHashSort = (a, b) => a.queryHash.localeCompare(b.queryHash);\nvar dateSort = (a, b) => a.state.dataUpdatedAt < b.state.dataUpdatedAt ? 1 : -1;\nvar statusAndDateSort = (a, b) => {\n  if (getStatusRank(a) === getStatusRank(b)) {\n    return dateSort(a, b);\n  }\n  return getStatusRank(a) > getStatusRank(b) ? 1 : -1;\n};\nvar sortFns = {\n  status: statusAndDateSort,\n  \"query hash\": queryHashSort,\n  \"last updated\": dateSort\n};\nvar getMutationStatusRank = (m) => m.state.isPaused ? 0 : m.state.status === \"error\" ? 2 : m.state.status === \"pending\" ? 1 : 3;\nvar mutationDateSort = (a, b) => a.state.submittedAt < b.state.submittedAt ? 1 : -1;\nvar mutationStatusSort = (a, b) => {\n  if (getMutationStatusRank(a) === getMutationStatusRank(b)) {\n    return mutationDateSort(a, b);\n  }\n  return getMutationStatusRank(a) > getMutationStatusRank(b) ? 1 : -1;\n};\nvar mutationSortFns = {\n  status: mutationStatusSort,\n  \"last updated\": mutationDateSort\n};\nvar convertRemToPixels = (rem) => {\n  return rem * parseFloat(getComputedStyle(document.documentElement).fontSize);\n};\nvar getPreferredColorScheme = () => {\n  const [colorScheme, setColorScheme] = createSignal(\"dark\");\n  onMount(() => {\n    const query = window.matchMedia(\"(prefers-color-scheme: dark)\");\n    setColorScheme(query.matches ? \"dark\" : \"light\");\n    const listener = (e) => {\n      setColorScheme(e.matches ? \"dark\" : \"light\");\n    };\n    query.addEventListener(\"change\", listener);\n    onCleanup(() => query.removeEventListener(\"change\", listener));\n  });\n  return colorScheme;\n};\nvar updateNestedDataByPath = (oldData, updatePath, value) => {\n  if (updatePath.length === 0) {\n    return value;\n  }\n  if (oldData instanceof Map) {\n    const newData = new Map(oldData);\n    if (updatePath.length === 1) {\n      newData.set(updatePath[0], value);\n      return newData;\n    }\n    const [head, ...tail] = updatePath;\n    newData.set(head, updateNestedDataByPath(newData.get(head), tail, value));\n    return newData;\n  }\n  if (oldData instanceof Set) {\n    const setAsArray = updateNestedDataByPath(Array.from(oldData), updatePath, value);\n    return new Set(setAsArray);\n  }\n  if (Array.isArray(oldData)) {\n    const newData = [...oldData];\n    if (updatePath.length === 1) {\n      newData[updatePath[0]] = value;\n      return newData;\n    }\n    const [head, ...tail] = updatePath;\n    newData[head] = updateNestedDataByPath(newData[head], tail, value);\n    return newData;\n  }\n  if (oldData instanceof Object) {\n    const newData = {\n      ...oldData\n    };\n    if (updatePath.length === 1) {\n      newData[updatePath[0]] = value;\n      return newData;\n    }\n    const [head, ...tail] = updatePath;\n    newData[head] = updateNestedDataByPath(newData[head], tail, value);\n    return newData;\n  }\n  return oldData;\n};\nvar deleteNestedDataByPath = (oldData, deletePath) => {\n  if (oldData instanceof Map) {\n    const newData = new Map(oldData);\n    if (deletePath.length === 1) {\n      newData.delete(deletePath[0]);\n      return newData;\n    }\n    const [head, ...tail] = deletePath;\n    newData.set(head, deleteNestedDataByPath(newData.get(head), tail));\n    return newData;\n  }\n  if (oldData instanceof Set) {\n    const setAsArray = deleteNestedDataByPath(Array.from(oldData), deletePath);\n    return new Set(setAsArray);\n  }\n  if (Array.isArray(oldData)) {\n    const newData = [...oldData];\n    if (deletePath.length === 1) {\n      return newData.filter((_, idx) => idx.toString() !== deletePath[0]);\n    }\n    const [head, ...tail] = deletePath;\n    newData[head] = deleteNestedDataByPath(newData[head], tail);\n    return newData;\n  }\n  if (oldData instanceof Object) {\n    const newData = {\n      ...oldData\n    };\n    if (deletePath.length === 1) {\n      delete newData[deletePath[0]];\n      return newData;\n    }\n    const [head, ...tail] = deletePath;\n    newData[head] = deleteNestedDataByPath(newData[head], tail);\n    return newData;\n  }\n  return oldData;\n};\nvar setupStyleSheet = (nonce, target) => {\n  if (!nonce) return;\n  const styleExists = document.querySelector(\"#_goober\") || target?.querySelector(\"#_goober\");\n  if (styleExists) return;\n  const styleTag = document.createElement(\"style\");\n  const textNode = document.createTextNode(\"\");\n  styleTag.appendChild(textNode);\n  styleTag.id = \"_goober\";\n  styleTag.setAttribute(\"nonce\", nonce);\n  if (target) {\n    target.appendChild(styleTag);\n  } else {\n    document.head.appendChild(styleTag);\n  }\n};\n\nexport { $TRACK, DEV, Dynamic, For, Index, Match, Portal, Show, Switch, addEventListener, batch, className, clearDelegatedEvents, convertRemToPixels, createComponent, createComputed, createContext, createEffect, createMemo, createRenderEffect, createRoot, createSignal, createUniqueId, delegateEvents, deleteNestedDataByPath, displayValue, getMutationStatusColor, getOwner, getPreferredColorScheme, getQueryStatusColor, getQueryStatusColorByLabel, getQueryStatusLabel, getSidedProp, insert, isServer, lazy, memo, mergeProps, mutationSortFns, on, onCleanup, onMount, render, serialize, setAttribute, setupStyleSheet, sortFns, splitProps, spread, stringify, template, untrack, updateNestedDataByPath, use, useContext, useTransition };\n","import { createSignal, render, lazy, setupStyleSheet, createComponent, mergeProps } from './chunk/CXOMC62J.js';\n\n// src/TanstackQueryDevtools.tsx\nvar TanstackQueryDevtools = class {\n  #client;\n  #onlineManager;\n  #queryFlavor;\n  #version;\n  #isMounted = false;\n  #styleNonce;\n  #shadowDOMTarget;\n  #buttonPosition;\n  #position;\n  #initialIsOpen;\n  #errorTypes;\n  #hideDisabledQueries;\n  #Component;\n  #dispose;\n  constructor(config) {\n    const {\n      client,\n      queryFlavor,\n      version,\n      onlineManager,\n      buttonPosition,\n      position,\n      initialIsOpen,\n      errorTypes,\n      styleNonce,\n      shadowDOMTarget,\n      hideDisabledQueries\n    } = config;\n    this.#client = createSignal(client);\n    this.#queryFlavor = queryFlavor;\n    this.#version = version;\n    this.#onlineManager = onlineManager;\n    this.#styleNonce = styleNonce;\n    this.#shadowDOMTarget = shadowDOMTarget;\n    this.#buttonPosition = createSignal(buttonPosition);\n    this.#position = createSignal(position);\n    this.#initialIsOpen = createSignal(initialIsOpen);\n    this.#errorTypes = createSignal(errorTypes);\n    this.#hideDisabledQueries = createSignal(hideDisabledQueries);\n  }\n  setButtonPosition(position) {\n    this.#buttonPosition[1](position);\n  }\n  setPosition(position) {\n    this.#position[1](position);\n  }\n  setInitialIsOpen(isOpen) {\n    this.#initialIsOpen[1](isOpen);\n  }\n  setErrorTypes(errorTypes) {\n    this.#errorTypes[1](errorTypes);\n  }\n  setClient(client) {\n    this.#client[1](client);\n  }\n  mount(el) {\n    if (this.#isMounted) {\n      throw new Error(\"Devtools is already mounted\");\n    }\n    const dispose = render(() => {\n      const _self$ = this;\n      const [btnPosition] = this.#buttonPosition;\n      const [pos] = this.#position;\n      const [isOpen] = this.#initialIsOpen;\n      const [errors] = this.#errorTypes;\n      const [hideDisabledQueries] = this.#hideDisabledQueries;\n      const [queryClient] = this.#client;\n      let Devtools;\n      if (this.#Component) {\n        Devtools = this.#Component;\n      } else {\n        Devtools = lazy(() => import('./DevtoolsComponent/EDEL3XIZ.js'));\n        this.#Component = Devtools;\n      }\n      setupStyleSheet(this.#styleNonce, this.#shadowDOMTarget);\n      return createComponent(Devtools, mergeProps({\n        get queryFlavor() {\n          return _self$.#queryFlavor;\n        },\n        get version() {\n          return _self$.#version;\n        },\n        get onlineManager() {\n          return _self$.#onlineManager;\n        },\n        get shadowDOMTarget() {\n          return _self$.#shadowDOMTarget;\n        }\n      }, {\n        get client() {\n          return queryClient();\n        },\n        get buttonPosition() {\n          return btnPosition();\n        },\n        get position() {\n          return pos();\n        },\n        get initialIsOpen() {\n          return isOpen();\n        },\n        get errorTypes() {\n          return errors();\n        },\n        get hideDisabledQueries() {\n          return hideDisabledQueries();\n        }\n      }));\n    }, el);\n    this.#isMounted = true;\n    this.#dispose = dispose;\n  }\n  unmount() {\n    if (!this.#isMounted) {\n      throw new Error(\"Devtools is not mounted\");\n    }\n    this.#dispose?.();\n    this.#isMounted = false;\n  }\n};\n\n// src/TanstackQueryDevtoolsPanel.tsx\nvar TanstackQueryDevtoolsPanel = class {\n  #client;\n  #onlineManager;\n  #queryFlavor;\n  #version;\n  #isMounted = false;\n  #styleNonce;\n  #shadowDOMTarget;\n  #buttonPosition;\n  #position;\n  #initialIsOpen;\n  #errorTypes;\n  #hideDisabledQueries;\n  #onClose;\n  #Component;\n  #dispose;\n  constructor(config) {\n    const {\n      client,\n      queryFlavor,\n      version,\n      onlineManager,\n      buttonPosition,\n      position,\n      initialIsOpen,\n      errorTypes,\n      styleNonce,\n      shadowDOMTarget,\n      onClose,\n      hideDisabledQueries\n    } = config;\n    this.#client = createSignal(client);\n    this.#queryFlavor = queryFlavor;\n    this.#version = version;\n    this.#onlineManager = onlineManager;\n    this.#styleNonce = styleNonce;\n    this.#shadowDOMTarget = shadowDOMTarget;\n    this.#buttonPosition = createSignal(buttonPosition);\n    this.#position = createSignal(position);\n    this.#initialIsOpen = createSignal(initialIsOpen);\n    this.#errorTypes = createSignal(errorTypes);\n    this.#hideDisabledQueries = createSignal(hideDisabledQueries);\n    this.#onClose = createSignal(onClose);\n  }\n  setButtonPosition(position) {\n    this.#buttonPosition[1](position);\n  }\n  setPosition(position) {\n    this.#position[1](position);\n  }\n  setInitialIsOpen(isOpen) {\n    this.#initialIsOpen[1](isOpen);\n  }\n  setErrorTypes(errorTypes) {\n    this.#errorTypes[1](errorTypes);\n  }\n  setClient(client) {\n    this.#client[1](client);\n  }\n  setOnClose(onClose) {\n    this.#onClose[1](() => onClose);\n  }\n  mount(el) {\n    if (this.#isMounted) {\n      throw new Error(\"Devtools is already mounted\");\n    }\n    const dispose = render(() => {\n      const _self$ = this;\n      const [btnPosition] = this.#buttonPosition;\n      const [pos] = this.#position;\n      const [isOpen] = this.#initialIsOpen;\n      const [errors] = this.#errorTypes;\n      const [hideDisabledQueries] = this.#hideDisabledQueries;\n      const [queryClient] = this.#client;\n      const [onClose] = this.#onClose;\n      let Devtools;\n      if (this.#Component) {\n        Devtools = this.#Component;\n      } else {\n        Devtools = lazy(() => import('./DevtoolsPanelComponent/RN252AT2.js'));\n        this.#Component = Devtools;\n      }\n      setupStyleSheet(this.#styleNonce, this.#shadowDOMTarget);\n      return createComponent(Devtools, mergeProps({\n        get queryFlavor() {\n          return _self$.#queryFlavor;\n        },\n        get version() {\n          return _self$.#version;\n        },\n        get onlineManager() {\n          return _self$.#onlineManager;\n        },\n        get shadowDOMTarget() {\n          return _self$.#shadowDOMTarget;\n        }\n      }, {\n        get client() {\n          return queryClient();\n        },\n        get buttonPosition() {\n          return btnPosition();\n        },\n        get position() {\n          return pos();\n        },\n        get initialIsOpen() {\n          return isOpen();\n        },\n        get errorTypes() {\n          return errors();\n        },\n        get hideDisabledQueries() {\n          return hideDisabledQueries();\n        },\n        get onClose() {\n          return onClose();\n        }\n      }));\n    }, el);\n    this.#isMounted = true;\n    this.#dispose = dispose;\n  }\n  unmount() {\n    if (!this.#isMounted) {\n      throw new Error(\"Devtools is not mounted\");\n    }\n    this.#dispose?.();\n    this.#isMounted = false;\n  }\n};\n\nexport { TanstackQueryDevtools, TanstackQueryDevtoolsPanel };\n","\"use client\";\n\n// src/ReactQueryDevtools.tsx\nimport * as React from \"react\";\nimport { onlineManager, useQueryClient } from \"@tanstack/react-query\";\nimport { TanstackQueryDevtools } from \"@tanstack/query-devtools\";\nimport { jsx } from \"react/jsx-runtime\";\nfunction ReactQueryDevtools(props) {\n  const queryClient = useQueryClient(props.client);\n  const ref = React.useRef(null);\n  const {\n    buttonPosition,\n    position,\n    initialIsOpen,\n    errorTypes,\n    styleNonce,\n    shadowDOMTarget,\n    hideDisabledQueries\n  } = props;\n  const [devtools] = React.useState(\n    new TanstackQueryDevtools({\n      client: queryClient,\n      queryFlavor: \"React Query\",\n      version: \"5\",\n      onlineManager,\n      buttonPosition,\n      position,\n      initialIsOpen,\n      errorTypes,\n      styleNonce,\n      shadowDOMTarget,\n      hideDisabledQueries\n    })\n  );\n  React.useEffect(() => {\n    devtools.setClient(queryClient);\n  }, [queryClient, devtools]);\n  React.useEffect(() => {\n    if (buttonPosition) {\n      devtools.setButtonPosition(buttonPosition);\n    }\n  }, [buttonPosition, devtools]);\n  React.useEffect(() => {\n    if (position) {\n      devtools.setPosition(position);\n    }\n  }, [position, devtools]);\n  React.useEffect(() => {\n    devtools.setInitialIsOpen(initialIsOpen || false);\n  }, [initialIsOpen, devtools]);\n  React.useEffect(() => {\n    devtools.setErrorTypes(errorTypes || []);\n  }, [errorTypes, devtools]);\n  React.useEffect(() => {\n    if (ref.current) {\n      devtools.mount(ref.current);\n    }\n    return () => {\n      devtools.unmount();\n    };\n  }, [devtools]);\n  return /* @__PURE__ */ jsx(\"div\", { dir: \"ltr\", className: \"tsqd-parent-container\", ref });\n}\nexport {\n  ReactQueryDevtools\n};\n//# sourceMappingURL=ReactQueryDevtools.js.map","\"use client\";\n\n// src/index.ts\nimport * as Devtools from \"./ReactQueryDevtools.js\";\nimport * as DevtoolsPanel from \"./ReactQueryDevtoolsPanel.js\";\nvar ReactQueryDevtools2 = process.env.NODE_ENV !== \"development\" ? function() {\n  return null;\n} : Devtools.ReactQueryDevtools;\nvar ReactQueryDevtoolsPanel2 = process.env.NODE_ENV !== \"development\" ? function() {\n  return null;\n} : DevtoolsPanel.ReactQueryDevtoolsPanel;\nexport {\n  ReactQueryDevtools2 as ReactQueryDevtools,\n  ReactQueryDevtoolsPanel2 as ReactQueryDevtoolsPanel\n};\n//# sourceMappingURL=index.js.map","import React from 'react';\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\r\nimport { ReactQueryDevtools } from '@tanstack/react-query-devtools';\r\n\r\n// Create a client\r\nconst queryClient = new QueryClient({\r\n  defaultOptions: {\r\n    queries: {\r\n      staleTime: 5 * 60 * 1000, // 5 minutes\r\n      gcTime: 10 * 60 * 1000, // 10 minutes (formerly cacheTime)\r\n      retry: (failureCount, error) => {\r\n        // Don't retry on 4xx errors\r\n        if (error && typeof error === 'object' && 'status' in error) {\r\n          const status = (error as any).status;\r\n          if (status >= 400 && status < 500) {\r\n            return false;\r\n          }\r\n        }\r\n        return failureCount < 3;\r\n      },\r\n      refetchOnWindowFocus: false,\r\n      refetchOnReconnect: true,\r\n    },\r\n    mutations: {\r\n      retry: 1,\r\n    },\r\n  },\r\n});\r\n\r\ninterface QueryProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const QueryProvider: React.FC<QueryProviderProps> = ({ children }) => {\r\n  return (\r\n    <QueryClientProvider client={queryClient}>\r\n      {children}\r\n      {process.env.NODE_ENV === 'development' && (\r\n        <ReactQueryDevtools initialIsOpen={false} />\r\n      )}\r\n    </QueryClientProvider>\r\n  );\r\n};\r\n","// Service Worker Utilities for Enhanced Security and Compatibility\r\nimport { shouldSkipServiceWorkerInFirefox, displayFirefoxServiceWorkerHelp } from './firefoxServiceWorkerFix';\r\n\r\nexport interface ServiceWorkerConfig {\r\n  enabled: boolean;\r\n  scope: string;\r\n  updateViaCache: ServiceWorkerUpdateViaCache;\r\n  skipWaiting: boolean;\r\n}\r\n\r\nexport interface BrowserCompatibility {\r\n  supportsServiceWorker: boolean;\r\n  supportsSecureContext: boolean;\r\n  isSecureContext: boolean;\r\n  isHTTPS: boolean;\r\n  isLocalhost: boolean;\r\n  userAgent: string;\r\n  browserName: string;\r\n}\r\n\r\n/**\r\n * Detect browser compatibility for Service Worker\r\n */\r\nexport function detectBrowserCompatibility(): BrowserCompatibility {\r\n  const userAgent = navigator.userAgent;\r\n  const isHTTPS = window.location.protocol === 'https:';\r\n  const isLocalhost = window.location.hostname === 'localhost' || \r\n                     window.location.hostname === '127.0.0.1' ||\r\n                     window.location.hostname === '0.0.0.0';\r\n  \r\n  // Detect browser name\r\n  let browserName = 'unknown';\r\n  if (userAgent.includes('Firefox')) {\r\n    browserName = 'firefox';\r\n  } else if (userAgent.includes('Chrome')) {\r\n    browserName = 'chrome';\r\n  } else if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) {\r\n    browserName = 'safari';\r\n  } else if (userAgent.includes('Edge')) {\r\n    browserName = 'edge';\r\n  }\r\n  \r\n  return {\r\n    supportsServiceWorker: 'serviceWorker' in navigator,\r\n    supportsSecureContext: 'isSecureContext' in window,\r\n    isSecureContext: window.isSecureContext || false,\r\n    isHTTPS,\r\n    isLocalhost,\r\n    userAgent,\r\n    browserName,\r\n  };\r\n}\r\n\r\n/**\r\n * Check if Service Worker registration is allowed\r\n */\r\nexport function canRegisterServiceWorker(): { allowed: boolean; reason?: string } {\r\n  const compatibility = detectBrowserCompatibility();\r\n  \r\n  // Check basic support\r\n  if (!compatibility.supportsServiceWorker) {\r\n    return { allowed: false, reason: 'Service Worker not supported in this browser' };\r\n  }\r\n  \r\n  // Check secure context\r\n  if (!compatibility.isSecureContext) {\r\n    return { allowed: false, reason: 'Not in a secure context (HTTPS or localhost required)' };\r\n  }\r\n  \r\n  // Check HTTPS or localhost\r\n  if (!compatibility.isHTTPS && !compatibility.isLocalhost) {\r\n    return { allowed: false, reason: 'Service Worker requires HTTPS or localhost' };\r\n  }\r\n  \r\n  // Firefox-specific checks\r\n  if (compatibility.browserName === 'firefox') {\r\n    console.log('🔍 Firefox detected - checking privacy settings');\r\n    \r\n    if (shouldSkipServiceWorkerInFirefox()) {\r\n      displayFirefoxServiceWorkerHelp();\r\n      return { allowed: false, reason: 'Firefox privacy settings block Service Worker' };\r\n    }\r\n  }\r\n  \r\n  return { allowed: true };\r\n}\r\n\r\n/**\r\n * Get Service Worker configuration based on environment and browser\r\n */\r\nexport function getServiceWorkerConfig(): ServiceWorkerConfig {\r\n  const compatibility = detectBrowserCompatibility();\r\n  \r\n  return {\r\n    enabled: import.meta.env.PROD && compatibility.isSecureContext,\r\n    scope: '/',\r\n    updateViaCache: 'none' as ServiceWorkerUpdateViaCache,\r\n    skipWaiting: true,\r\n  };\r\n}\r\n\r\n/**\r\n * Register Service Worker with enhanced error handling\r\n */\r\nexport async function registerServiceWorker(\r\n  scriptURL: string = '/sw.js',\r\n  config?: Partial<ServiceWorkerConfig>\r\n): Promise<ServiceWorkerRegistration | null> {\r\n  const canRegister = canRegisterServiceWorker();\r\n  \r\n  if (!canRegister.allowed) {\r\n    console.warn(`⚠️ Service Worker registration skipped: ${canRegister.reason}`);\r\n    return null;\r\n  }\r\n  \r\n  const defaultConfig = getServiceWorkerConfig();\r\n  const finalConfig = { ...defaultConfig, ...config };\r\n  \r\n  if (!finalConfig.enabled) {\r\n    console.log('ℹ️ Service Worker registration disabled by configuration');\r\n    return null;\r\n  }\r\n  \r\n  try {\r\n    console.log('🔄 Attempting to register Service Worker...');\r\n    \r\n    const registration = await navigator.serviceWorker.register(scriptURL, {\r\n      scope: finalConfig.scope,\r\n      updateViaCache: finalConfig.updateViaCache,\r\n    });\r\n    \r\n    console.log('✅ Service Worker registered successfully:', registration.scope);\r\n    \r\n    // Set up event listeners\r\n    setupServiceWorkerEventListeners(registration);\r\n    \r\n    return registration;\r\n  } catch (error) {\r\n    handleServiceWorkerError(error);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Set up Service Worker event listeners\r\n */\r\nfunction setupServiceWorkerEventListeners(registration: ServiceWorkerRegistration): void {\r\n  // Handle updates\r\n  registration.addEventListener('updatefound', () => {\r\n    console.log('🔄 Service Worker update found');\r\n    \r\n    const newWorker = registration.installing;\r\n    if (newWorker) {\r\n      newWorker.addEventListener('statechange', () => {\r\n        if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\r\n          console.log('🔄 New Service Worker installed, ready to activate');\r\n          // Optionally show update notification to user\r\n        }\r\n      });\r\n    }\r\n  });\r\n  \r\n  // Handle state changes\r\n  registration.addEventListener('statechange', () => {\r\n    console.log('🔄 Service Worker state changed:', registration.active?.state);\r\n  });\r\n  \r\n  // Global error handler\r\n  navigator.serviceWorker.addEventListener('error', (event) => {\r\n    console.error('❌ Service Worker error:', event);\r\n  });\r\n  \r\n  // Message handler\r\n  navigator.serviceWorker.addEventListener('message', (event) => {\r\n    console.log('📨 Service Worker message:', event.data);\r\n  });\r\n}\r\n\r\n/**\r\n * Handle Service Worker registration errors\r\n */\r\nfunction handleServiceWorkerError(error: any): void {\r\n  const errorMessage = error.message || error.toString();\r\n  \r\n  if (error.name === 'SecurityError') {\r\n    console.warn('⚠️ Service Worker registration blocked by security policy:', errorMessage);\r\n  } else if (error.name === 'NotSupportedError') {\r\n    console.warn('⚠️ Service Worker not supported in this context:', errorMessage);\r\n  } else if (errorMessage.includes('insecure') || errorMessage.includes('insecure')) {\r\n    console.warn('⚠️ Service Worker registration failed: Insecure context detected');\r\n  } else if (errorMessage.includes('DOMException')) {\r\n    console.warn('⚠️ Service Worker registration failed: DOM Exception - likely security restriction');\r\n  } else {\r\n    console.error('❌ Service Worker registration failed:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Unregister all Service Workers (useful for development)\r\n */\r\nexport async function unregisterAllServiceWorkers(): Promise<void> {\r\n  if (!('serviceWorker' in navigator)) {\r\n    return;\r\n  }\r\n  \r\n  try {\r\n    const registrations = await navigator.serviceWorker.getRegistrations();\r\n    \r\n    for (const registration of registrations) {\r\n      await registration.unregister();\r\n      console.log('🔄 Service Worker unregistered:', registration.scope);\r\n    }\r\n    \r\n    console.log(`✅ Unregistered ${registrations.length} Service Worker(s)`);\r\n  } catch (error) {\r\n    console.error('❌ Failed to unregister Service Workers:', error);\r\n  }\r\n}\r\n\r\n/**\r\n * Check Service Worker status\r\n */\r\nexport async function getServiceWorkerStatus(): Promise<{\r\n  isRegistered: boolean;\r\n  isControlling: boolean;\r\n  registrations: readonly ServiceWorkerRegistration[];\r\n  controller: ServiceWorker | null;\r\n}> {\r\n  if (!('serviceWorker' in navigator)) {\r\n    return {\r\n      isRegistered: false,\r\n      isControlling: false,\r\n      registrations: [],\r\n      controller: null,\r\n    };\r\n  }\r\n  \r\n  try {\r\n    const registrations = await navigator.serviceWorker.getRegistrations();\r\n    const controller = navigator.serviceWorker.controller;\r\n    \r\n    return {\r\n      isRegistered: registrations.length > 0,\r\n      isControlling: !!controller,\r\n      registrations,\r\n      controller,\r\n    };\r\n  } catch (error) {\r\n    console.error('❌ Failed to get Service Worker status:', error);\r\n    return {\r\n      isRegistered: false,\r\n      isControlling: false,\r\n      registrations: [],\r\n      controller: null,\r\n    };\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport App from './App.tsx';\r\nimport './index.css';\r\nimport { setupConsoleFilter } from './utils/consoleFilter';\r\nimport './utils/apiInterceptor';\r\nimport { QueryProvider } from './providers/QueryProvider';\r\nimport { registerServiceWorker, unregisterAllServiceWorkers, detectBrowserCompatibility } from './utils/serviceWorkerUtils';\r\n\r\n// Import Service Worker cache clearer for development\r\nif (import.meta.env.DEV) {\r\n  // Dynamically load the cache clearer script\r\n  const script = document.createElement('script');\r\n  script.src = '/clear-sw-cache.js';\r\n  script.onload = () => console.log('✅ Service Worker cache clearer loaded');\r\n  script.onerror = () => console.log('⚠️ Service Worker cache clearer not available');\r\n  document.head.appendChild(script);\r\n}\r\n\r\n// Setup console filter to suppress expected warnings in development\r\nsetupConsoleFilter();\r\n\r\n// Enhanced Service Worker registration with comprehensive security checks\r\nconst browserCompatibility = detectBrowserCompatibility();\r\nconsole.log('🔍 Browser compatibility check:', {\r\n  browser: browserCompatibility.browserName,\r\n  supportsServiceWorker: browserCompatibility.supportsServiceWorker,\r\n  isSecureContext: browserCompatibility.isSecureContext,\r\n  isHTTPS: browserCompatibility.isHTTPS,\r\n  isLocalhost: browserCompatibility.isLocalhost,\r\n});\r\n\r\nif (import.meta.env.PROD) {\r\n  // Production: Register Service Worker with enhanced security checks\r\n  window.addEventListener('load', async () => {\r\n    try {\r\n      await registerServiceWorker('/sw.js');\r\n    } catch (error) {\r\n      console.warn('⚠️ Service Worker registration failed in production:', error);\r\n    }\r\n  });\r\n} else if (import.meta.env.DEV) {\r\n  // Development: Unregister any existing service workers\r\n  window.addEventListener('load', async () => {\r\n    try {\r\n      await unregisterAllServiceWorkers();\r\n    } catch (error) {\r\n      console.warn('⚠️ Failed to unregister Service Workers in development:', error);\r\n    }\r\n  });\r\n}\r\n\r\n// Optimize font loading with proper resource hints\r\n// 1. Preconnect to the domain that will serve the font files\r\nconst preconnectLink = document.createElement('link');\r\npreconnectLink.rel = 'preconnect';\r\npreconnectLink.href = 'https://fonts.gstatic.com';\r\npreconnectLink.crossOrigin = 'anonymous';\r\ndocument.head.appendChild(preconnectLink);\r\n\r\n// 2. Add the font stylesheet with proper loading strategy\r\n// Using a direct link element with font-display: swap to prevent FOIT\r\nconst fontLink = document.createElement('link');\r\nfontLink.rel = 'stylesheet';\r\nfontLink.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap&font-display=swap';\r\ndocument.head.appendChild(fontLink);\r\n\r\n// Ensure proper rendering\r\nReactDOM.createRoot(document.getElementById('root')!).render(\r\n  <React.StrictMode>\r\n    <QueryProvider>\r\n      <App />\r\n    </QueryProvider>\r\n  </React.StrictMode>\r\n);\r\n"],"file":"assets/js/index-8uLCGpbZ.js"}