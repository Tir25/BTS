const t=t=>{let e;const n=new Set,i=(t,i)=>{const s="function"==typeof t?t(e):t;if(!Object.is(s,e)){const t=e;e=(null!=i?i:"object"!=typeof s||null===s)?s:Object.assign({},e,s),n.forEach(n=>n(e,t))}},s=()=>e,o={setState:i,getState:s,getInitialState:()=>r,subscribe:t=>(n.add(t),()=>n.delete(t))},r=e=t(i,s,o);return o},e=e=>e?t(e):t,n={BASE_URL:"/",DEV:!0,MODE:"production",PROD:!1,SSR:!1,VITE_API_URL:"http://localhost:3000",VITE_MAPLIBRE_TOKEN:"",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd0aHdtd2Z3dmh5cml5Z3BjZGxyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ5NzE0NTUsImV4cCI6MjA3MDU0NzQ1NX0.gY0ghDtKZ9b8XlgE7XtbQsT3efXYOBizGQKPJABGvAI",VITE_SUPABASE_URL:"https://gthwmwfwvhyriygpcdlr.supabase.co",VITE_USER_NODE_ENV:"development",VITE_WEBSOCKET_URL:"ws://localhost:3000"},i=new Map,s=t=>{const e=i.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([t,e])=>[t,e.getState()])):{}},o=t=>{var e,n;if(!t)return;const i=t.split("\n"),s=i.findIndex(t=>t.includes("api.setState"));if(s<0)return;const o=(null==(e=i[s+1])?void 0:e.trim())||"";return null==(n=/.+ (.+) .+/.exec(o))?void 0:n[1]},r=(t,e={})=>(r,a,l)=>{const{enabled:u,anonymousActionType:d,store:p,...S}=e;let y;try{y=(null!=u?u:"production"!==(n?"production":void 0))&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(_){}if(!y)return t(r,a,l);const{connection:f,...E}=((t,e,n)=>{if(void 0===t)return{type:"untracked",connection:e.connect(n)};const s=i.get(n.name);if(s)return{type:"tracked",store:t,...s};const o={connection:e.connect(n),stores:{}};return i.set(n.name,o),{type:"tracked",store:t,...o}})(p,y,S);let O=!0;l.setState=(t,e,n)=>{const i=r(t,e);if(!O)return i;const c=void 0===n?{type:d||o((new Error).stack)||"anonymous"}:"string"==typeof n?{type:n}:n;return void 0===p?(null==f||f.send(c,a()),i):(null==f||f.send({...c,type:`${p}/${c.type}`},{...s(S.name),[p]:l.getState()}),i)},l.devtools={cleanup:()=>{f&&"function"==typeof f.unsubscribe&&f.unsubscribe(),((t,e)=>{if(void 0===e)return;const n=i.get(t);n&&(delete n.stores[e],0===Object.keys(n.stores).length&&i.delete(t))})(S.name,p)}};const I=(...t)=>{const e=O;O=!1,r(...t),O=e},v=t(l.setState,a,l);if("untracked"===E.type?null==f||f.init(v):(E.stores[E.store]=l,null==f||f.init(Object.fromEntries(Object.entries(E.stores).map(([t,e])=>[t,t===E.store?v:e.getState()])))),l.dispatchFromDevtools&&"function"==typeof l.dispatch){let t=!1;const e=l.dispatch;l.dispatch=(...i)=>{"production"===(n?"production":void 0)||"__setState"!==i[0].type||t||(t=!0),e(...i)}}return f.subscribe(t=>{var e;switch(t.type){case"ACTION":if("string"!=typeof t.payload)return;return c(t.payload,t=>{if("__setState"===t.type){if(void 0===p)return void I(t.state);Object.keys(t.state).length;const e=t.state[p];if(null==e)return;return void(JSON.stringify(l.getState())!==JSON.stringify(e)&&I(e))}l.dispatchFromDevtools&&"function"==typeof l.dispatch&&l.dispatch(t)});case"DISPATCH":switch(t.payload.type){case"RESET":return I(v),void 0===p?null==f?void 0:f.init(l.getState()):null==f?void 0:f.init(s(S.name));case"COMMIT":return void 0===p?void(null==f||f.init(l.getState())):null==f?void 0:f.init(s(S.name));case"ROLLBACK":return c(t.state,t=>{if(void 0===p)return I(t),void(null==f||f.init(l.getState()));I(t[p]),null==f||f.init(s(S.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return c(t.state,t=>{void 0!==p?JSON.stringify(l.getState())!==JSON.stringify(t[p])&&I(t[p]):I(t)});case"IMPORT_STATE":{const{nextLiftedState:n}=t.payload,i=null==(e=n.computedStates.slice(-1)[0])?void 0:e.state;if(!i)return;return I(void 0===p?i:i[p]),void(null==f||f.send(null,n))}case"PAUSE_RECORDING":return O=!O}return}}),v},c=(t,e)=>{let n;try{n=JSON.parse(t)}catch(i){}void 0!==n&&e(n)};export{e as c,r as d};
